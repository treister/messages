(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/axO":function(t,e,n){(function(t){var e=void 0,r=function(r){return e||(e=new Promise(function(e,s){var i,a=void 0!==r?r:{},o=a.onAbort;a.onAbort=function(t){s(new Error(t)),o&&o(t)},a.postRun=a.postRun||[],a.postRun.push(function(){e(a)}),t=void 0,i||(i=void 0!==a?a:{}),i.onRuntimeInitialized=function(){function t(t,e){this.Ra=t,this.db=e,this.Qa=1,this.lb=[]}function e(t,e){if(this.db=e,e=G(t)+1,this.eb=Le(e),null===this.eb)throw Error("Unable to allocate memory for the SQL string");q(t,P,this.eb,e),this.jb=this.eb,this.$a=this.pb=null}function n(t){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),null!=t){var e=this.filename,n=e?gt("//"+e):"/";if(n=Qt(n,4095&(void 0!==(e=me(!0,!0))?e:438)|32768,0),t){if("string"==typeof t){for(var s=Array(t.length),i=0,o=t.length;i<o;++i)s[i]=t.charCodeAt(i);t=s}ae(n,146|e),pe(s=ue(n,"w"),t,0,t.length,0,void 0),ce(s),ae(n,e)}}this.handleError(a(this.filename,r)),this.db=T(r,"i32"),st(this.db),this.fb={},this.Xa={}}var r=He(4),s=i.cwrap,a=s("sqlite3_open","number",["string","number"]),o=s("sqlite3_close_v2","number",["number"]),l=s("sqlite3_exec","number",["number","string","number","number","number"]),u=s("sqlite3_changes","number",["number"]),c=s("sqlite3_prepare_v2","number",["number","string","number","number","number"]),h=s("sqlite3_sql","string",["number"]),d=s("sqlite3_normalized_sql","string",["number"]),p=s("sqlite3_prepare_v2","number",["number","number","number","number","number"]),f=s("sqlite3_bind_text","number",["number","number","number","number","number"]),m=s("sqlite3_bind_blob","number",["number","number","number","number","number"]),g=s("sqlite3_bind_double","number",["number","number","number"]),y=s("sqlite3_bind_int","number",["number","number","number"]),b=s("sqlite3_bind_parameter_index","number",["number","string"]),v=s("sqlite3_step","number",["number"]),w=s("sqlite3_errmsg","string",["number"]),_=s("sqlite3_column_count","number",["number"]),k=s("sqlite3_data_count","number",["number"]),N=s("sqlite3_column_double","number",["number","number"]),R=s("sqlite3_column_text","string",["number","number"]),O=s("sqlite3_column_blob","number",["number","number"]),D=s("sqlite3_column_bytes","number",["number","number"]),F=s("sqlite3_column_type","number",["number","number"]),M=s("sqlite3_column_name","string",["number","number"]),z=s("sqlite3_reset","number",["number"]),B=s("sqlite3_clear_bindings","number",["number"]),V=s("sqlite3_finalize","number",["number"]),W=s("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),U=s("sqlite3_value_type","number",["number"]),K=s("sqlite3_value_bytes","number",["number"]),X=s("sqlite3_value_text","string",["number"]),Y=s("sqlite3_value_blob","number",["number"]),Z=s("sqlite3_value_double","number",["number"]),Q=s("sqlite3_result_double","",["number","number"]),J=s("sqlite3_result_null","",["number"]),tt=s("sqlite3_result_text","",["number","string","number","number"]),et=s("sqlite3_result_blob","",["number","number","number","number"]),nt=s("sqlite3_result_int","",["number","number"]),rt=s("sqlite3_result_error","",["number","string","number"]),st=s("RegisterExtensionFunctions","number",["number"]);t.prototype.bind=function(t){if(!this.Ra)throw"Statement closed";return this.reset(),Array.isArray(t)?this.Bb(t):null==t||"object"!=typeof t||this.Cb(t)},t.prototype.step=function(){if(!this.Ra)throw"Statement closed";this.Qa=1;var t=v(this.Ra);switch(t){case 100:return!0;case 101:return!1;default:throw this.db.handleError(t)}},t.prototype.Ib=function(t){return null==t&&(t=this.Qa,this.Qa+=1),N(this.Ra,t)},t.prototype.Jb=function(t){return null==t&&(t=this.Qa,this.Qa+=1),R(this.Ra,t)},t.prototype.getBlob=function(t){null==t&&(t=this.Qa,this.Qa+=1);var e=D(this.Ra,t);t=O(this.Ra,t);for(var n=new Uint8Array(e),r=0;r<e;r+=1)n[r]=L[t+r];return n},t.prototype.get=function(t){null!=t&&this.bind(t)&&this.step(),t=[];for(var e=k(this.Ra),n=0;n<e;n+=1)switch(F(this.Ra,n)){case 1:case 2:t.push(this.Ib(n));break;case 3:t.push(this.Jb(n));break;case 4:t.push(this.getBlob(n));break;default:t.push(null)}return t},t.prototype.getColumnNames=function(){for(var t=[],e=_(this.Ra),n=0;n<e;n+=1)t.push(M(this.Ra,n));return t},t.prototype.getAsObject=function(t){t=this.get(t);for(var e=this.getColumnNames(),n={},r=0;r<e.length;r+=1)n[e[r]]=t[r];return n},t.prototype.getSQL=function(){return h(this.Ra)},t.prototype.getNormalizedSQL=function(){return d(this.Ra)},t.prototype.run=function(t){return null!=t&&this.bind(t),this.step(),this.reset()},t.prototype.Fb=function(t,e){null==e&&(e=this.Qa,this.Qa+=1);var n=$(t=Oe(t));this.lb.push(n),this.db.handleError(f(this.Ra,e,n,t.length-1,0))},t.prototype.Ab=function(t,e){null==e&&(e=this.Qa,this.Qa+=1);var n=$(t);this.lb.push(n),this.db.handleError(m(this.Ra,e,n,t.length,0))},t.prototype.Eb=function(t,e){null==e&&(e=this.Qa,this.Qa+=1),this.db.handleError((t===(0|t)?y:g)(this.Ra,e,t))},t.prototype.Db=function(t){null==t&&(t=this.Qa,this.Qa+=1),m(this.Ra,t,0,0,0)},t.prototype.tb=function(t,e){switch(null==e&&(e=this.Qa,this.Qa+=1),typeof t){case"string":return void this.Fb(t,e);case"number":case"boolean":return void this.Eb(t+0,e);case"object":if(null===t)return void this.Db(e);if(null!=t.length)return void this.Ab(t,e)}throw"Wrong API use : tried to bind a value of an unknown type ("+t+")."},t.prototype.Cb=function(t){var e=this;return Object.keys(t).forEach(function(n){var r=b(e.Ra,n);0!==r&&e.tb(t[n],r)}),!0},t.prototype.Bb=function(t){for(var e=0;e<t.length;e+=1)this.tb(t[e],e+1);return!0},t.prototype.reset=function(){return 0===B(this.Ra)&&0===z(this.Ra)},t.prototype.freemem=function(){for(var t;void 0!==(t=this.lb.pop());)Pe(t)},t.prototype.free=function(){var t=0===V(this.Ra);return delete this.db.fb[this.Ra],this.Ra=0,t},e.prototype.next=function(){if(null===this.eb)return{done:!0};if(null!==this.$a&&(this.$a.free(),this.$a=null),!this.db.db)throw this.nb(),Error("Database closed");var e=Ue(),n=He(4);E(r),E(n);try{this.db.handleError(p(this.db.db,this.jb,-1,r,n)),this.jb=T(n,"i32");var s=T(r,"i32");return 0===s?(this.nb(),{done:!0}):(this.$a=new t(s,this.db),this.db.fb[s]=this.$a,{value:this.$a,done:!1})}catch(i){throw this.pb=H(this.jb),this.nb(),i}finally{je(e)}},e.prototype.nb=function(){Pe(this.eb),this.eb=null},e.prototype.getRemainingSQL=function(){return null!==this.pb?this.pb:H(this.jb)},"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(e.prototype[Symbol.iterator]=function(){return this}),n.prototype.run=function(t,e){if(!this.db)throw"Database closed";if(e){t=this.prepare(t,e);try{t.step()}finally{t.free()}}else this.handleError(l(this.db,t,0,0,r));return this},n.prototype.exec=function(e,n){if(!this.db)throw"Database closed";var s=Ue(),i=null;try{var a=G(e)+1,o=He(a);q(e,L,o,a);var l=o,u=He(4);for(e=[];0!==T(l,"i8");){E(r),E(u),this.handleError(p(this.db,l,-1,r,u));var c=T(r,"i32");if(l=T(u,"i32"),0!==c){for(a=null,i=new t(c,this),null!=n&&i.bind(n);i.step();)null===a&&(a={columns:i.getColumnNames(),values:[]},e.push(a)),a.values.push(i.get());i.free()}}return e}catch(h){throw i&&i.free(),h}finally{je(s)}},n.prototype.each=function(t,e,n,r){"function"==typeof e&&(r=n,n=e,e=void 0),t=this.prepare(t,e);try{for(;t.step();)n(t.getAsObject())}finally{t.free()}if("function"==typeof r)return r()},n.prototype.prepare=function(e,n){if(E(r),this.handleError(c(this.db,e,-1,r,0)),0===(e=T(r,"i32")))throw"Nothing to prepare";var s=new t(e,this);return null!=n&&s.bind(n),this.fb[e]=s},n.prototype.iterateStatements=function(t){return new e(t,this)},n.prototype.export=function(){Object.values(this.fb).forEach(function(t){t.free()}),Object.values(this.Xa).forEach(I),this.Xa={},this.handleError(o(this.db));var t=function(t){var e={encoding:"binary"};if((e=e||{}).flags=e.flags||"r",e.encoding=e.encoding||"binary","utf8"!==e.encoding&&"binary"!==e.encoding)throw Error('Invalid encoding type "'+e.encoding+'"');var n,r=ue(t,e.flags);t=se(t).size;var s=new Uint8Array(t);return de(r,s,0,t,0),"utf8"===e.encoding?n=j(s,0):"binary"===e.encoding&&(n=s),ce(r),n}(this.filename);return this.handleError(a(this.filename,r)),this.db=T(r,"i32"),t},n.prototype.close=function(){null!==this.db&&(Object.values(this.fb).forEach(function(t){t.free()}),Object.values(this.Xa).forEach(I),this.Xa={},this.handleError(o(this.db)),ne("/"+this.filename),this.db=null)},n.prototype.handleError=function(t){if(0===t)return null;throw t=w(this.db),Error(t)},n.prototype.getRowsModified=function(){return u(this.db)},n.prototype.create_function=function(t,e){Object.prototype.hasOwnProperty.call(this.Xa,t)&&(C(this.Xa[t]),delete this.Xa[t]);var n=function(t){var e=A;if(!x){x=new WeakMap;for(var n=0;n<e.length;n++){var r=e.get(n);r&&x.set(r,n)}}if(x.has(t))t=x.get(t);else{if(S.length)n=S.pop();else{n=e.length;try{e.grow(1)}catch(o){if(!(o instanceof RangeError))throw o;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}}try{e.set(n,t)}catch(o){if(!(o instanceof TypeError))throw o;if("function"==typeof WebAssembly.Function){var s={i:"i32",j:"i64",f:"f32",d:"f64"},i={parameters:[],results:[]};for(r=1;4>r;++r)i.parameters.push(s["viii"[r]]);r=new WebAssembly.Function(i,t)}else{for(i={i:127,j:126,f:125,d:124},(s=[1,0,1,96]).push(3),r=0;3>r;++r)s.push(i["iii"[r]]);s.push(0),s[1]=s.length-2,r=new Uint8Array([0,97,115,109,1,0,0,0].concat(s,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),r=new WebAssembly.Module(r),r=new WebAssembly.Instance(r,{e:{f:t}}).exports.f}e.set(n,r)}x.set(t,n),t=n}return t}(function(t,n,r){for(var s,i=[],a=0;a<n;a+=1){var o=T(r+4*a,"i32"),l=U(o);if(1===l||2===l)o=Z(o);else if(3===l)o=X(o);else if(4===l){o=K(l=o),l=Y(l);for(var u=new Uint8Array(o),c=0;c<o;c+=1)u[c]=L[l+c];o=u}else o=null;i.push(o)}try{s=e.apply(null,i)}catch(h){return void rt(t,h,-1)}switch(typeof s){case"boolean":nt(t,s?1:0);break;case"number":Q(t,s);break;case"string":tt(t,s,-1,-1);break;case"object":null===s?J(t):null!=s.length?(n=$(s),et(t,n,s.length,-1),Pe(n)):rt(t,"Wrong API use : tried to return a value of an unknown type ("+s+").",-1);break;default:J(t)}});return this.Xa[t]=n,this.handleError(W(this.db,t,e.length,1,0,n,0,0,0)),this},i.Database=n};var l,u={};for(l in i)i.hasOwnProperty(l)&&(u[l]=i[l]);var c,h,d,p,f="./this.program";c="object"==typeof window,h="function"==typeof importScripts,d="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,p=!c&&!d&&!h;var m,g,y,b,v="";d?(v=h?n(1).dirname(v)+"/":__dirname+"/",m=function(t,e){return y||(y=n(2)),b||(b=n(1)),t=b.normalize(t),y.readFileSync(t,e?null:"utf8")},g=function(t){return(t=m(t,!0)).buffer||(t=new Uint8Array(t)),O(t.buffer),t},1<process.argv.length&&(f=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),t.exports=i,i.inspect=function(){return"[Emscripten Module object]"}):p?("undefined"!=typeof read&&(m=function(t){return read(t)}),g=function(t){return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(O("object"==typeof(t=read(t,"binary"))),t)},"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(c||h)&&(h?v=self.location.href:document.currentScript&&(v=document.currentScript.src),v=0!==v.indexOf("blob:")?v.substr(0,v.lastIndexOf("/")+1):"",m=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},h&&(g=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}));var w=i.print||console.log.bind(console),_=i.printErr||console.warn.bind(console);for(l in u)u.hasOwnProperty(l)&&(i[l]=u[l]);u=null,i.thisProgram&&(f=i.thisProgram);var x,k,S=[];function C(t){x.delete(A.get(t)),S.push(t)}function I(t){C(t)}function E(t){var e="i32";switch("*"===e.charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":L[t>>0]=0;break;case"i16":z[t>>1]=0;break;case"i32":B[t>>2]=0;break;case"i64":ut=[0,(lt=0,1<=+Math.abs(lt)?0<lt?(0|Math.min(+Math.floor(lt/4294967296),4294967295))>>>0:~~+Math.ceil((lt-+(~~lt>>>0))/4294967296)>>>0:0)],B[t>>2]=ut[0],B[t+4>>2]=ut[1];break;case"float":V[t>>2]=0;break;case"double":W[t>>3]=0;break;default:it("invalid type for setValue: "+e)}}function T(t,e){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return L[t>>0];case"i16":return z[t>>1];case"i32":case"i64":return B[t>>2];case"float":return V[t>>2];case"double":return W[t>>3];default:it("invalid type for getValue: "+e)}return null}i.wasmBinary&&(k=i.wasmBinary),"object"!=typeof WebAssembly&&it("no native wasm support detected");var N,A,R=!1;function O(t,e){t||it("Assertion failed: "+e)}function D(t){var e=i["_"+t];return O(e,"Cannot call unknown function "+t+", make sure it is exported"),e}function F(t,e,n,r){var s,i={string:function(t){var e=0;if(null!=t&&0!==t){var n=1+(t.length<<2);e=He(n),q(t,P,e,n)}return e},array:function(t){var e=He(t.length);return L.set(t,e),e}},a=D(t),o=[];if(t=0,r)for(var l=0;l<r.length;l++){var u=i[n[l]];u?(0===t&&(t=Ue()),o[l]=u(r[l])):o[l]=r[l]}return s=n=a.apply(null,o),n="string"===e?H(s):"boolean"===e?!!s:s,0!==t&&je(t),n}function $(t){var e=Le(t.length);return P.set(t.subarray||t.slice?t:new Uint8Array(t),e),e}var M,L,P,z,B,V,W,U="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function j(t,e,n){var r=e+n;for(n=e;t[n]&&!(n>=r);)++n;if(16<n-e&&t.subarray&&U)return U.decode(t.subarray(e,n));for(r="";e<n;){var s=t[e++];if(128&s){var i=63&t[e++];if(192==(224&s))r+=String.fromCharCode((31&s)<<6|i);else{var a=63&t[e++];65536>(s=224==(240&s)?(15&s)<<12|i<<6|a:(7&s)<<18|i<<12|a<<6|63&t[e++])?r+=String.fromCharCode(s):(s-=65536,r+=String.fromCharCode(55296|s>>10,56320|1023&s))}}else r+=String.fromCharCode(s)}return r}function H(t,e){return t?j(P,t,e):""}function q(t,e,n,r){if(!(0<r))return 0;var s=n;r=n+r-1;for(var i=0;i<t.length;++i){var a=t.charCodeAt(i);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++i)),127>=a){if(n>=r)break;e[n++]=a}else{if(2047>=a){if(n+1>=r)break;e[n++]=192|a>>6}else{if(65535>=a){if(n+2>=r)break;e[n++]=224|a>>12}else{if(n+3>=r)break;e[n++]=240|a>>18,e[n++]=128|a>>12&63}e[n++]=128|a>>6&63}e[n++]=128|63&a}}return e[n]=0,n-s}function G(t){for(var e=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);55296<=r&&57343>=r&&(r=65536+((1023&r)<<10)|1023&t.charCodeAt(++n)),127>=r?++e:e=2047>=r?e+2:65535>=r?e+3:e+4}return e}function K(t){var e=G(t)+1,n=Le(e);return n&&q(t,L,n,e),n}function X(t){M=t,i.HEAP8=L=new Int8Array(t),i.HEAP16=z=new Int16Array(t),i.HEAP32=B=new Int32Array(t),i.HEAPU8=P=new Uint8Array(t),i.HEAPU16=new Uint16Array(t),i.HEAPU32=new Uint32Array(t),i.HEAPF32=V=new Float32Array(t),i.HEAPF64=W=new Float64Array(t)}var Y=i.INITIAL_MEMORY||16777216;(N=i.wasmMemory?i.wasmMemory:new WebAssembly.Memory({initial:Y/65536,maximum:32768}))&&(M=N.buffer),Y=M.byteLength,X(M);var Z=[],Q=[],J=[],tt=[];function et(){var t=i.preRun.shift();Z.unshift(t)}var nt=0,rt=null,st=null;function it(t){throw i.onAbort&&i.onAbort(t),_(t),R=!0,new WebAssembly.RuntimeError("abort("+t+"). Build with -s ASSERTIONS=1 for more info.")}function at(t){var e=ht;return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}function ot(){return at("data:application/octet-stream;base64,")}i.preloadedImages={},i.preloadedAudios={};var lt,ut,ct,ht="sql-wasm.wasm";if(!ot()){var dt=ht;ht=i.locateFile?i.locateFile(dt,v):v+dt}function pt(){try{if(k)return new Uint8Array(k);if(g)return g(ht);throw"both async and sync fetching of the wasm failed"}catch(t){it(t)}}function ft(t){for(;0<t.length;){var e=t.shift();if("function"==typeof e)e(i);else{var n=e.Hb;"number"==typeof n?void 0===e.mb?A.get(n)():A.get(n)(e.mb):n(void 0===e.mb?null:e.mb)}}}function mt(t,e){for(var n=0,r=t.length-1;0<=r;r--){var s=t[r];"."===s?t.splice(r,1):".."===s?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n;n--)t.unshift("..");return t}function gt(t){var e="/"===t.charAt(0),n="/"===t.substr(-1);return(t=mt(t.split("/").filter(function(t){return!!t}),!e).join("/"))||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t}function yt(t){var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=e[0],e=e[1],t||e?(e&&(e=e.substr(0,e.length-1)),t+e):"."}function bt(t){if("/"===t)return"/";var e=(t=(t=gt(t)).replace(/\/$/,"")).lastIndexOf("/");return-1===e?t:t.substr(e+1)}function vt(t){B[Me()>>2]=t}function wt(){for(var t="",e=!1,n=arguments.length-1;-1<=n&&!e;n--){if("string"!=typeof(e=0<=n?arguments[n]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!e)return"";t=e+"/"+t,e="/"===e.charAt(0)}return(e?"/":"")+(t=mt(t.split("/").filter(function(t){return!!t}),!e).join("/"))||"."}var _t=[];function xt(t,e){_t[t]={input:[],output:[],cb:e},Yt(t,kt)}var kt={open:function(t){var e=_t[t.node.rdev];if(!e)throw new Ft(43);t.tty=e,t.seekable=!1},close:function(t){t.tty.cb.flush(t.tty)},flush:function(t){t.tty.cb.flush(t.tty)},read:function(t,e,n,r){if(!t.tty||!t.tty.cb.xb)throw new Ft(60);for(var s=0,i=0;i<r;i++){try{var a=t.tty.cb.xb(t.tty)}catch(o){throw new Ft(29)}if(void 0===a&&0===s)throw new Ft(6);if(null==a)break;s++,e[n+i]=a}return s&&(t.node.timestamp=Date.now()),s},write:function(t,e,n,r){if(!t.tty||!t.tty.cb.qb)throw new Ft(60);try{for(var s=0;s<r;s++)t.tty.cb.qb(t.tty,e[n+s])}catch(i){throw new Ft(29)}return r&&(t.node.timestamp=Date.now()),s}},St={xb:function(t){if(!t.input.length){var e=null;if(d){var n=Buffer.zb?Buffer.zb(256):new Buffer(256),r=0;try{r=y.readSync(process.stdin.fd,n,0,256,null)}catch(s){if(-1==s.toString().indexOf("EOF"))throw s;r=0}e=0<r?n.slice(0,r).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n");if(!e)return null;t.input=Oe(e,!0)}return t.input.shift()},qb:function(t,e){null===e||10===e?(w(j(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},flush:function(t){t.output&&0<t.output.length&&(w(j(t.output,0)),t.output=[])}},Ct={qb:function(t,e){null===e||10===e?(_(j(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},flush:function(t){t.output&&0<t.output.length&&(_(j(t.output,0)),t.output=[])}},It={Va:null,Wa:function(){return It.createNode(null,"/",16895,0)},createNode:function(t,e,n,r){if(24576==(61440&n)||4096==(61440&n))throw new Ft(63);return It.Va||(It.Va={dir:{node:{Ua:It.Na.Ua,Ta:It.Na.Ta,lookup:It.Na.lookup,gb:It.Na.gb,rename:It.Na.rename,unlink:It.Na.unlink,rmdir:It.Na.rmdir,readdir:It.Na.readdir,symlink:It.Na.symlink},stream:{Za:It.Oa.Za}},file:{node:{Ua:It.Na.Ua,Ta:It.Na.Ta},stream:{Za:It.Oa.Za,read:It.Oa.read,write:It.Oa.write,sb:It.Oa.sb,hb:It.Oa.hb,ib:It.Oa.ib}},link:{node:{Ua:It.Na.Ua,Ta:It.Na.Ta,readlink:It.Na.readlink},stream:{}},ub:{node:{Ua:It.Na.Ua,Ta:It.Na.Ta},stream:Xt}}),Wt((n=Vt(t,e,n,r)).mode)?(n.Na=It.Va.dir.node,n.Oa=It.Va.dir.stream,n.Ma={}):32768==(61440&n.mode)?(n.Na=It.Va.file.node,n.Oa=It.Va.file.stream,n.Sa=0,n.Ma=null):40960==(61440&n.mode)?(n.Na=It.Va.link.node,n.Oa=It.Va.link.stream):8192==(61440&n.mode)&&(n.Na=It.Va.ub.node,n.Oa=It.Va.ub.stream),n.timestamp=Date.now(),t&&(t.Ma[e]=n),n},Sb:function(t){if(t.Ma&&t.Ma.subarray){for(var e=[],n=0;n<t.Sa;++n)e.push(t.Ma[n]);return e}return t.Ma},Tb:function(t){return t.Ma?t.Ma.subarray?t.Ma.subarray(0,t.Sa):new Uint8Array(t.Ma):new Uint8Array(0)},vb:function(t,e){var n=t.Ma?t.Ma.length:0;n>=e||(e=Math.max(e,n*(1048576>n?2:1.125)>>>0),0!=n&&(e=Math.max(e,256)),n=t.Ma,t.Ma=new Uint8Array(e),0<t.Sa&&t.Ma.set(n.subarray(0,t.Sa),0))},Pb:function(t,e){if(t.Sa!=e)if(0==e)t.Ma=null,t.Sa=0;else{if(!t.Ma||t.Ma.subarray){var n=t.Ma;t.Ma=new Uint8Array(e),n&&t.Ma.set(n.subarray(0,Math.min(e,t.Sa)))}else if(t.Ma||(t.Ma=[]),t.Ma.length>e)t.Ma.length=e;else for(;t.Ma.length<e;)t.Ma.push(0);t.Sa=e}},Na:{Ua:function(t){var e={};return e.dev=8192==(61440&t.mode)?t.id:1,e.ino=t.id,e.mode=t.mode,e.nlink=1,e.uid=0,e.gid=0,e.rdev=t.rdev,e.size=Wt(t.mode)?4096:32768==(61440&t.mode)?t.Sa:40960==(61440&t.mode)?t.link.length:0,e.atime=new Date(t.timestamp),e.mtime=new Date(t.timestamp),e.ctime=new Date(t.timestamp),e.Gb=4096,e.blocks=Math.ceil(e.size/e.Gb),e},Ta:function(t,e){void 0!==e.mode&&(t.mode=e.mode),void 0!==e.timestamp&&(t.timestamp=e.timestamp),void 0!==e.size&&It.Pb(t,e.size)},lookup:function(){throw $t[44]},gb:function(t,e,n,r){return It.createNode(t,e,n,r)},rename:function(t,e,n){if(Wt(t.mode)){try{var r=Bt(e,n)}catch(i){}if(r)for(var s in r.Ma)throw new Ft(55)}delete t.parent.Ma[t.name],t.name=n,e.Ma[n]=t,t.parent=e},unlink:function(t,e){delete t.Ma[e]},rmdir:function(t,e){var n,r=Bt(t,e);for(n in r.Ma)throw new Ft(55);delete t.Ma[e]},readdir:function(t){var e,n=[".",".."];for(e in t.Ma)t.Ma.hasOwnProperty(e)&&n.push(e);return n},symlink:function(t,e,n){return(t=It.createNode(t,e,41471,0)).link=n,t},readlink:function(t){if(40960!=(61440&t.mode))throw new Ft(28);return t.link}},Oa:{read:function(t,e,n,r,s){var i=t.node.Ma;if(s>=t.node.Sa)return 0;if(8<(t=Math.min(t.node.Sa-s,r))&&i.subarray)e.set(i.subarray(s,s+t),n);else for(r=0;r<t;r++)e[n+r]=i[s+r];return t},write:function(t,e,n,r,s,i){if(e.buffer===L.buffer&&(i=!1),!r)return 0;if((t=t.node).timestamp=Date.now(),e.subarray&&(!t.Ma||t.Ma.subarray)){if(i)return t.Ma=e.subarray(n,n+r),t.Sa=r;if(0===t.Sa&&0===s)return t.Ma=e.slice(n,n+r),t.Sa=r;if(s+r<=t.Sa)return t.Ma.set(e.subarray(n,n+r),s),r}if(It.vb(t,s+r),t.Ma.subarray&&e.subarray)t.Ma.set(e.subarray(n,n+r),s);else for(i=0;i<r;i++)t.Ma[s+i]=e[n+i];return t.Sa=Math.max(t.Sa,s+r),r},Za:function(t,e,n){if(1===n?e+=t.position:2===n&&32768==(61440&t.node.mode)&&(e+=t.node.Sa),0>e)throw new Ft(28);return e},sb:function(t,e,n){It.vb(t.node,e+n),t.node.Sa=Math.max(t.node.Sa,e+n)},hb:function(t,e,n,r,s,i){if(O(0===e),32768!=(61440&t.node.mode))throw new Ft(43);if(t=t.node.Ma,2&i||t.buffer!==M){for((0<r||r+n<t.length)&&(t=t.subarray?t.subarray(r,r+n):Array.prototype.slice.call(t,r,r+n)),r=!0,i=16384*Math.ceil(n/16384),e=Le(i);n<i;)L[e+n++]=0;if(!(n=e))throw new Ft(48);L.set(t,n)}else r=!1,n=t.byteOffset;return{Ob:n,kb:r}},ib:function(t,e,n,r,s){if(32768!=(61440&t.node.mode))throw new Ft(43);return 2&s||It.Oa.write(t,e,0,r,n,!1),0}}},Et=null,Tt={},Nt=[],At=1,Rt=null,Ot=!0,Dt={},Ft=null,$t={};function Mt(t,e){if(e=e||{},!(t=wt("/",t)))return{path:"",node:null};var n,r={wb:!0,rb:0};for(n in r)void 0===e[n]&&(e[n]=r[n]);if(8<e.rb)throw new Ft(32);t=mt(t.split("/").filter(function(t){return!!t}),!1);var s=Et;for(r="/",n=0;n<t.length;n++){var i=n===t.length-1;if(i&&e.parent)break;if(s=Bt(s,t[n]),r=gt(r+"/"+t[n]),s.ab&&(!i||i&&e.wb)&&(s=s.ab.root),!i||e.Ya)for(i=0;40960==(61440&s.mode);)if(s=re(r),s=Mt(r=wt(yt(r),s),{rb:e.rb}).node,40<i++)throw new Ft(32)}return{path:r,node:s}}function Lt(t){for(var e;;){if(t===t.parent)return t=t.Wa.yb,e?"/"!==t[t.length-1]?t+"/"+e:t+e:t;e=e?t.name+"/"+e:t.name,t=t.parent}}function Pt(t,e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r)|0;return(t+n>>>0)%Rt.length}function zt(t){var e=Pt(t.parent.id,t.name);if(Rt[e]===t)Rt[e]=t.bb;else for(e=Rt[e];e;){if(e.bb===t){e.bb=t.bb;break}e=e.bb}}function Bt(t,e){var n;if(n=(n=Ht(t,"x"))?n:t.Na.lookup?0:2)throw new Ft(n,t);for(n=Rt[Pt(t.id,e)];n;n=n.bb)if(n.parent.id===t.id&&n.name===e)return n;return t.Na.lookup(t,e)}function Vt(t,e,n,r){return e=Pt((t=new Re(t,e,n,r)).parent.id,t.name),t.bb=Rt[e],Rt[e]=t}function Wt(t){return 16384==(61440&t)}var Ut={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function jt(t){var e=["r","w","rw"][3&t];return 512&t&&(e+="w"),e}function Ht(t,e){return Ot||(-1===e.indexOf("r")||292&t.mode)&&(-1===e.indexOf("w")||146&t.mode)&&(-1===e.indexOf("x")||73&t.mode)?0:2}function qt(t,e){try{return Bt(t,e),20}catch(n){}return Ht(t,"wx")}function Gt(t,e,n){try{var r=Bt(t,e)}catch(s){return s.Pa}if(t=Ht(t,"wx"))return t;if(n){if(!Wt(r.mode))return 54;if(r===r.parent||"/"===Lt(r))return 10}else if(Wt(r.mode))return 31;return 0}var Kt,Xt={open:function(t){t.Oa=Tt[t.node.rdev].Oa,t.Oa.open&&t.Oa.open(t)},Za:function(){throw new Ft(70)}};function Yt(t,e){Tt[t]={Oa:e}}function Zt(t,e){var n="/"===e,r=!e;if(n&&Et)throw new Ft(10);if(!n&&!r){var s=Mt(e,{wb:!1});if(e=s.path,(s=s.node).ab)throw new Ft(10);if(!Wt(s.mode))throw new Ft(54)}(t=t.Wa(e={type:t,Ub:{},yb:e,Mb:[]})).Wa=e,e.root=t,n?Et=t:s&&(s.ab=e,s.Wa&&s.Wa.Mb.push(e))}function Qt(t,e,n){var r=Mt(t,{parent:!0}).node;if(!(t=bt(t))||"."===t||".."===t)throw new Ft(28);var s=qt(r,t);if(s)throw new Ft(s);if(!r.Na.gb)throw new Ft(63);return r.Na.gb(r,t,e,n)}function Jt(t,e){Qt(t,1023&(void 0!==e?e:511)|16384,0)}function te(t,e,n){void 0===n&&(n=e,e=438),Qt(t,8192|e,n)}function ee(t,e){if(!wt(t))throw new Ft(44);var n=Mt(e,{parent:!0}).node;if(!n)throw new Ft(44);var r=qt(n,e=bt(e));if(r)throw new Ft(r);if(!n.Na.symlink)throw new Ft(63);n.Na.symlink(n,e,t)}function ne(t){var e=Mt(t,{parent:!0}).node,n=bt(t),r=Bt(e,n),s=Gt(e,n,!1);if(s)throw new Ft(s);if(!e.Na.unlink)throw new Ft(63);if(r.ab)throw new Ft(10);try{Dt.willDeletePath&&Dt.willDeletePath(t)}catch(i){_("FS.trackingDelegate['willDeletePath']('"+t+"') threw an exception: "+i.message)}e.Na.unlink(e,n),zt(r);try{Dt.onDeletePath&&Dt.onDeletePath(t)}catch(i){_("FS.trackingDelegate['onDeletePath']('"+t+"') threw an exception: "+i.message)}}function re(t){if(!(t=Mt(t).node))throw new Ft(44);if(!t.Na.readlink)throw new Ft(28);return wt(Lt(t.parent),t.Na.readlink(t))}function se(t,e){if(!(t=Mt(t,{Ya:!e}).node))throw new Ft(44);if(!t.Na.Ua)throw new Ft(63);return t.Na.Ua(t)}function ie(t){return se(t,!0)}function ae(t,e){var n;if(!(n="string"==typeof t?Mt(t,{Ya:!0}).node:t).Na.Ta)throw new Ft(63);n.Na.Ta(n,{mode:4095&e|-4096&n.mode,timestamp:Date.now()})}function oe(t){var e;if(!(e="string"==typeof t?Mt(t,{Ya:!0}).node:t).Na.Ta)throw new Ft(63);e.Na.Ta(e,{timestamp:Date.now()})}function le(t,e){if(0>e)throw new Ft(28);var n;if(!(n="string"==typeof t?Mt(t,{Ya:!0}).node:t).Na.Ta)throw new Ft(63);if(Wt(n.mode))throw new Ft(31);if(32768!=(61440&n.mode))throw new Ft(28);if(t=Ht(n,"w"))throw new Ft(t);n.Na.Ta(n,{size:e,timestamp:Date.now()})}function ue(t,e,n,r){if(""===t)throw new Ft(44);if("string"==typeof e){var s=Ut[e];if(void 0===s)throw Error("Unknown file open mode: "+e);e=s}if(n=64&e?4095&(void 0===n?438:n)|32768:0,"object"==typeof t)var a=t;else{t=gt(t);try{a=Mt(t,{Ya:!(131072&e)}).node}catch(o){}}if(s=!1,64&e)if(a){if(128&e)throw new Ft(20)}else a=Qt(t,n,0),s=!0;if(!a)throw new Ft(44);if(8192==(61440&a.mode)&&(e&=-513),65536&e&&!Wt(a.mode))throw new Ft(54);if(!s&&(n=a?40960==(61440&a.mode)?32:Wt(a.mode)&&("r"!==jt(e)||512&e)?31:Ht(a,jt(e)):44))throw new Ft(n);512&e&&le(a,0),e&=-131713,(r=function(t,e){be||((be=function(){}).prototype={});var n,r=new be;for(n in t)r[n]=t[n];return t=r,e=function(t){for(t=t||0;t<=4096;t++)if(!Nt[t])return t;throw new Ft(33)}(e),t.fd=e,Nt[e]=t}({node:a,path:Lt(a),flags:e,seekable:!0,position:0,Oa:a.Oa,Rb:[],error:!1},r)).Oa.open&&r.Oa.open(r),!i.logReadFiles||1&e||(ve||(ve={}),t in ve||(ve[t]=1,_("FS.trackingDelegate error on read file: "+t)));try{Dt.onOpenFile&&(a=0,1!=(2097155&e)&&(a|=1),0!=(2097155&e)&&(a|=2),Dt.onOpenFile(t,a))}catch(o){_("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+o.message)}return r}function ce(t){if(null===t.fd)throw new Ft(8);t.ob&&(t.ob=null);try{t.Oa.close&&t.Oa.close(t)}catch(e){throw e}finally{Nt[t.fd]=null}t.fd=null}function he(t,e,n){if(null===t.fd)throw new Ft(8);if(!t.seekable||!t.Oa.Za)throw new Ft(70);if(0!=n&&1!=n&&2!=n)throw new Ft(28);t.position=t.Oa.Za(t,e,n),t.Rb=[]}function de(t,e,n,r,s){if(0>r||0>s)throw new Ft(28);if(null===t.fd)throw new Ft(8);if(1==(2097155&t.flags))throw new Ft(8);if(Wt(t.node.mode))throw new Ft(31);if(!t.Oa.read)throw new Ft(28);var i=void 0!==s;if(i){if(!t.seekable)throw new Ft(70)}else s=t.position;return e=t.Oa.read(t,e,n,r,s),i||(t.position+=e),e}function pe(t,e,n,r,s,i){if(0>r||0>s)throw new Ft(28);if(null===t.fd)throw new Ft(8);if(0==(2097155&t.flags))throw new Ft(8);if(Wt(t.node.mode))throw new Ft(31);if(!t.Oa.write)throw new Ft(28);t.seekable&&1024&t.flags&&he(t,0,2);var a=void 0!==s;if(a){if(!t.seekable)throw new Ft(70)}else s=t.position;e=t.Oa.write(t,e,n,r,s,i),a||(t.position+=e);try{t.path&&Dt.onWriteToFile&&Dt.onWriteToFile(t.path)}catch(o){_("FS.trackingDelegate['onWriteToFile']('"+t.path+"') threw an exception: "+o.message)}return e}function fe(){Ft||((Ft=function(t,e){this.node=e,this.Qb=function(t){this.Pa=t},this.Qb(t),this.message="FS error"}).prototype=Error(),Ft.prototype.constructor=Ft,[44].forEach(function(t){$t[t]=new Ft(t),$t[t].stack="<generic error, no stack>"}))}function me(t,e){var n=0;return t&&(n|=365),e&&(n|=146),n}function ge(t,e,n){t=gt("/dev/"+t);var r=me(!!e,!!n);ye||(ye=64);var s=ye++<<8|0;Yt(s,{open:function(t){t.seekable=!1},close:function(){n&&n.buffer&&n.buffer.length&&n(10)},read:function(t,n,r,s){for(var i=0,a=0;a<s;a++){try{var o=e()}catch(l){throw new Ft(29)}if(void 0===o&&0===i)throw new Ft(6);if(null==o)break;i++,n[r+a]=o}return i&&(t.node.timestamp=Date.now()),i},write:function(t,e,r,s){for(var i=0;i<s;i++)try{n(e[r+i])}catch(a){throw new Ft(29)}return s&&(t.node.timestamp=Date.now()),i}}),te(t,r,s)}var ye,be,ve,we={},_e={};function xe(t,e,n){try{var r=t(e)}catch(s){if(s&&s.node&&gt(e)!==gt(Lt(s.node)))return-54;throw s}return B[n>>2]=r.dev,B[n+4>>2]=0,B[n+8>>2]=r.ino,B[n+12>>2]=r.mode,B[n+16>>2]=r.nlink,B[n+20>>2]=r.uid,B[n+24>>2]=r.gid,B[n+28>>2]=r.rdev,B[n+32>>2]=0,ut=[r.size>>>0,(lt=r.size,1<=+Math.abs(lt)?0<lt?(0|Math.min(+Math.floor(lt/4294967296),4294967295))>>>0:~~+Math.ceil((lt-+(~~lt>>>0))/4294967296)>>>0:0)],B[n+40>>2]=ut[0],B[n+44>>2]=ut[1],B[n+48>>2]=4096,B[n+52>>2]=r.blocks,B[n+56>>2]=r.atime.getTime()/1e3|0,B[n+60>>2]=0,B[n+64>>2]=r.mtime.getTime()/1e3|0,B[n+68>>2]=0,B[n+72>>2]=r.ctime.getTime()/1e3|0,B[n+76>>2]=0,ut=[r.ino>>>0,(lt=r.ino,1<=+Math.abs(lt)?0<lt?(0|Math.min(+Math.floor(lt/4294967296),4294967295))>>>0:~~+Math.ceil((lt-+(~~lt>>>0))/4294967296)>>>0:0)],B[n+80>>2]=ut[0],B[n+84>>2]=ut[1],0}var ke=void 0;function Se(){return B[(ke+=4)-4>>2]}function Ce(t){if(!(t=Nt[t]))throw new Ft(8);return t}var Ie,Ee,Te={};function Ne(){if(!Ie){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:f||"./this.program"};for(t in Te)e[t]=Te[t];var n=[];for(t in e)n.push(t+"="+e[t]);Ie=n}return Ie}function Ae(t){for(var e=Ee();Ee()-e<t/1e3;);}function Re(t,e,n,r){t||(t=this),this.parent=t,this.Wa=t.Wa,this.ab=null,this.id=At++,this.name=e,this.mode=n,this.Na={},this.Oa={},this.rdev=r}function Oe(t,e){var n=Array(G(t)+1);return t=q(t,n,0,n.length),e&&(n.length=t),n}Ee=d?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof dateNow?dateNow:function(){return performance.now()},i._usleep=Ae,Object.defineProperties(Re.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(t){t?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(t){t?this.mode|=146:this.mode&=-147}}}),fe(),Rt=Array(4096),Zt(It,"/"),Jt("/tmp"),Jt("/home"),Jt("/home/web_user"),function(){Jt("/dev"),Yt(259,{read:function(){return 0},write:function(t,e,n,r){return r}}),te("/dev/null",259),xt(1280,St),xt(1536,Ct),te("/dev/tty",1280),te("/dev/tty1",1536);var t=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return function(){return crypto.getRandomValues(t),t[0]}}if(d)try{var e=n(3);return function(){return e.randomBytes(1)[0]}}catch(r){}return function(){it("randomDevice")}}();ge("random",t),ge("urandom",t),Jt("/dev/shm"),Jt("/dev/shm/tmp")}(),Jt("/proc"),Jt("/proc/self"),Jt("/proc/self/fd"),Zt({Wa:function(){var t=Vt("/proc/self","fd",16895,73);return t.Na={lookup:function(t,e){var n=Nt[+e];if(!n)throw new Ft(8);return(t={parent:null,Wa:{yb:"fake"},Na:{readlink:function(){return n.path}}}).parent=t}},t}},"/proc/self/fd"),Q.push({Hb:function(){Fe()}});var De={b:function(t,e,n,r){it("Assertion failed: "+H(t)+", at: "+[e?H(e):"unknown filename",n,r?H(r):"unknown function"])},r:function(t,e){!function(){function t(t){return(t=t.toTimeString().match(/\(([A-Za-z ]+)\)$/))?t[1]:"GMT"}if(!ct){ct=!0,B[We()>>2]=60*(new Date).getTimezoneOffset();var e=(new Date).getFullYear(),n=new Date(e,0,1);e=new Date(e,6,1),B[Ve()>>2]=Number(n.getTimezoneOffset()!=e.getTimezoneOffset());var r=t(n),s=t(e);r=K(r),s=K(s),e.getTimezoneOffset()<n.getTimezoneOffset()?(B[Be()>>2]=r,B[Be()+4>>2]=s):(B[Be()>>2]=s,B[Be()+4>>2]=r)}}(),t=new Date(1e3*B[t>>2]),B[e>>2]=t.getSeconds(),B[e+4>>2]=t.getMinutes(),B[e+8>>2]=t.getHours(),B[e+12>>2]=t.getDate(),B[e+16>>2]=t.getMonth(),B[e+20>>2]=t.getFullYear()-1900,B[e+24>>2]=t.getDay();var n=new Date(t.getFullYear(),0,1);B[e+28>>2]=(t.getTime()-n.getTime())/864e5|0,B[e+36>>2]=-60*t.getTimezoneOffset();var r=new Date(t.getFullYear(),6,1).getTimezoneOffset();return t=0|(r!=(n=n.getTimezoneOffset())&&t.getTimezoneOffset()==Math.min(n,r)),B[e+32>>2]=t,t=B[Be()+(t?4:0)>>2],B[e+40>>2]=t,e},j:function(t,e){try{var n;if(t=H(t),-8&e)var r=-28;else(n=Mt(t,{Ya:!0}).node)?(t="",4&e&&(t+="r"),2&e&&(t+="w"),1&e&&(t+="x"),r=t&&Ht(n,t)?-2:0):r=-44;return r}catch(s){return void 0!==we&&s instanceof Ft||it(s),-s.Pa}},v:function(t,e){try{return ae(t=H(t),e),0}catch(n){return void 0!==we&&n instanceof Ft||it(n),-n.Pa}},D:function(t){try{return oe(t=H(t)),0}catch(e){return void 0!==we&&e instanceof Ft||it(e),-e.Pa}},w:function(t,e){try{var n=Nt[t];if(!n)throw new Ft(8);return ae(n.node,e),0}catch(r){return void 0!==we&&r instanceof Ft||it(r),-r.Pa}},E:function(t){try{var e=Nt[t];if(!e)throw new Ft(8);return oe(e.node),0}catch(n){return void 0!==we&&n instanceof Ft||it(n),-n.Pa}},c:function(t,e,n){ke=n;try{var r=Ce(t);switch(e){case 0:var s=Se();return 0>s?-28:ue(r.path,r.flags,0,s).fd;case 1:case 2:return 0;case 3:return r.flags;case 4:return s=Se(),r.flags|=s,0;case 12:return s=Se(),z[s+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return vt(28),-1;default:return-28}}catch(i){return void 0!==we&&i instanceof Ft||it(i),-i.Pa}},x:function(t,e){try{return xe(se,Ce(t).path,e)}catch(n){return void 0!==we&&n instanceof Ft||it(n),-n.Pa}},i:function(t,e,n){try{var r=Nt[t];if(!r)throw new Ft(8);if(0==(2097155&r.flags))throw new Ft(28);return le(r.node,n),0}catch(s){return void 0!==we&&s instanceof Ft||it(s),-s.Pa}},J:function(t,e){try{return 0===e?-28:e<G("/")+1?-68:(q("/",P,t,e),t)}catch(n){return void 0!==we&&n instanceof Ft||it(n),-n.Pa}},F:function(){return 0},e:function(){return 42},u:function(t,e){try{return xe(ie,t=H(t),e)}catch(n){return void 0!==we&&n instanceof Ft||it(n),-n.Pa}},t:function(t,e){try{return"/"===(t=gt(t=H(t)))[t.length-1]&&(t=t.substr(0,t.length-1)),Jt(t,e),0}catch(n){return void 0!==we&&n instanceof Ft||it(n),-n.Pa}},A:function(t,e,n,r,s,i){try{t:{i<<=12;var a=!1;if(0!=(16&r)&&0!=t%16384)var o=-28;else{if(0!=(32&r)){var l=qe(16384,e);if(!l){o=-48;break t}$e(l,0,e),a=!0}else{var u=Nt[s];if(!u){o=-8;break t}var c=i;if(0!=(2&n)&&0==(2&r)&&2!=(2097155&u.flags))throw new Ft(2);if(1==(2097155&u.flags))throw new Ft(2);if(!u.Oa.hb)throw new Ft(43);var h=u.Oa.hb(u,t,e,c,n,r);l=h.Ob,a=h.kb}_e[l]={Lb:l,Kb:e,kb:a,fd:s,Nb:n,flags:r,offset:i},o=l}}return o}catch(d){return void 0!==we&&d instanceof Ft||it(d),-d.Pa}},z:function(t,e){try{if(-1==(0|t)||0===e)var n=-28;else{var r=_e[t];if(r&&e===r.Kb){var s=Nt[r.fd];if(2&r.Nb){var i=r.flags,a=r.offset,o=P.slice(t,t+e);s&&s.Oa.ib&&s.Oa.ib(s,o,a,e,i)}_e[t]=null,r.kb&&Pe(r.Lb)}n=0}return n}catch(l){return void 0!==we&&l instanceof Ft||it(l),-l.Pa}},y:function(t,e,n){ke=n;try{return ue(H(t),e,Se()).fd}catch(r){return void 0!==we&&r instanceof Ft||it(r),-r.Pa}},G:function(t,e,n){try{return de(Ce(t),L,e,n)}catch(r){return void 0!==we&&r instanceof Ft||it(r),-r.Pa}},l:function(t,e,n){try{if(t=H(t),0>=n)var r=-28;else{var s=re(t),i=Math.min(n,G(s)),a=L[e+i];q(s,P,e,n+1),L[e+i]=a,r=i}return r}catch(o){return void 0!==we&&o instanceof Ft||it(o),-o.Pa}},C:function(t){try{var e=Mt(t=H(t),{parent:!0}).node,n=bt(t),r=Bt(e,n),s=Gt(e,n,!0);if(s)throw new Ft(s);if(!e.Na.rmdir)throw new Ft(63);if(r.ab)throw new Ft(10);try{Dt.willDeletePath&&Dt.willDeletePath(t)}catch(i){_("FS.trackingDelegate['willDeletePath']('"+t+"') threw an exception: "+i.message)}e.Na.rmdir(e,n),zt(r);try{Dt.onDeletePath&&Dt.onDeletePath(t)}catch(i){_("FS.trackingDelegate['onDeletePath']('"+t+"') threw an exception: "+i.message)}return 0}catch(i){return void 0!==we&&i instanceof Ft||it(i),-i.Pa}},f:function(t,e){try{return xe(se,t=H(t),e)}catch(n){return void 0!==we&&n instanceof Ft||it(n),-n.Pa}},H:function(t){try{return ne(t=H(t)),0}catch(e){return void 0!==we&&e instanceof Ft||it(e),-e.Pa}},n:function(t,e,n){P.copyWithin(t,e,e+n)},d:function(t){var e=P.length;if(2147483648<(t>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=e*(1+.2/n);r=Math.min(r,t+100663296),0<(r=Math.max(16777216,t,r))%65536&&(r+=65536-r%65536);t:{try{N.grow(Math.min(2147483648,r)-M.byteLength+65535>>>16),X(N.buffer);var s=1;break t}catch(i){}s=void 0}if(s)return!0}return!1},p:function(t,e){var n=0;return Ne().forEach(function(r,s){var i=e+n;for(s=B[t+4*s>>2]=i,i=0;i<r.length;++i)L[s++>>0]=r.charCodeAt(i);L[s>>0]=0,n+=r.length+1}),0},q:function(t,e){var n=Ne();B[t>>2]=n.length;var r=0;return n.forEach(function(t){r+=t.length+1}),B[e>>2]=r,0},g:function(t){try{return ce(Ce(t)),0}catch(e){return void 0!==we&&e instanceof Ft||it(e),e.Pa}},o:function(t,e){try{var n=Ce(t);return L[e>>0]=n.tty?2:Wt(n.mode)?3:40960==(61440&n.mode)?7:4,0}catch(r){return void 0!==we&&r instanceof Ft||it(r),r.Pa}},m:function(t,e,n,r,s){try{var i=Ce(t);return-9007199254740992>=(t=4294967296*n+(e>>>0))||9007199254740992<=t?-61:(he(i,t,r),ut=[i.position>>>0,(lt=i.position,1<=+Math.abs(lt)?0<lt?(0|Math.min(+Math.floor(lt/4294967296),4294967295))>>>0:~~+Math.ceil((lt-+(~~lt>>>0))/4294967296)>>>0:0)],B[s>>2]=ut[0],B[s+4>>2]=ut[1],i.ob&&0===t&&0===r&&(i.ob=null),0)}catch(a){return void 0!==we&&a instanceof Ft||it(a),a.Pa}},K:function(t){try{var e=Ce(t);return e.Oa&&e.Oa.fsync?-e.Oa.fsync(e):0}catch(n){return void 0!==we&&n instanceof Ft||it(n),n.Pa}},I:function(t,e,n,r){try{t:{for(var s=Ce(t),i=t=0;i<n;i++){var a=pe(s,L,B[e+8*i>>2],B[e+(8*i+4)>>2],void 0);if(0>a){var o=-1;break t}t+=a}o=t}return B[r>>2]=o,0}catch(l){return void 0!==we&&l instanceof Ft||it(l),l.Pa}},h:function(t){var e=Date.now();return B[t>>2]=e/1e3|0,B[t+4>>2]=e%1e3*1e3|0,0},a:N,k:function(t,e){if(0===t)return vt(28),-1;var n=B[t>>2];return 0>(t=B[t+4>>2])||999999999<t||0>n?(vt(28),-1):(0!==e&&(B[e>>2]=0,B[e+4>>2]=0),Ae(1e6*n+t/1e3))},B:function(t){switch(t){case 30:return 16384;case 85:return 131072;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:case 79:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return vt(28),-1},L:function(t){var e=Date.now()/1e3|0;return t&&(B[t>>2]=e),e},s:function(t,e){if(e){var n=1e3*B[e+8>>2];n+=B[e+12>>2]/1e3}else n=Date.now();t=H(t);try{e=n;var r=Mt(t,{Ya:!0}).node;return r.Na.Ta(r,{timestamp:Math.max(e,n)}),0}catch(s){if(!((t=s)instanceof Ft)){t+=" : ";t:{if(!(r=Error()).stack){try{throw Error()}catch(a){r=a}if(!r.stack){r="(no stack trace available)";break t}}r=r.stack.toString()}throw i.extraStackTrace&&(r+="\n"+i.extraStackTrace()),r=function(t){return t.replace(/\b_Z[\w\d_]+/g,function(t){return t==t?t:t+" ["+t+"]"})}(r),t+r}return vt(t.Pa),-1}}};!function(){function t(t){i.asm=t.exports,A=i.asm.M,nt--,i.monitorRunDependencies&&i.monitorRunDependencies(nt),0==nt&&(null!==rt&&(clearInterval(rt),rt=null),st&&(t=st,st=null,t()))}function e(e){t(e.instance)}function n(t){return(k||!c&&!h||"function"!=typeof fetch||at("file://")?Promise.resolve().then(pt):fetch(ht,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+ht+"'";return t.arrayBuffer()}).catch(function(){return pt()})).then(function(t){return WebAssembly.instantiate(t,r)}).then(t,function(t){_("failed to asynchronously prepare wasm: "+t),it(t)})}var r={a:De};if(nt++,i.monitorRunDependencies&&i.monitorRunDependencies(nt),i.instantiateWasm)try{return i.instantiateWasm(r,t)}catch(s){return _("Module.instantiateWasm callback failed with error: "+s),!1}!function(){if(k||"function"!=typeof WebAssembly.instantiateStreaming||ot()||at("file://")||"function"!=typeof fetch)return n(e);fetch(ht,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,r).then(e,function(t){return _("wasm streaming compile failed: "+t),_("falling back to ArrayBuffer instantiation"),n(e)})})}()}();var Fe=i.___wasm_call_ctors=function(){return(Fe=i.___wasm_call_ctors=i.asm.N).apply(null,arguments)},$e=i._memset=function(){return($e=i._memset=i.asm.O).apply(null,arguments)};i._sqlite3_free=function(){return(i._sqlite3_free=i.asm.P).apply(null,arguments)};var Me=i.___errno_location=function(){return(Me=i.___errno_location=i.asm.Q).apply(null,arguments)};i._sqlite3_finalize=function(){return(i._sqlite3_finalize=i.asm.R).apply(null,arguments)},i._sqlite3_reset=function(){return(i._sqlite3_reset=i.asm.S).apply(null,arguments)},i._sqlite3_clear_bindings=function(){return(i._sqlite3_clear_bindings=i.asm.T).apply(null,arguments)},i._sqlite3_value_blob=function(){return(i._sqlite3_value_blob=i.asm.U).apply(null,arguments)},i._sqlite3_value_text=function(){return(i._sqlite3_value_text=i.asm.V).apply(null,arguments)},i._sqlite3_value_bytes=function(){return(i._sqlite3_value_bytes=i.asm.W).apply(null,arguments)},i._sqlite3_value_double=function(){return(i._sqlite3_value_double=i.asm.X).apply(null,arguments)},i._sqlite3_value_int=function(){return(i._sqlite3_value_int=i.asm.Y).apply(null,arguments)},i._sqlite3_value_type=function(){return(i._sqlite3_value_type=i.asm.Z).apply(null,arguments)},i._sqlite3_result_blob=function(){return(i._sqlite3_result_blob=i.asm._).apply(null,arguments)},i._sqlite3_result_double=function(){return(i._sqlite3_result_double=i.asm.$).apply(null,arguments)},i._sqlite3_result_error=function(){return(i._sqlite3_result_error=i.asm.aa).apply(null,arguments)},i._sqlite3_result_int=function(){return(i._sqlite3_result_int=i.asm.ba).apply(null,arguments)},i._sqlite3_result_int64=function(){return(i._sqlite3_result_int64=i.asm.ca).apply(null,arguments)},i._sqlite3_result_null=function(){return(i._sqlite3_result_null=i.asm.da).apply(null,arguments)},i._sqlite3_result_text=function(){return(i._sqlite3_result_text=i.asm.ea).apply(null,arguments)},i._sqlite3_step=function(){return(i._sqlite3_step=i.asm.fa).apply(null,arguments)},i._sqlite3_column_count=function(){return(i._sqlite3_column_count=i.asm.ga).apply(null,arguments)},i._sqlite3_data_count=function(){return(i._sqlite3_data_count=i.asm.ha).apply(null,arguments)},i._sqlite3_column_blob=function(){return(i._sqlite3_column_blob=i.asm.ia).apply(null,arguments)},i._sqlite3_column_bytes=function(){return(i._sqlite3_column_bytes=i.asm.ja).apply(null,arguments)},i._sqlite3_column_double=function(){return(i._sqlite3_column_double=i.asm.ka).apply(null,arguments)},i._sqlite3_column_text=function(){return(i._sqlite3_column_text=i.asm.la).apply(null,arguments)},i._sqlite3_column_type=function(){return(i._sqlite3_column_type=i.asm.ma).apply(null,arguments)},i._sqlite3_column_name=function(){return(i._sqlite3_column_name=i.asm.na).apply(null,arguments)},i._sqlite3_bind_blob=function(){return(i._sqlite3_bind_blob=i.asm.oa).apply(null,arguments)},i._sqlite3_bind_double=function(){return(i._sqlite3_bind_double=i.asm.pa).apply(null,arguments)},i._sqlite3_bind_int=function(){return(i._sqlite3_bind_int=i.asm.qa).apply(null,arguments)},i._sqlite3_bind_text=function(){return(i._sqlite3_bind_text=i.asm.ra).apply(null,arguments)},i._sqlite3_bind_parameter_index=function(){return(i._sqlite3_bind_parameter_index=i.asm.sa).apply(null,arguments)},i._sqlite3_sql=function(){return(i._sqlite3_sql=i.asm.ta).apply(null,arguments)},i._sqlite3_normalized_sql=function(){return(i._sqlite3_normalized_sql=i.asm.ua).apply(null,arguments)},i._sqlite3_errmsg=function(){return(i._sqlite3_errmsg=i.asm.va).apply(null,arguments)},i._sqlite3_exec=function(){return(i._sqlite3_exec=i.asm.wa).apply(null,arguments)},i._sqlite3_prepare_v2=function(){return(i._sqlite3_prepare_v2=i.asm.xa).apply(null,arguments)},i._sqlite3_changes=function(){return(i._sqlite3_changes=i.asm.ya).apply(null,arguments)},i._sqlite3_close_v2=function(){return(i._sqlite3_close_v2=i.asm.za).apply(null,arguments)},i._sqlite3_create_function_v2=function(){return(i._sqlite3_create_function_v2=i.asm.Aa).apply(null,arguments)},i._sqlite3_open=function(){return(i._sqlite3_open=i.asm.Ba).apply(null,arguments)};var Le=i._malloc=function(){return(Le=i._malloc=i.asm.Ca).apply(null,arguments)},Pe=i._free=function(){return(Pe=i._free=i.asm.Da).apply(null,arguments)};i._RegisterExtensionFunctions=function(){return(i._RegisterExtensionFunctions=i.asm.Ea).apply(null,arguments)};var ze,Be=i.__get_tzname=function(){return(Be=i.__get_tzname=i.asm.Fa).apply(null,arguments)},Ve=i.__get_daylight=function(){return(Ve=i.__get_daylight=i.asm.Ga).apply(null,arguments)},We=i.__get_timezone=function(){return(We=i.__get_timezone=i.asm.Ha).apply(null,arguments)},Ue=i.stackSave=function(){return(Ue=i.stackSave=i.asm.Ia).apply(null,arguments)},je=i.stackRestore=function(){return(je=i.stackRestore=i.asm.Ja).apply(null,arguments)},He=i.stackAlloc=function(){return(He=i.stackAlloc=i.asm.Ka).apply(null,arguments)},qe=i._memalign=function(){return(qe=i._memalign=i.asm.La).apply(null,arguments)};function Ge(){function t(){if(!ze&&(ze=!0,i.calledRun=!0,!R)){if(i.noFSInit||Kt||(Kt=!0,fe(),i.stdin=i.stdin,i.stdout=i.stdout,i.stderr=i.stderr,i.stdin?ge("stdin",i.stdin):ee("/dev/tty","/dev/stdin"),i.stdout?ge("stdout",null,i.stdout):ee("/dev/tty","/dev/stdout"),i.stderr?ge("stderr",null,i.stderr):ee("/dev/tty1","/dev/stderr"),ue("/dev/stdin","r"),ue("/dev/stdout","w"),ue("/dev/stderr","w")),ft(Q),Ot=!1,ft(J),i.onRuntimeInitialized&&i.onRuntimeInitialized(),i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;){var t=i.postRun.shift();tt.unshift(t)}ft(tt)}}if(!(0<nt)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)et();ft(Z),0<nt||(i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),t()},1)):t())}}if(i.cwrap=function(t,e,n,r){var s=(n=n||[]).every(function(t){return"number"===t});return"string"!==e&&s&&!r?D(t):function(){return F(t,e,n,arguments)}},i.UTF8ToString=H,i.stackSave=Ue,i.stackRestore=je,i.stackAlloc=He,st=function t(){ze||Ge(),ze||(st=t)},i.run=Ge,i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();return Ge(),a}))};t.exports=r,t.exports.default=r}).call(this,n("YuTi")(t))},0:function(t,e,n){t.exports=n("zUnb")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},6:function(t,e){},7:function(t,e){},8:function(t,e){},B9Yq:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},EhIR:function(t,e,n){(function(t){var r;!function(t,s,i){function a(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new a(t),r=e&&e.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,r&&("object"==typeof r&&o(r,n),s.state=function(){return o(n,{})}),s}s&&s.exports?s.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,s))||(s.exports=r):this.alea=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},PDX0:function(t,e){(function(e){t.exports=e}).call(this,{})},YSVl:function(t,e,n){var r=n("EhIR"),s=n("uDiL"),i=n("pJ6O"),a=n("yuCN"),o=n("euyF"),l=n("ie1u"),u=n("pJ3+");u.alea=r,u.xor128=s,u.xorwow=i,u.xorshift7=a,u.xor4096=o,u.tychei=l,t.exports=u},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},euyF:function(t,e,n){(function(t){var r;!function(t,s,i){function a(t){var e=this;e.next=function(){var t,n,r=e.w,s=e.X,i=e.i;return e.w=r=r+1640531527|0,n=s[i+34&127],t=s[i=i+1&127],n^=n<<13,t^=t<<17,n=s[i]=(n^=n>>>15)^(t^=t>>>12),e.i=i,n+(r^r>>>16)|0},function(t,e){var n,r,s,i,a,o=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),s=0,i=-32;i<l;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(s=0==(n=o[127&i]^=r+(a=a+1640531527|0))?s+1:0);for(s>=128&&(o[127&(e&&e.length||0)]=-1),s=127,i=512;i>0;--i)r=o[s+34&127],n=o[s=s+1&127],r^=r<<13,n^=n<<17,o[s]=(r^=r>>>15)^(n^=n>>>12);t.w=a,t.X=o,t.i=s}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,r&&(r.X&&o(r,n),s.state=function(){return o(n,{})}),s}s&&s.exports?s.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,s))||(s.exports=r):this.xor4096=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},ie1u:function(t,e,n){(function(t){var r;!function(t,s,i){function a(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,s=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^s,s=s-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^s,e.a=s-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new a(t),r=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,r&&("object"==typeof r&&o(r,n),s.state=function(){return o(n,{})}),s}s&&s.exports?s.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,s))||(s.exports=r):this.tychei=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},"pJ3+":function(t,e,n){var r;!function(s,i){var a,o=this,l=256,u=i.pow(l,6),c=i.pow(2,52),h=2*c,d=255;function p(t,e,n){var r=[],d=y(g((e=1==e?{entropy:!0}:e||{}).entropy?[t,b(s)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(l):(t=new Uint8Array(l),(o.crypto||o.msCrypto).getRandomValues(t)),b(t)}catch(r){var e=o.navigator,n=e&&e.plugins;return[+new Date,o,n,o.screen,b(s)]}}():t,3),r),p=new f(r),v=function(){for(var t=p.g(6),e=u,n=0;t<c;)t=(t+n)*l,e*=l,n=p.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|p.g(4)},v.quick=function(){return p.g(4)/4294967296},v.double=v,y(b(p.S),s),(e.pass||n||function(t,e,n,r){return r&&(r.S&&m(r,p),t.state=function(){return m(p,{})}),n?(i.random=t,e):t})(v,d,"global"in e?e.global:this==i,e.state)}function f(t){var e,n=t.length,r=this,s=0,i=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);s<l;)a[s]=s++;for(s=0;s<l;s++)a[s]=a[i=d&i+t[s%n]+(e=a[s])],a[i]=e;(r.g=function(t){for(var e,n=0,s=r.i,i=r.j,a=r.S;t--;)e=a[s=d&s+1],n=n*l+a[d&(a[s]=a[i=d&i+e])+(a[i]=e)];return r.i=s,r.j=i,n})(l)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,r=[],s=typeof t;if(e&&"object"==s)for(n in t)try{r.push(g(t[n],e-1))}catch(i){}return r.length?r:"string"==s?t:t+"\0"}function y(t,e){for(var n,r=t+"",s=0;s<r.length;)e[d&s]=d&(n^=19*e[d&s])+r.charCodeAt(s++);return b(e)}function b(t){return String.fromCharCode.apply(0,t)}if(i.seedrandom=p,y(i.random(),s),t.exports){t.exports=p;try{a=n(6)}catch(v){}}else void 0===(r=(function(){return p}).call(e,n,e,t))||(t.exports=r)}([],Math)},pJ6O:function(t,e,n){(function(t){var r;!function(t,s,i){function a(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new a(t),r=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,r&&("object"==typeof r&&o(r,n),s.state=function(){return o(n,{})}),s}s&&s.exports?s.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,s))||(s.exports=r):this.xorwow=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},uDiL:function(t,e,n){(function(t){var r;!function(t,s,i){function a(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new a(t),r=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,r&&("object"==typeof r&&o(r,n),s.state=function(){return o(n,{})}),s}s&&s.exports?s.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,s))||(s.exports=r):this.xor128=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},yuCN:function(t,e,n){(function(t){var r;!function(t,s,i){function a(t){var e=this;e.next=function(){var t,n,r=e.x,s=e.i;return t=r[s],n=(t^=t>>>7)^t<<24,n^=(t=r[s+1&7])^t>>>10,n^=(t=r[s+3&7])^t>>>3,n^=(t=r[s+4&7])^t<<7,t=r[s+7&7],r[s]=n^=(t^=t<<13)^t<<9,e.i=s+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,r&&(r.x&&o(r,n),s.state=function(){return o(n,{})}),s}s&&s.exports?s.exports=l:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return l}).call(e,n,e,s))||(s.exports=r):this.xorshift7=l}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},zUnb:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"shuffle",function(){return VC}),n.d(r,"clamp",function(){return WC}),n.d(r,"nearestLargerEven",function(){return UC}),n.d(r,"sum",function(){return jC}),n.d(r,"randUniform",function(){return HC}),n.d(r,"distSquared",function(){return qC}),n.d(r,"assert",function(){return GC}),n.d(r,"assertShapesMatch",function(){return KC}),n.d(r,"assertNonNull",function(){return XC}),n.d(r,"flatten",function(){return YC}),n.d(r,"sizeFromShape",function(){return ZC}),n.d(r,"isScalarShape",function(){return QC}),n.d(r,"arraysEqual",function(){return JC}),n.d(r,"isInt",function(){return tI}),n.d(r,"tanh",function(){return eI}),n.d(r,"sizeToSquarishShape",function(){return nI}),n.d(r,"createShuffledIndices",function(){return rI}),n.d(r,"rightPad",function(){return sI}),n.d(r,"repeatedTry",function(){return iI}),n.d(r,"inferFromImplicitShape",function(){return aI}),n.d(r,"parseAxisParam",function(){return oI}),n.d(r,"squeezeShape",function(){return lI}),n.d(r,"getTypedArrayFromDType",function(){return uI}),n.d(r,"getArrayFromDType",function(){return cI}),n.d(r,"checkConversionForErrors",function(){return hI}),n.d(r,"isValidDtype",function(){return dI}),n.d(r,"hasEncodingLoss",function(){return pI}),n.d(r,"isTypedArray",function(){return fI}),n.d(r,"bytesPerElement",function(){return mI}),n.d(r,"bytesFromStringArray",function(){return gI}),n.d(r,"isString",function(){return yI}),n.d(r,"isBoolean",function(){return bI}),n.d(r,"isNumber",function(){return vI}),n.d(r,"inferDtype",function(){return wI}),n.d(r,"isFunction",function(){return _I}),n.d(r,"nearestDivisor",function(){return xI}),n.d(r,"computeStrides",function(){return kI}),n.d(r,"toNestedArray",function(){return CI}),n.d(r,"makeOnesTypedArray",function(){return II}),n.d(r,"makeZerosTypedArray",function(){return EI}),n.d(r,"makeZerosNestedTypedArray",function(){return TI}),n.d(r,"assertNonNegativeIntegerDimensions",function(){return NI}),n.d(r,"locToIndex",function(){return AI}),n.d(r,"indexToLoc",function(){return RI}),n.d(r,"isPromise",function(){return OI}),n.d(r,"createScalarValue",function(){return GN}),n.d(r,"toTypedArray",function(){return KN}),n.d(r,"now",function(){return XN}),n.d(r,"fetch",function(){return YN}),n.d(r,"encodeString",function(){return ZN}),n.d(r,"decodeString",function(){return QN});var s={};n.r(s),n.d(s,"makeTypesMatch",function(){return pA}),n.d(s,"assertTypesMatch",function(){return fA}),n.d(s,"isTensorInList",function(){return mA}),n.d(s,"getTensorsInContainer",function(){return gA});var i={};n.r(i),n.d(i,"isMobile",function(){return kA}),n.d(i,"isBrowser",function(){return SA});var a={};n.r(a),n.d(a,"copyModel",function(){return xR}),n.d(a,"listModels",function(){return wR}),n.d(a,"moveModel",function(){return kR}),n.d(a,"removeModel",function(){return _R}),n.d(a,"browserFiles",function(){return OR}),n.d(a,"browserHTTPRequest",function(){return VR}),n.d(a,"concatenateArrayBuffers",function(){return VA}),n.d(a,"decodeWeights",function(){return LA}),n.d(a,"encodeWeights",function(){return MA}),n.d(a,"fromMemory",function(){return jR}),n.d(a,"getLoadHandlers",function(){return XA}),n.d(a,"getModelArtifactsInfoForJSON",function(){return UA}),n.d(a,"getSaveHandlers",function(){return KA}),n.d(a,"http",function(){return BR}),n.d(a,"isHTTPScheme",function(){return PR}),n.d(a,"loadWeights",function(){return $R}),n.d(a,"registerLoadRouter",function(){return GA}),n.d(a,"registerSaveRouter",function(){return qA}),n.d(a,"weightsLoaderFactory",function(){return MR}),n.d(a,"withSaveHandler",function(){return HR});var o={};n.r(o),n.d(o,"toPixels",function(){return GR}),n.d(o,"fromPixels",function(){return KR});var l={};n.r(l),n.d(l,"assertParamsValid",function(){return XR}),n.d(l,"maskToAxes",function(){return YR}),n.d(l,"computeOutShape",function(){return ZR}),n.d(l,"stridesWithElidedDims",function(){return QR}),n.d(l,"getNormalizedAxes",function(){return eO}),n.d(l,"startIndicesWithElidedDims",function(){return nO}),n.d(l,"stopIndicesWithElidedDims",function(){return rO}),n.d(l,"stridesForAxis",function(){return sO}),n.d(l,"startForAxis",function(){return iO}),n.d(l,"stopForAxis",function(){return aO}),n.d(l,"isSliceContinous",function(){return oO}),n.d(l,"computeFlatOffset",function(){return lO}),n.d(l,"parseSliceParams",function(){return uO}),n.d(l,"sliceInfo",function(){return cO});var u={};n.r(u),n.d(u,"Serializable",function(){return hO}),n.d(u,"SerializationMap",function(){return dO}),n.d(u,"registerClass",function(){return pO});var c={};n.r(c),n.d(c,"conv2d",function(){return qF}),n.d(c,"depthwiseConv2d",function(){return XF}),n.d(c,"matMul",function(){return ZF});var h={};n.r(h),n.d(h,"segOpComputeOptimalWindowSize",function(){return SM}),n.d(h,"computeOutShape",function(){return CM}),n.d(h,"collectGatherOpShapeInfo",function(){return IM});var d={};n.r(d),n.d(d,"axesAreInnerMostDims",function(){return LD}),n.d(d,"combineLocations",function(){return PD}),n.d(d,"computeOutAndReduceShapes",function(){return zD}),n.d(d,"expandShapeToKeepDim",function(){return BD}),n.d(d,"assertAxesAreInnerMostDims",function(){return VD}),n.d(d,"getAxesPermutation",function(){return WD}),n.d(d,"getUndoAxesPermutation",function(){return UD}),n.d(d,"getInnerMostAxes",function(){return jD}),n.d(d,"getBroadcastDims",function(){return cD}),n.d(d,"getReductionAxes",function(){return hD}),n.d(d,"assertAndGetBroadcastShape",function(){return dD}),n.d(d,"assertParamsConsistent",function(){return H$}),n.d(d,"computeOutShape",function(){return q$}),n.d(d,"computeDilation2DInfo",function(){return NO}),n.d(d,"computePool2DInfo",function(){return AO}),n.d(d,"computePool3DInfo",function(){return RO}),n.d(d,"computeConv2DInfo",function(){return OO}),n.d(d,"computeConv3DInfo",function(){return DO}),n.d(d,"computeDefaultPad",function(){return FO}),n.d(d,"tupleValuesAreOne",function(){return zO}),n.d(d,"eitherStridesOrDilationsAreOne",function(){return BO}),n.d(d,"convertConv2DDataFormat",function(){return VO}),n.d(d,"getFusedDyActivation",function(){return WF}),n.d(d,"getFusedBiasGradient",function(){return UF}),n.d(d,"applyActivation",function(){return jF}),n.d(d,"shouldFuse",function(){return HF}),n.d(d,"PARALLELIZE_THRESHOLD",function(){return G$}),n.d(d,"computeOptimalWindowSize",function(){return K$}),n.d(d,"slice_util",function(){return l}),n.d(d,"upcastType",function(){return hA}),n.d(d,"getImageCenter",function(){return X$}),n.d(d,"getReshaped",function(){return Y$}),n.d(d,"getPermuted",function(){return Z$}),n.d(d,"getReshapedPermuted",function(){return Q$}),n.d(d,"getSliceBeginCoords",function(){return J$}),n.d(d,"getSliceSize",function(){return tM}),n.d(d,"prepareAndValidate",function(){return eM}),n.d(d,"validateUpdateShape",function(){return nM}),n.d(d,"validateInput",function(){return rM}),n.d(d,"calculateShapes",function(){return sM}),n.d(d,"SELU_SCALEALPHA",function(){return iM}),n.d(d,"SELU_SCALE",function(){return aM}),n.d(d,"ERF_P",function(){return oM}),n.d(d,"ERF_A1",function(){return lM}),n.d(d,"ERF_A2",function(){return uM}),n.d(d,"ERF_A3",function(){return cM}),n.d(d,"ERF_A4",function(){return hM}),n.d(d,"ERF_A5",function(){return dM}),n.d(d,"warn",function(){return pM}),n.d(d,"log",function(){return fM}),n.d(d,"mergeRealAndImagArrays",function(){return mM}),n.d(d,"splitRealAndImagArrays",function(){return gM}),n.d(d,"complexWithEvenIndex",function(){return yM}),n.d(d,"complexWithOddIndex",function(){return bM}),n.d(d,"getComplexWithIndex",function(){return vM}),n.d(d,"assignToTypedArray",function(){return wM}),n.d(d,"exponents",function(){return _M}),n.d(d,"exponent",function(){return xM}),n.d(d,"prepareSplitSize",function(){return kM}),n.d(d,"segment_util",function(){return h}),n.d(d,"castTensor",function(){return EM}),n.d(d,"reshapeTensor",function(){return TM}),n.d(d,"fromUint8ToStringArray",function(){return NM}),n.d(d,"fromStringArrayToUint8",function(){return AM});var p={};n.r(p),n.d(p,"nonMaxSuppressionV3Impl",function(){return l$}),n.d(p,"nonMaxSuppressionV4Impl",function(){return u$}),n.d(p,"nonMaxSuppressionV5Impl",function(){return c$}),n.d(p,"whereImpl",function(){return RM});var f={};n.r(f),n.d(f,"json",function(){return Pz});var m={};n.r(m),n.d(m,"json",function(){return zz});var g={};n.r(g),n.d(g,"json",function(){return Bz});var y={};n.r(y),n.d(y,"json",function(){return Vz});var b={};n.r(b),n.d(b,"json",function(){return Wz});var v={};n.r(v),n.d(v,"json",function(){return Uz});var w={};n.r(w),n.d(w,"json",function(){return jz});var _={};n.r(_),n.d(_,"json",function(){return Hz});var x={};n.r(x),n.d(x,"json",function(){return qz});var k={};n.r(k),n.d(k,"json",function(){return Gz});var S={};n.r(S),n.d(S,"json",function(){return Kz});var C={};n.r(C),n.d(C,"json",function(){return Xz});var I={};n.r(I),n.d(I,"json",function(){return Yz});var E={};n.r(E),n.d(E,"json",function(){return Zz});var T={};n.r(T),n.d(T,"json",function(){return Qz});var N={};n.r(N),n.d(N,"json",function(){return Jz});var A={};n.r(A),n.d(A,"json",function(){return tB});var R={};function O(t){return"function"==typeof t}n.r(R),n.d(R,"simpleAbsImpl",function(){return DG}),n.d(R,"addImpl",function(){return SG}),n.d(R,"bincountImpl",function(){return gK}),n.d(R,"bincountReduceImpl",function(){return yK}),n.d(R,"ceilImpl",function(){return wK}),n.d(R,"concatImpl",function(){return IK}),n.d(R,"expImpl",function(){return dX}),n.d(R,"expm1Impl",function(){return yX}),n.d(R,"floorImpl",function(){return PX}),n.d(R,"gatherV2Impl",function(){return GX}),n.d(R,"greaterImpl",function(){return XX}),n.d(R,"lessImpl",function(){return lY}),n.d(R,"linSpaceImpl",function(){return fY}),n.d(R,"logImpl",function(){return gY}),n.d(R,"maxImpl",function(){return RY}),n.d(R,"maximumImpl",function(){return FY}),n.d(R,"minimumImpl",function(){return qY}),n.d(R,"multiplyImpl",function(){return wX}),n.d(R,"negImpl",function(){return nZ}),n.d(R,"notEqualImpl",function(){return cZ}),n.d(R,"prodImpl",function(){return kZ}),n.d(R,"rangeImpl",function(){return CZ}),n.d(R,"rsqrtImpl",function(){return LZ}),n.d(R,"sliceImpl",function(){return dK}),n.d(R,"squaredDifferenceImpl",function(){return cQ}),n.d(R,"stridedSliceImpl",function(){return mQ}),n.d(R,"subImpl",function(){return EX}),n.d(R,"tileImpl",function(){return wQ}),n.d(R,"topKImpl",function(){return _Q}),n.d(R,"transposeImpl",function(){return BG}),n.d(R,"uniqueImpl",function(){return xQ});let D=!1;const F={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else D&&console.log("RxJS: Back to a better error behavior. Thank you. <3");D=t},get useDeprecatedSynchronousErrorHandling(){return D}};function $(t){setTimeout(()=>{throw t},0)}const M={closed:!0,next(t){},error(t){if(F.useDeprecatedSynchronousErrorHandling)throw t;$(t)},complete(){}},L=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function P(t){return null!==t&&"object"==typeof t}const z=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let B=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:s,_subscriptions:i}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(O(s)){r&&(this._unsubscribe=void 0);try{s.call(this)}catch(a){e=a instanceof z?V(a.errors):[a]}}if(L(i)){let t=-1,n=i.length;for(;++t<n;){const n=i[t];if(P(n))try{n.unsubscribe()}catch(a){e=e||[],a instanceof z?e=e.concat(V(a.errors)):e.push(a)}}}if(e)throw new z(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof t){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const s=this._subscriptions;return null===s?this._subscriptions=[n]:s.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}var e;return t.EMPTY=((e=new t).closed=!0,e),t})();function V(t){return t.reduce((t,e)=>t.concat(e instanceof z?e.errors:e),[])}const W=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class U extends B{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=M;break;case 1:if(!t){this.destination=M;break}if("object"==typeof t){t instanceof U?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new j(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new j(this,t,e,n)}}[W](){return this}static create(t,e,n){const r=new U(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class j extends U{constructor(t,e,n,r){let s;super(),this._parentSubscriber=t;let i=this;O(e)?s=e:e&&(s=e.next,n=e.error,r=e.complete,e!==M&&(i=Object.create(e),O(i.unsubscribe)&&this.add(i.unsubscribe.bind(i)),i.unsubscribe=this.unsubscribe.bind(this))),this._context=i,this._next=s,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;F.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=F;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):$(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;$(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);F.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),F.useDeprecatedSynchronousErrorHandling)throw n;$(n)}}__tryOrSetError(t,e,n){if(!F.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return F.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):($(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const H=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function q(t){return t}let G=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,s=function(t,e,n){if(t){if(t instanceof U)return t;if(t[W])return t[W]()}return t||e||n?new U(t,e,n):new U(M)}(t,e,n);if(s.add(r?r.call(s,this.source):this.source||F.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),F.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s}_trySubscribe(t){try{return this._subscribe(t)}catch(e){F.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof U?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=K(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(s){n(s),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[H](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?q:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=K(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function K(t){if(t||(t=F.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const X=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class Y extends B{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class Z extends U{constructor(t){super(t),this.destination=t}}let Q=(()=>{class t extends G{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[W](){return new Z(this)}lift(t){const e=new J(this,this);return e.operator=t,e}next(t){if(this.closed)throw new X;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let s=0;s<n;s++)r[s].next(t)}}error(t){if(this.closed)throw new X;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let s=0;s<n;s++)r[s].error(t);this.observers.length=0}complete(){if(this.closed)throw new X;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new X;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new X;return this.hasError?(t.error(this.thrownError),B.EMPTY):this.isStopped?(t.complete(),B.EMPTY):(this.observers.push(t),new Y(this,t))}asObservable(){const t=new G;return t.source=this,t}}return t.create=(t,e)=>new J(t,e),t})();class J extends Q{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):B.EMPTY}}function tt(t){return t&&"function"==typeof t.schedule}function et(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new nt(t,e))}}class nt{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new rt(t,this.project,this.thisArg))}}class rt extends U{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const st=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()};function it(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const at=it(),ot=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function lt(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const ut=t=>{if(t&&"function"==typeof t[H])return r=t,t=>{const e=r[H]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(ot(t))return st(t);if(lt(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,$),t);if(t&&"function"==typeof t[at])return e=t,t=>{const n=e[at]();for(;;){let e;try{e=n.next()}catch(r){return t.error(r),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=P(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,r};function ct(t,e){return new G(n=>{const r=new B;let s=0;return r.add(e.schedule(function(){s!==t.length?(n.next(t[s++]),n.closed||r.add(this.schedule())):n.complete()})),r})}function ht(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[H]}(t))return function(t,e){return new G(n=>{const r=new B;return r.add(e.schedule(()=>{const s=t[H]();r.add(s.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(lt(t))return function(t,e){return new G(n=>{const r=new B;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if(ot(t))return ct(t,e);if(function(t){return t&&"function"==typeof t[at]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new G(n=>{const r=new B;let s;return r.add(()=>{s&&"function"==typeof s.return&&s.return()}),r.add(e.schedule(()=>{s=t[at](),r.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=s.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof G?t:new G(ut(t))}class dt extends U{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class pt extends U{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function ft(t,e){if(!e.closed)return t instanceof G?t.subscribe(e):ut(t)(e)}function mt(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(mt((n,r)=>ht(t(n,r)).pipe(et((t,s)=>e(n,t,r,s))),n)):("number"==typeof e&&(n=e),e=>e.lift(new gt(t,n)))}class gt{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new yt(t,this.project,this.concurrent))}}class yt extends pt{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e)}_innerSub(t){const e=new dt(this),n=this.destination;n.add(e);const r=ft(t,e);r!==e&&n.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function bt(t=Number.POSITIVE_INFINITY){return mt(q,t)}function vt(t,e){return e?ct(t,e):new G(st(t))}function wt(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return tt(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof G?t[0]:bt(e)(vt(t,n))}function _t(){return function(t){return t.lift(new xt(t))}}class xt{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new kt(t,n),s=e.subscribe(r);return r.closed||(r.connection=n.connect()),s}}class kt extends U{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class St extends G{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new B,t.add(this.source.subscribe(new It(this.getSubject(),this))),t.closed&&(this._connection=null,t=B.EMPTY)),t}refCount(){return _t()(this)}}const Ct=(()=>{const t=St.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class It extends Z{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function Et(){return new Q}function Tt(){return t=>{return _t()((e=Et,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,Ct);return r.source=t,r.subjectFactory=n,r})(t));var e}}function Nt(t){for(let e in t)if(t[e]===Nt)return e;throw Error("Could not find renamed property on target object.")}function At(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Rt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Rt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Ot(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const Dt=Nt({__forward_ref__:Nt});function Ft(t){return t.__forward_ref__=Ft,t.toString=function(){return Rt(this())},t}function $t(t){return Mt(t)?t():t}function Mt(t){return"function"==typeof t&&t.hasOwnProperty(Dt)&&t.__forward_ref__===Ft}function Lt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Pt(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function zt(t){return Bt(t,Wt)||Bt(t,jt)}function Bt(t,e){return t.hasOwnProperty(e)?t[e]:null}function Vt(t){return t&&(t.hasOwnProperty(Ut)||t.hasOwnProperty(Ht))?t[Ut]:null}const Wt=Nt({"\u0275prov":Nt}),Ut=Nt({"\u0275inj":Nt}),jt=Nt({ngInjectableDef:Nt}),Ht=Nt({ngInjectorDef:Nt});var qt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});let Gt;function Kt(t){const e=Gt;return Gt=t,e}function Xt(t,e,n){const r=zt(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&qt.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${Rt(t)}]`)}function Yt(t){return{toString:t}.toString()}var Zt=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),Qt=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const Jt="undefined"!=typeof globalThis&&globalThis,te="undefined"!=typeof window&&window,ee="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ne="undefined"!=typeof global&&global,re=Jt||ne||te||ee,se={},ie=[],ae=Nt({"\u0275cmp":Nt}),oe=Nt({"\u0275dir":Nt}),le=Nt({"\u0275pipe":Nt}),ue=Nt({"\u0275mod":Nt}),ce=Nt({"\u0275loc":Nt}),he=Nt({"\u0275fac":Nt}),de=Nt({__NG_ELEMENT_ID__:Nt});let pe=0;function fe(t){return Yt(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Zt.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||ie,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||Qt.Emulated,id:"c",styles:t.styles||ie,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,s=t.features,i=t.pipes;return n.id+=pe++,n.inputs=ve(t.inputs,e),n.outputs=ve(t.outputs),s&&s.forEach(t=>t(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(me):null,n.pipeDefs=i?()=>("function"==typeof i?i():i).map(ge):null,n})}function me(t){return _e(t)||function(t){return t[oe]||null}(t)}function ge(t){return function(t){return t[le]||null}(t)}const ye={};function be(t){const e={type:t.type,bootstrap:t.bootstrap||ie,declarations:t.declarations||ie,imports:t.imports||ie,exports:t.exports||ie,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&Yt(()=>{ye[t.id]=t.type}),e}function ve(t,e){if(null==t)return se;const n={};for(const r in t)if(t.hasOwnProperty(r)){let s=t[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),n[s]=r,e&&(e[s]=i)}return n}const we=fe;function _e(t){return t[ae]||null}function xe(t,e){const n=t[ue]||null;if(!n&&!0===e)throw new Error(`Type ${Rt(t)} does not have '\u0275mod' property.`);return n}const ke=20,Se=10;function Ce(t){return Array.isArray(t)&&"object"==typeof t[1]}function Ie(t){return Array.isArray(t)&&!0===t[1]}function Ee(t){return 0!=(8&t.flags)}function Te(t){return 2==(2&t.flags)}function Ne(t){return 1==(1&t.flags)}function Ae(t){return null!==t.template}function Re(t,e){return t.hasOwnProperty(he)?t[he]:null}class Oe extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function De(t){return"string"==typeof t?t:null==t?"":String(t)}function Fe(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():De(t)}function $e(t,e){const n=e?" in "+e:"";throw new Oe("201",`No provider for ${Fe(t)} found${n}`)}class Me{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function Le(){return Pe}function Pe(t){return t.type.prototype.ngOnChanges&&(t.setInput=Be),ze}function ze(){const t=Ve(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===se)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function Be(t,e,n,r){const s=Ve(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:se,current:null}),i=s.current||(s.current={}),a=s.previous,o=this.declaredInputs[n],l=a[o];i[o]=new Me(l&&l.currentValue,e,a===se),t[r]=e}function Ve(t){return t.__ngSimpleChanges__||null}Le.ngInherit=!0;const We="http://www.w3.org/2000/svg";let Ue=void 0;function je(t){return!!t.listen}const He={createRenderer:(t,e)=>void 0!==Ue?Ue:"undefined"!=typeof document?document:void 0};function qe(t){for(;Array.isArray(t);)t=t[0];return t}function Ge(t,e){return qe(e[t])}function Ke(t,e){return qe(e[t.index])}function Xe(t,e){return t.data[e]}function Ye(t,e){const n=e[t];return Ce(n)?n:n[0]}function Ze(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Qe(t){return 4==(4&t[2])}function Je(t){return 128==(128&t[2])}function tn(t,e){return null==e?null:t[e]}function en(t){t[18]=0}function nn(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const rn={lFrame:En(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function sn(){return rn.bindingsEnabled}function an(){return rn.lFrame.lView}function on(){return rn.lFrame.tView}function ln(t){rn.lFrame.contextLView=t}function un(){let t=cn();for(;null!==t&&64===t.type;)t=t.parent;return t}function cn(){return rn.lFrame.currentTNode}function hn(t,e){const n=rn.lFrame;n.currentTNode=t,n.isParent=e}function dn(){return rn.lFrame.isParent}function pn(){rn.lFrame.isParent=!1}function fn(){return rn.isInCheckNoChangesMode}function mn(t){rn.isInCheckNoChangesMode=t}function gn(){return rn.lFrame.bindingIndex++}function yn(t){const e=rn.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function bn(t,e){const n=rn.lFrame;n.bindingIndex=n.bindingRootIndex=t,vn(e)}function vn(t){rn.lFrame.currentDirectiveIndex=t}function wn(t){const e=rn.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}function _n(){return rn.lFrame.currentQueryIndex}function xn(t){rn.lFrame.currentQueryIndex=t}function kn(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Sn(t,e,n){if(n&qt.SkipSelf){let r=e,s=t;for(;r=r.parent,!(null!==r||n&qt.Host||(r=kn(s),null===r)||(s=s[15],10&r.type)););if(null===r)return!1;e=r,t=s}const r=rn.lFrame=In();return r.currentTNode=e,r.lView=t,!0}function Cn(t){const e=In(),n=t[1];rn.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function In(){const t=rn.lFrame,e=null===t?null:t.child;return null===e?En(t):e}function En(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Tn(){const t=rn.lFrame;return rn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Nn=Tn;function An(){const t=Tn();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Rn(){return rn.lFrame.selectedIndex}function On(t){rn.lFrame.selectedIndex=t}function Dn(){const t=rn.lFrame;return Xe(t.tView,t.selectedIndex)}function Fn(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:s,ngAfterViewInit:i,ngAfterViewChecked:a,ngOnDestroy:o}=e;r&&(t.contentHooks||(t.contentHooks=[])).push(-n,r),s&&((t.contentHooks||(t.contentHooks=[])).push(n,s),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,s)),i&&(t.viewHooks||(t.viewHooks=[])).push(-n,i),a&&((t.viewHooks||(t.viewHooks=[])).push(n,a),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,a)),null!=o&&(t.destroyHooks||(t.destroyHooks=[])).push(n,o)}}function $n(t,e,n){Pn(t,e,3,n)}function Mn(t,e,n,r){(3&t[2])===n&&Pn(t,e,n,r)}function Ln(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function Pn(t,e,n,r){const s=null!=r?r:-1;let i=0;for(let a=void 0!==r?65535&t[18]:0;a<e.length;a++)if("number"==typeof e[a+1]){if(i=e[a],null!=r&&i>=r)break}else e[a]<0&&(t[18]+=65536),(i<s||-1==s)&&(zn(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function zn(t,e,n,r){const s=n[r]<0,i=n[r+1],a=t[s?-n[r]:n[r]];s?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,i.call(a)):i.call(a)}const Bn=-1;class Vn{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function Wn(t,e,n){const r=je(t);let s=0;for(;s<n.length;){const i=n[s];if("number"==typeof i){if(0!==i)break;s++;const a=n[s++],o=n[s++],l=n[s++];r?t.setAttribute(e,o,l,a):e.setAttributeNS(a,o,l)}else{const a=i,o=n[++s];jn(a)?r&&t.setProperty(e,a,o):r?t.setAttribute(e,a,o):e.setAttribute(a,o),s++}}return s}function Un(t){return 3===t||4===t||6===t}function jn(t){return 64===t.charCodeAt(0)}function Hn(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const s=e[r];"number"==typeof s?n=s:0===n||qn(t,n,s,null,-1===n||2===n?e[++r]:null)}}return t}function qn(t,e,n,r,s){let i=0,a=t.length;if(-1===e)a=-1;else for(;i<t.length;){const n=t[i++];if("number"==typeof n){if(n===e){a=-1;break}if(n>e){a=i-1;break}}}for(;i<t.length;){const e=t[i];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==s&&(t[i+1]=s));if(r===t[i+1])return void(t[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==a&&(t.splice(a,0,e),i=a+1),t.splice(i++,0,n),null!==r&&t.splice(i++,0,r),null!==s&&t.splice(i++,0,s)}function Gn(t){return t!==Bn}function Kn(t){return 32767&t}function Xn(t,e){let n=t>>16,r=e;for(;n>0;)r=r[15],n--;return r}let Yn=!0;function Zn(t){const e=Yn;return Yn=t,e}let Qn=0;function Jn(t,e){const n=er(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,tr(r.data,t),tr(e,null),tr(r.blueprint,null));const s=nr(t,e),i=t.injectorIndex;if(Gn(s)){const t=Kn(s),n=Xn(s,e),r=n[1].data;for(let s=0;s<8;s++)e[i+s]=n[t+s]|r[t+s]}return e[i+8]=s,i}function tr(t,e){t.push(0,0,0,0,0,0,0,0,e)}function er(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function nr(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,s=e;for(;null!==s;){const t=s[1],e=t.type;if(r=2===e?t.declTNode:1===e?s[6]:null,null===r)return Bn;if(n++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return Bn}function rr(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(de)&&(r=n[de]),null==r&&(r=n[de]=Qn++);const s=255&r,i=1<<s,a=64&s,o=32&s,l=e.data;128&s?a?o?l[t+7]|=i:l[t+6]|=i:o?l[t+5]|=i:l[t+4]|=i:a?o?l[t+3]|=i:l[t+2]|=i:o?l[t+1]|=i:l[t]|=i}(t,e,n)}function sr(t,e,n){if(n&qt.Optional)return t;$e(e,"NodeInjector")}function ir(t,e,n,r){if(n&qt.Optional&&void 0===r&&(r=null),0==(n&(qt.Self|qt.Host))){const s=t[9],i=Kt(void 0);try{return s?s.get(e,r,n&qt.Optional):Xt(e,r,n&qt.Optional)}finally{Kt(i)}}return sr(r,e,n)}function ar(t,e,n,r=qt.Default,s){if(null!==t){const i=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(de)?t[de]:void 0;return"number"==typeof e?e>=0?255&e:lr:e}(n);if("function"==typeof i){if(!Sn(e,t,r))return r&qt.Host?sr(s,n,r):ir(e,n,r,s);try{const t=i();if(null!=t||r&qt.Optional)return t;$e(n)}finally{Nn()}}else if("number"==typeof i){let s=null,a=er(t,e),o=Bn,l=r&qt.Host?e[16][6]:null;for((-1===a||r&qt.SkipSelf)&&(o=-1===a?nr(t,e):e[a+8],o!==Bn&&pr(r,!1)?(s=e[1],a=Kn(o),e=Xn(o,e)):a=-1);-1!==a;){const t=e[1];if(dr(i,a,t.data)){const t=ur(a,e,n,s,r,l);if(t!==or)return t}o=e[a+8],o!==Bn&&pr(r,e[1].data[a+8]===l)&&dr(i,a,e)?(s=t,a=Kn(o),e=Xn(o,e)):a=-1}}}return ir(e,n,r,s)}const or={};function lr(){return new fr(un(),an())}function ur(t,e,n,r,s,i){const a=e[1],o=a.data[t+8],l=cr(o,a,n,null==r?Te(o)&&Yn:r!=a&&0!=(3&o.type),s&qt.Host&&i===o);return null!==l?hr(e,a,l,o):or}function cr(t,e,n,r,s){const i=t.providerIndexes,a=e.data,o=1048575&i,l=t.directiveStart,u=i>>20,c=s?o+u:t.directiveEnd;for(let h=r?o:o+u;h<c;h++){const t=a[h];if(h<l&&n===t||h>=l&&t.type===n)return h}if(s){const t=a[l];if(t&&Ae(t)&&t.type===n)return l}return null}function hr(t,e,n,r){let s=t[n];const i=e.data;if(s instanceof Vn){const a=s;a.resolving&&function(t,e){throw new Oe("200","Circular dependency in DI detected for "+t)}(Fe(i[n]));const o=Zn(a.canSeeViewProviders);a.resolving=!0;const l=a.injectImpl?Kt(a.injectImpl):null;Sn(t,r,qt.Default);try{s=t[n]=a.factory(void 0,i,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=e.type.prototype;if(r){const r=Pe(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)}s&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,s),i&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,i))}(n,i[n],e)}finally{null!==l&&Kt(l),Zn(o),a.resolving=!1,Nn()}}return s}function dr(t,e,n){const r=64&t,s=32&t;let i;return i=128&t?r?s?n[e+7]:n[e+6]:s?n[e+5]:n[e+4]:r?s?n[e+3]:n[e+2]:s?n[e+1]:n[e],!!(i&1<<t)}function pr(t,e){return!(t&qt.Self||t&qt.Host&&e)}class fr{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return ar(this._tNode,this._lView,t,void 0,e)}}function mr(t){const e=t;if(Mt(t))return()=>{const t=mr($t(e));return t?t():null};let n=Re(e);if(null===n){const t=Vt(e);n=t&&t.factory}return n||null}function gr(t){return Yt(()=>{const e=t.prototype.constructor,n=e[he]||mr(e),r=Object.prototype;let s=Object.getPrototypeOf(t.prototype).constructor;for(;s&&s!==r;){const t=s[he]||mr(s);if(t&&t!==n)return t;s=Object.getPrototypeOf(s)}return t=>new t})}function yr(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let r=0;for(;r<t;){const s=n[r];if(Un(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<t&&"string"==typeof n[r];)r++;else{if(s===e)return n[r+1];r+=2}}}return null}(un(),t)}const br="__parameters__";function vr(t,e,n){return Yt(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function s(...t){if(this instanceof s)return r.apply(this,t),this;const e=new s(...t);return n.annotation=e,n;function n(t,n,r){const s=t.hasOwnProperty(br)?t[br]:Object.defineProperty(t,br,{value:[]})[br];for(;s.length<=r;)s.push(null);return(s[r]=s[r]||[]).push(e),t}}return n&&(s.prototype=Object.create(n.prototype)),s.prototype.ngMetadataName=t,s.annotationCls=s,s})}class wr{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Lt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}const _r=new wr("AnalyzeForEntryComponents"),xr=Function;function kr(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?(e===t&&(e=t.slice(0,n)),kr(r,e)):e!==t&&e.push(r)}return e}function Sr(t,e){t.forEach(t=>Array.isArray(t)?Sr(t,e):e(t))}function Cr(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Ir(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Er(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function Tr(t,e,n){let r=Ar(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let s=t.length;if(s==e)t.push(n,r);else if(1===s)t.push(r,t[0]),t[0]=n;else{for(s--,t.push(t[s-1],t[s]);s>e;)t[s]=t[s-2],s--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function Nr(t,e){const n=Ar(t,e);if(n>=0)return t[1|n]}function Ar(t,e){return function(t,e,n){let r=0,s=t.length>>1;for(;s!==r;){const n=r+(s-r>>1),i=t[n<<1];if(e===i)return n<<1;i>e?s=n:r=n+1}return~(s<<1)}(t,e)}const Rr=vr("Inject",t=>({token:t})),Or=vr("Optional"),Dr=vr("Self"),Fr=vr("SkipSelf"),$r={},Mr=/\n/gm,Lr="__source",Pr=Nt({provide:String,useValue:Nt});let zr=void 0;function Br(t){const e=zr;return zr=t,e}function Vr(t,e=qt.Default){if(void 0===zr)throw new Error("inject() must be called from an injection context");return null===zr?Xt(t,void 0,e):zr.get(t,e&qt.Optional?null:void 0,e)}function Wr(t,e=qt.Default){return(Gt||Vr)($t(t),e)}const Ur=Wr;function jr(t){const e=[];for(let n=0;n<t.length;n++){const r=$t(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t=void 0,n=qt.Default;for(let e=0;e<r.length;e++){const s=r[e];s instanceof Or||"Optional"===s.ngMetadataName||s===Or?n|=qt.Optional:s instanceof Fr||"SkipSelf"===s.ngMetadataName||s===Fr?n|=qt.SkipSelf:s instanceof Dr||"Self"===s.ngMetadataName||s===Dr?n|=qt.Self:t=s instanceof Rr||s===Rr?s.token:s}e.push(Wr(t,n))}else e.push(Wr(r))}return e}let Hr;function qr(t){var e;return(null===(e=function(){if(void 0===Hr&&(Hr=null,re.trustedTypes))try{Hr=re.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(e){}return Hr}())||void 0===e?void 0:e.createHTML(t))||t}class Gr{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see https://g.co/ng/security#xss)"}}class Kr extends Gr{getTypeName(){return"HTML"}}class Xr extends Gr{getTypeName(){return"Style"}}class Yr extends Gr{getTypeName(){return"Script"}}class Zr extends Gr{getTypeName(){return"URL"}}class Qr extends Gr{getTypeName(){return"ResourceURL"}}function Jr(t){return t instanceof Gr?t.changingThisBreaksApplicationSecurity:t}function ts(t,e){const n=es(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}function es(t){return t instanceof Gr&&t.getTypeName()||null}class ns{getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(qr(t),"text/html").body;return e.removeChild(e.firstChild),e}catch(e){return null}}}class rs{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const e=this.inertDocument.createElement("body");t.appendChild(e)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=qr(t),e;const n=this.inertDocument.createElement("body");return n.innerHTML=qr(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const ss=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,is=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function as(t){return(t=String(t)).match(ss)||t.match(is)?t:"unsafe:"+t}function os(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function ls(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const us=os("area,br,col,hr,img,wbr"),cs=os("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),hs=os("rp,rt"),ds=ls(hs,cs),ps=ls(us,ls(cs,os("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ls(hs,os("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ds),fs=os("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ms=os("srcset"),gs=ls(fs,ms,os("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),os("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ys=os("script,style,template");class bs{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!ps.hasOwnProperty(e))return this.sanitizedSomething=!0,!ys.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let s=0;s<n.length;s++){const t=n.item(s),e=t.name,i=e.toLowerCase();if(!gs.hasOwnProperty(i)){this.sanitizedSomething=!0;continue}let a=t.value;fs[i]&&(a=as(a)),ms[i]&&(r=a,a=(r=String(r)).split(",").map(t=>as(t.trim())).join(", ")),this.buf.push(" ",e,'="',_s(a),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();ps.hasOwnProperty(e)&&!us.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(_s(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+t.outerHTML);return e}}const vs=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ws=/([^\#-~ |!])/g;function _s(t){return t.replace(/&/g,"&amp;").replace(vs,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(ws,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let xs;function ks(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Ss=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function Cs(t){const e=function(){const t=an();return t&&t[12]}();return e?e.sanitize(Ss.URL,t)||"":ts(t,"URL")?Jr(t):as(De(t))}function Is(t){return t.ngDebugContext}function Es(t){return t.ngOriginalError}function Ts(t,...e){t.error(...e)}class Ns{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||Ts}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?Is(t)?Is(t):this._findContext(Es(t)):null}_findOriginalError(t){let e=Es(t);for(;e&&Es(e);)e=Es(e);return e}}function As(t,e){t.__ngContext__=e}const Rs=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(re))();function Os(t){return t instanceof Function?t():t}var Ds=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});function Fs(t,e){return(void 0)(t,e)}function $s(t){const e=t[3];return Ie(e)?e[3]:e}function Ms(t){return Ps(t[13])}function Ls(t){return Ps(t[4])}function Ps(t){for(;null!==t&&!Ie(t);)t=t[4];return t}function zs(t,e,n,r,s){if(null!=r){let i,a=!1;Ie(r)?i=r:Ce(r)&&(a=!0,r=r[0]);const o=qe(r);0===t&&null!==n?null==s?Gs(e,n,o):qs(e,n,o,s||null,!0):1===t&&null!==n?qs(e,n,o,s||null,!0):2===t?function(t,e,n){const r=Xs(t,e);r&&function(t,e,n,r){je(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,o,a):3===t&&e.destroyNode(o),null!=i&&function(t,e,n,r,s){const i=n[7];i!==qe(n)&&zs(e,t,r,i,s);for(let a=Se;a<n.length;a++){const s=n[a];ni(s[1],s,t,e,r,i)}}(e,t,i,n,s)}}function Bs(t,e,n){return je(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Vs(t,e){const n=t[9],r=n.indexOf(e),s=e[3];1024&e[2]&&(e[2]&=-1025,nn(s,-1)),n.splice(r,1)}function Ws(t,e){if(t.length<=Se)return;const n=Se+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&Vs(i,r),e>0&&(t[n-1][4]=r[4]);const a=Ir(t,Se+e);ni(r[1],s=r,s[11],2,null,null),s[0]=null,s[6]=null;const o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}var s;return r}function Us(t,e){if(!(256&e[2])){const n=e[11];je(n)&&n.destroyNode&&ni(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return js(t[1],t);for(;e;){let n=null;if(Ce(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)Ce(e)&&js(e[1],e),e=e[3];null===e&&(e=t),Ce(e)&&js(e[1],e),n=e&&e[4]}e=n}}(e)}}function js(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];if(!(t instanceof Vn)){const e=n[r+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2)e[n+1].call(t[e[n]]);else e.call(t)}}}(t,e),function(t,e){const n=t.cleanup,r=e[7];let s=-1;if(null!==n){for(let t=0;t<n.length-1;t+=2)if("string"==typeof n[t]){const i=n[t+1],a="function"==typeof i?i(e):qe(e[i]),o=r[s=n[t+2]],l=n[t+3];"boolean"==typeof l?a.removeEventListener(n[t],o,l):l>=0?r[s=l]():r[s=-l].unsubscribe(),t+=2}else{const e=r[s=n[t+1]];n[t].call(e)}if(null!==r)for(let t=s+1;t<r.length;t++)(0,r[t])();e[7]=null}}(t,e),1===e[1].type&&je(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&Ie(e[3])){n!==e[3]&&Vs(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function Hs(t,e,n){return function(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const e=t.data[r.directiveStart].encapsulation;if(e===Qt.None||e===Qt.Emulated)return null}return Ke(r,n)}(t,e.parent,n)}function qs(t,e,n,r,s){je(t)?t.insertBefore(e,n,r,s):e.insertBefore(n,r,s)}function Gs(t,e,n){je(t)?t.appendChild(e,n):e.appendChild(n)}function Ks(t,e,n,r,s){null!==r?qs(t,e,n,r,s):Gs(t,e,n)}function Xs(t,e){return je(t)?t.parentNode(e):e.parentNode}function Ys(t,e,n){return Zs(t,e,n)}let Zs=function(t,e,n){return 40&t.type?Ke(t,n):null};function Qs(t,e,n,r){const s=Hs(t,r,e),i=e[11],a=Ys(r.parent||e[6],r,e);if(null!=s)if(Array.isArray(n))for(let o=0;o<n.length;o++)Ks(i,s,n[o],a,!1);else Ks(i,s,n,a,!1)}function Js(t,e){if(null!==e){const n=e.type;if(3&n)return Ke(e,t);if(4&n)return ti(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return Js(t,n);{const n=t[e.index];return Ie(n)?ti(-1,n):qe(n)}}if(32&n)return Fs(e,t)()||qe(t[e.index]);{const n=t[16],r=n[6],s=$s(n),i=r.projection[e.projection];return null!=i?Js(s,i):Js(t,e.next)}}return null}function ti(t,e){const n=Se+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return Js(t,r)}return e[7]}function ei(t,e,n,r,s,i,a){for(;null!=n;){const o=r[n.index],l=n.type;if(a&&0===e&&(o&&As(qe(o),r),n.flags|=4),64!=(64&n.flags))if(8&l)ei(t,e,n.child,r,s,i,!1),zs(e,t,s,o,i);else if(32&l){const a=Fs(n,r);let l;for(;l=a();)zs(e,t,s,l,i);zs(e,t,s,o,i)}else 16&l?ri(t,e,r,n,s,i):zs(e,t,s,o,i);n=a?n.projectionNext:n.next}}function ni(t,e,n,r,s,i){ei(n,r,t.firstChild,e,s,i,!1)}function ri(t,e,n,r,s,i){const a=n[16],o=a[6].projection[r.projection];if(Array.isArray(o))for(let l=0;l<o.length;l++)zs(e,t,s,o[l],i);else ei(t,e,o,a[3],s,i,!0)}function si(t,e,n){je(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function ii(t,e,n){je(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function ai(t,e,n){let r=t.length;for(;;){const s=t.indexOf(e,n);if(-1===s)return s;if(0===s||t.charCodeAt(s-1)<=32){const n=e.length;if(s+n===r||t.charCodeAt(s+n)<=32)return s}n=s+1}}const oi="ng-template";function li(t,e,n){let r=0;for(;r<t.length;){let s=t[r++];if(n&&"class"===s){if(s=t[r],-1!==ai(s.toLowerCase(),e,0))return!0}else if(1===s){for(;r<t.length&&"string"==typeof(s=t[r++]);)if(s.toLowerCase()===e)return!0;return!1}}return!1}function ui(t){return 4===t.type&&t.value!==oi}function ci(t,e,n){return e===(4!==t.type||n?t.value:oi)}function hi(t,e,n){let r=4;const s=t.attrs||[],i=function(t){for(let e=0;e<t.length;e++)if(Un(t[e]))return e;return t.length}(s);let a=!1;for(let o=0;o<e.length;o++){const l=e[o];if("number"!=typeof l){if(!a)if(4&r){if(r=2|1&r,""!==l&&!ci(t,l,n)||""===l&&1===e.length){if(di(r))return!1;a=!0}}else{const u=8&r?l:e[++o];if(8&r&&null!==t.attrs){if(!li(t.attrs,u,n)){if(di(r))return!1;a=!0}continue}const c=pi(8&r?"class":l,s,ui(t),n);if(-1===c){if(di(r))return!1;a=!0;continue}if(""!==u){let t;t=c>i?"":s[c+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==ai(e,u,0)||2&r&&u!==t){if(di(r))return!1;a=!0}}}}else{if(!a&&!di(r)&&!di(l))return!1;if(a&&di(l))continue;a=!1,r=l|1&r}}return di(r)||a}function di(t){return 0==(1&t)}function pi(t,e,n,r){if(null===e)return-1;let s=0;if(r||!n){let n=!1;for(;s<e.length;){const r=e[s];if(r===t)return s;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++s];for(;"string"==typeof t;)t=e[++s];continue}if(4===r)break;if(0===r){s+=4;continue}}s+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function fi(t,e,n=!1){for(let r=0;r<e.length;r++)if(hi(t,e[r],n))return!0;return!1}function mi(t,e){t:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let e=0;e<t.length;e++)if(t[e]!==r[e])continue t;return!0}}return!1}function gi(t,e){return t?":not("+e.trim()+")":e}function yi(t){let e=t[0],n=1,r=2,s="",i=!1;for(;n<t.length;){let a=t[n];if("string"==typeof a)if(2&r){const e=t[++n];s+="["+a+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?s+="."+a:4&r&&(s+=" "+a);else""===s||di(a)||(e+=gi(i,s),s=""),r=a,i=i||!di(r);n++}return""!==s&&(e+=gi(i,s)),e}const bi={};function vi(t){wi(on(),an(),Rn()+t,fn())}function wi(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&$n(e,r,n)}else{const r=t.preOrderHooks;null!==r&&Mn(e,r,0,n)}On(n)}function _i(t,e){return t<<17|e<<2}function xi(t){return t>>17&32767}function ki(t){return 2|t}function Si(t){return(131068&t)>>2}function Ci(t,e){return-131069&t|e<<2}function Ii(t){return 1|t}function Ei(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const s=n[r],i=n[r+1];if(-1!==i){const n=t.data[i];xn(s),n.contentQueries(2,e[i],i)}}}function Ti(t,e,n,r,s,i,a,o,l,u){const c=e.blueprint.slice();return c[0]=s,c[2]=140|r,en(c),c[3]=c[15]=t,c[8]=n,c[10]=a||t&&t[10],c[11]=o||t&&t[11],c[12]=l||t&&t[12]||null,c[9]=u||t&&t[9]||null,c[6]=i,c[16]=2==e.type?t[16]:c,c}function Ni(t,e,n,r,s){let i=t.data[e];if(null===i)i=function(t,e,n,r,s){const i=cn(),a=dn(),o=t.data[e]=function(t,e,n,r,s,i){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?i:i&&i.parent,n,e,r,s);return null===t.firstChild&&(t.firstChild=o),null!==i&&(a?null==i.child&&null!==o.parent&&(i.child=o):null===i.next&&(i.next=o)),o}(t,e,n,r,s),rn.lFrame.inI18n&&(i.flags|=64);else if(64&i.type){i.type=n,i.value=r,i.attrs=s;const t=function(){const t=rn.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();i.injectorIndex=null===t?-1:t.injectorIndex}return hn(i,!0),i}function Ai(t,e,n,r){if(0===n)return-1;const s=e.length;for(let i=0;i<n;i++)e.push(r),t.blueprint.push(r),t.data.push(null);return s}function Ri(t,e,n){Cn(e);try{const r=t.viewQuery;null!==r&&oa(1,r,n);const s=t.template;null!==s&&Fi(t,e,s,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Ei(t,e),t.staticViewQueries&&oa(2,t.viewQuery,n);const i=t.components;null!==i&&function(t,e){for(let n=0;n<e.length;n++)na(t,e[n])}(e,i)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),r}finally{e[2]&=-5,An()}}function Oi(t,e,n,r){const s=e[2];if(256==(256&s))return;Cn(e);const i=fn();try{en(e),rn.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Fi(t,e,n,2,r);const a=3==(3&s);if(!i)if(a){const n=t.preOrderCheckHooks;null!==n&&$n(e,n,null)}else{const n=t.preOrderHooks;null!==n&&Mn(e,n,0,null),Ln(e,0)}if(function(t){for(let e=Ms(t);null!==e;e=Ls(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],r=n[3];0==(1024&n[2])&&nn(r,1),n[2]|=1024}}}(e),function(t){for(let e=Ms(t);null!==e;e=Ls(e))for(let t=Se;t<e.length;t++){const n=e[t],r=n[1];Je(n)&&Oi(r,n,r.template,n[8])}}(e),null!==t.contentQueries&&Ei(t,e),!i)if(a){const n=t.contentCheckHooks;null!==n&&$n(e,n)}else{const n=t.contentHooks;null!==n&&Mn(e,n,1),Ln(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const r=n[t];if(r<0)On(~r);else{const s=r,i=n[++t],a=n[++t];bn(i,s),a(2,e[s])}}}finally{On(-1)}}(t,e);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)ta(t,e[n])}(e,o);const l=t.viewQuery;if(null!==l&&oa(2,l,r),!i)if(a){const n=t.viewCheckHooks;null!==n&&$n(e,n)}else{const n=t.viewHooks;null!==n&&Mn(e,n,2),Ln(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),i||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,nn(e[3],-1))}finally{An()}}function Di(t,e,n,r){const s=e[10],i=!fn(),a=Qe(e);try{i&&!a&&s.begin&&s.begin(),a&&Ri(t,e,r),Oi(t,e,n,r)}finally{i&&!a&&s.end&&s.end()}}function Fi(t,e,n,r,s){const i=Rn();try{On(-1),2&r&&e.length>ke&&wi(t,e,ke,fn()),n(r,s)}finally{On(i)}}function $i(t,e,n){if(Ee(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const e=t.data[s];e.contentQueries&&e.contentQueries(1,n[s],s)}}}function Mi(t,e,n){sn()&&(function(t,e,n,r){const s=n.directiveStart,i=n.directiveEnd;t.firstCreatePass||Jn(n,e),As(r,e);const a=n.initialInputs;for(let o=s;o<i;o++){const r=t.data[o],i=Ae(r);i&&Yi(e,n,r);const l=hr(e,t,o,n);As(l,e),null!==a&&Zi(0,o-s,l,r,0,a),i&&(Ye(n.index,e)[8]=l)}}(t,e,n,Ke(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,s=n.directiveEnd,i=n.index,a=rn.lFrame.currentDirectiveIndex;try{On(i);for(let n=r;n<s;n++){const r=t.data[n],s=e[n];vn(n),null===r.hostBindings&&0===r.hostVars&&null===r.hostAttrs||Hi(r,s)}}finally{On(-1),vn(a)}}(t,e,n))}function Li(t,e,n=Ke){const r=e.localNames;if(null!==r){let s=e.index+1;for(let i=0;i<r.length;i+=2){const a=r[i+1],o=-1===a?n(e,t):t[a];t[s++]=o}}}function Pi(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=zi(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function zi(t,e,n,r,s,i,a,o,l,u){const c=ke+r,h=c+s,d=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:bi);return n}(c,h),p="function"==typeof u?u():u;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:o,declTNode:e,data:d.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function Bi(t,e,n,r){const s=ua(e);null===n?s.push(r):(s.push(n),t.firstCreatePass&&ca(t).push(r,s.length-1))}function Vi(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const s=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,s):n[r]=[e,s]}return n}function Wi(t,e,n,r,s,i,a,o){const l=Ke(e,n);let u,c=e.inputs;var h;!o&&null!=c&&(u=c[r])?(pa(t,n,u,r,s),Te(e)&&function(t,e){const n=Ye(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,s=null!=a?a(s,e.value||"",r):s,je(i)?i.setProperty(l,r,s):jn(r)||(l.setProperty?l.setProperty(r,s):l[r]=s))}function Ui(t,e,n,r){let s=!1;if(sn()){const i=function(t,e,n){const r=t.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const a=r[i];fi(n,a.selectors,!1)&&(s||(s=[]),rr(Jn(n,e),t,a.type),Ae(a)?(qi(t,n),s.unshift(a)):s.push(a))}return s}(t,e,n),a=null===r?null:{"":-1};if(null!==i){s=!0,Ki(n,t.data.length,i.length);for(let t=0;t<i.length;t++){const e=i[t];e.providersResolver&&e.providersResolver(e)}let r=!1,o=!1,l=Ai(t,e,i.length,null);for(let s=0;s<i.length;s++){const u=i[s];n.mergedAttrs=Hn(n.mergedAttrs,u.hostAttrs),Xi(t,n,e,l,u),Gi(l,u,a),null!==u.contentQueries&&(n.flags|=8),null===u.hostBindings&&null===u.hostAttrs&&0===u.hostVars||(n.flags|=128);const c=u.type.prototype;!r&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),r=!0),o||!c.ngOnChanges&&!c.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),o=!0),l++}!function(t,e){const n=e.directiveEnd,r=t.data,s=e.attrs,i=[];let a=null,o=null;for(let l=e.directiveStart;l<n;l++){const t=r[l],n=t.inputs,u=null===s||ui(e)?null:Qi(n,s);i.push(u),a=Vi(n,l,a),o=Vi(t.outputs,l,o)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=i,e.inputs=a,e.outputs=o}(t,n)}a&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const s=n[e[t+1]];if(null==s)throw new Oe("301",`Export of name '${e[t+1]}' not found!`);r.push(e[t],s)}}}(n,r,a)}return n.mergedAttrs=Hn(n.mergedAttrs,n.attrs),s}function ji(t,e,n,r,s,i){const a=i.hostBindings;if(a){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const i=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=i&&n.push(i),n.push(r,s,a)}}function Hi(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function qi(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Gi(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Ae(e)&&(n[""]=t)}}function Ki(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Xi(t,e,n,r,s){t.data[r]=s;const i=s.factory||(s.factory=Re(s.type)),a=new Vn(i,Ae(s),null);t.blueprint[r]=a,n[r]=a,ji(t,e,0,r,Ai(t,n,s.hostVars,bi),s)}function Yi(t,e,n){const r=Ke(e,t),s=Pi(n),i=t[10],a=ra(t,Ti(t,s,null,n.onPush?64:16,r,e,i,i.createRenderer(r,n),null,null));t[e.index]=a}function Zi(t,e,n,r,s,i){const a=i[e];if(null!==a){const t=r.setInput;for(let e=0;e<a.length;){const s=a[e++],i=a[e++],o=a[e++];null!==t?r.setInput(n,o,s,i):n[i]=o}}}function Qi(t,e){let n=null,r=0;for(;r<e.length;){const s=e[r];if(0!==s)if(5!==s){if("number"==typeof s)break;t.hasOwnProperty(s)&&(null===n&&(n=[]),n.push(s,t[s],e[r+1])),r+=2}else r+=2;else r+=4}return n}function Ji(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function ta(t,e){const n=Ye(e,t);if(Je(n)){const t=n[1];80&n[2]?Oi(t,n,t.template,n[8]):n[5]>0&&ea(n)}}function ea(t){for(let n=Ms(t);null!==n;n=Ls(n))for(let t=Se;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];Oi(t,e,t.template,e[8])}else e[5]>0&&ea(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const r=Ye(e[n],t);Je(r)&&r[5]>0&&ea(r)}}function na(t,e){const n=Ye(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),Ri(r,n,n[8])}function ra(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function sa(t){for(;t;){t[2]|=64;const e=$s(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function ia(t,e,n){const r=e[10];r.begin&&r.begin();try{Oi(t,e,t.template,n)}catch(s){throw da(e,s),s}finally{r.end&&r.end()}}function aa(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=Ze(n),s=r[1];Di(s,r,s.template,n)}}(t[8])}function oa(t,e,n){xn(0),e(t,n)}const la=(()=>Promise.resolve(null))();function ua(t){return t[7]||(t[7]=[])}function ca(t){return t.cleanup||(t.cleanup=[])}function ha(t,e,n){return(null===t||Ae(t))&&(n=function(t){for(;Array.isArray(t);){if("object"==typeof t[1])return t;t=t[0]}return null}(n[e.index])),n[11]}function da(t,e){const n=t[9],r=n?n.get(Ns,null):null;r&&r.handleError(e)}function pa(t,e,n,r,s){for(let i=0;i<n.length;){const a=n[i++],o=n[i++],l=e[a],u=t.data[a];null!==u.setInput?u.setInput(l,s,r,o):l[o]=s}}function fa(t,e,n){let r=n?t.styles:null,s=n?t.classes:null,i=0;if(null!==e)for(let a=0;a<e.length;a++){const t=e[a];"number"==typeof t?i=t:1==i?s=Ot(s,t):2==i&&(r=Ot(r,t+": "+e[++a]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=s:t.classesWithoutHost=s}const ma=new wr("INJECTOR",-1);class ga{get(t,e=$r){if(e===$r){const e=new Error(`NullInjectorError: No provider for ${Rt(t)}!`);throw e.name="NullInjectorError",e}return e}}const ya=new wr("Set Injector scope."),ba={},va={},wa=[];let _a=void 0;function xa(){return void 0===_a&&(_a=new ga),_a}function ka(t,e=null,n=null,r){return new Sa(t,n,e||xa(),r)}class Sa{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&Sr(e,n=>this.processProvider(n,t,e)),Sr([t],t=>this.processInjectorType(t,[],s)),this.records.set(ma,Ea(void 0,this));const i=this.records.get(ya);this.scope=null!=i?i.value:null,this.source=r||("object"==typeof t?null:Rt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=$r,n=qt.Default){this.assertNotDestroyed();const r=Br(this);try{if(!(n&qt.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(s=t)||"object"==typeof s&&s instanceof wr)&&zt(t);e=n&&this.injectableDefInScope(n)?Ea(Ca(t),ba):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&qt.Self?xa():this.parent).get(t,e=n&qt.Optional&&e===$r?null:e)}catch(i){if("NullInjectorError"===i.name){if((i.ngTempTokenPath=i.ngTempTokenPath||[]).unshift(Rt(t)),r)throw i;return function(t,e,n,r){const s=t.ngTempTokenPath;throw e[Lr]&&s.unshift(e[Lr]),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let s=Rt(e);if(Array.isArray(e))s=e.map(Rt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):Rt(r)))}s=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${s}]: ${t.replace(Mr,"\n  ")}`}("\n"+t.message,s,n,r),t.ngTokenPath=s,t.ngTempTokenPath=null,t}(i,t,"R3InjectorError",this.source)}throw i}finally{Br(r)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(Rt(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=$t(t)))return!1;let r=Vt(t);const s=null==r&&t.ngModule||void 0,i=void 0===s?t:s,a=-1!==n.indexOf(i);if(void 0!==s&&(r=Vt(s)),null==r)return!1;if(null!=r.imports&&!a){let t;n.push(i);try{Sr(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];Sr(r,t=>this.processProvider(t,n,r||wa))}}this.injectorDefTypes.add(i),this.records.set(i,Ea(r.factory,ba));const o=r.providers;if(null!=o&&!a){const e=t;Sr(o,t=>this.processProvider(t,e,o))}return void 0!==s&&void 0!==t.providers}processProvider(t,e,n){let r=Na(t=$t(t))?t:$t(t&&t.provide);const s=function(t,e,n){return Ta(t)?Ea(void 0,t.useValue):Ea(Ia(t),ba)}(t);if(Na(t)||!0!==t.multi)this.records.get(r);else{let e=this.records.get(r);e||(e=Ea(void 0,ba,!0),e.factory=()=>jr(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,s)}hydrate(t,e){var n;return e.value===ba&&(e.value=va,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function Ca(t){const e=zt(t),n=null!==e?e.factory:Re(t);if(null!==n)return n;const r=Vt(t);if(null!==r)return r.factory;if(t instanceof wr)throw new Error(`Token ${Rt(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=Er(e,"?");throw new Error(`Can't resolve all parameters for ${Rt(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[Wt]||t[jt]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Ia(t,e,n){let r=void 0;if(Na(t)){const e=$t(t);return Re(e)||Ca(e)}if(Ta(t))r=()=>$t(t.useValue);else if((s=t)&&s.useFactory)r=()=>t.useFactory(...jr(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>Wr($t(t.useExisting));else{const e=$t(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return Re(e)||Ca(e);r=()=>new e(...jr(t.deps))}var s;return r}function Ea(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Ta(t){return null!==t&&"object"==typeof t&&Pr in t}function Na(t){return"function"==typeof t}const Aa=function(t,e,n){return function(t,e=null,n=null,r){const s=ka(t,e,n,r);return s._resolveInjectorDefTypes(),s}({name:n},e,t,n)};let Ra=(()=>{class t{static create(t,e){return Array.isArray(t)?Aa(t,e,""):Aa(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=$r,t.NULL=new ga,t.\u0275prov=Lt({token:t,providedIn:"any",factory:()=>Wr(ma)}),t.__NG_ELEMENT_ID__=-1,t})();function Oa(t,e){Fn(Ze(t)[1],un())}function Da(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const r=[t];for(;e;){let s=void 0;if(Ae(t))s=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");s=e.\u0275dir}if(s){if(n){r.push(s);const e=t;e.inputs=Fa(t.inputs),e.declaredInputs=Fa(t.declaredInputs),e.outputs=Fa(t.outputs);const n=s.hostBindings;n&&La(t,n);const i=s.viewQuery,a=s.contentQueries;if(i&&$a(t,i),a&&Ma(t,a),At(t.inputs,s.inputs),At(t.declaredInputs,s.declaredInputs),At(t.outputs,s.outputs),Ae(s)&&s.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(s.data.animation)}}const e=s.features;if(e)for(let r=0;r<e.length;r++){const s=e[r];s&&s.ngInherit&&s(t),s===Da&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const s=t[r];s.hostVars=e+=s.hostVars,s.hostAttrs=Hn(s.hostAttrs,n=Hn(n,s.hostAttrs))}}(r)}function Fa(t){return t===se?{}:t===ie?[]:t}function $a(t,e){const n=t.viewQuery;t.viewQuery=n?(t,r)=>{e(t,r),n(t,r)}:e}function Ma(t,e){const n=t.contentQueries;t.contentQueries=n?(t,r,s)=>{e(t,r,s),n(t,r,s)}:e}function La(t,e){const n=t.hostBindings;t.hostBindings=n?(t,r)=>{e(t,r),n(t,r)}:e}let Pa=null;function za(){if(!Pa){const t=re.Symbol;if(t&&t.iterator)Pa=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Pa=n)}}}return Pa}function Ba(t){return!!Va(t)&&(Array.isArray(t)||!(t instanceof Map)&&za()in t)}function Va(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Wa(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Ua(t,e,n,r){const s=an();return Wa(s,gn(),e)&&(on(),function(t,e,n,r,s,i){const a=Ke(t,e);!function(t,e,n,r,s,i,a){if(null==i)je(t)?t.removeAttribute(e,s,n):e.removeAttribute(s);else{const o=null==a?De(i):a(i,r||"",s);je(t)?t.setAttribute(e,s,o,n):n?e.setAttributeNS(n,s,o):e.setAttribute(s,o)}}(e[11],a,i,t.value,n,r,s)}(Dn(),s,t,e,n,r)),Ua}function ja(t,e,n,r){return Wa(t,gn(),n)?e+De(n)+r:bi}function Ha(t,e,n,r,s,i,a,o){const l=an(),u=on(),c=t+ke,h=u.firstCreatePass?function(t,e,n,r,s,i,a,o,l){const u=e.consts,c=Ni(e,t,4,a||null,tn(u,o));Ui(e,n,c,tn(u,l)),Fn(e,c);const h=c.tViews=zi(2,c,r,s,i,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u);return null!==e.queries&&(e.queries.template(e,c),h.queries=e.queries.embeddedTView(c)),c}(c,u,l,e,n,r,s,i,a):u.data[c];hn(h,!1);const d=l[11].createComment("");Qs(u,l,d,h),As(d,l),ra(l,l[c]=Ji(d,l,d,h)),Ne(h)&&Mi(u,l,h),null!=a&&Li(l,h,o)}function qa(t){return function(t,e){return t[e]}(rn.lFrame.contextLView,ke+t)}function Ga(t,e=qt.Default){const n=an();return null===n?Wr(t,e):ar(un(),n,$t(t),e)}function Ka(t,e,n){const r=an();return Wa(r,gn(),e)&&Wi(on(),Dn(),r,t,e,r[11],n,!1),Ka}function Xa(t,e,n,r,s){const i=s?"class":"style";pa(t,n,e.inputs[i],i,r)}function Ya(t,e,n,r){const s=an(),i=on(),a=ke+t,o=s[11],l=s[a]=Bs(o,e,rn.lFrame.currentNamespace),u=i.firstCreatePass?function(t,e,n,r,s,i,a){const o=e.consts,l=Ni(e,t,2,s,tn(o,i));return Ui(e,n,l,tn(o,a)),null!==l.attrs&&fa(l,l.attrs,!1),null!==l.mergedAttrs&&fa(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(a,i,s,0,e,n,r):i.data[a];hn(u,!0);const c=u.mergedAttrs;null!==c&&Wn(o,l,c);const h=u.classes;null!==h&&ii(o,l,h);const d=u.styles;null!==d&&si(o,l,d),64!=(64&u.flags)&&Qs(i,s,l,u),0===rn.lFrame.elementDepthCount&&As(l,s),rn.lFrame.elementDepthCount++,Ne(u)&&(Mi(i,s,u),$i(i,u,s)),null!==r&&Li(s,u)}function Za(){let t=un();dn()?pn():(t=t.parent,hn(t,!1));const e=t;rn.lFrame.elementDepthCount--;const n=on();n.firstCreatePass&&(Fn(n,t),Ee(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Xa(n,e,an(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Xa(n,e,an(),e.stylesWithoutHost,!1)}function Qa(t,e,n,r){Ya(t,e,n,r),Za()}function Ja(t,e,n){const r=an(),s=on(),i=t+ke,a=s.firstCreatePass?function(t,e,n,r,s){const i=e.consts,a=tn(i,r),o=Ni(e,t,8,"ng-container",a);return null!==a&&fa(o,a,!0),Ui(e,n,o,tn(i,s)),null!==e.queries&&e.queries.elementStart(e,o),o}(i,s,r,e,n):s.data[i];hn(a,!0);const o=r[i]=r[11].createComment("");Qs(s,r,o,a),As(o,r),Ne(a)&&(Mi(s,r,a),$i(s,a,r)),null!=n&&Li(r,a)}function to(){let t=un();const e=on();dn()?pn():(t=t.parent,hn(t,!1)),e.firstCreatePass&&(Fn(e,t),Ee(t)&&e.queries.elementEnd(t))}function eo(){return an()}function no(t){return!!t&&"function"==typeof t.then}function ro(t){return!!t&&"function"==typeof t.subscribe}function so(t,e,n=!1,r){const s=an(),i=on(),a=un();return ao(i,s,s[11],a,t,e,n,r),so}function io(t,e,n=!1,r){const s=un(),i=an(),a=on();return ao(a,i,ha(wn(a.data),s,i),s,t,e,n,r),io}function ao(t,e,n,r,s,i,a=!1,o){const l=Ne(r),u=t.firstCreatePass&&ca(t),c=ua(e);let h=!0;if(3&r.type){const d=Ke(r,e),p=o?o(d):se,f=p.target||d,m=c.length,g=o?t=>o(qe(t[r.index])).target:r.index;if(je(n)){let a=null;if(!o&&l&&(a=function(t,e,n,r){const s=t.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const t=s[i];if(t===n&&s[i+1]===r){const t=e[7],n=s[i+2];return t.length>n?t[n]:null}"string"==typeof t&&(i+=2)}return null}(t,e,s,r.index)),null!==a)(a.__ngLastListenerFn__||a).__ngNextListenerFn__=i,a.__ngLastListenerFn__=i,h=!1;else{i=lo(r,e,i,!1);const t=n.listen(p.name||f,s,i);c.push(i,t),u&&u.push(s,g,m,m+1)}}else i=lo(r,e,i,!0),f.addEventListener(s,i,a),c.push(i),u&&u.push(s,g,m,a)}else i=lo(r,e,i,!1);const d=r.outputs;let p;if(h&&null!==d&&(p=d[s])){const t=p.length;if(t)for(let n=0;n<t;n+=2){const t=e[p[n]][p[n+1]].subscribe(i),a=c.length;c.push(i,t),u&&u.push(s,r.index,a,-(a+1))}}}function oo(t,e,n){try{return!1!==e(n)}catch(r){return da(t,r),!1}}function lo(t,e,n,r){return function s(i){if(i===Function)return n;const a=2&t.flags?Ye(t.index,e):e;0==(32&e[2])&&sa(a);let o=oo(e,n,i),l=s.__ngNextListenerFn__;for(;l;)o=oo(e,l,i)&&o,l=l.__ngNextListenerFn__;return r&&!1===o&&(i.preventDefault(),i.returnValue=!1),o}}function uo(t=1){return function(t){return(rn.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,rn.lFrame.contextLView))[8]}(t)}function co(t,e){let n=null;const r=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let s=0;s<e.length;s++){const i=e[s];if("*"!==i){if(null===r?fi(t,i,!0):mi(r,i))return s}else n=s}return n}function ho(t){const e=an()[16][6];if(!e.projection){const n=e.projection=Er(t?t.length:1,null),r=n.slice();let s=e.child;for(;null!==s;){const e=t?co(s,t):0;null!==e&&(r[e]?r[e].projectionNext=s:n[e]=s,r[e]=s),s=s.next}}}function po(t,e=0,n){const r=an(),s=on(),i=Ni(s,ke+t,16,null,n||null);null===i.projection&&(i.projection=e),pn(),64!=(64&i.flags)&&function(t,e,n){ri(e[11],0,e,n,Hs(t,n,e),Ys(n.parent||e[6],n,e))}(s,r,i)}const fo=[];function mo(t,e,n,r,s){const i=t[n+1],a=null===e;let o=r?xi(i):Si(i),l=!1;for(;0!==o&&(!1===l||a);){const n=t[o+1];go(t[o],e)&&(l=!0,t[o+1]=r?Ii(n):ki(n)),o=r?xi(n):Si(n)}l&&(t[n+1]=r?ki(i):Ii(i))}function go(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Ar(t,e)>=0}const yo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function bo(t){return t.substring(yo.key,yo.keyEnd)}function vo(t,e){const n=yo.textEnd;return n===e?-1:(e=yo.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,yo.key=e,n),wo(t,e,n))}function wo(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function _o(t,e,n){return So(t,e,n,!1),_o}function xo(t,e){return So(t,e,null,!0),xo}function ko(t,e){for(let n=function(t){return function(t){yo.key=0,yo.keyEnd=0,yo.value=0,yo.valueEnd=0,yo.textEnd=t.length}(t),vo(t,wo(t,0,yo.textEnd))}(e);n>=0;n=vo(e,n))Tr(t,bo(e),!0)}function So(t,e,n,r){const s=an(),i=on(),a=yn(2);i.firstUpdatePass&&Io(i,t,a,r),e!==bi&&Wa(s,a,e)&&No(i,i.data[Rn()],s,s[11],t,s[a+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=Rt(Jr(t)))),t}(e,n),r,a)}function Co(t,e){return e>=t.expandoStartIndex}function Io(t,e,n,r){const s=t.data;if(null===s[n+1]){const i=s[Rn()],a=Co(t,n);Oo(i,r)&&null===e&&!a&&(e=!1),e=function(t,e,n,r){const s=wn(t);let i=r?e.residualClasses:e.residualStyles;if(null===s)0===(r?e.classBindings:e.styleBindings)&&(n=To(n=Eo(null,t,e,n,r),e.attrs,r),i=null);else{const a=e.directiveStylingLast;if(-1===a||t[a]!==s)if(n=Eo(s,t,e,n,r),null===i){let n=function(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==Si(r))return t[xi(r)]}(t,e,r);void 0!==n&&Array.isArray(n)&&(n=Eo(null,t,e,n[1],r),n=To(n,e.attrs,r),function(t,e,n,r){t[xi(n?e.classBindings:e.styleBindings)]=r}(t,e,r,n))}else i=function(t,e,n){let r=void 0;const s=e.directiveEnd;for(let i=1+e.directiveStylingLast;i<s;i++)r=To(r,t[i].hostAttrs,n);return To(r,e.attrs,n)}(t,e,r)}return void 0!==i&&(r?e.residualClasses=i:e.residualStyles=i),n}(s,i,e,r),function(t,e,n,r,s,i){let a=i?e.classBindings:e.styleBindings,o=xi(a),l=Si(a);t[r]=n;let u,c=!1;if(Array.isArray(n)){const t=n;u=t[1],(null===u||Ar(t,u)>0)&&(c=!0)}else u=n;if(s)if(0!==l){const e=xi(t[o+1]);t[r+1]=_i(e,o),0!==e&&(t[e+1]=Ci(t[e+1],r)),t[o+1]=131071&t[o+1]|r<<17}else t[r+1]=_i(o,0),0!==o&&(t[o+1]=Ci(t[o+1],r)),o=r;else t[r+1]=_i(l,0),0===o?o=r:t[l+1]=Ci(t[l+1],r),l=r;c&&(t[r+1]=ki(t[r+1])),mo(t,u,r,!0),mo(t,u,r,!1),function(t,e,n,r,s){const i=s?t.residualClasses:t.residualStyles;null!=i&&"string"==typeof e&&Ar(i,e)>=0&&(n[r+1]=Ii(n[r+1]))}(e,u,t,r,i),a=_i(o,l),i?e.classBindings=a:e.styleBindings=a}(s,i,e,n,a,r)}}function Eo(t,e,n,r,s){let i=null;const a=n.directiveEnd;let o=n.directiveStylingLast;for(-1===o?o=n.directiveStart:o++;o<a&&(i=e[o],r=To(r,i.hostAttrs,s),i!==t);)o++;return null!==t&&(n.directiveStylingLast=o),r}function To(t,e,n){const r=n?1:2;let s=-1;if(null!==e)for(let i=0;i<e.length;i++){const a=e[i];"number"==typeof a?s=a:s===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Tr(t,a,!!n||e[++i]))}return void 0===t?null:t}function No(t,e,n,r,s,i,a,o){if(!(3&e.type))return;const l=t.data,u=l[o+1];Ro(1==(1&u)?Ao(l,e,n,s,Si(u),a):void 0)||(Ro(i)||2==(2&u)&&(i=Ao(l,null,n,s,o,a)),function(t,e,n,r,s){const i=je(t);if(e)s?i?t.addClass(n,r):n.classList.add(r):i?t.removeClass(n,r):n.classList.remove(r);else{let e=-1===r.indexOf("-")?void 0:Ds.DashCase;if(null==s)i?t.removeStyle(n,r,e):n.style.removeProperty(r);else{const a="string"==typeof s&&s.endsWith("!important");a&&(s=s.slice(0,-10),e|=Ds.Important),i?t.setStyle(n,r,s,e):n.style.setProperty(r,s,a?"important":"")}}}(r,a,Ge(Rn(),n),s,i))}function Ao(t,e,n,r,s,i){const a=null===e;let o=void 0;for(;s>0;){const e=t[s],i=Array.isArray(e),l=i?e[1]:e,u=null===l;let c=n[s+1];c===bi&&(c=u?fo:void 0);let h=u?Nr(c,r):l===r?c:void 0;if(i&&!Ro(h)&&(h=Nr(e,r)),Ro(h)&&(o=h,a))return o;const d=t[s+1];s=a?xi(d):Si(d)}if(null!==e){let t=i?e.residualClasses:e.residualStyles;null!=t&&(o=Nr(t,r))}return o}function Ro(t){return void 0!==t}function Oo(t,e){return 0!=(t.flags&(e?16:32))}function Do(t,e=""){const n=an(),r=on(),s=t+ke,i=r.firstCreatePass?Ni(r,s,1,e,null):r.data[s],a=n[s]=function(t,e){return je(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Qs(r,n,a,i),hn(i,!1)}function Fo(t){return $o("",t,""),Fo}function $o(t,e,n){const r=an(),s=ja(r,t,e,n);return s!==bi&&function(t,e,n){const r=Ge(e,t);!function(t,e,n){je(t)?t.setValue(e,n):e.textContent=n}(t[11],r,n)}(r,Rn(),s),$o}function Mo(t,e,n){const r=an();return Wa(r,gn(),e)&&Wi(on(),Dn(),r,t,e,r[11],n,!0),Mo}function Lo(t,e,n){const r=an();if(Wa(r,gn(),e)){const s=on(),i=Dn();Wi(s,i,r,t,e,ha(wn(s.data),i,r),n,!0)}return Lo}const Po=void 0;var zo=["en",[["a","p"],["AM","PM"],Po],[["AM","PM"],Po,Po],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Po,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Po,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Po,"{1} 'at' {0}",Po],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Bo={};function Vo(t){return t in Bo||(Bo[t]=re.ng&&re.ng.common&&re.ng.common.locales&&re.ng.common.locales[t]),Bo[t]}var Wo=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});const Uo="en-US";let jo=Uo;function Ho(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error("ASSERTION ERROR: "+t+` [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(jo=t.toLowerCase().replace(/_/g,"-"))}function qo(t,e,n,r,s){if(t=$t(t),Array.isArray(t))for(let i=0;i<t.length;i++)qo(t[i],e,n,r,s);else{const i=on(),a=an();let o=Na(t)?t:$t(t.provide),l=Ia(t);const u=un(),c=1048575&u.providerIndexes,h=u.directiveStart,d=u.providerIndexes>>20;if(Na(t)||!t.multi){const r=new Vn(l,s,Ga),p=Xo(o,e,s?c:c+d,h);-1===p?(rr(Jn(u,a),i,o),Go(i,t,e.length),e.push(o),u.directiveStart++,u.directiveEnd++,s&&(u.providerIndexes+=1048576),n.push(r),a.push(r)):(n[p]=r,a[p]=r)}else{const p=Xo(o,e,c+d,h),f=Xo(o,e,c,c+d),m=p>=0&&n[p],g=f>=0&&n[f];if(s&&!g||!s&&!m){rr(Jn(u,a),i,o);const c=function(t,e,n,r,s){const i=new Vn(t,n,Ga);return i.multi=[],i.index=e,i.componentProviders=0,Ko(i,s,r&&!n),i}(s?Zo:Yo,n.length,s,r,l);!s&&g&&(n[f].providerFactory=c),Go(i,t,e.length,0),e.push(o),u.directiveStart++,u.directiveEnd++,s&&(u.providerIndexes+=1048576),n.push(c),a.push(c)}else Go(i,t,p>-1?p:f,Ko(n[s?f:p],l,!s&&r));!s&&r&&g&&n[f].componentProviders++}}}function Go(t,e,n,r){const s=Na(e);if(s||e.useClass){const i=(e.useClass||e).prototype.ngOnDestroy;if(i){const a=t.destroyHooks||(t.destroyHooks=[]);if(!s&&e.multi){const t=a.indexOf(n);-1===t?a.push(n,[r,i]):a[t+1].push(r,i)}else a.push(n,i)}}}function Ko(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Xo(t,e,n,r){for(let s=n;s<r;s++)if(e[s]===t)return s;return-1}function Yo(t,e,n,r){return Qo(this.multi,[])}function Zo(t,e,n,r){const s=this.multi;let i;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=hr(n,n[1],this.providerFactory.index,r);i=e.slice(0,t),Qo(s,i);for(let n=t;n<e.length;n++)i.push(e[n])}else i=[],Qo(s,i);return i}function Qo(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Jo(t,e=[]){return n=>{n.providersResolver=(n,r)=>function(t,e,n){const r=on();if(r.firstCreatePass){const s=Ae(t);qo(n,r.data,r.blueprint,s,!0),qo(e,r.data,r.blueprint,s,!1)}}(n,r?r(t):t,e)}}class tl{}class el{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${Rt(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let nl=(()=>{class t{}return t.NULL=new el,t})();function rl(...t){}function sl(t,e){return new al(Ke(t,e))}const il=function(){return sl(un(),an())};let al=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=il,t})();class ol{}let ll=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>ul(),t})();const ul=function(){const t=an(),e=Ye(un().index,t);return function(t){return t[11]}(Ce(e)?e:t)};let cl=(()=>{class t{}return t.\u0275prov=Lt({token:t,providedIn:"root",factory:()=>null}),t})();class hl{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const dl=new hl("11.0.5");class pl{constructor(){}supports(t){return Ba(t)}create(t){return new ml(t)}}const fl=(t,e)=>e;class ml{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||fl}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,s=null;for(;e||n;){const i=!n||e&&e.currentIndex<vl(n,r,s)?e:n,a=vl(i,r,s),o=i.currentIndex;if(i===n)r--,n=n._nextRemoved;else if(e=e._next,null==i.previousIndex)r++;else{s||(s=[]);const t=a-r,e=o-r;if(t!=e){for(let n=0;n<t;n++){const r=n<s.length?s[n]:s[n]=0,i=r+n;e<=i&&i<t&&(s[n]=r+1)}s[i.previousIndex]=e-t}}a!==o&&t(i,a,o)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Ba(t))throw new Error(`Error trying to diff '${Rt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,s=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==s&&Object.is(s.trackById,r)?(i&&(s=this._verifyReinsertion(s,n,r,e)),Object.is(s.item,n)||this._addIdentityChange(s,n)):(s=this._mismatch(s,n,r,e),i=!0),s=s._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[za()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==s&&Object.is(s.trackById,r)?(i&&(s=this._verifyReinsertion(s,t,r,e)),Object.is(s.item,t)||this._addIdentityChange(s,t)):(s=this._mismatch(s,t,r,e),i=!0),s=s._next,e++}),this.length=e;return this._truncate(s),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,r)):t=this._addAfter(new gl(e,n),s,r),t}_verifyReinsertion(t,e,n,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new bl),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new bl),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class gl{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class yl{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class bl{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new yl,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function vl(t,e,n){const r=t.previousIndex;if(null===r)return r;let s=0;return n&&r<n.length&&(s=n[r]),r+e+s}class wl{constructor(){}supports(t){return t instanceof Map||Va(t)}create(){return new _l}}class _l{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Va(t)))throw new Error(`Error trying to diff '${Rt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,s=n._next;return r&&(r._next=s),s&&(s._prev=r),n._next=null,n._prev=null,n}const n=new xl(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class xl{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let kl=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Fr,new Or]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=Lt({token:t,providedIn:"root",factory:()=>new t([new pl])}),t})(),Sl=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Fr,new Or]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=Lt({token:t,providedIn:"root",factory:()=>new t([new wl])}),t})();function Cl(t,e,n,r,s=!1){for(;null!==n;){const i=e[n.index];if(null!==i&&r.push(qe(i)),Ie(i))for(let t=Se;t<i.length;t++){const e=i[t],n=e[1].firstChild;null!==n&&Cl(e[1],e,n,r)}const a=n.type;if(8&a)Cl(t,e,n.child,r);else if(32&a){const t=Fs(n,e);let s;for(;s=t();)r.push(s)}else if(16&a){const t=e[16],s=t[6].projection[n.projection];if(Array.isArray(s))r.push(...s);else{const e=$s(t);Cl(e[1],e,s,r,!0)}}n=s?n.projectionNext:n.next}return r}class Il{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null}get rootNodes(){const t=this._lView,e=t[1];return Cl(e,t,e.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}Us(this._lView[1],this._lView)}onDestroy(t){Bi(this._lView[1],this._lView,null,t)}markForCheck(){sa(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){ia(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){mn(!0);try{ia(t,e,n)}finally{mn(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,ni(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class El extends Il{constructor(t){super(t),this._view=t}detectChanges(){aa(this._view)}checkNoChanges(){!function(t){mn(!0);try{aa(t)}finally{mn(!1)}}(this._view)}get context(){return null}}const Tl=function(t=!1){return function(t,e,n){if(!n&&Te(t)){const n=Ye(t.index,e);return new Il(n,n)}return 47&t.type?new Il(e[16],e):null}(un(),an(),t)};let Nl=(()=>{class t{}return t.__NG_ELEMENT_ID__=Tl,t.__ChangeDetectorRef__=!0,t})();const Al=[new wl],Rl=new kl([new pl]),Ol=new Sl(Al),Dl=function(){return Ll(un(),an())};let Fl=(()=>{class t{}return t.__NG_ELEMENT_ID__=Dl,t})();const $l=Fl,Ml=class extends $l{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=Ti(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(e)),Ri(e,n,t),new Il(n)}};function Ll(t,e){return 4&t.type?new Ml(e,t,sl(t,e)):null}class Pl{}class zl{}const Bl=function(){return ql(un(),an())};let Vl=(()=>{class t{}return t.__NG_ELEMENT_ID__=Bl,t})();const Wl=Vl,Ul=class extends Wl{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return sl(this._hostTNode,this._hostLView)}get injector(){return new fr(this._hostTNode,this._hostLView)}get parentInjector(){const t=nr(this._hostTNode,this._hostLView);if(Gn(t)){const e=Xn(t,this._hostLView),n=Kn(t);return new fr(e[1].data[n+8],e)}return new fr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=jl(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-Se}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,s){const i=n||this.parentInjector;if(!s&&null==t.ngModule&&i){const t=i.get(Pl,null);t&&(s=t)}const a=t.create(i,r,void 0,s);return this.insert(a.hostView,e),a}insert(t,e){const n=t._lView,r=n[1];if(Ie(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new Ul(e,e[6],e[3]);r.detach(r.indexOf(t))}}const s=this._adjustIndex(e),i=this._lContainer;!function(t,e,n,r){const s=Se+r,i=n.length;r>0&&(n[s-1][4]=e),r<i-Se?(e[4]=n[s],Cr(n,Se+r,e)):(n.push(e),e[4]=null),e[3]=n;const a=e[17];null!==a&&n!==a&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(a,e);const o=e[19];null!==o&&o.insertView(t),e[2]|=128}(r,n,i,s);const a=ti(s,i),o=n[11],l=Xs(o,i[7]);return null!==l&&function(t,e,n,r,s,i){r[0]=s,r[6]=e,ni(t,r,n,1,s,i)}(r,i[6],o,n,l,a),t.attachToViewContainerRef(this),Cr(Hl(i),s,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=jl(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Ws(this._lContainer,e);n&&(Ir(Hl(this._lContainer),e),Us(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=Ws(this._lContainer,e);return n&&null!=Ir(Hl(this._lContainer),e)?new Il(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function jl(t){return t[8]}function Hl(t){return t[8]||(t[8]=[])}function ql(t,e){let n;const r=e[t.index];if(Ie(r))n=r;else{let s;if(8&t.type)s=qe(r);else{const n=e[11];s=n.createComment("");const r=Ke(t,e);qs(n,Xs(n,r),s,function(t,e){return je(t)?t.nextSibling(e):e.nextSibling}(n,r),!1)}e[t.index]=n=Ji(r,e,s,t),ra(e,n)}return new Ul(n,t,e)}const Gl={};class Kl extends nl{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=_e(t);return new Zl(e,this.ngModule)}}function Xl(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const Yl=new wr("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Rs});class Zl extends tl{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(yi).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Xl(this.componentDef.inputs)}get outputs(){return Xl(this.componentDef.outputs)}create(t,e,n,r){const s=(r=r||this.ngModule)?function(t,e){return{get:(n,r,s)=>{const i=t.get(n,Gl,s);return i!==Gl||r===Gl?i:e.get(n,r,s)}}}(t,r.injector):t,i=s.get(ol,He),a=s.get(cl,null),o=i.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",u=n?function(t,e,n){if(je(t))return t.selectRootElement(e,n===Qt.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(o,n,this.componentDef.encapsulation):Bs(i.createRenderer(null,this.componentDef),l,function(t){const e=t.toLowerCase();return"svg"===e?We:"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),c=this.componentDef.onPush?576:528,h={components:[],scheduler:Rs,clean:la,playerHandler:null,flags:0},d=zi(0,null,null,1,0,null,null,null,null,null),p=Ti(null,d,h,c,null,null,i,o,a,s);let f,m;Cn(p);try{const t=function(t,e,n,r,s,i){const a=n[1];n[20]=t;const o=Ni(a,20,2,"#host",null),l=o.mergedAttrs=e.hostAttrs;null!==l&&(fa(o,l,!0),null!==t&&(Wn(s,t,l),null!==o.classes&&ii(s,t,o.classes),null!==o.styles&&si(s,t,o.styles)));const u=r.createRenderer(t,e),c=Ti(n,Pi(e),null,e.onPush?64:16,n[20],o,r,u,null,null);return a.firstCreatePass&&(rr(Jn(o,n),a,e.type),qi(a,o),Ki(o,n.length,1)),ra(n,c),n[20]=c}(u,this.componentDef,p,i,o);if(u)if(n)Wn(o,u,["ng-version",dl.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,s=2;for(;r<t.length;){let i=t[r];if("string"==typeof i)2===s?""!==i&&e.push(i,t[++r]):8===s&&n.push(i);else{if(!di(s))break;s=i}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&Wn(o,u,t),e&&e.length>0&&ii(o,u,e.join(" "))}if(m=Xe(d,ke),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=e[n];t.push(null!=r?Array.from(r):null)}}f=function(t,e,n,r,s){const i=n[1],a=function(t,e,n){const r=un();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Xi(t,r,e,Ai(t,e,1,null),n));const s=hr(e,t,r.directiveStart,r);As(s,e);const i=Ke(r,e);return i&&As(i,e),s}(i,n,e);if(r.components.push(a),t[8]=a,s&&s.forEach(t=>t(a,e)),e.contentQueries){const t=un();e.contentQueries(1,a,t.directiveStart)}const o=un();return!i.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(On(o.index),ji(n[1],o,0,o.directiveStart,o.directiveEnd,e),Hi(e,a)),a}(t,this.componentDef,p,h,[Oa]),Ri(d,p,null)}finally{An()}return new Ql(this.componentType,f,sl(m,p),p,m)}}class Ql extends class{}{constructor(t,e,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new El(r),this.componentType=t}get injector(){return new fr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Jl=new Map;class tu extends Pl{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Kl(this);const n=xe(t),r=t[ce]||null;r&&Ho(r),this._bootstrapComponents=Os(n.bootstrap),this._r3Injector=ka(t,e,[{provide:Pl,useValue:this},{provide:nl,useValue:this.componentFactoryResolver}],Rt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Ra.THROW_IF_NOT_FOUND,n=qt.Default){return t===Ra||t===Pl||t===ma?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class eu extends zl{constructor(t){super(),this.moduleType=t,null!==xe(t)&&function(t){const e=new Set;!function t(n){const r=xe(n,!0),s=r.id;null!==s&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${Rt(e)} vs ${Rt(e.name)}`)}(s,Jl.get(s),n),Jl.set(s,n));const i=Os(r.imports);for(const a of i)e.has(a)||(e.add(a),t(a))}(t)}(t)}create(t){return new tu(this.moduleType,t)}}const nu=class extends Q{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,s=t=>null,i=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(s=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(i=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(s=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(i=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const a=super.subscribe(r,s,i);return t instanceof B&&t.add(a),a}};function ru(){return this._results[za()]()}class su{constructor(){this.dirty=!0,this._results=[],this.changes=new nu,this.length=0;const t=za(),e=su.prototype;e[t]||(e[t]=ru)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=kr(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class iu{constructor(t){this.queryList=t,this.matches=null}clone(){return new iu(this.queryList)}setDirty(){this.queryList.setDirty()}}class au{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);r.push(this.queries[n.indexInDeclarationView].clone())}return new au(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==ku(t,e).matches&&this.queries[e].setDirty()}}class ou{constructor(t,e,n,r=null){this.predicate=t,this.descendants=e,this.isStatic=n,this.read=r}}class lu{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,s=this.getByIndex(n).embeddedTView(t,r);s&&(s.indexInDeclarationView=n,null!==e?e.push(s):e=[s])}return null!==e?new lu(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class uu{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new uu(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(t,e,cu(e,s)),this.matchTNodeWithReadOption(t,e,cr(e,t,s,!1,!1))}else n===Fl?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,cr(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===al||r===Vl||r===Fl&&4&e.type)this.addMatch(e.index,-2);else{const n=cr(e,t,r,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function cu(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function hu(t,e,n,r){return-1===n?function(t,e){return 11&t.type?sl(t,e):4&t.type?Ll(t,e):null}(e,t):-2===n?function(t,e,n){return n===al?sl(e,t):n===Fl?Ll(e,t):n===Vl?ql(e,t):void 0}(t,e,r):hr(t,t[1],n,e)}function du(t,e,n,r){const s=e[19].queries[r];if(null===s.matches){const r=t.data,i=n.matches,a=[];for(let t=0;t<i.length;t+=2){const s=i[t];a.push(s<0?null:hu(e,r[s],i[t+1],n.metadata.read))}s.matches=a}return s.matches}function pu(t,e,n,r){const s=t.queries.getByIndex(n),i=s.matches;if(null!==i){const a=du(t,e,s,n);for(let t=0;t<i.length;t+=2){const n=i[t];if(n>0)r.push(a[t/2]);else{const s=i[t+1],a=e[-n];for(let t=Se;t<a.length;t++){const e=a[t];e[17]===e[3]&&pu(e[1],e,s,r)}if(null!==a[9]){const t=a[9];for(let e=0;e<t.length;e++){const n=t[e];pu(n[1],n,s,r)}}}}}return r}function fu(t){const e=an(),n=on(),r=_n();xn(r+1);const s=ku(n,r);if(t.dirty&&Qe(e)===s.metadata.isStatic){if(null===s.matches)t.reset([]);else{const i=s.crossesNgTemplate?pu(n,e,r,[]):du(n,e,s,r);t.reset(i),t.notifyOnChanges()}return!0}return!1}function mu(t,e,n){gu(on(),an(),t,e,n,!1)}function gu(t,e,n,r,s,i){t.firstCreatePass&&(xu(t,new ou(n,r,i,s),-1),i&&(t.staticViewQueries=!0)),_u(t,e)}function yu(t,e,n,r){vu(on(),an(),e,n,r,!1,un(),t)}function bu(t,e,n,r){vu(on(),an(),e,n,r,!0,un(),t)}function vu(t,e,n,r,s,i,a,o){t.firstCreatePass&&(xu(t,new ou(n,r,i,s),a.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(t,o),i&&(t.staticContentQueries=!0)),_u(t,e)}function wu(){return t=an(),e=_n(),t[19].queries[e].queryList;var t,e}function _u(t,e){const n=new su;Bi(t,e,n,n.destroy),null===e[19]&&(e[19]=new au),e[19].queries.push(new iu(n))}function xu(t,e,n){null===t.queries&&(t.queries=new lu),t.queries.track(new uu(e,n))}function ku(t,e){return t.queries.getByIndex(e)}function Su(t,e){return Ll(t,e)}const Cu=new wr("Application Initializer");let Iu=(()=>{class t{constructor(t){this.appInits=t,this.resolve=rl,this.reject=rl,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();no(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cu,8))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const Eu=new wr("AppId"),Tu={provide:Eu,useFactory:function(){return`${Nu()}${Nu()}${Nu()}`},deps:[]};function Nu(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Au=new wr("Platform Initializer"),Ru=new wr("Platform ID"),Ou=new wr("appBootstrapListener");let Du=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const Fu=new wr("LocaleId"),$u=new wr("DefaultCurrencyCode");class Mu{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Lu=function(t){return new eu(t)},Pu=Lu,zu=function(t){return Promise.resolve(Lu(t))},Bu=function(t){const e=Lu(t),n=Os(xe(t).declarations).reduce((t,e)=>{const n=_e(e);return n&&t.push(new Zl(n)),t},[]);return new Mu(e,n)},Vu=Bu,Wu=function(t){return Promise.resolve(Bu(t))};let Uu=(()=>{class t{constructor(){this.compileModuleSync=Pu,this.compileModuleAsync=zu,this.compileModuleAndAllComponentsSync=Vu,this.compileModuleAndAllComponentsAsync=Wu}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const ju=(()=>Promise.resolve(0))();function Hu(t){"undefined"==typeof Zone?ju.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class qu{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new nu(!1),this.onMicrotaskEmpty=new nu(!1),this.onStable=new nu(!1),this.onError=new nu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const n=this;n._nesting=0,n._outer=n._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(n._inner=n._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(n._inner=n._inner.fork(Zone.longStackTraceZoneSpec)),n.shouldCoalesceEventChangeDetection=e,n.lastRequestAnimationFrameId=-1,n.nativeRequestAnimationFrame=function(){let t=re.requestAnimationFrame,e=re.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(re,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Xu(t),Ku(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Xu(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(n,r,s,i,a,o)=>{try{return Yu(t),n.invokeTask(s,i,a,o)}finally{e&&"eventTask"===i.type&&e(),Zu(t)}},onInvoke:(e,n,r,s,i,a,o)=>{try{return Yu(t),e.invoke(r,s,i,a,o)}finally{Zu(t)}},onHasTask:(e,n,r,s)=>{e.hasTask(r,s),n===r&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Xu(t),Ku(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,n,r,s)=>(e.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(n)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!qu.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(qu.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const s=this._inner,i=s.scheduleEventTask("NgZoneEvent: "+r,t,Gu,rl,rl);try{return s.runTask(i,e,n)}finally{s.cancelTask(i)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const Gu={};function Ku(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Xu(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function Yu(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Zu(t){t._nesting--,Ku(t)}class Qu{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new nu,this.onMicrotaskEmpty=new nu,this.onStable=new nu,this.onError=new nu}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let Ju=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{qu.assertNotInAngularZone(),Hu(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Hu(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(Wr(qu))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),tc=(()=>{class t{constructor(){this._applications=new Map,rc.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return rc.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();class ec{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let nc,rc=new ec,sc=!0,ic=!1;function ac(){return ic=!0,sc}const oc=new wr("AllowMultipleToken");class lc{constructor(t,e){this.name=t,this.token=e}}function uc(t,e,n=[]){const r="Platform: "+e,s=new wr(r);return(e=[])=>{let i=cc();if(!i||i.injector.get(oc,!1))if(t)t(n.concat(e).concat({provide:s,useValue:!0}));else{const t=n.concat(e).concat({provide:s,useValue:!0},{provide:ya,useValue:"platform"});!function(t){if(nc&&!nc.destroyed&&!nc.injector.get(oc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");nc=t.get(hc);const e=t.get(Au,null);e&&e.forEach(t=>t())}(Ra.create({providers:t,name:r}))}return function(t){const e=cc();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(s)}}function cc(){return nc&&!nc.destroyed?nc:null}let hc=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new Qu:("zone.js"===t?void 0:t)||new qu({enableLongStackTrace:ac(),shouldCoalesceEventChangeDetection:e}),n}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),r=[{provide:qu,useValue:n}];return n.run(()=>{const e=Ra.create({providers:r,parent:this.injector,name:t.moduleType.name}),s=t.create(e),i=s.injector.get(Ns,null);if(!i)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{i.handleError(t)}});s.onDestroy(()=>{fc(this._modules,s),t.unsubscribe()})}),function(t,e,n){try{const r=n();return no(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(i,n,()=>{const t=s.injector.get(Iu);return t.runInitializers(),t.donePromise.then(()=>(Ho(s.injector.get(Fu,Uo)||Uo),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,e=[]){const n=dc({},e);return function(t,e,n){const r=new eu(n);return Promise.resolve(r)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(pc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${Rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Wr(Ra))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();function dc(t,e){return Array.isArray(e)?e.reduce(dc,t):Object.assign(Object.assign({},t),e)}let pc=(()=>{class t{constructor(t,e,n,r,s,i){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new G(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),o=new G(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{qu.assertNotInAngularZone(),Hu(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{qu.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=wt(a,o.pipe(Tt()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof tl?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(Pl),s=n.create(Ra.NULL,[],e||n.selector,r),i=s.location.nativeElement,a=s.injector.get(Ju,null),o=a&&s.injector.get(tc);return a&&o&&o.registerApplication(i,a),s.onDestroy(()=>{this.detachView(s.hostView),fc(this.components,s),o&&o.unregisterApplication(i)}),this._loadComponent(s),ac()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),s}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;fc(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Ou,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(Wr(qu),Wr(Du),Wr(Ra),Wr(Ns),Wr(nl),Wr(Iu))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();function fc(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class mc{}class gc{}const yc={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let bc=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||yc}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>vc(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),s="NgFactory";return void 0===r&&(r="default",s=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+s]).then(t=>vc(t,e,r))}}return t.\u0275fac=function(e){return new(e||t)(Wr(Uu),Wr(gc,8))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();function vc(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const wc=uc(null,"core",[{provide:Ru,useValue:"unknown"},{provide:hc,deps:[Ra]},{provide:tc,deps:[]},{provide:Du,deps:[]}]),_c=[{provide:pc,useClass:pc,deps:[qu,Du,Ra,Ns,nl,Iu]},{provide:Yl,deps:[qu],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Iu,useClass:Iu,deps:[[new Or,Cu]]},{provide:Uu,useClass:Uu,deps:[]},Tu,{provide:kl,useFactory:function(){return Rl},deps:[]},{provide:Sl,useFactory:function(){return Ol},deps:[]},{provide:Fu,useFactory:function(t){return Ho(t=t||"undefined"!=typeof $localize&&$localize.locale||Uo),t},deps:[[new Rr(Fu),new Or,new Fr]]},{provide:$u,useValue:"USD"}];let xc=(()=>{class t{constructor(t){}}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)(Wr(pc))},providers:_c}),t})(),kc=null;function Sc(){return kc}const Cc=new wr("DocumentToken");let Ic=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({factory:Ec,token:t,providedIn:"platform"}),t})();function Ec(){return Wr(Nc)}const Tc=new wr("Location Initialized");let Nc=(()=>{class t extends Ic{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=Sc().getLocation(),this._history=Sc().getHistory()}getBaseHrefFromDOM(){return Sc().getBaseHref(this._doc)}onPopState(t){Sc().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){Sc().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){Ac()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){Ac()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc))},t.\u0275prov=Lt({factory:Rc,token:t,providedIn:"platform"}),t})();function Ac(){return!!window.history.pushState}function Rc(){return new Nc(Wr(Cc))}function Oc(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function Dc(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Fc(t){return t&&"?"!==t[0]?"?"+t:t}let $c=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({factory:Mc,token:t,providedIn:"root"}),t})();function Mc(t){const e=Wr(Cc).location;return new Pc(Wr(Ic),e&&e.origin||"")}const Lc=new wr("appBaseHref");let Pc=(()=>{class t extends $c{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Oc(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+Fc(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const s=this.prepareExternalUrl(n+Fc(r));this._platformLocation.pushState(t,e,s)}replaceState(t,e,n,r){const s=this.prepareExternalUrl(n+Fc(r));this._platformLocation.replaceState(t,e,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Wr(Ic),Wr(Lc,8))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),zc=(()=>{class t extends $c{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Oc(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let s=this.prepareExternalUrl(n+Fc(r));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,e,s)}replaceState(t,e,n,r){let s=this.prepareExternalUrl(n+Fc(r));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Wr(Ic),Wr(Lc,8))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),Bc=(()=>{class t{constructor(t,e){this._subject=new nu,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=Dc(Wc(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+Fc(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Wc(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Fc(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Fc(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(Wr($c),Wr(Ic))},t.normalizeQueryParams=Fc,t.joinWithSlash=Oc,t.stripTrailingSlash=Dc,t.\u0275prov=Lt({factory:Vc,token:t,providedIn:"root"}),t})();function Vc(){return new Bc(Wr($c),Wr(Ic))}function Wc(t){return t.replace(/\/index.html$/,"")}var Uc=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({});class jc{}let Hc=(()=>{class t extends jc{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=Vo(e);if(n)return n;const r=e.split("-")[0];if(n=Vo(r),n)return n;if("en"===r)return zo;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Wo.PluralCase]}(e||this.locale)(t)){case Uc.Zero:return"zero";case Uc.One:return"one";case Uc.Two:return"two";case Uc.Few:return"few";case Uc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(Wr(Fu))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),qc=(()=>{class t{constructor(t,e,n,r){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Ba(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+Rt(t.item));this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(Ga(kl),Ga(Sl),Ga(al),Ga(ll))},t.\u0275dir=we({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class Gc{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Kc=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new Gc(null,this._ngForOf,-1,-1),null===r?void 0:r),s=new Xc(t,n);e.push(s)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const s=this._viewContainer.get(n);this._viewContainer.move(s,r);const i=new Xc(t,s);e.push(i)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ga(Vl),Ga(Fl),Ga(kl))},t.\u0275dir=we({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class Xc{constructor(t,e){this.record=t,this.view=e}}let Yc=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new Zc,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Qc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Qc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ga(Vl),Ga(Fl))},t.\u0275dir=we({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class Zc{constructor(){this.$implicit=null,this.ngIf=null}}function Qc(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Rt(e)}'.`)}class Jc{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let th=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const e=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),e}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let e=0;e<this._defaultViews.length;e++)this._defaultViews[e].enforceState(t)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),t})(),eh=(()=>{class t{constructor(t,e,n){this.ngSwitch=n,n._addCase(),this._view=new Jc(t,e)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(Ga(Vl),Ga(Fl),Ga(th,1))},t.\u0275dir=we({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),t})(),nh=(()=>{class t{constructor(t,e,n){n._addDefault(new Jc(t,e))}}return t.\u0275fac=function(e){return new(e||t)(Ga(Vl),Ga(Fl),Ga(th,1))},t.\u0275dir=we({type:t,selectors:[["","ngSwitchDefault",""]]}),t})(),rh=(()=>{class t{constructor(t,e,n){this._ngEl=t,this._differs=e,this._renderer=n,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,e){const[n,r]=t.split(".");null!=(e=null!=e&&r?`${e}${r}`:e)?this._renderer.setStyle(this._ngEl.nativeElement,n,e):this._renderer.removeStyle(this._ngEl.nativeElement,n)}_applyChanges(t){t.forEachRemovedItem(t=>this._setStyle(t.key,null)),t.forEachAddedItem(t=>this._setStyle(t.key,t.currentValue)),t.forEachChangedItem(t=>this._setStyle(t.key,t.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Sl),Ga(ll))},t.\u0275dir=we({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),sh=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},providers:[{provide:jc,useClass:Hc}]}),t})(),ih=(()=>{class t{}return t.\u0275prov=Lt({token:t,providedIn:"root",factory:()=>new ah(Wr(Cc),window,Wr(Ns))}),t})();class ah{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportsScrolling()){const e=this.document.getElementById(t)||this.document.getElementsByName(t)[0];e&&this.scrollToElement(e)}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=oh(this.window.history)||oh(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function oh(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class lh extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new lh,kc||(kc=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=ch||(ch=document.querySelector("base"),ch)?ch.getAttribute("href"):null;return null==e?null:(n=e,uh||(uh=document.createElement("a")),uh.setAttribute("href",n),"/"===uh.pathname.charAt(0)?uh.pathname:"/"+uh.pathname);var n}resetBaseElement(){ch=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,s]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,t)}}let uh,ch=null;const hh=new wr("TRANSITION_ID"),dh=[{provide:Cu,useFactory:function(t,e,n){return()=>{n.get(Iu).donePromise.then(()=>{const n=Sc();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[hh,Cc,Ra],multi:!0}];class ph{static init(){var t;t=new ph,rc=t}addToWindow(t){re.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},re.getAllAngularTestabilities=()=>t.getAllTestabilities(),re.getAllAngularRootElements=()=>t.getAllRootElements(),re.frameworkStabilizers||(re.frameworkStabilizers=[]),re.frameworkStabilizers.push(t=>{const e=re.getAllAngularTestabilities();let n=e.length,r=!1;const s=function(e){r=r||e,n--,0==n&&t(r)};e.forEach(function(t){t.whenStable(s)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?Sc().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const fh=new wr("EventManagerPlugins");let mh=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(Wr(fh),Wr(qu))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();class gh{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=Sc().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let yh=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),bh=(()=>{class t extends yh{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>Sc().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const vh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},wh=/%COMP%/g;function _h(t,e,n){for(let r=0;r<e.length;r++){let s=e[r];Array.isArray(s)?_h(t,s,n):(s=s.replace(wh,t),n.push(s))}return n}function xh(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let kh=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Sh(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case Qt.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new Ch(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case Qt.ShadowDom:return new Ih(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=_h(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Wr(mh),Wr(bh),Wr(Eu))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();class Sh{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(vh[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const s=vh[r];s?t.setAttributeNS(s,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=vh[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(Ds.DashCase|Ds.Important)?t.style.setProperty(e,n,r&Ds.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&Ds.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,xh(n)):this.eventManager.addEventListener(t,e,xh(n))}}class Ch extends Sh{constructor(t,e,n,r){super(t),this.component=n;const s=_h(r+"-"+n.id,n.styles,[]);e.addStyles(s),this.contentAttr="_ngcontent-%COMP%".replace(wh,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(wh,r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Ih extends Sh{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=_h(r.id,r.styles,[]);for(let i=0;i<s.length;i++){const t=document.createElement("style");t.textContent=s[i],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Eh=(()=>{class t extends gh{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const Th=["alt","control","meta","shift"],Nh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ah={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Rh={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Oh=(()=>{class t extends gh{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const s=t.parseEventName(n),i=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Sc().onAndCancel(e,s.domEventName,i))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(n.pop());let i="";if(Th.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),i+=t+".")}),i+=s,0!=n.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=i,a}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&Ah.hasOwnProperty(e)&&(e=Ah[e]))}return Nh[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),Th.forEach(r=>{r!=n&&(0,Rh[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return s=>{t.getEventFullKey(s)===e&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),Dh=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({factory:function(){return Wr(Fh)},token:t,providedIn:"root"}),t})(),Fh=(()=>{class t extends Dh{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case Ss.NONE:return e;case Ss.HTML:return ts(e,"HTML")?Jr(e):function(t,e){let n=null;try{xs=xs||function(t){return function(){try{return!!(new window.DOMParser).parseFromString(qr(""),"text/html")}catch(t){return!1}}()?new ns:new rs(t)}(t);let r=e?String(e):"";n=xs.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=n.innerHTML,n=xs.getInertBodyElement(r)}while(r!==i);return(new bs).sanitizeChildren(ks(n)||n)}finally{if(n){const t=ks(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}(this._doc,String(e));case Ss.STYLE:return ts(e,"Style")?Jr(e):e;case Ss.SCRIPT:if(ts(e,"Script"))return Jr(e);throw new Error("unsafe value used in a script context");case Ss.URL:return es(e),ts(e,"URL")?Jr(e):as(String(e));case Ss.RESOURCE_URL:if(ts(e,"ResourceURL"))return Jr(e);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return new Kr(t)}bypassSecurityTrustStyle(t){return new Xr(t)}bypassSecurityTrustScript(t){return new Yr(t)}bypassSecurityTrustUrl(t){return new Zr(t)}bypassSecurityTrustResourceUrl(t){return new Qr(t)}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc))},t.\u0275prov=Lt({factory:function(){return t=Wr(ma),new Fh(t.get(Cc));var t},token:t,providedIn:"root"}),t})();const $h=uc(wc,"browser",[{provide:Ru,useValue:"browser"},{provide:Au,useValue:function(){lh.makeCurrent(),ph.init()},multi:!0},{provide:Cc,useFactory:function(){return function(t){Ue=t}(document),document},deps:[]}]),Mh=[[],{provide:ya,useValue:"root"},{provide:Ns,useFactory:function(){return new Ns},deps:[]},{provide:fh,useClass:Eh,multi:!0,deps:[Cc,qu,Ru]},{provide:fh,useClass:Oh,multi:!0,deps:[Cc]},[],{provide:kh,useClass:kh,deps:[mh,bh,Eu]},{provide:ol,useExisting:kh},{provide:yh,useExisting:bh},{provide:bh,useClass:bh,deps:[Cc]},{provide:Ju,useClass:Ju,deps:[qu]},{provide:mh,useClass:mh,deps:[fh,qu]},[]];let Lh=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:Eu,useValue:e.appId},{provide:hh,useExisting:Eu},dh]}}}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)(Wr(t,12))},providers:Mh,imports:[sh,xc]}),t})();function Ph(t){return null!=t&&""+t!="false"}function zh(t,e=0){return function(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):e}function Bh(t){return Array.isArray(t)?t:[t]}function Vh(t){return null==t?"":"string"==typeof t?t:t+"px"}function Wh(t){return t instanceof al?t.nativeElement:t}function Uh(...t){let e=t[t.length-1];return tt(e)?(t.pop(),ct(t,e)):vt(t)}function jh(t,e,n,r){return O(n)&&(r=n,n=void 0),r?jh(t,e,n).pipe(et(t=>L(t)?r(...t):r(t))):new G(r=>{Hh(t,e,function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},r,n)})}function Hh(t,e,n,r,s){let i;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const r=t;t.addEventListener(e,n,s),i=()=>r.removeEventListener(e,n,s)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const r=t;t.on(e,n),i=()=>r.off(e,n)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const r=t;t.addListener(e,n),i=()=>r.removeListener(e,n)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let i=0,a=t.length;i<a;i++)Hh(t[i],e,n,r,s)}r.add(i)}"undefined"!=typeof window&&window;class qh extends B{constructor(t,e){super()}schedule(t,e=0){return this}}class Gh extends qh{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(s){n=!0,r=!!s&&s||new Error(s)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let Kh=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class Xh extends Kh{constructor(t,e=Kh.now){super(t,()=>Xh.delegate&&Xh.delegate!==this?Xh.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return Xh.delegate&&Xh.delegate!==this?Xh.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}function Yh(t,e){return n=>n.lift(new Zh(t,e))}class Zh{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new Qh(t,this.compare,this.keySelector))}}class Qh extends U{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(r){return this.destination.error(r)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(r){return this.destination.error(r)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}const Jh=new Xh(Gh);class td{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new ed(t,this.durationSelector))}}class ed extends pt{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let n;try{const{durationSelector:e}=this;n=e(t)}catch(e){return this.destination.error(e)}const r=ft(n,new dt(this));!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}}clearThrottle(){const{value:t,hasValue:e,throttled:n}=this;n&&(this.remove(n),this.throttled=void 0,n.unsubscribe()),e&&(this.value=void 0,this.hasValue=!1,this.destination.next(t))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function nd(t){return!L(t)&&t-parseFloat(t)+1>=0}function rd(t){const{index:e,period:n,subscriber:r}=t;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}function sd(t,e=Jh){return n=()=>function(t=0,e,n){let r=-1;return nd(e)?r=Number(e)<1?1:Number(e):tt(e)&&(n=e),tt(n)||(n=Jh),new G(e=>{const s=nd(t)?t:+t-n.now();return n.schedule(rd,s,{index:0,period:r,subscriber:e})})}(t,e),function(t){return t.lift(new td(n))};var n}function id(t,e){return function(n){return n.lift(new ad(t,e))}}class ad{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new od(t,this.predicate,this.thisArg))}}class od extends U{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}function ld(t){return e=>e.lift(new ud(t))}class ud{constructor(t){this.notifier=t}call(t,e){const n=new cd(t),r=ft(this.notifier,new dt(n));return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class cd extends pt{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function hd(){return bt(1)}function dd(...t){return hd()(Uh(...t))}function pd(...t){const e=t[t.length-1];return tt(e)?(t.pop(),n=>dd(t,n,e)):e=>dd(t,e)}function fd(t,e){return"function"==typeof e?n=>n.pipe(fd((n,r)=>ht(t(n,r)).pipe(et((t,s)=>e(n,t,r,s))))):e=>e.lift(new md(t))}class md{constructor(t){this.project=t}call(t,e){return e.subscribe(new gd(t,this.project))}}class gd extends pt{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new dt(this),r=this.destination;r.add(n),this.innerSubscription=ft(t,n),this.innerSubscription!==n&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}const yd=new G(t=>t.complete());function bd(t){return t?function(t){return new G(e=>t.schedule(()=>e.complete()))}(t):yd}let vd;try{vd="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(xrt){vd=!1}let wd,_d,xd,kd,Sd=(()=>{class t{constructor(t){this._platformId=t,this.isBrowser=this._platformId?"browser"===this._platformId:"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!vd)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(Wr(Ru))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Ru))},token:t,providedIn:"root"}),t})(),Cd=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)}}),t})();function Id(t){return function(){if(null==wd&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>wd=!0}))}finally{wd=wd||!1}return wd}()?t:!!t.capture}function Ed(){if("object"!=typeof document||!document)return 0;if(null==_d){const t=document.createElement("div"),e=t.style;t.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const n=document.createElement("div"),r=n.style;r.width="2px",r.height="1px",t.appendChild(n),document.body.appendChild(t),_d=0,0===t.scrollLeft&&(t.scrollLeft=1,_d=0===t.scrollLeft?1:2),t.parentNode.removeChild(t)}return _d}const Td=new wr("cdk-dir-doc",{providedIn:"root",factory:function(){return Ur(Cc)}});let Nd=(()=>{class t{constructor(t){if(this.value="ltr",this.change=new nu,t){const e=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||e;this.value="ltr"===n||"rtl"===n?n:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(Wr(Td,8))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Td,8))},token:t,providedIn:"root"}),t})(),Ad=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)}}),t})();class Rd{constructor(t=!1,e,n=!0){this._multiple=t,this._emitChanges=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new Q,e&&e.length&&(t?e.forEach(t=>this._markSelected(t)):this._markSelected(e[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...t){this._verifyValueAssignment(t),t.forEach(t=>this._markSelected(t)),this._emitChangeEvent()}deselect(...t){this._verifyValueAssignment(t),t.forEach(t=>this._unmarkSelected(t)),this._emitChangeEvent()}toggle(t){this.isSelected(t)?this.deselect(t):this.select(t)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(t){return this._selection.has(t)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){this.isSelected(t)||(this._multiple||this._unmarkAll(),this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}}let Od=(()=>{class t{constructor(t,e,n){this._ngZone=t,this._platform=e,this._scrolled=new Q,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new G(e=>{this._globalSubscription||this._addGlobalListener();const n=t>0?this._scrolled.pipe(sd(t)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Uh()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(t,e){const n=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe(id(t=>!t||n.indexOf(t)>-1))}getAncestorScrollContainers(t){const e=[];return this.scrollContainers.forEach((n,r)=>{this._scrollableContainsElement(r,t)&&e.push(r)}),e}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,e){let n=e.nativeElement,r=t.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>jh(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(Wr(qu),Wr(Sd),Wr(Cc,8))},t.\u0275prov=Lt({factory:function(){return new t(Wr(qu),Wr(Sd),Wr(Cc,8))},token:t,providedIn:"root"}),t})(),Dd=(()=>{class t{constructor(t,e,n,r){this.elementRef=t,this.scrollDispatcher=e,this.ngZone=n,this.dir=r,this._destroyed=new Q,this._elementScrolled=new G(t=>this.ngZone.runOutsideAngular(()=>jh(this.elementRef.nativeElement,"scroll").pipe(ld(this._destroyed)).subscribe(t)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const e=this.elementRef.nativeElement,n=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=n?t.end:t.start),null==t.right&&(t.right=n?t.start:t.end),null!=t.bottom&&(t.top=e.scrollHeight-e.clientHeight-t.bottom),n&&0!=Ed()?(null!=t.left&&(t.right=e.scrollWidth-e.clientWidth-t.left),2==Ed()?t.left=t.right:1==Ed()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=e.scrollWidth-e.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const e=this.elementRef.nativeElement;!function(){if(null==xd)if("object"==typeof document&&document||(xd=!1),"scrollBehavior"in document.documentElement.style)xd=!0;else{const t=Element.prototype.scrollTo;xd=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}return xd}()?(null!=t.top&&(e.scrollTop=t.top),null!=t.left&&(e.scrollLeft=t.left)):e.scrollTo(t)}measureScrollOffset(t){const e="left",n="right",r=this.elementRef.nativeElement;if("top"==t)return r.scrollTop;if("bottom"==t)return r.scrollHeight-r.clientHeight-r.scrollTop;const s=this.dir&&"rtl"==this.dir.value;return"start"==t?t=s?n:e:"end"==t&&(t=s?e:n),s&&2==Ed()?t==e?r.scrollWidth-r.clientWidth-r.scrollLeft:r.scrollLeft:s&&1==Ed()?t==e?r.scrollLeft+r.scrollWidth-r.clientWidth:-r.scrollLeft:t==e?r.scrollLeft:r.scrollWidth-r.clientWidth-r.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Od),Ga(qu),Ga(Nd,8))},t.\u0275dir=we({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),t})(),Fd=(()=>{class t{constructor(t,e,n){this._platform=t,this._change=new Q,this._changeListener=t=>{this._change.next(t)},this._document=n,e.runOutsideAngular(()=>{if(t.isBrowser){const t=this._getWindow();t.addEventListener("resize",this._changeListener),t.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:e,height:n}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+n,right:t.left+e,height:n,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,e=this._getWindow(),n=t.documentElement,r=n.getBoundingClientRect();return{top:-r.top||t.body.scrollTop||e.scrollY||n.scrollTop||0,left:-r.left||t.body.scrollLeft||e.scrollX||n.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(sd(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(Wr(Sd),Wr(qu),Wr(Cc,8))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Sd),Wr(qu),Wr(Cc,8))},token:t,providedIn:"root"}),t})(),$d=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)}}),t})(),Md=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[Ad,Cd,$d],Ad,$d]}),t})();function Ld(t,...e){return e.length?e.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}function Pd(){}function zd(t,e,n){return function(r){return r.lift(new Bd(t,e,n))}}class Bd{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new Vd(t,this.nextOrObserver,this.error,this.complete))}}class Vd extends U{constructor(t,e,n,r){super(t),this._tapNext=Pd,this._tapError=Pd,this._tapComplete=Pd,this._tapError=n||Pd,this._tapComplete=r||Pd,O(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Pd,this._tapError=e.error||Pd,this._tapComplete=e.complete||Pd)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}function Wd(t,e=Jh){return n=>n.lift(new Ud(t,e))}class Ud{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new jd(t,this.dueTime,this.scheduler))}}class jd extends U{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Hd,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function Hd(t){t.debouncedNext()}const qd=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function Gd(t){return e=>0===t?bd():e.lift(new Kd(t))}class Kd{constructor(t){if(this.total=t,this.total<0)throw new qd}call(t,e){return e.subscribe(new Xd(t,this.total))}}class Xd extends U{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}let Yd=(()=>{class t{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Zd=(()=>{class t{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,e)=>this._cleanupObserver(e))}observe(t){const e=Wh(t);return new G(t=>{const n=this._observeElement(e).subscribe(t);return()=>{n.unsubscribe(),this._unobserveElement(e)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const e=new Q,n=this._mutationObserverFactory.create(t=>e.next(t));n&&n.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:n,stream:e,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:e,stream:n}=this._observedElements.get(t);e&&e.disconnect(),n.complete(),this._observedElements.delete(t)}}}return t.\u0275fac=function(e){return new(e||t)(Wr(Yd))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Yd))},token:t,providedIn:"root"}),t})(),Qd=(()=>{class t{constructor(t,e,n){this._contentObserver=t,this._elementRef=e,this._ngZone=n,this.event=new nu,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=Ph(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=zh(t),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(Wd(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Ga(Zd),Ga(al),Ga(qu))},t.\u0275dir=we({type:t,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),t})(),Jd=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},providers:[Yd]}),t})();class tp{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Q,this._typeaheadSubscription=B.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new Q,this.change=new Q,t instanceof su&&t.changes.subscribe(t=>{if(this._activeItem){const e=t.toArray().indexOf(this._activeItem);e>-1&&e!==this._activeItemIndex&&(this._activeItemIndex=e)}})}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(zd(t=>this._pressedLetters.push(t)),Wd(t),id(()=>this._pressedLetters.length>0),et(()=>this._pressedLetters.join(""))).subscribe(t=>{const e=this._getItemsArray();for(let n=1;n<e.length+1;n++){const r=(this._activeItemIndex+n)%e.length,s=e[r];if(!this._skipPredicateFn(s)&&0===s.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(r);break}}this._pressedLetters=[]}),this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,n=["altKey","ctrlKey","metaKey","shiftKey"].every(e=>!t[e]||this._allowedModifierKeys.indexOf(e)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&n){this.setNextItemActive();break}return;case 38:if(this._vertical&&n){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&n){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&n){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&n){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&n){this.setLastItemActive();break}return;default:return void((n||Ld(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t),r=e[n];this._activeItem=null==r?null:r,this._activeItemIndex=n}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let n=1;n<=e.length;n++){const r=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof su?this._items.toArray():this._items}}class ep extends tp{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class np extends tp{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let rp=(()=>{class t{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const e=function(t){try{return t.frameElement}catch(xrt){return null}}((n=t).ownerDocument&&n.ownerDocument.defaultView||window);var n;if(e){if(-1===ip(e))return!1;if(!this.isVisible(e))return!1}let r=t.nodeName.toLowerCase(),s=ip(t);return t.hasAttribute("contenteditable")?-1!==s:"iframe"!==r&&"object"!==r&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(t){let e=t.nodeName.toLowerCase(),n="input"===e&&t.type;return"text"===n||"password"===n||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,e){return function(t){return!function(t){return function(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function(t){let e=t.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(t)||function(t){return function(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||sp(t))}(t)&&!this.isDisabled(t)&&((null==e?void 0:e.ignoreVisibility)||this.isVisible(t))}}return t.\u0275fac=function(e){return new(e||t)(Wr(Sd))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Sd))},token:t,providedIn:"root"}),t})();function sp(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let e=t.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function ip(t){if(!sp(t))return null;const e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class ap{constructor(t,e,n,r,s=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),e&&(e.removeEventListener("focus",this.endAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement()))})}focusFirstTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement()))})}focusLastTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement()))})}_getRegionBoundary(t){let e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);for(let n=0;n<e.length;n++)e[n].hasAttribute("cdk-focus-"+t)?console.warn(`Found use of deprecated attribute 'cdk-focus-${t}', use 'cdkFocusRegion${t}' instead. The deprecated attribute will be removed in 8.0.0.`,e[n]):e[n].hasAttribute("cdk-focus-region-"+t)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${t}', use 'cdkFocusRegion${t}' instead. The deprecated attribute will be removed in 8.0.0.`,e[n]);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),!this._checker.isFocusable(t)){const e=this._getFirstTabbableElement(t);return null==e||e.focus(),!!e}return t.focus(),!0}return this.focusFirstTabbableElement()}focusFirstTabbableElement(){const t=this._getRegionBoundary("start");return t&&t.focus(),!!t}focusLastTabbableElement(){const t=this._getRegionBoundary("end");return t&&t.focus(),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=0;n<e.length;n++){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(t)return t}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=e.length-1;n>=0;n--){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(t)return t}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(Gd(1)).subscribe(t)}}let op=(()=>{class t{constructor(t,e,n){this._checker=t,this._ngZone=e,this._document=n}create(t,e=!1){return new ap(t,this._checker,this._ngZone,this._document,e)}}return t.\u0275fac=function(e){return new(e||t)(Wr(rp),Wr(qu),Wr(Cc))},t.\u0275prov=Lt({factory:function(){return new t(Wr(rp),Wr(qu),Wr(Cc))},token:t,providedIn:"root"}),t})();"undefined"!=typeof Element&&Element;const lp=new wr("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),up=new wr("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let cp=(()=>{class t{constructor(t,e,n,r){this._ngZone=e,this._defaultOptions=r,this._document=n,this._liveElement=t||this._createLiveElement()}announce(t,...e){const n=this._defaultOptions;let r,s;return 1===e.length&&"number"==typeof e[0]?s=e[0]:[r,s]=e,this.clear(),clearTimeout(this._previousTimeout),r||(r=n&&n.politeness?n.politeness:"polite"),null==s&&n&&(s=n.duration),this._liveElement.setAttribute("aria-live",r),this._ngZone.runOutsideAngular(()=>new Promise(e=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,e(),"number"==typeof s&&(this._previousTimeout=setTimeout(()=>this.clear(),s))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}_createLiveElement(){const t="cdk-live-announcer-element",e=this._document.getElementsByClassName(t),n=this._document.createElement("div");for(let r=0;r<e.length;r++)e[r].parentNode.removeChild(e[r]);return n.classList.add(t),n.classList.add("cdk-visually-hidden"),n.setAttribute("aria-atomic","true"),n.setAttribute("aria-live","polite"),this._document.body.appendChild(n),n}}return t.\u0275fac=function(e){return new(e||t)(Wr(lp,8),Wr(qu),Wr(Cc),Wr(up,8))},t.\u0275prov=Lt({factory:function(){return new t(Wr(lp,8),Wr(qu),Wr(Cc),Wr(up,8))},token:t,providedIn:"root"}),t})();function hp(t){return 0===t.buttons}const dp=new wr("cdk-focus-monitor-default-options"),pp=Id({passive:!0,capture:!0});let fp=(()=>{class t{constructor(t,e,n,r){this._ngZone=t,this._platform=e,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._documentKeydownListener=()=>{this._lastTouchTarget=null,this._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=t=>{if(!this._lastTouchTarget){const e=hp(t)?"keyboard":"mouse";this._setOriginForCurrentEventQueue(e)}},this._documentTouchstartListener=t=>{null!=this._touchTimeoutId&&clearTimeout(this._touchTimeoutId),this._lastTouchTarget=mp(t),this._touchTimeoutId=setTimeout(()=>this._lastTouchTarget=null,650)},this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._rootNodeFocusAndBlurListener=t=>{const e=mp(t),n="focus"===t.type?this._onFocus:this._onBlur;for(let r=e;r;r=r.parentElement)n.call(this,t,r)},this._document=n,this._detectionMode=(null==r?void 0:r.detectionMode)||0}monitor(t,e=!1){const n=Wh(t);if(!this._platform.isBrowser||1!==n.nodeType)return Uh(null);const r=function(t){if(function(){if(null==kd){const t="undefined"!=typeof document?document.head:null;kd=!(!t||!t.createShadowRoot&&!t.attachShadow)}return kd}()){const e=t.getRootNode?t.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(n)||this._getDocument(),s=this._elementInfo.get(n);if(s)return e&&(s.checkChildren=!0),s.subject;const i={checkChildren:e,subject:new Q,rootNode:r};return this._elementInfo.set(n,i),this._registerGlobalListeners(i),i.subject}stopMonitoring(t){const e=Wh(t),n=this._elementInfo.get(e);n&&(n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._removeGlobalListeners(n))}focusVia(t,e,n){const r=Wh(t);r===this._getDocument().activeElement&&this._elementInfo.has(r)?this._originChanged(r,e,this._elementInfo.get(r)):(this._setOriginForCurrentEventQueue(e),"function"==typeof r.focus&&r.focus(n))}ngOnDestroy(){this._elementInfo.forEach((t,e)=>this.stopMonitoring(e))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,e,n){n?t.classList.add(e):t.classList.remove(e)}_getFocusOrigin(t){return this._origin?this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(t)?"touch":"program"}_setClasses(t,e){this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e)}_setOriginForCurrentEventQueue(t){this._ngZone.runOutsideAngular(()=>{this._origin=t,0===this._detectionMode&&(this._originTimeoutId=setTimeout(()=>this._origin=null,1))})}_wasCausedByTouch(t){const e=mp(t);return this._lastTouchTarget instanceof Node&&e instanceof Node&&(e===this._lastTouchTarget||e.contains(this._lastTouchTarget))}_onFocus(t,e){const n=this._elementInfo.get(e);n&&(n.checkChildren||e===mp(t))&&this._originChanged(e,this._getFocusOrigin(t),n)}_onBlur(t,e){const n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}_emitOrigin(t,e){this._ngZone.run(()=>t.next(e))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const e=t.rootNode,n=this._rootNodeFocusListenerCount.get(e)||0;n||this._ngZone.runOutsideAngular(()=>{e.addEventListener("focus",this._rootNodeFocusAndBlurListener,pp),e.addEventListener("blur",this._rootNodeFocusAndBlurListener,pp)}),this._rootNodeFocusListenerCount.set(e,n+1),1==++this._monitoredElementCount&&this._ngZone.runOutsideAngular(()=>{const t=this._getDocument(),e=this._getWindow();t.addEventListener("keydown",this._documentKeydownListener,pp),t.addEventListener("mousedown",this._documentMousedownListener,pp),t.addEventListener("touchstart",this._documentTouchstartListener,pp),e.addEventListener("focus",this._windowFocusListener)})}_removeGlobalListeners(t){const e=t.rootNode;if(this._rootNodeFocusListenerCount.has(e)){const t=this._rootNodeFocusListenerCount.get(e);t>1?this._rootNodeFocusListenerCount.set(e,t-1):(e.removeEventListener("focus",this._rootNodeFocusAndBlurListener,pp),e.removeEventListener("blur",this._rootNodeFocusAndBlurListener,pp),this._rootNodeFocusListenerCount.delete(e))}if(!--this._monitoredElementCount){const t=this._getDocument(),e=this._getWindow();t.removeEventListener("keydown",this._documentKeydownListener,pp),t.removeEventListener("mousedown",this._documentMousedownListener,pp),t.removeEventListener("touchstart",this._documentTouchstartListener,pp),e.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId)}}_originChanged(t,e,n){this._setClasses(t,e),this._emitOrigin(n.subject,e),this._lastFocusOrigin=e}}return t.\u0275fac=function(e){return new(e||t)(Wr(qu),Wr(Sd),Wr(Cc,8),Wr(dp,8))},t.\u0275prov=Lt({factory:function(){return new t(Wr(qu),Wr(Sd),Wr(Cc,8),Wr(dp,8))},token:t,providedIn:"root"}),t})();function mp(t){return t.composedPath?t.composedPath()[0]:t.target}const gp="cdk-high-contrast-black-on-white",yp="cdk-high-contrast-white-on-black",bp="cdk-high-contrast-active";let vp=(()=>{class t{constructor(t,e){this._platform=t,this._document=e}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const e=this._document.defaultView||window,n=e&&e.getComputedStyle?e.getComputedStyle(t):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),r){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(bp),t.remove(gp),t.remove(yp);const e=this.getHighContrastMode();1===e?(t.add(bp),t.add(gp)):2===e&&(t.add(bp),t.add(yp))}}}return t.\u0275fac=function(e){return new(e||t)(Wr(Sd),Wr(Cc))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Sd),Wr(Cc))},token:t,providedIn:"root"}),t})(),wp=(()=>{class t{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)(Wr(vp))},imports:[[Cd,Jd]]}),t})();const _p=new hl("11.0.3");class xp{}const kp="*";function Sp(t,e){return{type:7,name:t,definitions:e,options:{}}}function Cp(t,e=null){return{type:4,styles:e,timings:t}}function Ip(t,e=null){return{type:2,steps:t,options:e}}function Ep(t){return{type:6,styles:t,offset:null}}function Tp(t,e,n){return{type:0,name:t,styles:e,options:n}}function Np(t,e,n=null){return{type:1,expr:t,animation:e,options:n}}function Ap(t=null){return{type:9,options:t}}function Rp(t,e,n=null){return{type:11,selector:t,animation:e,options:n}}function Op(t){Promise.resolve(null).then(t)}class Dp{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Op(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class Fp{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const s=this.players.length;0==s?Op(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==s&&this._onFinish()}),t.onDestroy(()=>{++n==s&&this._onDestroy()}),t.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){const t=this.players.reduce((t,e)=>null===t||e.totalTime>t.totalTime?e:t,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}function $p(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Mp(t){switch(t.length){case 0:return new Dp;case 1:return t[0];default:return new Fp(t)}}function Lp(t,e,n,r,s={},i={}){const a=[],o=[];let l=-1,u=null;if(r.forEach(t=>{const n=t.offset,r=n==l,c=r&&u||{};Object.keys(t).forEach(n=>{let r=n,o=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,a),o){case"!":o=s[n];break;case kp:o=i[n];break;default:o=e.normalizeStyleValue(n,r,o,a)}c[r]=o}),r||o.push(c),u=c,l=n}),a.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${a.join(t)}`)}return o}function Pp(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&zp(n,"start",t)));break;case"done":t.onDone(()=>r(n&&zp(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&zp(n,"destroy",t)))}}function zp(t,e,n){const r=n.totalTime,s=Bp(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),i=t._data;return null!=i&&(s._data=i),s}function Bp(t,e,n,r,s="",i=0,a){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:s,totalTime:i,disabled:!!a}}function Vp(t,e,n){let r;return t instanceof Map?(r=t.get(e),r||t.set(e,r=n)):(r=t[e],r||(r=t[e]=n)),r}function Wp(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let Up=(t,e)=>!1,jp=(t,e)=>!1,Hp=(t,e,n)=>[];const qp=$p();(qp||"undefined"!=typeof Element)&&(Up=(t,e)=>t.contains(e),jp=(()=>{if(qp||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):jp}})(),Hp=(t,e,n)=>{let r=[];if(n){const n=t.querySelectorAll(e);for(let t=0;t<n.length;t++)r.push(n[t])}else{const n=t.querySelector(e);n&&r.push(n)}return r});let Gp=null,Kp=!1;function Xp(t){Gp||(Gp=("undefined"!=typeof document?document.body:null)||{},Kp=!!Gp.style&&"WebkitAppearance"in Gp.style);let e=!0;return Gp.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in Gp.style,!e&&Kp)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in Gp.style),e}const Yp=jp,Zp=Up,Qp=Hp;function Jp(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}let tf=(()=>{class t{validateStyleProperty(t){return Xp(t)}matchesElement(t,e){return Yp(t,e)}containsElement(t,e){return Zp(t,e)}query(t,e,n){return Qp(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,s,i=[],a){return new Dp(n,r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),ef=(()=>{class t{}return t.NOOP=new tf,t})();const nf="ng-enter",rf="ng-leave",sf="ng-trigger",af=".ng-trigger",of="ng-animating",lf=".ng-animating";function uf(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:cf(parseFloat(e[1]),e[2])}function cf(t,e){switch(e){case"s":return 1e3*t;default:return t}}function hf(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,s=0,i="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=cf(parseFloat(n[1]),n[2]);const a=n[3];null!=a&&(s=cf(parseFloat(a),n[4]));const o=n[5];o&&(i=o)}else r=t;if(!n){let n=!1,i=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),s<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(i,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:s,easing:i}}(t,e,n)}function df(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function pf(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else df(t,n);return n}function ff(t,e,n){return n?e+":"+n+";":""}function mf(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=ff(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=ff(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function gf(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const s=Sf(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[s]),t.style[s]=e[r]}),$p()&&mf(t))}function yf(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=Sf(e);t.style[n]=""}),$p()&&mf(t))}function bf(t){return Array.isArray(t)?1==t.length?t[0]:Ip(t):t}const vf=new RegExp("{{\\s*(.+?)\\s*}}","g");function wf(t){let e=[];if("string"==typeof t){let n;for(;n=vf.exec(t);)e.push(n[1]);vf.lastIndex=0}return e}function _f(t,e,n){const r=t.toString(),s=r.replace(vf,(t,r)=>{let s=e[r];return e.hasOwnProperty(r)||(n.push("Please provide a value for the animation param "+r),s=""),s.toString()});return s==r?t:s}function xf(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const kf=/-+([a-z0-9])/g;function Sf(t){return t.replace(kf,(...t)=>t[1].toUpperCase())}function Cf(t,e){return 0===t||0===e}function If(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let i=e[0],a=[];if(r.forEach(t=>{i.hasOwnProperty(t)||a.push(t),i[t]=n[t]}),a.length)for(var s=1;s<e.length;s++){let n=e[s];a.forEach(function(e){n[e]=Tf(t,e)})}}return e}function Ef(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error("Unable to resolve animation metadata node #"+e.type)}}function Tf(t,e){return window.getComputedStyle(t)[e]}const Nf="*";function Af(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const s=r[1],i=r[2],a=r[3];e.push(Df(s,a)),"<"!=i[0]||s==Nf&&a==Nf||e.push(Df(a,s))}(t,n,e)):n.push(t),n}const Rf=new Set(["true","1"]),Of=new Set(["false","0"]);function Df(t,e){const n=Rf.has(t)||Of.has(t),r=Rf.has(e)||Of.has(e);return(s,i)=>{let a=t==Nf||t==s,o=e==Nf||e==i;return!a&&n&&"boolean"==typeof s&&(a=s?Rf.has(t):Of.has(t)),!o&&r&&"boolean"==typeof i&&(o=i?Rf.has(e):Of.has(e)),a&&o}}const Ff=new RegExp("s*:selfs*,?","g");function $f(t,e,n){return new Mf(t).build(e,n)}class Mf{constructor(t){this._driver=t}build(t,e){const n=new Lf(e);return this._resetContextStyleTimingState(n),Ef(this,bf(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const s=[],i=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,s.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const s=this.visitTransition(t,e);n+=s.queryCount,r+=s.depCount,i.push(s)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:s,transitions:i,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const s=new Set,i=r||{};if(n.styles.forEach(t=>{if(Pf(t)){const e=t;Object.keys(e).forEach(t=>{wf(e[t]).forEach(t=>{i.hasOwnProperty(t)||s.add(t)})})}}),s.size){const n=xf(s.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=Ef(this,bf(t.animation),e);return{type:1,matchers:Af(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:zf(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>Ef(this,t,e)),options:zf(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const s=t.steps.map(t=>{e.currentTime=n;const s=Ef(this,t,e);return r=Math.max(r,e.currentTime),s});return e.currentTime=r,{type:3,steps:s,options:zf(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return Bf(hf(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=Bf(0,0,"");return t.dynamic=!0,t.strValue=r,t}return n=n||hf(r,e),Bf(n.duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let s=t.styles?t.styles:Ep({});if(5==s.type)r=this.visitKeyframes(s,e);else{let s=t.styles,i=!1;if(!s){i=!0;const t={};n.easing&&(t.easing=n.easing),s=Ep(t)}e.currentTime+=n.duration+n.delay;const a=this.visitStyle(s,e);a.isEmptyStep=i,r=a}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?t==kp?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,s=null;return n.forEach(t=>{if(Pf(t)){const e=t,n=e.easing;if(n&&(s=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:s,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;n&&s>0&&(s-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const i=e.collectedStyles[e.currentQuerySelector],a=i[n];let o=!0;a&&(s!=r&&s>=a.startTime&&r<=a.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${a.startTime}ms" and "${a.endTime}ms" is also being animated in a parallel animation between the times of "${s}ms" and "${r}ms"`),o=!1),s=a.startTime),o&&(i[n]={startTime:s,endTime:r}),e.options&&function(t,e,n){const r=e.params||{},s=wf(t);s.length&&s.forEach(t=>{r.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const s=[];let i=!1,a=!1,o=0;const l=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let l=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(Pf(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(Pf(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),u=0;return null!=l&&(r++,u=n.offset=l),a=a||u<0||u>1,i=i||u<o,o=u,s.push(u),n});a&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),i&&e.errors.push("Please ensure that all keyframe offsets are in order");const u=t.steps.length;let c=0;r>0&&r<u?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(c=1/(u-1));const h=u-1,d=e.currentTime,p=e.currentAnimateTimings,f=p.duration;return l.forEach((t,r)=>{const i=c>0?r==h?1:c*r:s[r],a=i*f;e.currentTime=d+p.delay+a,p.duration=a,this._validateStyleAst(t,e),t.offset=i,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:Ef(this,bf(t.animation),e),options:zf(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:zf(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:zf(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[s,i]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(Ff,"")),[t=t.replace(/@\*/g,af).replace(/@\w+/g,t=>".ng-trigger-"+t.substr(1)).replace(/:animating/g,lf),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+s:s,Vp(e.collectedStyles,e.currentQuerySelector,{});const a=Ef(this,bf(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:i,animation:a,originalSelector:t.selector,options:zf(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:hf(t.timings,e.errors,!0);return{type:12,animation:Ef(this,bf(t.animation),e),timings:n,options:null}}}class Lf{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Pf(t){return!Array.isArray(t)&&"object"==typeof t}function zf(t){var e;return t?(t=df(t)).params&&(t.params=(e=t.params)?df(e):null):t={},t}function Bf(t,e,n){return{duration:t,delay:e,easing:n}}function Vf(t,e,n,r,s,i,a=null,o=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:a,subTimeline:o}}class Wf{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Uf=new RegExp(":enter","g"),jf=new RegExp(":leave","g");function Hf(t,e,n,r,s,i={},a={},o,l,u=[]){return(new qf).buildKeyframes(t,e,n,r,s,i,a,o,l,u)}class qf{buildKeyframes(t,e,n,r,s,i,a,o,l,u=[]){l=l||new Wf;const c=new Kf(t,e,l,r,s,u,[]);c.options=o,c.currentTimeline.setStyles([i],null,c.errors,o),Ef(this,n,c);const h=c.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(a).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([a],null,c.errors,o)}return h.length?h.map(t=>t.buildKeyframes()):[Vf(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),s=e.currentTimeline.currentTime,i=this._visitSubInstructions(n,r,r.options);s!=i&&e.transformIntoNewTimeline(i)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const s=null!=n.duration?uf(n.duration):null,i=null!=n.delay?uf(n.delay):null;return 0!==s&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,s,i);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),Ef(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const s=t.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Gf);const t=uf(s.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>Ef(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const s=t.options&&t.options.delay?uf(t.options.delay):0;t.steps.forEach(i=>{const a=e.createSubContext(t.options);s&&a.delayNextStep(s),Ef(this,i,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return hf(e.params?_f(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(n.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const s=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(s):n.setStyles(t.styles,s,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,s=n.duration,i=e.createSubContext().currentTimeline;i.easing=n.easing,t.styles.forEach(t=>{i.forwardTime((t.offset||0)*s),i.setStyles(t.styles,t.easing,e.errors,e.options),i.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(i),e.transformIntoNewTimeline(r+s),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},s=r.delay?uf(r.delay):0;s&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Gf);let i=n;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let o=null;a.forEach((n,r)=>{e.currentQueryIndex=r;const a=e.createSubContext(t.options,n);s&&a.delayNextStep(s),n===e.element&&(o=a.currentTimeline),Ef(this,t.animation,a),a.currentTimeline.applyStylesToKeyframe(),i=Math.max(i,a.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(i),o&&(e.currentTimeline.mergeTimelineCollectedStyles(o),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,s=t.timings,i=Math.abs(s.duration),a=i*(e.currentQueryTotal-1);let o=i*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":o=a-o;break;case"full":o=n.currentStaggerTime}const l=e.currentTimeline;o&&l.delayNextStep(o);const u=l.currentTime;Ef(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-u+(r.startTime-n.currentTimeline.startTime)}}const Gf={};class Kf{constructor(t,e,n,r,s,i,a,o){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=i,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Gf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=o||new Xf(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=uf(n.duration)),null!=n.delay&&(r.delay=uf(n.delay));const s=n.params;if(s){let t=r.params;t||(t=this.options.params={}),Object.keys(s).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=_f(s[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,s=new Kf(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=Gf,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},s=new Yf(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,s,i){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(Uf,"."+this._enterClassName)).replace(jf,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),a.push(...e)}return s||0!=a.length||i.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),a}}class Xf{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Xf(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||kp,this._currentKeyframe[t]=kp}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const s=r&&r.params||{},i=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e),r.forEach(t=>{n[t]=kp})):pf(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(i).forEach(t=>{const e=_f(i[t],s,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:kp),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((s,i)=>{const a=pf(s,!0);Object.keys(a).forEach(n=>{const r=a[n];"!"==r?t.add(n):r==kp&&e.add(n)}),n||(a.offset=i/this.duration),r.push(a)});const s=t.size?xf(t.values()):[],i=e.size?xf(e.values()):[];if(n){const t=r[0],e=df(t);t.offset=0,e.offset=1,r=[t,e]}return Vf(this.element,r,s,i,this.duration,this.startTime,this.easing,!1)}}class Yf extends Xf{constructor(t,e,n,r,s,i,a=!1){super(t,e,i.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:i.duration,delay:i.delay,easing:i.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],i=n+e,a=e/i,o=pf(t[0],!1);o.offset=0,s.push(o);const l=pf(t[0],!1);l.offset=Zf(a),s.push(l);const u=t.length-1;for(let r=1;r<=u;r++){let a=pf(t[r],!1);a.offset=Zf((e+a.offset*n)/i),s.push(a)}n=i,e=0,r="",t=s}return Vf(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function Zf(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class Qf{}class Jf extends Qf{normalizePropertyName(t,e){return Sf(t)}normalizeStyleValue(t,e,n,r){let s="";const i=n.toString().trim();if(tm[e]&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return i+s}}const tm=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function em(t,e,n,r,s,i,a,o,l,u,c,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:s,fromState:n,fromStyles:i,toState:r,toStyles:a,timelines:o,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:h,errors:d}}const nm={};class rm{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,s){return t.some(t=>t(e,n,r,s))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],s=this._stateStyles[t],i=r?r.buildStyles(e,n):{};return s?s.buildStyles(e,n):i}build(t,e,n,r,s,i,a,o,l,u){const c=[],h=this.ast.options&&this.ast.options.params||nm,d=this.buildStyles(n,a&&a.params||nm,c),p=o&&o.params||nm,f=this.buildStyles(r,p,c),m=new Set,g=new Map,y=new Map,b="void"===r,v={params:Object.assign(Object.assign({},h),p)},w=u?[]:Hf(t,e,this.ast.animation,s,i,d,f,v,l,c);let _=0;if(w.forEach(t=>{_=Math.max(t.duration+t.delay,_)}),c.length)return em(e,this._triggerName,n,r,b,d,f,[],[],g,y,_,c);w.forEach(t=>{const n=t.element,r=Vp(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const s=Vp(y,n,{});t.postStyleProps.forEach(t=>s[t]=!0),n!==e&&m.add(n)});const x=xf(m.values());return em(e,this._triggerName,n,r,b,d,f,w,x,g,y,_)}}class sm{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=df(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const s=t;Object.keys(s).forEach(t=>{let i=s[t];i.length>1&&(i=_f(i,r,e)),n[t]=i})}}),n}}class im{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new sm(t.style,t.options&&t.options.params||{})}),am(this.states,"true","1"),am(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new rm(t,e,this.states))}),this.fallbackTransition=new rm(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(s=>s.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function am(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const om=new Wf;class lm{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=$f(this._driver,e,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: "+n.join("\n"));this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,s=Lp(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,s,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],s=this._animations[t];let i;const a=new Map;if(s?(i=Hf(this._driver,e,s,nf,rf,{},{},n,om,r),i.forEach(t=>{const e=Vp(a,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),i=[]),r.length)throw new Error("Unable to create the animation due to the following errors: "+r.join("\n"));a.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,kp)})});const o=Mp(i.map(t=>{const e=a.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=o,o.onDestroy(()=>this.destroy(t)),this.players.push(o),o}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error("Unable to find the timeline player referenced by "+t);return e}listen(t,e,n,r){const s=Bp(e,"","","");return Pp(this._getPlayer(t),n,s,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const s=this._getPlayer(t);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const um="ng-animate-queued",cm="ng-animate-disabled",hm=".ng-animate-disabled",dm=[],pm={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},fm={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class mm{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=null!=(r=n?t.value:t)?r:null,n){const e=df(t);delete e.value,this.options=e}else this.options={};var r;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const gm="void",ym=new mm(gm);class bm{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Cm(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(s=n)&&"done"!=s)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var s;const i=Vp(this._elementListeners,t,[]),a={name:e,phase:n,callback:r};i.push(a);const o=Vp(this._engine.statesByElement,t,{});return o.hasOwnProperty(e)||(Cm(t,sf),Cm(t,"ng-trigger-"+e),o[e]=ym),()=>{this._engine.afterFlush(()=>{const t=i.indexOf(a);t>=0&&i.splice(t,1),this._triggers[e]||delete o[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const s=this._getTrigger(e),i=new wm(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(Cm(t,sf),Cm(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,a={}));let o=a[e];const l=new mm(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&o&&l.absorbOptions(o.options),a[e]=l,o||(o=ym),l.value!==gm&&o.value===l.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let s=0;s<n.length;s++){const r=n[s];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(o.params,l.params)){const e=[],n=s.matchStyles(o.value,o.params,e),r=s.matchStyles(l.value,l.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{yf(t,n),gf(t,r)})}return}const u=Vp(this._engine.playersByElement,t,[]);u.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let c=s.matchTransition(o.value,l.value,t,l.params),h=!1;if(!c){if(!r)return;c=s.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:c,fromState:o,toState:l,player:i,isFallbackTransition:h}),h||(Cm(t,um),i.onStart(()=>{Im(t,um)})),i.onDone(()=>{let e=this.players.indexOf(i);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(i);t>=0&&n.splice(t,1)}}),this.players.push(i),u.push(i),i}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,af,!0);n.forEach(t=>{if(t.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(t=>this.clearElementCache(t)))}triggerLeaveAnimation(t,e,n,r){const s=this._engine.statesByElement.get(t);if(s){const i=[];if(Object.keys(s).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,gm,r);n&&i.push(n)}}),i.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&Mp(i).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t);if(e){const n=new Set;e.forEach(e=>{const r=e.name;if(n.has(r))return;n.add(r);const s=this._triggers[r].fallbackTransition,i=this._engine.statesByElement.get(t)[r]||ym,a=new mm(gm),o=new wm(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:s,fromState:i,toState:a,player:o,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const r=t.__ng_removed;r&&r!==pm||(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Cm(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,i=this._elementListeners.get(s);i&&i.forEach(e=>{if(e.name==n.triggerName){const r=Bp(s,n.triggerName,n.fromState.value,n.toState.value);r._data=t,Pp(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class vm{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new bm(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let s=n;s>=0;s--)if(this.driver.containsElement(this._namespaceList[s].hostElement,e)){this._namespaceList.splice(s+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const s=n[t[r]].namespaceId;if(s){const t=this._fetchNamespace(s);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(_m(e)){const s=this._fetchNamespace(t);if(s)return s.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!_m(e))return;const s=e.__ng_removed;if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Cm(t,cm)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Im(t,cm))}removeNode(t,e,n,r){if(_m(e)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,s){return _m(e)?this._fetchNamespace(t).listen(e,n,r,s):()=>{}}_buildInstruction(t,e,n,r,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,s)}destroyInnerAnimations(t){let e=this.driver.query(t,af,!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,lf,!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Mp(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t.__ng_removed;if(e&&e.setForRemoval){if(t.__ng_removed=pm,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,hm)&&this.markElementAsDisabled(t,!1),this.driver.query(t,hm,!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Cm(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?Mp(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error("Unable to process animations due to the following failed trigger transitions\n "+t.join("\n"))}_flushAnimations(t,e){const n=new Wf,r=[],s=new Map,i=[],a=new Map,o=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(t=>{u.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)u.add(e[n])});const c=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=Sm(h,this.collectedEnterElements),p=new Map;let f=0;d.forEach((t,e)=>{const n=nf+f++;p.set(e,n),t.forEach(t=>Cm(t,n))});const m=[],g=new Set,y=new Set;for(let A=0;A<this.collectedLeaveElements.length;A++){const t=this.collectedLeaveElements[A],e=t.__ng_removed;e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):y.add(t))}const b=new Map,v=Sm(h,Array.from(g));v.forEach((t,e)=>{const n=rf+f++;b.set(e,n),t.forEach(t=>Cm(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=p.get(e);t.forEach(t=>Im(t,n))}),v.forEach((t,e)=>{const n=b.get(e);t.forEach(t=>Im(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const w=[],_=[];for(let A=this._namespaceList.length-1;A>=0;A--)this._namespaceList[A].drainQueuedTransitions(e).forEach(t=>{const e=t.player,s=t.element;if(w.push(e),this.collectedEnterElements.length){const t=s.__ng_removed;if(t&&t.setForMove)return void e.destroy()}const u=!c||!this.driver.containsElement(c,s),h=b.get(s),d=p.get(s),f=this._buildInstruction(t,n,d,h,u);if(f.errors&&f.errors.length)_.push(f);else{if(u)return e.onStart(()=>yf(s,f.fromStyles)),e.onDestroy(()=>gf(s,f.toStyles)),void r.push(e);if(t.isFallbackTransition)return e.onStart(()=>yf(s,f.fromStyles)),e.onDestroy(()=>gf(s,f.toStyles)),void r.push(e);f.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(s,f.timelines),i.push({instruction:f,player:e,element:s}),f.queriedElements.forEach(t=>Vp(a,t,[]).push(e)),f.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=o.get(e);t||o.set(e,t=new Set),n.forEach(e=>t.add(e))}}),f.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=l.get(e);r||l.set(e,r=new Set),n.forEach(t=>r.add(t))})}});if(_.length){const t=[];_.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),w.forEach(t=>t.destroy()),this.reportError(t)}const x=new Map,k=new Map;i.forEach(t=>{const e=t.element;n.has(e)&&(k.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,x))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{Vp(x,e,[]).push(t),t.destroy()})});const S=m.filter(t=>Nm(t,o,l)),C=new Map;km(C,this.driver,y,l,kp).forEach(t=>{Nm(t,o,l)&&S.push(t)});const I=new Map;d.forEach((t,e)=>{km(I,this.driver,new Set(t),o,"!")}),S.forEach(t=>{const e=C.get(t),n=I.get(t);C.set(t,Object.assign(Object.assign({},e),n))});const E=[],T=[],N={};i.forEach(t=>{const{element:e,player:i,instruction:a}=t;if(n.has(e)){if(u.has(e))return i.onDestroy(()=>gf(e,a.toStyles)),i.disabled=!0,i.overrideTotalTime(a.totalTime),void r.push(i);let t=N;if(k.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=k.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>k.set(e,t))}const n=this._buildAnimation(i.namespaceId,a,x,s,I,C);if(i.setRealPlayer(n),t===N)E.push(i);else{const e=this.playersByElement.get(t);e&&e.length&&(i.parentPlayer=Mp(e)),r.push(i)}}else yf(e,a.fromStyles),i.onDestroy(()=>gf(e,a.toStyles)),T.push(i),u.has(e)&&r.push(i)}),T.forEach(t=>{const e=s.get(t.element);if(e&&e.length){const n=Mp(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let A=0;A<m.length;A++){const t=m[A],e=t.__ng_removed;if(Im(t,rf),e&&e.hasAnimation)continue;let n=[];if(a.size){let e=a.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,lf,!0);for(let t=0;t<r.length;t++){let e=a.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?Em(this,t,r):this.processLeaveNode(t)}return m.length=0,E.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),E}elementContainsData(t,e){let n=!1;const r=e.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,s){let i=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(i=e)}else{const e=this.playersByElement.get(t);if(e){const t=!s||s==gm;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&i.push(e)})}}return(n||r)&&(i=i.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),i}_beforeAnimationBuild(t,e,n){const r=e.element,s=e.isRemovalTransition?void 0:t,i=e.isRemovalTransition?void 0:e.triggerName;for(const a of e.timelines){const t=a.element,o=t!==r,l=Vp(n,t,[]);this._getPreviousPlayers(t,o,s,i,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),l.push(t)})}yf(r,e.fromStyles)}_buildAnimation(t,e,n,r,s,i){const a=e.triggerName,o=e.element,l=[],u=new Set,c=new Set,h=e.timelines.map(e=>{const h=e.element;u.add(h);const d=h.__ng_removed;if(d&&d.removedBeforeQueried)return new Dp(e.duration,e.delay);const p=h!==o,f=function(t){const e=[];return Tm(t,e),e}((n.get(h)||dm).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=s.get(h),g=i.get(h),y=Lp(0,this._normalizer,0,e.keyframes,m,g),b=this._buildPlayer(e,y,f);if(e.subTimeline&&r&&c.add(h),p){const e=new wm(t,a,h);e.setRealPlayer(b),l.push(e)}return b});l.forEach(t=>{Vp(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e),r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e],r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r}(this.playersByQueriedElement,t.element,t))}),u.forEach(t=>Cm(t,of));const d=Mp(h);return d.onDestroy(()=>{u.forEach(t=>Im(t,of)),gf(o,e.toStyles)}),c.forEach(t=>{Vp(r,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new Dp(t.duration,t.delay)}}class wm{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new Dp,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>Pp(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Vp(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function _m(t){return t&&1===t.nodeType}function xm(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function km(t,e,n,r,s){const i=[];n.forEach(t=>i.push(xm(t)));const a=[];r.forEach((n,r)=>{const i={};n.forEach(t=>{const n=i[t]=e.computeStyle(r,t,s);n&&0!=n.length||(r.__ng_removed=fm,a.push(r))}),t.set(r,i)});let o=0;return n.forEach(t=>xm(t,i[o++])),a}function Sm(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),s=new Map;function i(t){if(!t)return 1;let e=s.get(t);if(e)return e;const a=t.parentNode;return e=n.has(a)?a:r.has(a)?1:i(a),s.set(t,e),e}return e.forEach(t=>{const e=i(t);1!==e&&n.get(e).push(t)}),n}function Cm(t,e){if(t.classList)t.classList.add(e);else{let n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function Im(t,e){if(t.classList)t.classList.remove(e);else{let n=t.$$classes;n&&delete n[e]}}function Em(t,e,n){Mp(n).onDone(()=>t.processLeaveNode(e))}function Tm(t,e){for(let n=0;n<t.length;n++){const r=t[n];r instanceof Fp?Tm(r.players,e):e.push(r)}}function Nm(t,e,n){const r=n.get(t);if(!r)return!1;let s=e.get(t);return s?r.forEach(t=>s.add(t)):e.set(t,r),n.delete(t),!0}class Am{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new vm(t,e,n),this._timelineEngine=new lm(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,s){const i=t+"-"+r;let a=this._triggerCache[i];if(!a){const t=[],e=$f(this._driver,s,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);a=function(t,e){return new im(t,e)}(r,e),this._triggerCache[i]=a}this._transitionEngine.registerTrigger(e,r,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,s]=Wp(n);this._timelineEngine.command(t,e,s,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,s){if("@"==n.charAt(0)){const[t,r]=Wp(n);return this._timelineEngine.listen(t,e,r,s)}return this._transitionEngine.listen(t,e,n,r,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function Rm(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=Dm(e[0]),e.length>1&&(r=Dm(e[e.length-1]))):e&&(n=Dm(e)),n||r?new Om(t,n,r):null}let Om=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let s=t.initialStylesByElement.get(e);s||t.initialStylesByElement.set(e,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&gf(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(gf(this._element,this._initialStyles),this._endStyles&&(gf(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(yf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(yf(this._element,this._endStyles),this._endStyles=null),gf(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function Dm(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const s=n[r];Fm(s)&&(e=e||{},e[s]=t[s])}return e}function Fm(t){return"display"===t||"position"===t}const $m="animation",Mm="animationend";class Lm{constructor(t,e,n,r,s,i,a){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=s,this._fillMode=i,this._onDoneFn=a,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=Um(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),Wm(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),Vm(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){Pm(this._element,this._name,"paused")}resume(){Pm(this._element,this._name,"running")}setPosition(t){const e=zm(this._element,this._name);this._position=t*this._duration,Wm(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),Vm(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=Um(t,"").split(","),r=Bm(n,e);r>=0&&(n.splice(r,1),Wm(t,"",n.join(",")))}(this._element,this._name))}}function Pm(t,e,n){Wm(t,"PlayState",n,zm(t,e))}function zm(t,e){const n=Um(t,"");return n.indexOf(",")>0?Bm(n.split(","),e):Bm([n],e)}function Bm(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function Vm(t,e,n){n?t.removeEventListener(Mm,e):t.addEventListener(Mm,e)}function Wm(t,e,n,r){const s=$m+e;if(null!=r){const e=t.style[s];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[s]=n}function Um(t,e){return t.style[$m+e]||""}class jm{constructor(t,e,n,r,s,i,a,o){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=s,this._finalStyles=a,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=i||"linear",this.totalTime=r+s,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new Lm(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:Tf(this.element,n))})}this.currentSnapshot=t}}class Hm extends Dp{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=Jp(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class qm{constructor(){this._count=0,this._head=document.querySelector("head")}validateStyleProperty(t){return Xp(t)}matchesElement(t,e){return Yp(t,e)}containsElement(t,e){return Zp(t,e)}query(t,e,n){return Qp(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>Jp(t));let r=`@keyframes ${e} {\n`,s="";n.forEach(t=>{s=" ";const e=parseFloat(t.offset);r+=`${s}${100*e}% {\n`,s+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${s}animation-timing-function: ${n};\n`));default:return void(r+=`${s}${e}: ${n};\n`)}}),r+=s+"}\n"}),r+="}\n";const i=document.createElement("style");return i.textContent=r,i}animate(t,e,n,r,s,i=[],a){const o=i.filter(t=>t instanceof jm),l={};Cf(n,r)&&o.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const u=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=If(t,e,l));if(0==n)return new Hm(t,u);const c="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(t,c,e);document.querySelector("head").appendChild(h);const d=Rm(t,e),p=new jm(t,e,c,n,r,s,u,d);return p.onDestroy(()=>{var t;(t=h).parentNode.removeChild(t)}),p}}class Gm{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:Tf(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class Km{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(Xm().toString()),this._cssKeyframesDriver=new qm}validateStyleProperty(t){return Xp(t)}matchesElement(t,e){return Yp(t,e)}containsElement(t,e){return Zp(t,e)}query(t,e,n){return Qp(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,s,i=[],a){if(!a&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,s,i);const o={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(o.easing=s);const l={},u=i.filter(t=>t instanceof Gm);Cf(n,r)&&u.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const c=Rm(t,e=If(t,e=e.map(t=>pf(t,!1)),l));return new Gm(t,e,o,c)}}function Xm(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let Ym=(()=>{class t extends xp{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:Qt.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?Ip(t):t;return Jm(this._renderer,null,e,"register",[n]),new Zm(e,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(Wr(ol),Wr(Cc))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();class Zm extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new Qm(this._id,t,e||{},this._renderer)}}class Qm{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return Jm(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function Jm(t,e,n,r,s){return t.setProperty(e,`@@${n}:${r}`,s)}const tg="@",eg="@.disabled";let ng=(()=>{class t{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new rg("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,s=e.id+"-"+this._currentId;this._currentId++,this.engine.register(s,t);const i=e=>{Array.isArray(e)?e.forEach(i):this.engine.registerTrigger(r,s,t,e.name,e)};return e.data.animation.forEach(i),new sg(this,s,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(Wr(ol),Wr(Am),Wr(qu))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();class rg{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,r=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){e.charAt(0)==tg&&e==eg?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class sg extends rg{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){e.charAt(0)==tg?"."==e.charAt(1)&&e==eg?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if(e.charAt(0)==tg){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let s=e.substr(1),i="";return s.charAt(0)!=tg&&([s,i]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,i,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let ig=(()=>{class t extends Am{constructor(t,e,n){super(t.body,e,n)}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc),Wr(ef),Wr(Qf))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const ag=new wr("AnimationModuleType"),og=[{provide:ef,useFactory:function(){return"function"==typeof Xm()?new Km:new qm}},{provide:ag,useValue:"BrowserAnimations"},{provide:xp,useClass:Ym},{provide:Qf,useFactory:function(){return new Jf}},{provide:Am,useClass:ig},{provide:ol,useFactory:function(t,e,n){return new ng(t,e,n)},deps:[kh,Am,qu]}];let lg=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},providers:og,imports:[Lh]}),t})();function ug(t,e){if(1&t&&Qa(0,"mat-pseudo-checkbox",3),2&t){const t=uo();Ka("state",t.selected?"checked":"unchecked")("disabled",t.disabled)}}const cg=["*"],hg=new hl("11.0.3"),dg=new wr("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let pg,fg=(()=>{class t{constructor(t,e,n){this._hasDoneGlobalChecks=!1,this._document=n,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=e,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checksAreEnabled(){return ac()&&!this._isTestEnv()}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype)&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const e=getComputedStyle(t);e&&"none"!==e.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&hg.full!==_p.full&&console.warn("The Angular Material version ("+hg.full+") does not match the Angular CDK version ("+_p.full+").\nPlease ensure the versions of these two packages exactly match.")}}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)(Wr(vp),Wr(dg,8),Wr(Cc))},imports:[[Ad],Ad]}),t})();function mg(t){return class extends t{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=Ph(t)}}}function gg(t,e){return class extends t{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const e=t||this.defaultColor;e!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove("mat-"+this._color),e&&this._elementRef.nativeElement.classList.add("mat-"+e),this._color=e)}}}function yg(t){return class extends t{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Ph(t)}}}function bg(t,e=0){return class extends t{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?zh(t):this.defaultTabIndex}}}function vg(t){return class extends t{constructor(...t){super(...t),this.errorState=!1,this.stateChanges=new Q}updateErrorState(){const t=this.errorState,e=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);e!==t&&(this.errorState=e,this.stateChanges.next())}}}try{pg="undefined"!=typeof Intl}catch(xrt){pg=!1}let wg=(()=>{class t{isErrorState(t,e){return!!(t&&t.invalid&&(t.touched||e&&e.submitted))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),_g=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),t})();function xg(t,e,n="mat"){t.changes.pipe(pd(t)).subscribe(({length:t})=>{kg(e,n+"-2-line",!1),kg(e,n+"-3-line",!1),kg(e,n+"-multi-line",!1),2===t||3===t?kg(e,`${n}-${t}-line`,!0):t>3&&kg(e,n+"-multi-line",!0)})}function kg(t,e,n){const r=t.nativeElement.classList;n?r.add(e):r.remove(e)}let Sg=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[fg],fg]}),t})();class Cg{constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const Ig={enterDuration:450,exitDuration:400},Eg=Id({passive:!0}),Tg=["mousedown","touchstart"],Ng=["mouseup","mouseleave","touchend","touchcancel"];class Ag{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Wh(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},Ig),n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const i=n.radius||function(t,e,n){const r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),s=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+s*s)}(t,e,r),a=t-r.left,o=e-r.top,l=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-i+"px",u.style.top=o-i+"px",u.style.height=2*i+"px",u.style.width=2*i+"px",null!=n.color&&(u.style.backgroundColor=n.color),u.style.transitionDuration=l+"ms",this._containerElement.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)";const c=new Cg(this,u,n);return c.state=0,this._activeRipples.add(c),n.persistent||(this._mostRecentTransientRipple=c),this._runTimeoutOutsideZone(()=>{const t=c===this._mostRecentTransientRipple;c.state=1,n.persistent||t&&this._isPointerDown||c.fadeOut()},l),c}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign(Object.assign({},Ig),t.config.animation);n.style.transitionDuration=r.exitDuration+"ms",n.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}setupTriggerEvents(t){const e=Wh(t);e&&e!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(Tg))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(Ng),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const e=hp(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let t=0;t<e.length;t++)this.fadeInRipple(e[t].clientX,e[t].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(t=>{this._triggerElement.addEventListener(t,this,Eg)})})}_removeTriggerEvents(){this._triggerElement&&(Tg.forEach(t=>{this._triggerElement.removeEventListener(t,this,Eg)}),this._pointerUpEventsRegistered&&Ng.forEach(t=>{this._triggerElement.removeEventListener(t,this,Eg)}))}}const Rg=new wr("mat-ripple-global-options");let Og=(()=>{class t{constructor(t,e,n,r,s){this._elementRef=t,this._animationMode=s,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new Ag(this,e,t,n)}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,e=0,n){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(qu),Ga(Sd),Ga(Rg,8),Ga(ag,8))},t.\u0275dir=we({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,e){2&t&&xo("mat-ripple-unbounded",e.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),t})(),Dg=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[fg,Cd],fg]}),t})(),Fg=(()=>{class t{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1}}return t.\u0275fac=function(e){return new(e||t)(Ga(ag,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(t,e){2&t&&xo("mat-pseudo-checkbox-indeterminate","indeterminate"===e.state)("mat-pseudo-checkbox-checked","checked"===e.state)("mat-pseudo-checkbox-disabled",e.disabled)("_mat-animation-noopable","NoopAnimations"===e._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(t,e){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),t})(),$g=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[fg]]}),t})();class Mg{}const Lg=mg(Mg);let Pg=0,zg=(()=>{class t extends Lg{constructor(){super(...arguments),this._labelId="mat-optgroup-label-"+Pg++}}return t.\u0275fac=function(e){return Bg(e||t)},t.\u0275dir=we({type:t,inputs:{label:"label"},features:[Da]}),t})();const Bg=gr(zg),Vg=new wr("MatOptgroup");let Wg=0;class Ug{constructor(t,e=!1){this.source=t,this.isUserInput=e}}const jg=new wr("MAT_OPTION_PARENT_COMPONENT");let Hg=(()=>{class t{constructor(t,e,n,r){this._element=t,this._changeDetectorRef=e,this._parent=n,this.group=r,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+Wg++,this.onSelectionChange=new nu,this._stateChanges=new Q}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=Ph(t)}get disableRipple(){return this._parent&&this._parent.disableRipple}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(t,e){const n=this._getHostElement();"function"==typeof n.focus&&n.focus(e)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){13!==t.keyCode&&32!==t.keyCode||Ld(t)||(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue=t,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new Ug(this,t))}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Nl),Ga(void 0),Ga(zg))},t.\u0275dir=we({type:t,inputs:{id:"id",disabled:"disabled",value:"value"},outputs:{onSelectionChange:"onSelectionChange"}}),t})(),qg=(()=>{class t extends Hg{constructor(t,e,n,r){super(t,e,n,r)}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Nl),Ga(jg,8),Ga(Vg,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(t,e){1&t&&so("click",function(){return e._selectViaInteraction()})("keydown",function(t){return e._handleKeydown(t)}),2&t&&(Mo("id",e.id),Ua("tabindex",e._getTabIndex())("aria-selected",e._getAriaSelected())("aria-disabled",e.disabled.toString()),xo("mat-selected",e.selected)("mat-option-multiple",e.multiple)("mat-active",e.active)("mat-option-disabled",e.disabled))},exportAs:["matOption"],features:[Da],ngContentSelectors:cg,decls:4,vars:3,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"]],template:function(t,e){1&t&&(ho(),Ha(0,ug,1,2,"mat-pseudo-checkbox",0),Ya(1,"span",1),po(2),Za(),Qa(3,"div",2)),2&t&&(Ka("ngIf",e.multiple),vi(3),Ka("matRippleTrigger",e._getHostElement())("matRippleDisabled",e.disabled||e.disableRipple))},directives:[Yc,Og,Fg],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.cdk-high-contrast-active .mat-option .mat-option-ripple{opacity:.5}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),t})();function Gg(t,e,n){if(n.length){let r=e.toArray(),s=n.toArray(),i=0;for(let e=0;e<t+1;e++)r[e].group&&r[e].group===s[i]&&i++;return i}return 0}let Kg=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[Dg,sh,fg,$g]]}),t})();const Xg=["*",[["mat-toolbar-row"]]],Yg=["*","mat-toolbar-row"];class Zg{constructor(t){this._elementRef=t}}const Qg=gg(Zg);let Jg=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),t})(),ty=(()=>{class t extends Qg{constructor(t,e,n){super(t),this._platform=e,this._document=n}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Sd),Ga(Cc))},t.\u0275cmp=fe({type:t,selectors:[["mat-toolbar"]],contentQueries:function(t,e,n){if(1&t&&yu(n,Jg,!0),2&t){let t;fu(t=wu())&&(e._toolbarRows=t)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,e){2&t&&xo("mat-toolbar-multiple-rows",e._toolbarRows.length>0)("mat-toolbar-single-row",0===e._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Da],ngContentSelectors:Yg,decls:2,vars:0,template:function(t,e){1&t&&(ho(Xg),po(0),po(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}\n"],encapsulation:2,changeDetection:0}),t})(),ey=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[fg],fg]}),t})();function ny(t){return e=>e.lift(new ry(t))}class ry{constructor(t){this.value=t}call(t,e){return e.subscribe(new sy(t,this.value))}}class sy extends U{constructor(t,e){super(t),this.value=e}_next(t){this.destination.next(this.value)}}const iy=["*"];function ay(t,e){if(1&t){const t=eo();Ya(0,"div",2),so("click",function(){return ln(t),uo()._onBackdropClicked()}),Za()}2&t&&xo("mat-drawer-shown",uo()._isShowingBackdrop())}function oy(t,e){1&t&&(Ya(0,"mat-drawer-content"),po(1,2),Za())}const ly=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],uy=["mat-drawer","mat-drawer-content","*"];function cy(t,e){if(1&t){const t=eo();Ya(0,"div",2),so("click",function(){return ln(t),uo()._onBackdropClicked()}),Za()}2&t&&xo("mat-drawer-shown",uo()._isShowingBackdrop())}function hy(t,e){1&t&&(Ya(0,"mat-sidenav-content",3),po(1,2),Za())}const dy=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],py=["mat-sidenav","mat-sidenav-content","*"],fy=".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n",my={transformDrawer:Sp("transform",[Tp("open, open-instant",Ep({transform:"none",visibility:"visible"})),Tp("void",Ep({"box-shadow":"none",visibility:"hidden"})),Np("void => open-instant",Cp("0ms")),Np("void <=> open, open-instant => void",Cp("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},gy=new wr("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),yy=new wr("MAT_DRAWER_CONTAINER");let by=(()=>{class t extends Dd{constructor(t,e,n,r,s){super(n,r,s),this._changeDetectorRef=t,this._container=e}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return t.\u0275fac=function(e){return new(e||t)(Ga(Nl),Ga(Ft(()=>wy)),Ga(al),Ga(Od),Ga(qu))},t.\u0275cmp=fe({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,e){2&t&&_o("margin-left",e._container._contentMargins.left,"px")("margin-right",e._container._contentMargins.right,"px")},features:[Da],ngContentSelectors:iy,decls:1,vars:0,template:function(t,e){1&t&&(ho(),po(0))},encapsulation:2,changeDetection:0}),t})(),vy=(()=>{class t{constructor(t,e,n,r,s,i,a){this._elementRef=t,this._focusTrapFactory=e,this._focusMonitor=n,this._platform=r,this._ngZone=s,this._doc=i,this._container=a,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Q,this._animationEnd=new Q,this._animationState="void",this.openedChange=new nu(!0),this._openedStream=this.openedChange.pipe(id(t=>t),et(()=>{})),this.openedStart=this._animationStarted.pipe(id(t=>t.fromState!==t.toState&&0===t.toState.indexOf("open")),ny(void 0)),this._closedStream=this.openedChange.pipe(id(t=>!t),et(()=>{})),this.closedStart=this._animationStarted.pipe(id(t=>t.fromState!==t.toState&&"void"===t.toState),ny(void 0)),this._destroyed=new Q,this.onPositionChanged=new nu,this._modeChanged=new Q,this.openedChange.subscribe(t=>{t?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus()}),this._ngZone.runOutsideAngular(()=>{jh(this._elementRef.nativeElement,"keydown").pipe(id(t=>27===t.keyCode&&!this.disableClose&&!Ld(t)),ld(this._destroyed)).subscribe(t=>this._ngZone.run(()=>{this.close(),t.stopPropagation(),t.preventDefault()}))}),this._animationEnd.pipe(Yh((t,e)=>t.fromState===e.fromState&&t.toState===e.toState)).subscribe(t=>{const{fromState:e,toState:n}=t;(0===n.indexOf("open")&&"void"===e||"void"===n&&0===e.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!=this._position&&(this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=Ph(t)}get autoFocus(){const t=this._autoFocus;return null==t?"side"!==this.mode:t}set autoFocus(t){this._autoFocus=Ph(t)}get opened(){return this._opened}set opened(t){this.toggle(Ph(t))}_takeFocus(){this.autoFocus&&this._focusTrap&&this._focusTrap.focusInitialElementWhenReady().then(t=>{t||"function"!=typeof this._elementRef.nativeElement.focus||this._elementRef.nativeElement.focus()})}_restoreFocus(){this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null)}_isFocusWithinDrawer(){var t;const e=null===(t=this._doc)||void 0===t?void 0:t.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0)}toggle(t=!this.opened,e){return this._setOpen(t,!t&&this._isFocusWithinDrawer(),e)}_setOpen(t,e,n="program"){return this._opened=t,t?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=n):(this._animationState="void",e&&this._restoreFocus()),this._updateFocusTrapState(),new Promise(t=>{this.openedChange.pipe(Gd(1)).subscribe(e=>t(e?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_animationStartListener(t){this._animationStarted.next(t)}_animationDoneListener(t){this._animationEnd.next(t)}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(op),Ga(fp),Ga(Sd),Ga(qu),Ga(Cc,8),Ga(yy,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,e){1&t&&io("@transform.start",function(t){return e._animationStartListener(t)})("@transform.done",function(t){return e._animationDoneListener(t)}),2&t&&(Ua("align",null),Lo("@transform",e._animationState),xo("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:iy,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(ho(),Ya(0,"div",0),po(1),Za())},encapsulation:2,data:{animation:[my.transformDrawer]},changeDetection:0}),t})(),wy=(()=>{class t{constructor(t,e,n,r,s,i=!1,a){this._dir=t,this._element=e,this._ngZone=n,this._changeDetectorRef=r,this._animationMode=a,this._drawers=new su,this.backdropClick=new nu,this._destroyed=new Q,this._doCheckSubject=new Q,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Q,t&&t.change.pipe(ld(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),s.change().pipe(ld(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=i}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=Ph(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:Ph(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(pd(this._allDrawers),ld(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(t=>!t._container||t._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(pd(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(Wd(10),ld(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,e=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const n=this._left._getWidth();t+=n,e-=n}if(this._right&&this._right.opened)if("side"==this._right.mode)e+=this._right._getWidth();else if("push"==this._right.mode){const n=this._right._getWidth();e+=n,t-=n}t=t||null,e=e||null,t===this._contentMargins.left&&e===this._contentMargins.right||(this._contentMargins={left:t,right:e},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(id(t=>t.fromState!==t.toState),ld(this._drawers.changes)).subscribe(t=>{"open-instant"!==t.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(ld(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(ld(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Gd(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(ld(wt(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const e=this._element.nativeElement.classList,n="mat-drawer-container-has-open";t?e.add(n):e.remove(n)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return t.\u0275fac=function(e){return new(e||t)(Ga(Nd,8),Ga(al),Ga(qu),Ga(Nl),Ga(Fd),Ga(gy),Ga(ag,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(t,e,n){if(1&t&&(yu(n,by,!0),yu(n,vy,!0)),2&t){let t;fu(t=wu())&&(e._content=t.first),fu(t=wu())&&(e._allDrawers=t)}},viewQuery:function(t,e){if(1&t&&mu(by,!0),2&t){let t;fu(t=wu())&&(e._userContent=t.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,e){2&t&&xo("mat-drawer-container-explicit-backdrop",e._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[Jo([{provide:yy,useExisting:t}])],ngContentSelectors:uy,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,e){1&t&&(ho(ly),Ha(0,ay,1,2,"div",0),po(1),po(2,1),Ha(3,oy,2,0,"mat-drawer-content",1)),2&t&&(Ka("ngIf",e.hasBackdrop),vi(3),Ka("ngIf",!e._content))},directives:[Yc,by],styles:[fy],encapsulation:2,changeDetection:0}),t})(),_y=(()=>{class t extends by{constructor(t,e,n,r,s){super(t,e,n,r,s)}}return t.\u0275fac=function(e){return new(e||t)(Ga(Nl),Ga(Ft(()=>Sy)),Ga(al),Ga(Od),Ga(qu))},t.\u0275cmp=fe({type:t,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,e){2&t&&_o("margin-left",e._container._contentMargins.left,"px")("margin-right",e._container._contentMargins.right,"px")},features:[Da],ngContentSelectors:iy,decls:1,vars:0,template:function(t,e){1&t&&(ho(),po(0))},encapsulation:2,changeDetection:0}),t})(),xy=(()=>{class t extends vy{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=Ph(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=zh(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=zh(t)}}return t.\u0275fac=function(e){return ky(e||t)},t.\u0275cmp=fe({type:t,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,e){2&t&&(Ua("align",null),_o("top",e.fixedInViewport?e.fixedTopGap:null,"px")("bottom",e.fixedInViewport?e.fixedBottomGap:null,"px"),xo("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened)("mat-sidenav-fixed",e.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Da],ngContentSelectors:iy,decls:2,vars:0,consts:[[1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(ho(),Ya(0,"div",0),po(1),Za())},encapsulation:2,data:{animation:[my.transformDrawer]},changeDetection:0}),t})();const ky=gr(xy);let Sy=(()=>{class t extends wy{}return t.\u0275fac=function(e){return Cy(e||t)},t.\u0275cmp=fe({type:t,selectors:[["mat-sidenav-container"]],contentQueries:function(t,e,n){if(1&t&&(yu(n,_y,!0),yu(n,xy,!0)),2&t){let t;fu(t=wu())&&(e._content=t.first),fu(t=wu())&&(e._allDrawers=t)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,e){2&t&&xo("mat-drawer-container-explicit-backdrop",e._backdropOverride)},exportAs:["matSidenavContainer"],features:[Jo([{provide:yy,useExisting:t}]),Da],ngContentSelectors:py,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(t,e){1&t&&(ho(dy),Ha(0,cy,1,2,"div",0),po(1),po(2,1),Ha(3,hy,2,0,"mat-sidenav-content",1)),2&t&&(Ka("ngIf",e.hasBackdrop),vi(3),Ka("ngIf",!e._content))},directives:[Yc,_y,Dd],styles:[fy],encapsulation:2,changeDetection:0}),t})();const Cy=gr(Sy);let Iy=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[sh,fg,Cd,$d],$d,fg]}),t})();function Ey(...t){if(1===t.length){const e=t[0];if(L(e))return Ty(e,null);if(P(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return Ty(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return Ty(t=1===t.length&&L(t[0])?t[0]:t,null).pipe(et(t=>e(...t)))}return Ty(t,null)}function Ty(t,e){return new G(n=>{const r=t.length;if(0===r)return void n.complete();const s=new Array(r);let i=0,a=0;for(let o=0;o<r;o++){const l=ht(t[o]);let u=!1;n.add(l.subscribe({next:t=>{u||(u=!0,a++),s[o]=t},error:t=>n.error(t),complete:()=>{i++,i!==r&&u||(a===r&&n.next(e?e.reduce((t,e,n)=>(t[e]=s[n],t),{}):s),n.complete())}}))}})}function Ny(t){return function(e){const n=new Ay(t),r=e.lift(n);return n.caught=r}}class Ay{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Ry(t,this.selector,this.caught))}}class Ry extends pt{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new dt(this);this.add(r);const s=ft(n,r);s!==r&&this.add(s)}}}function Oy(t){return e=>e.lift(new Dy(t))}class Dy{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Fy(t,this.callback))}}class Fy extends U{constructor(t,e){super(t),this.add(new B(e))}}function $y(t,e){return mt(t,e,1)}class My{}class Ly{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),r=n.toLowerCase(),s=t.slice(e+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(s):this.headers.set(r,[s])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Ly?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Ly;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Ly?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const s=t.value;if(s){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===s.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class Py{encodeKey(t){return zy(t)}encodeValue(t){return zy(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function zy(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class By{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Py,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.split("&").forEach(t=>{const r=t.indexOf("="),[s,i]=-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],a=n.get(s)||[];a.push(i),n.set(s,a)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new By({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(t.value);-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function Vy(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function Wy(t){return"undefined"!=typeof Blob&&t instanceof Blob}function Uy(t){return"undefined"!=typeof FormData&&t instanceof FormData}class jy{constructor(t,e,n,r){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.params&&(this.params=s.params)),this.headers||(this.headers=new Ly),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new By,this.urlWithParams=e}serializeBody(){return null===this.body?null:Vy(this.body)||Wy(this.body)||Uy(this.body)||"string"==typeof this.body?this.body:this.body instanceof By?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Uy(this.body)?null:Wy(this.body)?this.body.type||null:Vy(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof By?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,r=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,i=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let o=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(o=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),o)),t.setParams&&(l=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),l)),new jy(e,n,s,{params:l,headers:o,reportProgress:a,responseType:r,withCredentials:i})}}var Hy=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class qy extends class{constructor(t,e=200,n="OK"){this.headers=t.headers||new Ly,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}{constructor(t={}){super(t),this.type=Hy.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new qy({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}function Gy(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Ky=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let r;if(t instanceof jy)r=t;else{let s=void 0;s=n.headers instanceof Ly?n.headers:new Ly(n.headers);let i=void 0;n.params&&(i=n.params instanceof By?n.params:new By({fromObject:n.params})),r=new jy(t,e,void 0!==n.body?n.body:null,{headers:s,params:i,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const s=Uh(r).pipe($y(t=>this.handler.handle(t)));if(t instanceof jy||"events"===n.observe)return s;const i=s.pipe(id(t=>t instanceof qy));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return i.pipe(et(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return i.pipe(et(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return i.pipe(et(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return i.pipe(et(t=>t.body))}case"response":return i;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new By).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,Gy(n,e))}post(t,e,n={}){return this.request("POST",t,Gy(n,e))}put(t,e,n={}){return this.request("PUT",t,Gy(n,e))}}return t.\u0275fac=function(e){return new(e||t)(Wr(My))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const Xy=["*"];function Yy(t){return Error(`Unable to find icon with the name "${t}"`)}function Zy(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function Qy(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}class Jy{constructor(t,e,n){this.url=t,this.svgText=e,this.options=n}}let tb=(()=>{class t{constructor(t,e,n,r){this._httpClient=t,this._sanitizer=e,this._errorHandler=r,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=n}addSvgIcon(t,e,n){return this.addSvgIconInNamespace("",t,e,n)}addSvgIconLiteral(t,e,n){return this.addSvgIconLiteralInNamespace("",t,e,n)}addSvgIconInNamespace(t,e,n,r){return this._addSvgIconConfig(t,e,new Jy(n,null,r))}addSvgIconLiteralInNamespace(t,e,n,r){const s=this._sanitizer.sanitize(Ss.HTML,n);if(!s)throw Qy(n);return this._addSvgIconConfig(t,e,new Jy("",s,r))}addSvgIconSet(t,e){return this.addSvgIconSetInNamespace("",t,e)}addSvgIconSetLiteral(t,e){return this.addSvgIconSetLiteralInNamespace("",t,e)}addSvgIconSetInNamespace(t,e,n){return this._addSvgIconSetConfig(t,new Jy(e,null,n))}addSvgIconSetLiteralInNamespace(t,e,n){const r=this._sanitizer.sanitize(Ss.HTML,e);if(!r)throw Qy(e);return this._addSvgIconSetConfig(t,new Jy("",r,n))}registerFontClassAlias(t,e=t){return this._fontCssClassesByAlias.set(t,e),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const e=this._sanitizer.sanitize(Ss.RESOURCE_URL,t);if(!e)throw Zy(t);const n=this._cachedIconsByUrl.get(e);return n?Uh(eb(n)):this._loadSvgIconFromConfig(new Jy(t,null)).pipe(zd(t=>this._cachedIconsByUrl.set(e,t)),et(t=>eb(t)))}getNamedSvgIcon(t,e=""){const n=nb(e,t),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);const s=this._iconSetConfigs.get(e);return s?this._getSvgFromIconSetConfigs(t,s):(i=Yy(n),new G(t=>t.error(i)));var i}ngOnDestroy(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Uh(eb(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(et(t=>eb(t)))}_getSvgFromIconSetConfigs(t,e){const n=this._extractIconWithNameFromAnySet(t,e);return n?Uh(n):Ey(e.filter(t=>!t.svgText).map(t=>this._loadSvgIconSetFromConfig(t).pipe(Ny(e=>{const n=this._sanitizer.sanitize(Ss.RESOURCE_URL,t.url);return this._errorHandler.handleError(new Error(`Loading icon set URL: ${n} failed: ${e.message}`)),Uh(null)})))).pipe(et(()=>{const n=this._extractIconWithNameFromAnySet(t,e);if(!n)throw Yy(t);return n}))}_extractIconWithNameFromAnySet(t,e){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.svgText&&r.svgText.indexOf(t)>-1){const e=this._svgElementFromConfig(r),n=this._extractSvgIconFromSet(e,t,r.options);if(n)return n}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(zd(e=>t.svgText=e),et(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Uh(null):this._fetchIcon(t).pipe(zd(e=>t.svgText=e))}_extractSvgIconFromSet(t,e,n){const r=t.querySelector(`[id="${e}"]`);if(!r)return null;const s=r.cloneNode(!0);if(s.removeAttribute("id"),"svg"===s.nodeName.toLowerCase())return this._setSvgAttributes(s,n);if("symbol"===s.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(s),n);const i=this._svgElementFromString("<svg></svg>");return i.appendChild(s),this._setSvgAttributes(i,n)}_svgElementFromString(t){const e=this._document.createElement("DIV");e.innerHTML=t;const n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(t){const e=this._svgElementFromString("<svg></svg>"),n=t.attributes;for(let r=0;r<n.length;r++){const{name:t,value:s}=n[r];"id"!==t&&e.setAttribute(t,s)}for(let r=0;r<t.childNodes.length;r++)t.childNodes[r].nodeType===this._document.ELEMENT_NODE&&e.appendChild(t.childNodes[r].cloneNode(!0));return e}_setSvgAttributes(t,e){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),e&&e.viewBox&&t.setAttribute("viewBox",e.viewBox),t}_fetchIcon(t){var e;const{url:n,options:r}=t,s=null!==(e=null==r?void 0:r.withCredentials)&&void 0!==e&&e;if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const i=this._sanitizer.sanitize(Ss.RESOURCE_URL,n);if(!i)throw Zy(n);const a=this._inProgressUrlFetches.get(i);if(a)return a;const o=this._httpClient.get(i,{responseType:"text",withCredentials:s}).pipe(Oy(()=>this._inProgressUrlFetches.delete(i)),Tt());return this._inProgressUrlFetches.set(i,o),o}_addSvgIconConfig(t,e,n){return this._svgIconConfigs.set(nb(t,e),n),this}_addSvgIconSetConfig(t,e){const n=this._iconSetConfigs.get(t);return n?n.push(e):this._iconSetConfigs.set(t,[e]),this}_svgElementFromConfig(t){if(!t.svgElement){const e=this._svgElementFromString(t.svgText);this._setSvgAttributes(e,t.options),t.svgElement=e}return t.svgElement}}return t.\u0275fac=function(e){return new(e||t)(Wr(Ky,8),Wr(Dh),Wr(Cc,8),Wr(Ns))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Ky,8),Wr(Dh),Wr(Cc,8),Wr(Ns))},token:t,providedIn:"root"}),t})();function eb(t){return t.cloneNode(!0)}function nb(t,e){return t+":"+e}class rb{constructor(t){this._elementRef=t}}const sb=gg(rb),ib=new wr("mat-icon-location",{providedIn:"root",factory:function(){const t=Ur(Cc),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),ab=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],ob=ab.map(t=>`[${t}]`).join(", "),lb=/^url\(['"]?#(.*?)['"]?\)$/;let ub=(()=>{class t extends sb{constructor(t,e,n,r,s){super(t),this._iconRegistry=e,this._location=r,this._errorHandler=s,this._inline=!1,this._currentIconFetch=B.EMPTY,n||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=Ph(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const e=this._cleanupFontValue(t);e!==this._fontSet&&(this._fontSet=e,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const e=this._cleanupFontValue(t);e!==this._fontIcon&&(this._fontIcon=e,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const e=t.querySelectorAll("style");for(let r=0;r<e.length;r++)e[r].textContent+=" ";const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let e=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();e--;){const n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,e=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();e!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),e&&t.classList.add(e),this._previousFontSetClass=e),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const e=this._elementsWithExternalReferences;e&&e.forEach((e,n)=>{e.forEach(e=>{n.setAttribute(e.name,`url('${t}#${e.value}')`)})})}_cacheChildrenWithExternalReferences(t){const e=t.querySelectorAll(ob),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<e.length;r++)ab.forEach(t=>{const s=e[r],i=s.getAttribute(t),a=i?i.match(lb):null;if(a){let e=n.get(s);e||(e=[],n.set(s,e)),e.push({name:t,value:a[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[e,n]=this._splitIconName(t);e&&(this._svgNamespace=e),n&&(this._svgName=n),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(n,e).pipe(Gd(1)).subscribe(t=>this._setSvgElement(t),t=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${e}:${n}! ${t.message}`))})}}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(tb),yr("aria-hidden"),Ga(ib),Ga(Ns))},t.\u0275cmp=fe({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,e){2&t&&(Ua("data-mat-icon-type",e._usingFontIcon()?"font":"svg")("data-mat-icon-name",e._svgName||e.fontIcon)("data-mat-icon-namespace",e._svgNamespace||e.fontSet),xo("mat-icon-inline",e.inline)("mat-icon-no-color","primary"!==e.color&&"accent"!==e.color&&"warn"!==e.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Da],ngContentSelectors:Xy,decls:1,vars:0,template:function(t,e){1&t&&(ho(),po(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),t})(),cb=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[fg],fg]}),t})();const hb=new wr("NgValueAccessor");function db(t){return null==t||0===t.length}function pb(t){return null!=t&&"number"==typeof t.length}const fb=new wr("NgValidators"),mb=new wr("NgAsyncValidators"),gb=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class yb{static min(t){return e=>{if(db(e.value)||db(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(db(e.value)||db(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return db(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return db(t.value)||gb.test(t.value)?null:{email:!0}}static minLength(t){return e=>db(e.value)||!pb(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}static maxLength(t){return e=>pb(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}static pattern(t){if(!t)return yb.nullValidator;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(db(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(bb);return 0==e.length?null:function(t){return wb(_b(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(bb);return 0==e.length?null:function(t){return Ey(_b(t,e).map(vb)).pipe(et(wb))}}}function bb(t){return null!=t}function vb(t){const e=no(t)?ht(t):t;return ro(e),e}function wb(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function _b(t,e){return e.map(e=>e(t))}function xb(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}function kb(t){return null!=t?yb.compose(xb(t)):null}function Sb(t){return null!=t?yb.composeAsync(xb(t)):null}function Cb(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Ib(t){return t._rawValidators}function Eb(t){return t._rawAsyncValidators}let Tb=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=kb(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Sb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t}),t})(),Nb=(()=>{class t extends Tb{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return Ab(e||t)},t.\u0275dir=we({type:t,features:[Da]}),t})();const Ab=gr(Nb);class Rb extends Tb{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}function Ob(t,e){Fb(t,e,!0),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Mb(t,e)})}(t,e),function(t,e){const n=(t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Mb(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function(t,e){if(e.valueAccessor.setDisabledState){const n=t=>{e.valueAccessor.setDisabledState(t)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function Db(t,e){t.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Fb(t,e,n){const r=Ib(t);null!==e.validator?t.setValidators(Cb(r,e.validator)):"function"==typeof r&&t.setValidators([r]);const s=Eb(t);if(null!==e.asyncValidator?t.setAsyncValidators(Cb(s,e.asyncValidator)):"function"==typeof s&&t.setAsyncValidators([s]),n){const n=()=>t.updateValueAndValidity();Db(e._rawValidators,n),Db(e._rawAsyncValidators,n)}}function $b(t,e,n){if(null!==t){if(null!==e.validator){const n=Ib(t);Array.isArray(n)&&n.length>0&&t.setValidators(n.filter(t=>t!==e.validator))}if(null!==e.asyncValidator){const n=Eb(t);Array.isArray(n)&&n.length>0&&t.setAsyncValidators(n.filter(t=>t!==e.asyncValidator))}}if(n){const t=()=>{};Db(e._rawValidators,t),Db(e._rawAsyncValidators,t)}}function Mb(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Lb(t,e){Fb(t,e,!1)}function Pb(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function zb(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Bb="VALID",Vb="INVALID",Wb="PENDING",Ub="DISABLED";function jb(t){return(Kb(t)?t.validators:t)||null}function Hb(t){return Array.isArray(t)?kb(t):t||null}function qb(t,e){return(Kb(e)?e.asyncValidators:t)||null}function Gb(t){return Array.isArray(t)?Sb(t):t||null}function Kb(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Xb{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=Hb(this._rawValidators),this._composedAsyncValidatorFn=Gb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Bb}get invalid(){return this.status===Vb}get pending(){return this.status==Wb}get disabled(){return this.status===Ub}get enabled(){return this.status!==Ub}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=Hb(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=Gb(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Wb,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ub,this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Bb,this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==Bb&&this.status!==Wb||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ub:Bb}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Wb,this._hasOwnPendingAsyncValidator=!0;const e=vb(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let r=t;return e.forEach(t=>{r=r instanceof Zb?r.controls.hasOwnProperty(t)?r.controls[t]:null:r instanceof Qb&&r.at(t)||null}),r}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new nu,this.statusChanges=new nu}_calculateStatus(){return this._allControlsDisabled()?Ub:this.errors?Vb:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Wb)?Wb:this._anyControlsHaveStatus(Vb)?Vb:Bb}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Kb(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class Yb extends Xb{constructor(t=null,e,n){super(jb(e),qb(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){zb(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){zb(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Zb extends Xb{constructor(t,e,n){super(jb(e),qb(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof Yb?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class Qb extends Xb{constructor(t,e,n){super(jb(e),qb(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof Yb?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const Jb={provide:Nb,useExisting:Ft(()=>ev)},tv=(()=>Promise.resolve(null))();let ev=(()=>{class t extends Nb{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new nu,this.form=new Zb({},kb(t),Sb(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){tv.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),Ob(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){tv.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),zb(this._directives,t)})}addFormGroup(t){tv.then(()=>{const e=this._findContainer(t.path),n=new Zb({});Lb(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){tv.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){tv.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,Pb(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(Ga(fb,10),Ga(mb,10))},t.\u0275dir=we({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&so("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Jo([Jb]),Da]}),t})();const nv={provide:Nb,useExisting:Ft(()=>rv)};let rv=(()=>{class t extends Nb{constructor(t,e){super(),this.validators=t,this.asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new nu,this._setValidators(t),this._setAsyncValidators(e)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return Ob(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){zb(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);Lb(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);Lb(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,Pb(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){const n=()=>{};e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n),$b(t,e,!0),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}(t.control||null,t),e&&Ob(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Fb(this.form,this,!1),this._oldForm&&$b(this._oldForm,this,!1)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(Ga(fb,10),Ga(mb,10))},t.\u0275dir=we({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&so("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Jo([nv]),Da,Le]}),t})(),sv=(()=>{class t{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(t){this._vertical=Ph(t)}get inset(){return this._inset}set inset(t){this._inset=Ph(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=fe({type:t,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(t,e){2&t&&(Ua("aria-orientation",e.vertical?"vertical":"horizontal"),xo("mat-divider-vertical",e.vertical)("mat-divider-horizontal",!e.vertical)("mat-divider-inset",e.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(t,e){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}\n"],encapsulation:2,changeDetection:0}),t})(),iv=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[fg],fg]}),t})();const av=["*"],ov='.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n',lv=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],uv=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],cv=["text"];function hv(t,e){if(1&t&&Qa(0,"mat-pseudo-checkbox",5),2&t){const t=uo();Ka("state",t.selected?"checked":"unchecked")("disabled",t.disabled)}}const dv=["*",[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]]],pv=["*","[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]"];class fv{}const mv=mg(yg(fv));class gv{}const yv=yg(gv),bv=new wr("MatList"),vv=new wr("MatNavList");let wv=(()=>{class t extends mv{constructor(){super(...arguments),this._stateChanges=new Q}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return t.\u0275fac=function(e){return _v(e||t)},t.\u0275cmp=fe({type:t,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[Jo([{provide:vv,useExisting:t}]),Da,Le],ngContentSelectors:av,decls:1,vars:0,template:function(t,e){1&t&&(ho(),po(0))},styles:[ov],encapsulation:2,changeDetection:0}),t})();const _v=gr(wv);let xv=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),t})(),kv=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),t})(),Sv=(()=>{class t extends yv{constructor(t,e,n,r){super(),this._element=t,this._isInteractiveList=!1,this._destroyed=new Q,this._disabled=!1,this._isInteractiveList=!!(n||r&&"action-list"===r._getListType()),this._list=n||r;const s=this._getHostElement();"button"!==s.nodeName.toLowerCase()||s.hasAttribute("type")||s.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(ld(this._destroyed)).subscribe(()=>{e.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(t){this._disabled=Ph(t)}ngAfterContentInit(){xg(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Nl),Ga(vv,8),Ga(bv,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(t,e,n){if(1&t&&(yu(n,xv,!0),yu(n,kv,!0),yu(n,_g,!0)),2&t){let t;fu(t=wu())&&(e._avatar=t.first),fu(t=wu())&&(e._icon=t.first),fu(t=wu())&&(e._lines=t)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(t,e){2&t&&xo("mat-list-item-disabled",e.disabled)("mat-list-item-avatar",e._avatar||e._icon)("mat-list-item-with-avatar",e._avatar||e._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[Da],ngContentSelectors:uv,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(t,e){1&t&&(ho(lv),Ya(0,"div",0),Qa(1,"div",1),po(2),Ya(3,"div",2),po(4,1),Za(),po(5,2),Za()),2&t&&(vi(1),Ka("matRippleTrigger",e._getHostElement())("matRippleDisabled",e._isRippleDisabled()))},directives:[Og],encapsulation:2,changeDetection:0}),t})();class Cv{}const Iv=yg(Cv);class Ev{}const Tv=yg(Ev),Nv={provide:hb,useExisting:Ft(()=>Ov),multi:!0};class Av{constructor(t,e,n){this.source=t,this.option=e,this.options=n}}let Rv=(()=>{class t extends Tv{constructor(t,e,n){super(),this._element=t,this._changeDetector=e,this.selectionList=n,this._selected=!1,this._disabled=!1,this._hasFocus=!1,this.checkboxPosition="after",this._inputsInitialized=!1}get color(){return this._color||this.selectionList.color}set color(t){this._color=t}get value(){return this._value}set value(t){this.selected&&!this.selectionList.compareWith(t,this.value)&&this._inputsInitialized&&(this.selected=!1),this._value=t}get disabled(){return this._disabled||this.selectionList&&this.selectionList.disabled}set disabled(t){const e=Ph(t);e!==this._disabled&&(this._disabled=e,this._changeDetector.markForCheck())}get selected(){return this.selectionList.selectedOptions.isSelected(this)}set selected(t){const e=Ph(t);e!==this._selected&&(this._setSelected(e),this.selectionList._reportValueChange())}ngOnInit(){const t=this.selectionList;t._value&&t._value.some(e=>t.compareWith(e,this._value))&&this._setSelected(!0);const e=this._selected;Promise.resolve().then(()=>{(this._selected||e)&&(this.selected=!0,this._changeDetector.markForCheck())}),this._inputsInitialized=!0}ngAfterContentInit(){xg(this._lines,this._element)}ngOnDestroy(){this.selected&&Promise.resolve().then(()=>{this.selected=!1});const t=this._hasFocus,e=this.selectionList._removeOptionFromList(this);t&&e&&e.focus()}toggle(){this.selected=!this.selected}focus(){this._element.nativeElement.focus()}getLabel(){return this._text&&this._text.nativeElement.textContent||""}_isRippleDisabled(){return this.disabled||this.disableRipple||this.selectionList.disableRipple}_handleClick(){this.disabled||!this.selectionList.multiple&&this.selected||(this.toggle(),this.selectionList._emitChangeEvent([this]))}_handleFocus(){this.selectionList._setFocusedOption(this),this._hasFocus=!0}_handleBlur(){this.selectionList._onTouched(),this._hasFocus=!1}_getHostElement(){return this._element.nativeElement}_setSelected(t){return t!==this._selected&&(this._selected=t,t?this.selectionList.selectedOptions.select(this):this.selectionList.selectedOptions.deselect(this),this._changeDetector.markForCheck(),!0)}_markForCheck(){this._changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Nl),Ga(Ft(()=>Ov)))},t.\u0275cmp=fe({type:t,selectors:[["mat-list-option"]],contentQueries:function(t,e,n){if(1&t&&(yu(n,xv,!0),yu(n,kv,!0),yu(n,_g,!0)),2&t){let t;fu(t=wu())&&(e._avatar=t.first),fu(t=wu())&&(e._icon=t.first),fu(t=wu())&&(e._lines=t)}},viewQuery:function(t,e){if(1&t&&mu(cv,!0),2&t){let t;fu(t=wu())&&(e._text=t.first)}},hostAttrs:["role","option",1,"mat-list-item","mat-list-option","mat-focus-indicator"],hostVars:15,hostBindings:function(t,e){1&t&&so("focus",function(){return e._handleFocus()})("blur",function(){return e._handleBlur()})("click",function(){return e._handleClick()}),2&t&&(Ua("aria-selected",e.selected)("aria-disabled",e.disabled)("tabindex",-1),xo("mat-list-item-disabled",e.disabled)("mat-list-item-with-avatar",e._avatar||e._icon)("mat-primary","primary"===e.color)("mat-accent","primary"!==e.color&&"warn"!==e.color)("mat-warn","warn"===e.color)("mat-list-single-selected-option",e.selected&&!e.selectionList.multiple))},inputs:{disableRipple:"disableRipple",checkboxPosition:"checkboxPosition",color:"color",value:"value",selected:"selected",disabled:"disabled"},exportAs:["matListOption"],features:[Da],ngContentSelectors:pv,decls:7,vars:5,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[3,"state","disabled",4,"ngIf"],[1,"mat-list-text"],["text",""],[3,"state","disabled"]],template:function(t,e){1&t&&(ho(dv),Ya(0,"div",0),Qa(1,"div",1),Ha(2,hv,1,2,"mat-pseudo-checkbox",2),Ya(3,"div",3,4),po(5),Za(),po(6,1),Za()),2&t&&(xo("mat-list-item-content-reverse","after"==e.checkboxPosition),vi(1),Ka("matRippleTrigger",e._getHostElement())("matRippleDisabled",e._isRippleDisabled()),vi(1),Ka("ngIf",e.selectionList.multiple))},directives:[Og,Yc,Fg],encapsulation:2,changeDetection:0}),t})(),Ov=(()=>{class t extends Iv{constructor(t,e,n,r){super(),this._element=t,this._changeDetector=n,this._focusMonitor=r,this._multiple=!0,this._contentInitialized=!1,this.selectionChange=new nu,this.tabIndex=0,this.color="accent",this.compareWith=(t,e)=>t===e,this._disabled=!1,this.selectedOptions=new Rd(this._multiple),this._tabIndex=-1,this._onChange=t=>{},this._destroyed=new Q,this._onTouched=()=>{}}get disabled(){return this._disabled}set disabled(t){this._disabled=Ph(t),this._markOptionsForCheck()}get multiple(){return this._multiple}set multiple(t){const e=Ph(t);e!==this._multiple&&(this._multiple=e,this.selectedOptions=new Rd(this._multiple,this.selectedOptions.selected))}ngAfterContentInit(){var t;this._contentInitialized=!0,this._keyManager=new np(this.options).withWrap().withTypeAhead().withHomeAndEnd().skipPredicate(()=>!1).withAllowedModifierKeys(["shiftKey"]),this._value&&this._setOptionsFromValues(this._value),this._keyManager.tabOut.pipe(ld(this._destroyed)).subscribe(()=>{this._allowFocusEscape()}),this.options.changes.pipe(pd(null),ld(this._destroyed)).subscribe(()=>{this._updateTabIndex()}),this.selectedOptions.changed.pipe(ld(this._destroyed)).subscribe(t=>{if(t.added)for(let e of t.added)e.selected=!0;if(t.removed)for(let e of t.removed)e.selected=!1}),null===(t=this._focusMonitor)||void 0===t||t.monitor(this._element).pipe(ld(this._destroyed)).subscribe(t=>{if("keyboard"===t||"program"===t){const t=this._keyManager.activeItemIndex;t&&-1!==t?this._keyManager.setActiveItem(t):this._keyManager.setFirstItemActive()}})}ngOnChanges(t){const e=t.disableRipple,n=t.color;(e&&!e.firstChange||n&&!n.firstChange)&&this._markOptionsForCheck()}ngOnDestroy(){var t;null===(t=this._focusMonitor)||void 0===t||t.stopMonitoring(this._element),this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0}focus(t){this._element.nativeElement.focus(t)}selectAll(){this._setAllOptionsSelected(!0)}deselectAll(){this._setAllOptionsSelected(!1)}_setFocusedOption(t){this._keyManager.updateActiveItem(t)}_removeOptionFromList(t){const e=this._getOptionIndex(t);return e>-1&&this._keyManager.activeItemIndex===e&&(e>0?this._keyManager.updateActiveItem(e-1):0===e&&this.options.length>1&&this._keyManager.updateActiveItem(Math.min(e+1,this.options.length-1))),this._keyManager.activeItem}_keydown(t){const e=t.keyCode,n=this._keyManager,r=n.activeItemIndex,s=Ld(t);switch(e){case 32:case 13:s||n.isTyping()||(this._toggleFocusedOption(),t.preventDefault());break;default:if(65===e&&this.multiple&&Ld(t,"ctrlKey")&&!n.isTyping()){const e=this.options.some(t=>!t.disabled&&!t.selected);this._setAllOptionsSelected(e,!0,!0),t.preventDefault()}else n.onKeydown(t)}this.multiple&&(38===e||40===e)&&t.shiftKey&&n.activeItemIndex!==r&&this._toggleFocusedOption()}_reportValueChange(){if(this.options&&!this._isDestroyed){const t=this._getSelectedOptionValues();this._onChange(t),this._value=t}}_emitChangeEvent(t){this.selectionChange.emit(new Av(this,t[0],t))}writeValue(t){this._value=t,this.options&&this._setOptionsFromValues(t||[])}setDisabledState(t){this.disabled=t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}_setOptionsFromValues(t){this.options.forEach(t=>t._setSelected(!1)),t.forEach(t=>{const e=this.options.find(e=>!e.selected&&this.compareWith(e.value,t));e&&e._setSelected(!0)})}_getSelectedOptionValues(){return this.options.filter(t=>t.selected).map(t=>t.value)}_toggleFocusedOption(){let t=this._keyManager.activeItemIndex;if(null!=t&&this._isValidIndex(t)){let e=this.options.toArray()[t];!e||e.disabled||!this._multiple&&e.selected||(e.toggle(),this._emitChangeEvent([e]))}}_setAllOptionsSelected(t,e,n){const r=[];this.options.forEach(n=>{e&&n.disabled||!n._setSelected(t)||r.push(n)}),r.length&&(this._reportValueChange(),n&&this._emitChangeEvent(r))}_isValidIndex(t){return t>=0&&t<this.options.length}_getOptionIndex(t){return this.options.toArray().indexOf(t)}_markOptionsForCheck(){this.options&&this.options.forEach(t=>t._markForCheck())}_allowFocusEscape(){this._tabIndex=-1,setTimeout(()=>{this._tabIndex=0,this._changeDetector.markForCheck()})}_updateTabIndex(){this._tabIndex=0===this.options.length?-1:0}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),yr("tabindex"),Ga(Nl),Ga(fp))},t.\u0275cmp=fe({type:t,selectors:[["mat-selection-list"]],contentQueries:function(t,e,n){if(1&t&&yu(n,Rv,!0),2&t){let t;fu(t=wu())&&(e.options=t)}},hostAttrs:["role","listbox",1,"mat-selection-list","mat-list-base"],hostVars:3,hostBindings:function(t,e){1&t&&so("keydown",function(t){return e._keydown(t)}),2&t&&Ua("aria-multiselectable",e.multiple)("aria-disabled",e.disabled.toString())("tabindex",e._tabIndex)},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex",color:"color",compareWith:"compareWith",disabled:"disabled",multiple:"multiple"},outputs:{selectionChange:"selectionChange"},exportAs:["matSelectionList"],features:[Jo([Nv]),Da,Le],ngContentSelectors:av,decls:1,vars:0,template:function(t,e){1&t&&(ho(),po(0))},styles:[ov],encapsulation:2,changeDetection:0}),t})(),Dv=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[Sg,Dg,fg,$g,sh],Sg,fg,$g,iv]}),t})();const Fv=["mat-button",""],$v=["*"],Mv=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class Lv{constructor(t){this._elementRef=t}}const Pv=gg(mg(yg(Lv)));let zv=(()=>{class t extends Pv{constructor(t,e,n){super(t),this._focusMonitor=e,this._animationMode=n,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const r of Mv)this._hasHostAttributes(r)&&this._getHostElement().classList.add(r);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",e){this._focusMonitor.focusVia(this._getHostElement(),t,e)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(t=>this._getHostElement().hasAttribute(t))}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(fp),Ga(ag,8))},t.\u0275cmp=fe({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,e){if(1&t&&mu(Og,!0),2&t){let t;fu(t=wu())&&(e.ripple=t.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,e){2&t&&(Ua("disabled",e.disabled||null),xo("_mat-animation-noopable","NoopAnimations"===e._animationMode)("mat-button-disabled",e.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Da],attrs:Fv,ngContentSelectors:$v,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(ho(),Ya(0,"span",0),po(1),Za(),Qa(2,"span",1),Qa(3,"span",2)),2&t&&(vi(2),xo("mat-button-ripple-round",e.isRoundButton||e.isIconButton),Ka("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[Og],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),t})(),Bv=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[Dg,fg],fg]}),t})();const Vv=["*"],Wv=".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-figure{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}\n",Uv=new wr("MAT_GRID_LIST");let jv=(()=>{class t{constructor(t,e){this._element=t,this._gridList=e,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(t){this._rowspan=Math.round(zh(t))}get colspan(){return this._colspan}set colspan(t){this._colspan=Math.round(zh(t))}_setStyle(t,e){this._element.nativeElement.style[t]=e}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Uv,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(t,e){2&t&&Ua("rowspan",e.rowspan)("colspan",e.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:Vv,decls:2,vars:0,consts:[[1,"mat-figure"]],template:function(t,e){1&t&&(ho(),Ya(0,"figure",0),po(1),Za())},styles:[Wv],encapsulation:2,changeDetection:0}),t})();class Hv{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const t=Math.max(...this.tracker);return t>1?this.rowCount+t-1:this.rowCount}update(t,e){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(t),this.tracker.fill(0,0,this.tracker.length),this.positions=e.map(t=>this._trackTile(t))}_trackTile(t){const e=this._findMatchingGap(t.colspan);return this._markTilePosition(e,t),this.columnIndex=e+t.colspan,new qv(this.rowIndex,e)}_findMatchingGap(t){let e=-1,n=-1;do{this.columnIndex+t>this.tracker.length?(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)):(e=this.tracker.indexOf(0,this.columnIndex),-1!=e?(n=this._findGapEndIndex(e),this.columnIndex=e+1):(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)))}while(n-e<t||0==n);return Math.max(e,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let t=0;t<this.tracker.length;t++)this.tracker[t]=Math.max(0,this.tracker[t]-1)}_findGapEndIndex(t){for(let e=t+1;e<this.tracker.length;e++)if(0!=this.tracker[e])return e;return this.tracker.length}_markTilePosition(t,e){for(let n=0;n<e.colspan;n++)this.tracker[t+n]=e.rowspan}}class qv{constructor(t,e){this.row=t,this.col=e}}const Gv=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class Kv{constructor(){this._rows=0,this._rowspan=0}init(t,e,n,r){this._gutterSize=Jv(t),this._rows=e.rowCount,this._rowspan=e.rowspan,this._cols=n,this._direction=r}getBaseTileSize(t,e){return`(${t}% - (${this._gutterSize} * ${e}))`}getTilePosition(t,e){return 0===e?"0":Qv(`(${t} + ${this._gutterSize}) * ${e}`)}getTileSize(t,e){return`(${t} * ${e}) + (${e-1} * ${this._gutterSize})`}setStyle(t,e,n){let r=100/this._cols,s=(this._cols-1)/this._cols;this.setColStyles(t,n,r,s),this.setRowStyles(t,e,r,s)}setColStyles(t,e,n,r){let s=this.getBaseTileSize(n,r);t._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(s,e)),t._setStyle("width",Qv(this.getTileSize(s,t.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(t){return`${this._rowspan} * ${this.getTileSize(t,1)}`}getComputedHeight(){return null}}class Xv extends Kv{constructor(t){super(),this.fixedRowHeight=t}init(t,e,n,r){super.init(t,e,n,r),this.fixedRowHeight=Jv(this.fixedRowHeight),Gv.test(this.fixedRowHeight)}setRowStyles(t,e){t._setStyle("top",this.getTilePosition(this.fixedRowHeight,e)),t._setStyle("height",Qv(this.getTileSize(this.fixedRowHeight,t.rowspan)))}getComputedHeight(){return["height",Qv(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["height",null]),t._tiles&&t._tiles.forEach(t=>{t._setStyle("top",null),t._setStyle("height",null)})}}class Yv extends Kv{constructor(t){super(),this._parseRatio(t)}setRowStyles(t,e,n,r){this.baseTileHeight=this.getBaseTileSize(n/this.rowHeightRatio,r),t._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,e)),t._setStyle("paddingTop",Qv(this.getTileSize(this.baseTileHeight,t.rowspan)))}getComputedHeight(){return["paddingBottom",Qv(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["paddingBottom",null]),t._tiles.forEach(t=>{t._setStyle("marginTop",null),t._setStyle("paddingTop",null)})}_parseRatio(t){const e=t.split(":");this.rowHeightRatio=parseFloat(e[0])/parseFloat(e[1])}}class Zv extends Kv{setRowStyles(t,e){let n=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);t._setStyle("top",this.getTilePosition(n,e)),t._setStyle("height",Qv(this.getTileSize(n,t.rowspan)))}reset(t){t._tiles&&t._tiles.forEach(t=>{t._setStyle("top",null),t._setStyle("height",null)})}}function Qv(t){return`calc(${t})`}function Jv(t){return t.match(/([A-Za-z%]+)$/)?t:t+"px"}let tw=(()=>{class t{constructor(t,e){this._element=t,this._dir=e,this._gutter="1px"}get cols(){return this._cols}set cols(t){this._cols=Math.max(1,Math.round(zh(t)))}get gutterSize(){return this._gutter}set gutterSize(t){this._gutter=""+(null==t?"":t)}get rowHeight(){return this._rowHeight}set rowHeight(t){const e=""+(null==t?"":t);e!==this._rowHeight&&(this._rowHeight=e,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(t){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===t?new Zv:t&&t.indexOf(":")>-1?new Yv(t):new Xv(t)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new Hv);const t=this._tileCoordinator,e=this._tiles.filter(t=>!t._gridList||t._gridList===this),n=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,e),this._tileStyler.init(this.gutterSize,t,this.cols,n),e.forEach((e,n)=>{const r=t.positions[n];this._tileStyler.setStyle(e,r.row,r.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(t){t&&(this._element.nativeElement.style[t[0]]=t[1])}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Nd,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-grid-list"]],contentQueries:function(t,e,n){if(1&t&&yu(n,jv,!0),2&t){let t;fu(t=wu())&&(e._tiles=t)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(t,e){2&t&&Ua("cols",e.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[Jo([{provide:Uv,useExisting:t}])],ngContentSelectors:Vv,decls:2,vars:0,template:function(t,e){1&t&&(ho(),Ya(0,"div"),po(1),Za())},styles:[Wv],encapsulation:2,changeDetection:0}),t})(),ew=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[Sg,fg],Sg,fg]}),t})();class nw{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class rw extends nw{constructor(t,e,n,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r}}class sw extends nw{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class iw extends nw{constructor(t){super(),this.element=t instanceof al?t.nativeElement:t}}class aw extends class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof rw?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof sw?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof iw?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}{constructor(t,e,n,r,s){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=t=>{const e=t.element,n=this._document.createComment("dom-portal");e.parentNode.insertBefore(n,e),this.outletElement.appendChild(e),super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})},this._document=s}attachComponentPortal(t){const e=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(e,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>n.destroy())):(n=e.create(t.injector||this._defaultInjector),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),n}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.rootNodes.forEach(t=>this.outletElement.appendChild(t)),n.detectChanges(),this.setDisposeFn(()=>{let t=e.indexOf(n);-1!==t&&e.remove(t)}),n}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let ow=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)}}),t})(),lw=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[sh,fg,ow,Dg,Jd,wp],fg]}),t})();const uw=["*",[["mat-card-footer"]]],cw=["*","mat-card-footer"],hw=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],dw=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"];let pw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-card-content"],["","mat-card-content",""],["","matCardContent",""]],hostAttrs:[1,"mat-card-content"]}),t})(),fw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-card-title"]}),t})(),mw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-card-subtitle"]}),t})(),gw=(()=>{class t{constructor(){this.align="start"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-card-actions"],hostVars:2,hostBindings:function(t,e){2&t&&xo("mat-card-actions-align-end","end"===e.align)},inputs:{align:"align"},exportAs:["matCardActions"]}),t})(),yw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","mat-card-avatar",""],["","matCardAvatar",""]],hostAttrs:[1,"mat-card-avatar"]}),t})(),bw=(()=>{class t{constructor(t){this._animationMode=t}}return t.\u0275fac=function(e){return new(e||t)(Ga(ag,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,e){2&t&&xo("_mat-animation-noopable","NoopAnimations"===e._animationMode)},exportAs:["matCard"],ngContentSelectors:cw,decls:2,vars:0,template:function(t,e){1&t&&(ho(uw),po(0),po(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}\n"],encapsulation:2,changeDetection:0}),t})(),vw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=fe({type:t,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-card-header"],ngContentSelectors:dw,decls:4,vars:0,consts:[[1,"mat-card-header-text"]],template:function(t,e){1&t&&(ho(hw),po(0),Ya(1,"div",0),po(2,1),Za(),po(3,2))},encapsulation:2,changeDetection:0}),t})(),ww=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[fg],fg]}),t})();class _w{constructor(t,e){this.predicate=t,this.inclusive=e}call(t,e){return e.subscribe(new xw(t,this.predicate,this.inclusive))}}class xw extends U{constructor(t,e,n){super(t),this.predicate=e,this.inclusive=n,this.index=0}_next(t){const e=this.destination;let n;try{n=this.predicate(t,this.index++)}catch(r){return void e.error(r)}this.nextOrComplete(t,n)}nextOrComplete(t,e){const n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())}}class kw{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Vh(-this._previousScrollPosition.left),t.style.top=Vh(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,e=t.style,n=this._document.body.style,r=e.scrollBehavior||"",s=n.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e.scrollBehavior=r,n.scrollBehavior=s}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,e=this._viewportRuler.getViewportSize();return t.scrollHeight>e.height||t.scrollWidth>e.width}}class Sw{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Cw{enable(){}disable(){}attach(){}}function Iw(t,e){return e.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function Ew(t,e){return e.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class Tw{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:e,height:n}=this._viewportRuler.getViewportSize();Iw(t,[{width:e,height:n,bottom:n,right:e,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Nw=(()=>{class t{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this.noop=()=>new Cw,this.close=t=>new Sw(this._scrollDispatcher,this._ngZone,this._viewportRuler,t),this.block=()=>new kw(this._viewportRuler,this._document),this.reposition=t=>new Tw(this._scrollDispatcher,this._viewportRuler,this._ngZone,t),this._document=r}}return t.\u0275fac=function(e){return new(e||t)(Wr(Od),Wr(Fd),Wr(qu),Wr(Cc))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Od),Wr(Fd),Wr(qu),Wr(Cc))},token:t,providedIn:"root"}),t})();class Aw{constructor(t){if(this.scrollStrategy=new Cw,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class Rw{constructor(t,e,n,r,s){this.offsetX=n,this.offsetY=r,this.panelClass=s,this.originX=t.originX,this.originY=t.originY,this.overlayX=e.overlayX,this.overlayY=e.overlayY}}class Ow{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let Dw=(()=>{class t{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const e=this._attachedOverlays.indexOf(t);e>-1&&this._attachedOverlays.splice(e,1),0===this._attachedOverlays.length&&this.detach()}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Cc))},token:t,providedIn:"root"}),t})(),Fw=(()=>{class t extends Dw{constructor(t){super(t),this._keydownListener=t=>{const e=this._attachedOverlays;for(let n=e.length-1;n>-1;n--)if(e[n]._keydownEvents.observers.length>0){e[n]._keydownEvents.next(t);break}}}add(t){super.add(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Cc))},token:t,providedIn:"root"}),t})(),$w=(()=>{class t extends Dw{constructor(t,e){super(t),this._platform=e,this._cursorStyleIsSet=!1,this._clickListener=t=>{const e=t.composedPath?t.composedPath()[0]:t.target,n=this._attachedOverlays.slice();for(let r=n.length-1;r>-1;r--){const s=n[r];if(!(s._outsidePointerEvents.observers.length<1)&&s.hasAttached()){if(s.overlayElement.contains(e))break;s._outsidePointerEvents.next(t)}}}}add(t){super.add(t),this._isAttached||(this._document.body.addEventListener("click",this._clickListener,!0),this._document.body.addEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=this._document.body.style.cursor,this._document.body.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("click",this._clickListener,!0),this._document.body.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc),Wr(Sd))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Cc),Wr(Sd))},token:t,providedIn:"root"}),t})();const Mw=!("undefined"==typeof window||!window||!window.__karma__&&!window.jasmine);let Lw=(()=>{class t{constructor(t,e){this._platform=e,this._document=t}ngOnDestroy(){const t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||Mw){const e=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])}const e=this._document.createElement("div");e.classList.add(t),Mw?e.setAttribute("platform","test"):this._platform.isBrowser||e.setAttribute("platform","server"),this._document.body.appendChild(e),this._containerElement=e}}return t.\u0275fac=function(e){return new(e||t)(Wr(Cc),Wr(Sd))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Cc),Wr(Sd))},token:t,providedIn:"root"}),t})();class Pw{constructor(t,e,n,r,s,i,a,o,l){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=i,this._document=a,this._location=o,this._outsideClickDispatcher=l,this._backdropElement=null,this._backdropClick=new Q,this._attachments=new Q,this._detachments=new Q,this._locationChanges=B.EMPTY,this._backdropClickHandler=t=>this._backdropClick.next(t),this._keydownEvents=new Q,this._outsidePointerEvents=new Q,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Gd(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=Vh(this._config.width),t.height=Vh(this._config.height),t.minWidth=Vh(this._config.minWidth),t.minHeight=Vh(this._config.minHeight),t.maxWidth=Vh(this._config.maxWidth),t.maxHeight=Vh(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"auto":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t,e=this._backdropElement;if(!e)return;let n=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",n),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",n)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(n,500))}_toggleClasses(t,e,n){const r=t.classList;Bh(e).forEach(t=>{t&&(n?r.add(t):r.remove(t))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(ld(wt(this._attachments,this._detachments))).subscribe(()=>{this._pane&&this._host&&0!==this._pane.children.length||(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}}const zw="cdk-overlay-connected-position-bounding-box",Bw=/([A-Za-z%]+)$/;class Vw{constructor(t,e,n,r,s){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Q,this._resizeSubscription=B.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){this._validatePositions(),t.hostElement.classList.add(zw),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=[];let s;for(let i of this._preferredPositions){let a=this._getOriginPoint(t,i),o=this._getOverlayPoint(a,e,i),l=this._getOverlayFit(o,e,n,i);if(l.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(i,a);this._canFitWithFlexibleDimensions(l,o,n)?r.push({position:i,origin:a,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(a,i)}):(!s||s.overlayFit.visibleArea<l.visibleArea)&&(s={overlayFit:l,overlayPoint:o,originPoint:a,position:i,overlayRect:e})}if(r.length){let t=null,e=-1;for(const n of r){const r=n.boundingBoxRect.width*n.boundingBoxRect.height*(n.position.weight||1);r>e&&(e=r,t=n)}return this._isPushed=!1,void this._applyPosition(t.position,t.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(s.position,s.originPoint);this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Ww(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(zw),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const t=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,t);this._applyPosition(t,e)}}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e){let n,r;if("center"==e.originX)n=t.left+t.width/2;else{const r=this._isRtl()?t.right:t.left,s=this._isRtl()?t.left:t.right;n="start"==e.originX?r:s}return r="center"==e.originY?t.top+t.height/2:"top"==e.originY?t.top:t.bottom,{x:n,y:r}}_getOverlayPoint(t,e,n){let r,s;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,s="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+s}}_getOverlayFit(t,e,n,r){let{x:s,y:i}=t,a=this._getOffset(r,"x"),o=this._getOffset(r,"y");a&&(s+=a),o&&(i+=o);let l=0-i,u=i+e.height-n.height,c=this._subtractOverflows(e.width,0-s,s+e.width-n.width),h=this._subtractOverflows(e.height,l,u),d=c*h;return{visibleArea:d,isCompletelyWithinViewport:e.width*e.height===d,fitsInViewportVertically:h===e.height,fitsInViewportHorizontally:c==e.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,s=n.right-e.x,i=Uw(this._overlayRef.getConfig().minHeight),a=Uw(this._overlayRef.getConfig().minWidth),o=t.fitsInViewportHorizontally||null!=a&&a<=s;return(t.fitsInViewportVertically||null!=i&&i<=r)&&o}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=this._viewportRect,s=Math.max(t.x+e.width-r.width,0),i=Math.max(t.y+e.height-r.height,0),a=Math.max(r.top-n.top-t.y,0),o=Math.max(r.left-n.left-t.x,0);let l=0,u=0;return l=e.width<=r.width?o||-s:t.x<this._viewportMargin?r.left-n.left-t.x:0,u=e.height<=r.height?a||-i:t.y<this._viewportMargin?r.top-n.top-t.y:0,this._previousPushAmount={x:l,y:u},{x:t.x+l,y:t.y+u}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const e=this._getScrollVisibility(),n=new Ow(t,e);this._positionChanges.next(n)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let s=0;s<e.length;s++)e[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let s,i,a,o,l,u;if("top"===e.overlayY)i=t.y,s=n.height-i+this._viewportMargin;else if("bottom"===e.overlayY)a=n.height-t.y+2*this._viewportMargin,s=n.height-a+this._viewportMargin;else{const e=Math.min(n.bottom-t.y+n.top,t.y),r=this._lastBoundingBoxSize.height;s=2*e,i=t.y-e,s>r&&!this._isInitialRender&&!this._growAfterOpen&&(i=t.y-r/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)u=n.width-t.x+this._viewportMargin,o=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)l=t.x,o=n.right-t.x;else{const e=Math.min(n.right-t.x+n.left,t.x),r=this._lastBoundingBoxSize.width;o=2*e,l=t.x-e,o>r&&!this._isInitialRender&&!this._growAfterOpen&&(l=t.x-r/2)}return{top:i,left:l,bottom:a,right:u,width:o,height:s}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const t=this._overlayRef.getConfig().maxHeight,s=this._overlayRef.getConfig().maxWidth;r.height=Vh(n.height),r.top=Vh(n.top),r.bottom=Vh(n.bottom),r.width=Vh(n.width),r.left=Vh(n.left),r.right=Vh(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",t&&(r.maxHeight=Vh(t)),s&&(r.maxWidth=Vh(s))}this._lastBoundingBoxSize=n,Ww(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Ww(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Ww(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,i=this._overlayRef.getConfig();if(r){const r=this._viewportRuler.getViewportScrollPosition();Ww(n,this._getExactOverlayY(e,t,r)),Ww(n,this._getExactOverlayX(e,t,r))}else n.position="static";let a="",o=this._getOffset(e,"x"),l=this._getOffset(e,"y");o&&(a+=`translateX(${o}px) `),l&&(a+=`translateY(${l}px)`),n.transform=a.trim(),i.maxHeight&&(r?n.maxHeight=Vh(i.maxHeight):s&&(n.maxHeight="")),i.maxWidth&&(r?n.maxWidth=Vh(i.maxWidth):s&&(n.maxWidth="")),Ww(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:"",bottom:""},s=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n));let i=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return s.y-=i,"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Vh(s.y),r}_getExactOverlayX(t,e,n){let r,s={left:"",right:""},i=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n)),r=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===r?s.right=this._document.documentElement.clientWidth-(i.x+this._overlayRect.width)+"px":s.left=Vh(i.x),s}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(t=>t.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Ew(t,n),isOriginOutsideView:Iw(t,n),isOverlayClipped:Ew(e,n),isOverlayOutsideView:Iw(e,n)}}_subtractOverflows(t,...e){return e.reduce((t,e)=>t-Math.max(e,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&Bh(t).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof al)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function Ww(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Uw(t){if("number"!=typeof t&&null!=t){const[e,n]=t.split(Bw);return n&&"px"!==n?null:parseFloat(e)}return t||null}class jw{constructor(t,e,n,r,s,i,a){this._preferredPositions=[],this._positionStrategy=new Vw(n,r,s,i,a).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,e),this.onPositionChange=this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(t){this._overlayRef=t,this._positionStrategy.attach(t),this._direction&&(t.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(t){this._positionStrategy.withScrollableContainers(t)}withFallbackPosition(t,e,n,r){const s=new Rw(t,e,n,r);return this._preferredPositions.push(s),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(t){return this._overlayRef?this._overlayRef.setDirection(t):this._direction=t,this}withOffsetX(t){return this._positionStrategy.withDefaultOffsetX(t),this}withOffsetY(t){return this._positionStrategy.withDefaultOffsetY(t),this}withLockedPosition(t){return this._positionStrategy.withLockedPosition(t),this}withPositions(t){return this._preferredPositions=t.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(t){return this._positionStrategy.setOrigin(t),this}}const Hw="cdk-global-overlay-wrapper";class qw{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(Hw),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:i,maxHeight:a}=n,o=!("100%"!==r&&"100vw"!==r||i&&"100%"!==i&&"100vw"!==i),l=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a);t.position=this._cssPosition,t.marginLeft=o?"0":this._leftOffset,t.marginTop=l?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,o?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(Hw),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let Gw=(()=>{class t{constructor(t,e,n,r){this._viewportRuler=t,this._document=e,this._platform=n,this._overlayContainer=r}global(){return new qw}connectedTo(t,e,n){return new jw(e,n,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new Vw(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return t.\u0275fac=function(e){return new(e||t)(Wr(Fd),Wr(Cc),Wr(Sd),Wr(Lw))},t.\u0275prov=Lt({factory:function(){return new t(Wr(Fd),Wr(Cc),Wr(Sd),Wr(Lw))},token:t,providedIn:"root"}),t})(),Kw=0,Xw=(()=>{class t{constructor(t,e,n,r,s,i,a,o,l,u,c){this.scrollStrategies=t,this._overlayContainer=e,this._componentFactoryResolver=n,this._positionBuilder=r,this._keyboardDispatcher=s,this._injector=i,this._ngZone=a,this._document=o,this._directionality=l,this._location=u,this._outsideClickDispatcher=c}create(t){const e=this._createHostElement(),n=this._createPaneElement(e),r=this._createPortalOutlet(n),s=new Aw(t);return s.direction=s.direction||this._directionality.value,new Pw(r,e,n,s,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(t){const e=this._document.createElement("div");return e.id="cdk-overlay-"+Kw++,e.classList.add("cdk-overlay-pane"),t.appendChild(e),e}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(pc)),new aw(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return t.\u0275fac=function(e){return new(e||t)(Wr(Nw),Wr(Lw),Wr(nl),Wr(Gw),Wr(Fw),Wr(Ra),Wr(qu),Wr(Cc),Wr(Nd),Wr(Bc),Wr($w))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const Yw=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Zw=new wr("cdk-connected-overlay-scroll-strategy");let Qw=(()=>{class t{constructor(t){this.elementRef=t}}return t.\u0275fac=function(e){return new(e||t)(Ga(al))},t.\u0275dir=we({type:t,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]}),t})(),Jw=(()=>{class t{constructor(t,e,n,r,s){this._overlay=t,this._dir=s,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=B.EMPTY,this._attachSubscription=B.EMPTY,this._detachSubscription=B.EMPTY,this._positionSubscription=B.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new nu,this.positionChange=new nu,this.attach=new nu,this.detach=new nu,this.overlayKeydown=new nu,this.overlayOutsideClick=new nu,this._templatePortal=new sw(e,n),this._scrollStrategyFactory=r,this.scrollStrategy=this._scrollStrategyFactory()}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=Ph(t)}get lockPosition(){return this._lockPosition}set lockPosition(t){this._lockPosition=Ph(t)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(t){this._flexibleDimensions=Ph(t)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(t){this._growAfterOpen=Ph(t)}get push(){return this._push}set push(t){this._push=Ph(t)}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){this.positions&&this.positions.length||(this.positions=Yw);const t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(t=>{this.overlayKeydown.next(t),27!==t.keyCode||this.disableClose||Ld(t)||(t.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(t=>{this.overlayOutsideClick.next(t)})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),e=new Aw({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(e.width=this.width),(this.height||0===this.height)&&(e.height=this.height),(this.minWidth||0===this.minWidth)&&(e.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(e.minHeight=this.minHeight),this.backdropClass&&(e.backdropClass=this.backdropClass),this.panelClass&&(e.panelClass=this.panelClass),e}_updatePositionStrategy(t){const e=this.positions.map(t=>({originX:t.originX,originY:t.originY,overlayX:t.overlayX,overlayY:t.overlayY,offsetX:t.offsetX||this.offsetX,offsetY:t.offsetY||this.offsetY,panelClass:t.panelClass||void 0}));return t.setOrigin(this.origin.elementRef).withPositions(e).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this.origin.elementRef);return this._updatePositionStrategy(t),t}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function(t,e=!1){return n=>n.lift(new _w(t,e))}(()=>this.positionChange.observers.length>0)).subscribe(t=>{this.positionChange.emit(t),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Ga(Xw),Ga(Fl),Ga(Vl),Ga(Zw),Ga(Nd,8))},t.\u0275dir=we({type:t,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"],positions:["cdkConnectedOverlayPositions","positions"],origin:["cdkConnectedOverlayOrigin","origin"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[Le]}),t})();const t_={provide:Zw,deps:[Xw],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let e_=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},providers:[Xw,t_],imports:[[Ad,ow,Md],Md]}),t})();const n_=["underline"],r_=["connectionContainer"],s_=["inputContainer"],i_=["label"];function a_(t,e){1&t&&(Ja(0),Ya(1,"div",14),Qa(2,"div",15),Qa(3,"div",16),Qa(4,"div",17),Za(),Ya(5,"div",18),Qa(6,"div",15),Qa(7,"div",16),Qa(8,"div",17),Za(),to())}function o_(t,e){1&t&&(Ya(0,"div",19),po(1,1),Za())}function l_(t,e){if(1&t&&(Ja(0),po(1,2),Ya(2,"span"),Do(3),Za(),to()),2&t){const t=uo(2);vi(3),Fo(t._control.placeholder)}}function u_(t,e){1&t&&po(0,3,["*ngSwitchCase","true"])}function c_(t,e){1&t&&(Ya(0,"span",23),Do(1," *"),Za())}function h_(t,e){if(1&t){const t=eo();Ya(0,"label",20,21),so("cdkObserveContent",function(){return ln(t),uo().updateOutlineGap()}),Ha(2,l_,4,1,"ng-container",12),Ha(3,u_,1,0,"ng-content",12),Ha(4,c_,2,0,"span",22),Za()}if(2&t){const t=uo();xo("mat-empty",t._control.empty&&!t._shouldAlwaysFloat())("mat-form-field-empty",t._control.empty&&!t._shouldAlwaysFloat())("mat-accent","accent"==t.color)("mat-warn","warn"==t.color),Ka("cdkObserveContentDisabled","outline"!=t.appearance)("id",t._labelId)("ngSwitch",t._hasLabel()),Ua("for",t._control.id)("aria-owns",t._control.id),vi(2),Ka("ngSwitchCase",!1),vi(1),Ka("ngSwitchCase",!0),vi(1),Ka("ngIf",!t.hideRequiredMarker&&t._control.required&&!t._control.disabled)}}function d_(t,e){1&t&&(Ya(0,"div",24),po(1,4),Za())}function p_(t,e){if(1&t&&(Ya(0,"div",25,26),Qa(2,"span",27),Za()),2&t){const t=uo();vi(2),xo("mat-accent","accent"==t.color)("mat-warn","warn"==t.color)}}function f_(t,e){1&t&&(Ya(0,"div"),po(1,5),Za()),2&t&&Ka("@transitionMessages",uo()._subscriptAnimationState)}function m_(t,e){if(1&t&&(Ya(0,"div",31),Do(1),Za()),2&t){const t=uo(2);Ka("id",t._hintLabelId),vi(1),Fo(t.hintLabel)}}function g_(t,e){if(1&t&&(Ya(0,"div",28),Ha(1,m_,2,2,"div",29),po(2,6),Qa(3,"div",30),po(4,7),Za()),2&t){const t=uo();Ka("@transitionMessages",t._subscriptAnimationState),vi(1),Ka("ngIf",t.hintLabel)}}const y_=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],b_=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],v_=new wr("MatError"),w_={transitionMessages:Sp("transitionMessages",[Tp("enter",Ep({opacity:1,transform:"translateY(0%)"})),Np("void => enter",[Ep({opacity:0,transform:"translateY(-100%)"}),Cp("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let __=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t}),t})();const x_=new wr("MatHint");let k_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-label"]]}),t})(),S_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-placeholder"]]}),t})();const C_=new wr("MatPrefix"),I_=new wr("MatSuffix");let E_=0;class T_{constructor(t){this._elementRef=t}}const N_=gg(T_,"primary"),A_=new wr("MAT_FORM_FIELD_DEFAULT_OPTIONS"),R_=new wr("MatFormField");let O_=(()=>{class t extends N_{constructor(t,e,n,r,s,i,a,o){super(t),this._elementRef=t,this._changeDetectorRef=e,this._dir=r,this._defaults=s,this._platform=i,this._ngZone=a,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new Q,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+E_++,this._labelId="mat-form-field-label-"+E_++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==o,this.appearance=s&&s.appearance?s.appearance:"legacy",this._hideRequiredMarker=!(!s||null==s.hideRequiredMarker)&&s.hideRequiredMarker}get appearance(){return this._appearance}set appearance(t){const e=this._appearance;this._appearance=t||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&e!==t&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=Ph(t)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(t){this._explicitFormFieldControl=t}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add("mat-form-field-type-"+t.controlType),t.stateChanges.pipe(pd(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(ld(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(ld(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),wt(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(pd(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(pd(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(ld(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(t){const e=this._control?this._control.ngControl:null;return e&&e[t]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,jh(this._label.nativeElement,"transitionend").pipe(Gd(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&t.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const e=this._hintChildren?this._hintChildren.find(t=>"start"===t.align):null,n=this._hintChildren?this._hintChildren.find(t=>"end"===t.align):null;e?t.push(e.id):this._hintLabel&&t.push(this._hintLabelId),n&&t.push(n.id)}else this._errorChildren&&t.push(...this._errorChildren.map(t=>t.id));this._control.setDescribedByIds(t)}}_validateControlChild(){}updateOutlineGap(){const t=this._label?this._label.nativeElement:null;if("outline"!==this.appearance||!t||!t.children.length||!t.textContent.trim())return;if(!this._platform.isBrowser)return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let e=0,n=0;const r=this._connectionContainerRef.nativeElement,s=r.querySelectorAll(".mat-form-field-outline-start"),i=r.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const s=r.getBoundingClientRect();if(0===s.width&&0===s.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const i=this._getStartEnd(s),a=t.children,o=this._getStartEnd(a[0].getBoundingClientRect());let l=0;for(let t=0;t<a.length;t++)l+=a[t].offsetWidth;e=Math.abs(o-i)-5,n=l>0?.75*l+10:0}for(let a=0;a<s.length;a++)s[a].style.width=e+"px";for(let a=0;a<i.length;a++)i[a].style.width=n+"px";this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(t){return this._dir&&"rtl"===this._dir.value?t.right:t.left}_isAttachedToDOM(){const t=this._elementRef.nativeElement;if(t.getRootNode){const e=t.getRootNode();return e&&e!==t}return document.documentElement.contains(t)}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(Nl),Ga(al),Ga(Nd,8),Ga(A_,8),Ga(Sd),Ga(qu),Ga(ag,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-form-field"]],contentQueries:function(t,e,n){if(1&t&&(yu(n,__,!0),bu(n,__,!0),yu(n,k_,!0),bu(n,k_,!0),yu(n,S_,!0),yu(n,v_,!0),yu(n,x_,!0),yu(n,C_,!0),yu(n,I_,!0)),2&t){let t;fu(t=wu())&&(e._controlNonStatic=t.first),fu(t=wu())&&(e._controlStatic=t.first),fu(t=wu())&&(e._labelChildNonStatic=t.first),fu(t=wu())&&(e._labelChildStatic=t.first),fu(t=wu())&&(e._placeholderChild=t.first),fu(t=wu())&&(e._errorChildren=t),fu(t=wu())&&(e._hintChildren=t),fu(t=wu())&&(e._prefixChildren=t),fu(t=wu())&&(e._suffixChildren=t)}},viewQuery:function(t,e){if(1&t&&(mu(n_,!0),n=r_,gu(on(),an(),n,!0,void 0,!0),mu(s_,!0),mu(i_,!0)),2&t){let t;fu(t=wu())&&(e.underlineRef=t.first),fu(t=wu())&&(e._connectionContainerRef=t.first),fu(t=wu())&&(e._inputContainerRef=t.first),fu(t=wu())&&(e._label=t.first)}var n},hostAttrs:[1,"mat-form-field"],hostVars:44,hostBindings:function(t,e){2&t&&xo("mat-form-field-appearance-standard","standard"==e.appearance)("mat-form-field-appearance-fill","fill"==e.appearance)("mat-form-field-appearance-outline","outline"==e.appearance)("mat-form-field-appearance-legacy","legacy"==e.appearance)("mat-form-field-invalid",e._control.errorState)("mat-form-field-can-float",e._canLabelFloat())("mat-form-field-should-float",e._shouldLabelFloat())("mat-form-field-has-label",e._hasFloatingLabel())("mat-form-field-hide-placeholder",e._hideControlPlaceholder())("mat-form-field-disabled",e._control.disabled)("mat-form-field-autofilled",e._control.autofilled)("mat-focused",e._control.focused)("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)("ng-untouched",e._shouldForward("untouched"))("ng-touched",e._shouldForward("touched"))("ng-pristine",e._shouldForward("pristine"))("ng-dirty",e._shouldForward("dirty"))("ng-valid",e._shouldForward("valid"))("ng-invalid",e._shouldForward("invalid"))("ng-pending",e._shouldForward("pending"))("_mat-animation-noopable",!e._animationsEnabled)},inputs:{color:"color",floatLabel:"floatLabel",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Jo([{provide:R_,useExisting:t}]),Da],ngContentSelectors:b_,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],["underline",""],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(t,e){1&t&&(ho(y_),Ya(0,"div",0),Ya(1,"div",1,2),so("click",function(t){return e._control.onContainerClick&&e._control.onContainerClick(t)}),Ha(3,a_,9,0,"ng-container",3),Ha(4,o_,2,0,"div",4),Ya(5,"div",5,6),po(7),Ya(8,"span",7),Ha(9,h_,5,16,"label",8),Za(),Za(),Ha(10,d_,2,0,"div",9),Za(),Ha(11,p_,3,4,"div",10),Ya(12,"div",11),Ha(13,f_,2,1,"div",12),Ha(14,g_,5,2,"div",13),Za(),Za()),2&t&&(vi(3),Ka("ngIf","outline"==e.appearance),vi(1),Ka("ngIf",e._prefixChildren.length),vi(5),Ka("ngIf",e._hasFloatingLabel()),vi(1),Ka("ngIf",e._suffixChildren.length),vi(1),Ka("ngIf","outline"!=e.appearance),vi(1),Ka("ngSwitch",e._getDisplayedMessages()),vi(1),Ka("ngSwitchCase","error"),vi(1),Ka("ngSwitchCase","hint"))},directives:[Yc,th,eh,Qd],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:none}.mat-focused .cdk-high-contrast-active select.mat-input-element::-ms-value{color:inherit}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[w_.transitionMessages]},changeDetection:0}),t})(),D_=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[sh,fg,Jd],fg]}),t})();function F_(t){return new G(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?ht(n):bd()).subscribe(e)})}const $_=["trigger"],M_=["panel"];function L_(t,e){if(1&t&&(Ya(0,"span",8),Do(1),Za()),2&t){const t=uo();vi(1),Fo(t.placeholder||"\xa0")}}function P_(t,e){if(1&t&&(Ya(0,"span"),Do(1),Za()),2&t){const t=uo(2);vi(1),Fo(t.triggerValue||"\xa0")}}function z_(t,e){1&t&&po(0,0,["*ngSwitchCase","true"])}function B_(t,e){1&t&&(Ya(0,"span",9),Ha(1,P_,2,1,"span",10),Ha(2,z_,1,0,"ng-content",11),Za()),2&t&&(Ka("ngSwitch",!!uo().customTrigger),vi(2),Ka("ngSwitchCase",!0))}function V_(t,e){if(1&t){const t=eo();Ya(0,"div",12),Ya(1,"div",13,14),so("@transformPanel.done",function(e){return ln(t),uo()._panelDoneAnimatingStream.next(e.toState)})("keydown",function(e){return ln(t),uo()._handleKeydown(e)}),po(3,1),Za(),Za()}if(2&t){const t=uo();Ka("@transformPanelWrap",void 0),vi(1),n="mat-select-panel ",r=t._getPanelTheme(),s="",function(t,e,n,r){const s=on(),i=yn(2);s.firstUpdatePass&&Io(s,null,i,r);const a=an();if(n!==bi&&Wa(a,i,n)){const o=s.data[Rn()];if(Oo(o,r)&&!Co(s,i)){let t=o.classesWithoutHost;null!==t&&(n=Ot(t,n||"")),Xa(s,o,a,n,r)}else!function(t,e,n,r,s,i,a,o){s===bi&&(s=fo);let l=0,u=0,c=0<s.length?s[0]:null,h=0<i.length?i[0]:null;for(;null!==c||null!==h;){const a=l<s.length?s[l+1]:void 0,d=u<i.length?i[u+1]:void 0;let p=null,f=void 0;c===h?(l+=2,u+=2,a!==d&&(p=h,f=d)):null===h||null!==c&&c<h?(l+=2,p=c):(u+=2,p=h,f=d),null!==p&&No(t,e,n,r,p,f,!0,o),c=l<s.length?s[l]:null,h=u<i.length?i[u]:null}}(s,o,a,a[11],a[i+1],a[i+1]=function(t,e,n){if(null==n||""===n)return fo;const r=[],s=Jr(n);if(Array.isArray(s))for(let i=0;i<s.length;i++)t(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&t(r,i,s[i]);else"string"==typeof s&&e(r,s);return r}(t,e,n),0,i)}}(Tr,ko,ja(an(),n,r,s),!0),_o("transform-origin",t._transformOrigin)("font-size",t._triggerFontSize,"px"),Ka("ngClass",t.panelClass)("@transformPanel",t.multiple?"showing-multiple":"showing"),Ua("id",t.id+"-panel")("aria-multiselectable",t.multiple)("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby())}var n,r,s}const W_=[[["mat-select-trigger"]],"*"],U_=["mat-select-trigger","*"],j_={transformPanelWrap:Sp("transformPanelWrap",[Np("* => void",Rp("@transformPanel",[Ap()],{optional:!0}))]),transformPanel:Sp("transformPanel",[Tp("void",Ep({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),Tp("showing",Ep({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),Tp("showing-multiple",Ep({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),Np("void => *",Cp("120ms cubic-bezier(0, 0, 0.2, 1)")),Np("* => void",Cp("100ms 25ms linear",Ep({opacity:0})))])};let H_=0;const q_=256,G_=new wr("mat-select-scroll-strategy"),K_=new wr("MAT_SELECT_CONFIG"),X_={provide:G_,deps:[Xw],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};class Y_{constructor(t,e){this.source=t,this.value=e}}class Z_{constructor(t,e,n,r,s){this._elementRef=t,this._defaultErrorStateMatcher=e,this._parentForm=n,this._parentFormGroup=r,this.ngControl=s}}const Q_=yg(bg(mg(vg(Z_)))),J_=new wr("MatSelectTrigger");let tx=(()=>{class t extends Q_{constructor(t,e,n,r,s,i,a,o,l,u,c,h,d,p){var f,m,g;super(s,r,a,o,u),this._viewportRuler=t,this._changeDetectorRef=e,this._ngZone=n,this._dir=i,this._parentFormField=l,this.ngControl=u,this._liveAnnouncer=d,this._defaultOptions=p,this._panelOpen=!1,this._compareWith=(t,e)=>t===e,this._uid="mat-select-"+H_++,this._triggerAriaLabelledBy=null,this._destroy=new Q,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+H_++,this._panelDoneAnimatingStream=new Q,this._overlayPanelClass=(null===(f=this._defaultOptions)||void 0===f?void 0:f.overlayPanelClass)||"",this._focused=!1,this.controlType="mat-select",this._required=!1,this._multiple=!1,this._disableOptionCentering=null!==(g=null===(m=this._defaultOptions)||void 0===m?void 0:m.disableOptionCentering)&&void 0!==g&&g,this.ariaLabel="",this.optionSelectionChanges=F_(()=>{const t=this.options;return t?t.changes.pipe(pd(t),fd(()=>wt(...t.map(t=>t.onSelectionChange)))):this._ngZone.onStable.pipe(Gd(1),fd(()=>this.optionSelectionChanges))}),this.openedChange=new nu,this._openedStream=this.openedChange.pipe(id(t=>t),et(()=>{})),this._closedStream=this.openedChange.pipe(id(t=>!t),et(()=>{})),this.selectionChange=new nu,this.valueChange=new nu,this.ngControl&&(this.ngControl.valueAccessor=this),null!=(null==p?void 0:p.typeaheadDebounceInterval)&&(this._typeaheadDebounceInterval=p.typeaheadDebounceInterval),this._scrollStrategyFactory=h,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(c)||0,this.id=this.id}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required}set required(t){this._required=Ph(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){this._multiple=Ph(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=Ph(t)}get compareWith(){return this._compareWith}set compareWith(t){this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){t!==this._value&&(this.options&&this._setSelectionByValue(t),this._value=t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=zh(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new Rd(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(Yh(),ld(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(ld(this._destroy)).subscribe(t=>{t.added.forEach(t=>t.select()),t.removed.forEach(t=>t.deselect())}),this.options.changes.pipe(pd(null),ld(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const t=this._getTriggerAriaLabelledby();if(t!==this._triggerAriaLabelledBy){const e=this._elementRef.nativeElement;this._triggerAriaLabelledBy=t,t?e.setAttribute("aria-labelledby",t):e.removeAttribute("aria-labelledby")}this.ngControl&&this.updateErrorState()}ngOnChanges(t){t.disabled&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this.value=t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(t=>t.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const e=t.keyCode,n=40===e||38===e||37===e||39===e,r=13===e||32===e,s=this._keyManager;if(!s.isTyping()&&r&&!Ld(t)||(this.multiple||t.altKey)&&n)t.preventDefault(),this.open();else if(!this.multiple){const e=this.selected;s.onKeydown(t);const n=this.selected;n&&e!==n&&this._liveAnnouncer.announce(n.viewValue,1e4)}}_handleOpenKeydown(t){const e=this._keyManager,n=t.keyCode,r=40===n||38===n,s=e.isTyping();if(r&&t.altKey)t.preventDefault(),this.close();else if(s||13!==n&&32!==n||!e.activeItem||Ld(t))if(!s&&this._multiple&&65===n&&t.ctrlKey){t.preventDefault();const e=this.options.some(t=>!t.disabled&&!t.selected);this.options.forEach(t=>{t.disabled||(e?t.select():t.deselect())})}else{const n=e.activeItemIndex;e.onKeydown(t),this._multiple&&r&&t.shiftKey&&e.activeItem&&e.activeItemIndex!==n&&e.activeItem._selectViaInteraction()}else t.preventDefault(),e.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this.overlayDir.positionChange.pipe(Gd(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?"mat-"+this._parentFormField.color:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this._setSelectionByValue(this.ngControl?this.ngControl.value:this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this._selectionModel.selected.forEach(t=>t.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&t)Array.isArray(t),t.forEach(t=>this._selectValue(t)),this._sortValues();else{const e=this._selectValue(t);e?this._keyManager.updateActiveItem(e):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectValue(t){const e=this.options.find(e=>{try{return null!=e.value&&this._compareWith(e.value,t)}catch(n){return!1}});return e&&this._selectionModel.select(e),e}_initKeyManager(){this._keyManager=new ep(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(ld(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe(ld(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):this._panelOpen||this.multiple||!this._keyManager.activeItem||this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=wt(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(ld(t)).subscribe(t=>{this._onSelect(t.source,t.isUserInput),t.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),wt(...this.options.map(t=>t._stateChanges)).pipe(ld(t)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}_onSelect(t,e){const n=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(n!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),e&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),e&&this.focus())):(t.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(t.value)),n!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((e,n)=>this.sortComparator?this.sortComparator(e,n,t):t.indexOf(e)-t.indexOf(n)),this.stateChanges.next()}}_propagateChanges(t){let e=null;e=this.multiple?this.selected.map(t=>t.value):this.selected?this.selected.value:t,this._value=e,this.valueChange.emit(e),this._onChange(e),this.selectionChange.emit(this._getChangeEvent(e)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){var t;return!this._panelOpen&&!this.disabled&&(null===(t=this.options)||void 0===t?void 0:t.length)>0}focus(t){this._elementRef.nativeElement.focus(t)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const t=this._getLabelId();return this.ariaLabelledby?t+" "+this.ariaLabelledby:t}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getLabelId(){var t;return(null===(t=this._parentFormField)||void 0===t?void 0:t.getLabelId())||""}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let t=this._getLabelId()+" "+this._valueId;return this.ariaLabelledby&&(t+=" "+this.ariaLabelledby),t}_panelDoneAnimating(t){this.openedChange.emit(t)}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty}}return t.\u0275fac=function(e){return new(e||t)(Ga(Fd),Ga(Nl),Ga(qu),Ga(wg),Ga(al),Ga(Nd,8),Ga(ev,8),Ga(rv,8),Ga(R_,8),Ga(Rb,10),yr("tabindex"),Ga(G_),Ga(cp),Ga(K_,8))},t.\u0275dir=we({type:t,viewQuery:function(t,e){if(1&t&&(mu($_,!0),mu(M_,!0),mu(Jw,!0)),2&t){let t;fu(t=wu())&&(e.trigger=t.first),fu(t=wu())&&(e.panel=t.first),fu(t=wu())&&(e.overlayDir=t.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],id:"id",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",typeaheadDebounceInterval:"typeaheadDebounceInterval",panelClass:"panelClass",ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",sortComparator:"sortComparator"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[Da,Le]}),t})(),ex=(()=>{class t extends tx{constructor(){super(...arguments),this._scrollTop=0,this._triggerFontSize=0,this._transformOrigin="top",this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}]}_calculateOverlayScroll(t,e,n){const r=this._getItemHeight();return Math.min(Math.max(0,r*t-e+r/2),n)}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(ld(this._destroy)).subscribe(()=>{this.panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}open(){super._canOpen()&&(super.open(),this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._calculateOverlayPosition(),this._ngZone.onStable.pipe(Gd(1)).subscribe(()=>{this._triggerFontSize&&this.overlayDir.overlayRef&&this.overlayDir.overlayRef.overlayElement&&(this.overlayDir.overlayRef.overlayElement.style.fontSize=this._triggerFontSize+"px")}))}_scrollOptionIntoView(t){const e=Gg(t,this.options,this.optionGroups),n=this._getItemHeight();var r,s,i;this.panel.nativeElement.scrollTop=(s=n,(r=(t+e)*n)<(i=this.panel.nativeElement.scrollTop)?r:r+s>i+256?Math.max(0,r-256+s):i)}_positioningSettled(){this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop}_panelDoneAnimating(t){this.panelOpen?this._scrollTop=0:(this.overlayDir.offsetX=0,this._changeDetectorRef.markForCheck()),super._panelDoneAnimating(t)}_getChangeEvent(t){return new Y_(this,t)}_calculateOverlayOffsetX(){const t=this.overlayDir.overlayRef.overlayElement.getBoundingClientRect(),e=this._viewportRuler.getViewportSize(),n=this._isRtl(),r=this.multiple?56:32;let s;if(this.multiple)s=40;else{let t=this._selectionModel.selected[0]||this.options.first;s=t&&t.group?32:16}n||(s*=-1);const i=0-(t.left+s-(n?r:0)),a=t.right+s-e.width+(n?0:r);i>0?s+=i+8:a>0&&(s-=a+8),this.overlayDir.offsetX=Math.round(s),this.overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(t,e,n){const r=this._getItemHeight(),s=(r-this._triggerRect.height)/2,i=Math.floor(q_/r);let a;return this.disableOptionCentering?0:(a=0===this._scrollTop?t*r:this._scrollTop===n?(t-(this._getItemCount()-i))*r+(r-(this._getItemCount()*r-q_)%r):e-r/2,Math.round(-1*a-s))}_checkOverlayWithinViewport(t){const e=this._getItemHeight(),n=this._viewportRuler.getViewportSize(),r=this._triggerRect.top-8,s=n.height-this._triggerRect.bottom-8,i=Math.abs(this._offsetY),a=Math.min(this._getItemCount()*e,q_)-i-this._triggerRect.height;a>s?this._adjustPanelUp(a,s):i>r?this._adjustPanelDown(i,r,t):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(t,e){const n=Math.round(t-e);this._scrollTop-=n,this._offsetY-=n,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(t,e,n){const r=Math.round(t-e);if(this._scrollTop+=r,this._offsetY+=r,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=n)return this._scrollTop=n,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_calculateOverlayPosition(){const t=this._getItemHeight(),e=this._getItemCount(),n=Math.min(e*t,q_),r=e*t-n;let s;s=this.empty?0:Math.max(this.options.toArray().indexOf(this._selectionModel.selected[0]),0),s+=Gg(s,this.options,this.optionGroups);const i=n/2;this._scrollTop=this._calculateOverlayScroll(s,i,r),this._offsetY=this._calculateOverlayOffsetY(s,i,r),this._checkOverlayWithinViewport(r)}_getOriginBasedOnOption(){const t=this._getItemHeight(),e=(t-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-e+t/2}px 0px`}_getItemHeight(){return 3*this._triggerFontSize}_getItemCount(){return this.options.length+this.optionGroups.length}}return t.\u0275fac=function(e){return nx(e||t)},t.\u0275cmp=fe({type:t,selectors:[["mat-select"]],contentQueries:function(t,e,n){if(1&t&&(yu(n,J_,!0),yu(n,qg,!0),yu(n,Vg,!0)),2&t){let t;fu(t=wu())&&(e.customTrigger=t.first),fu(t=wu())&&(e.options=t),fu(t=wu())&&(e.optionGroups=t)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","true",1,"mat-select"],hostVars:20,hostBindings:function(t,e){1&t&&so("keydown",function(t){return e._handleKeydown(t)})("focus",function(){return e._onFocus()})("blur",function(){return e._onBlur()}),2&t&&(Ua("id",e.id)("tabindex",e.tabIndex)("aria-controls",e.panelOpen?e.id+"-panel":null)("aria-expanded",e.panelOpen)("aria-label",e.ariaLabel||null)("aria-required",e.required.toString())("aria-disabled",e.disabled.toString())("aria-invalid",e.errorState)("aria-describedby",e._ariaDescribedby||null)("aria-activedescendant",e._getAriaActiveDescendant()),xo("mat-select-disabled",e.disabled)("mat-select-invalid",e.errorState)("mat-select-required",e.required)("mat-select-empty",e.empty)("mat-select-multiple",e.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matSelect"],features:[Jo([{provide:__,useExisting:t},{provide:jg,useExisting:t}]),Da],ngContentSelectors:U_,decls:9,vars:12,consts:[["cdk-overlay-origin","",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder"],[1,"mat-select-value-text",3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-panel-wrap"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(t,e){if(1&t&&(ho(W_),Ya(0,"div",0,1),so("click",function(){return e.toggle()}),Ya(3,"div",2),Ha(4,L_,2,1,"span",3),Ha(5,B_,3,2,"span",4),Za(),Ya(6,"div",5),Qa(7,"div",6),Za(),Za(),Ha(8,V_,4,14,"ng-template",7),so("backdropClick",function(){return e.close()})("attach",function(){return e._onAttached()})("detach",function(){return e.close()})),2&t){const t=qa(1);Ua("aria-owns",e.panelOpen?e.id+"-panel":null),vi(3),Ka("ngSwitch",e.empty),Ua("id",e._valueId),vi(1),Ka("ngSwitchCase",!0),vi(1),Ka("ngSwitchCase",!1),vi(3),Ka("cdkConnectedOverlayPanelClass",e._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",e._scrollStrategy)("cdkConnectedOverlayOrigin",t)("cdkConnectedOverlayOpen",e.panelOpen)("cdkConnectedOverlayPositions",e._positions)("cdkConnectedOverlayMinWidth",null==e._triggerRect?null:e._triggerRect.width)("cdkConnectedOverlayOffsetY",e._offsetY)}},directives:[Qw,th,eh,Jw,nh,qc],styles:[".mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-table;cursor:pointer;position:relative;box-sizing:border-box}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-select-value{display:table-cell;max-width:0;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{display:table-cell;vertical-align:middle}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px;outline:0}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}\n"],encapsulation:2,data:{animation:[j_.transformPanelWrap,j_.transformPanel]},changeDetection:0}),t})();const nx=gr(ex);let rx=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},providers:[X_],imports:[[sh,e_,Kg,fg],$d,D_,Kg,fg]}),t})(),sx=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[Cd]]}),t})(),ix=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},providers:[wg],imports:[[sx,D_,fg],sx,D_]}),t})();const ax=["primaryValueBar"];class ox{constructor(t){this._elementRef=t}}const lx=gg(ox,"primary"),ux=new wr("mat-progress-bar-location",{providedIn:"root",factory:function(){const t=Ur(Cc),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}});let cx=0,hx=(()=>{class t extends lx{constructor(t,e,n,r){super(t),this._elementRef=t,this._ngZone=e,this._animationMode=n,this._isNoopAnimation=!1,this._value=0,this._bufferValue=0,this.animationEnd=new nu,this._animationEndSubscription=B.EMPTY,this.mode="determinate",this.progressbarId="mat-progress-bar-"+cx++;const s=r?r.getPathname().split("#")[0]:"";this._rectangleFillValue=`url('${s}#${this.progressbarId}')`,this._isNoopAnimation="NoopAnimations"===n}get value(){return this._value}set value(t){this._value=dx(zh(t)||0)}get bufferValue(){return this._bufferValue}set bufferValue(t){this._bufferValue=dx(t||0)}_primaryTransform(){return{transform:`scale3d(${this.value/100}, 1, 1)`}}_bufferTransform(){return"buffer"===this.mode?{transform:`scale3d(${this.bufferValue/100}, 1, 1)`}:null}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const t=this._primaryValueBar.nativeElement;this._animationEndSubscription=jh(t,"transitionend").pipe(id(e=>e.target===t)).subscribe(()=>{"determinate"!==this.mode&&"buffer"!==this.mode||this._ngZone.run(()=>this.animationEnd.next({value:this.value}))})})}ngOnDestroy(){this._animationEndSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Ga(al),Ga(qu),Ga(ag,8),Ga(ux,8))},t.\u0275cmp=fe({type:t,selectors:[["mat-progress-bar"]],viewQuery:function(t,e){if(1&t&&mu(ax,!0),2&t){let t;fu(t=wu())&&(e._primaryValueBar=t.first)}},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"mat-progress-bar"],hostVars:4,hostBindings:function(t,e){2&t&&(Ua("aria-valuenow","indeterminate"===e.mode||"query"===e.mode?null:e.value)("mode",e.mode),xo("_mat-animation-noopable",e._isNoopAnimation))},inputs:{color:"color",mode:"mode",value:"value",bufferValue:"bufferValue"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[Da],decls:9,vars:4,consts:[["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(t,e){1&t&&(rn.lFrame.currentNamespace=We,Ya(0,"svg",0),Ya(1,"defs"),Ya(2,"pattern",1),Qa(3,"circle",2),Za(),Za(),Qa(4,"rect",3),Za(),rn.lFrame.currentNamespace=null,Qa(5,"div",4),Qa(6,"div",5,6),Qa(8,"div",7)),2&t&&(vi(2),Ka("id",e.progressbarId),vi(2),Ua("fill",e._rectangleFillValue),vi(1),Ka("ngStyle",e._bufferTransform()),vi(1),Ka("ngStyle",e._primaryTransform()))},directives:[rh],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}\n'],encapsulation:2,changeDetection:0}),t})();function dx(t,e=0,n=100){return Math.max(e,Math.min(n,t))}let px=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[sh,fg],fg]}),t})();class fx extends Q{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new X;return this._value}next(t){super.next(this._value=t)}}class mx extends U{notifyNext(t,e,n,r,s){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class gx extends U{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function yx(t,e,n,r,s=new gx(t,n,r)){if(!s.closed)return e instanceof G?e.subscribe(s):ut(e)(s)}const bx={};class vx{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new wx(t,this.resultSelector))}}class wx extends mx{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(bx),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++)this.add(yx(this,t[n],void 0,n))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n){const r=this.values,s=this.toRespond?r[n]===bx?--this.toRespond:this.toRespond:0;r[n]=e,0===s&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const _x=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();function xx(t){return function(e){return 0===t?bd():e.lift(new kx(t))}}class kx{constructor(t){if(this.total=t,this.total<0)throw new qd}call(t,e){return e.subscribe(new Sx(t,this.total))}}class Sx extends U{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let s=0;s<n;s++){const s=e++%n;t.next(r[s])}}t.complete()}}function Cx(t=Tx){return e=>e.lift(new Ix(t))}class Ix{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new Ex(t,this.errorFactory))}}class Ex extends U{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function Tx(){return new _x}function Nx(t=null){return e=>e.lift(new Ax(t))}class Ax{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Rx(t,this.defaultValue))}}class Rx extends U{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}class Ox{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new Dx(t,this.accumulator,this.seed,this.hasSeed))}}class Dx extends U{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function Fx(t,e){const n=arguments.length>=2;return r=>r.pipe(t?id((e,n)=>t(e,n,r)):q,Gd(1),n?Nx(e):Cx(()=>new _x))}class $x{constructor(t,e){this.id=t,this.url=e}}class Mx extends $x{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Lx extends $x{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Px extends $x{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class zx extends $x{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Bx extends $x{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Vx extends $x{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wx extends $x{constructor(t,e,n,r,s){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Ux extends $x{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jx extends $x{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hx{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class qx{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Gx{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Kx{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xx{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Yx{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zx{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Qx="primary";class Jx{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function tk(t){return new Jx(t)}function ek(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function nk(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const s={};for(let i=0;i<r.length;i++){const e=r[i],n=t[i];if(e.startsWith(":"))s[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:s}}function rk(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let s;for(let i=0;i<n.length;i++)if(s=n[i],!sk(t[s],e[s]))return!1;return!0}function sk(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((t,e)=>r[e]===t)}return t===e}function ik(t){return Array.prototype.concat.apply([],t)}function ak(t){return t.length>0?t[t.length-1]:null}function ok(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function lk(t){return ro(t)?t:no(t)?ht(Promise.resolve(t)):Uh(t)}function uk(t,e,n){return n?function(t,e){return rk(t,e)}(t.queryParams,e.queryParams)&&ck(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>sk(t[n],e[n]))}(t.queryParams,e.queryParams)&&hk(t.root,e.root)}function ck(t,e){if(!gk(t.segments,e.segments))return!1;if(t.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children){if(!t.children[n])return!1;if(!ck(t.children[n],e.children[n]))return!1}return!0}function hk(t,e){return dk(t,e,e.segments)}function dk(t,e,n){if(t.segments.length>n.length)return!!gk(t.segments.slice(0,n.length),n)&&!e.hasChildren();if(t.segments.length===n.length){if(!gk(t.segments,n))return!1;for(const n in e.children){if(!t.children[n])return!1;if(!hk(t.children[n],e.children[n]))return!1}return!0}{const r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!gk(t.segments,r)&&!!t.children.primary&&dk(t.children.primary,e,s)}}class pk{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tk(this.queryParams)),this._queryParamMap}toString(){return wk.serialize(this)}}class fk{constructor(t,e){this.segments=t,this.children=e,this.parent=null,ok(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return _k(this)}}class mk{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=tk(this.parameters)),this._parameterMap}toString(){return Tk(this)}}function gk(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function yk(t,e){let n=[];return ok(t.children,(t,r)=>{r===Qx&&(n=n.concat(e(t,r)))}),ok(t.children,(t,r)=>{r!==Qx&&(n=n.concat(e(t,r)))}),n}class bk{}class vk{parse(t){const e=new Dk(t);return new pk(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${"/"+xk(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${Sk(e)}=${Sk(t)}`).join("&"):`${Sk(e)}=${Sk(n)}`});return e.length?"?"+e.join("&"):""}(t.queryParams)}${"string"==typeof t.fragment?"#"+encodeURI(t.fragment):""}`}}const wk=new vk;function _k(t){return t.segments.map(t=>Tk(t)).join("/")}function xk(t,e){if(!t.hasChildren())return _k(t);if(e){const e=t.children.primary?xk(t.children.primary,!1):"",n=[];return ok(t.children,(t,e)=>{e!==Qx&&n.push(`${e}:${xk(t,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=yk(t,(e,n)=>n===Qx?[xk(t.children.primary,!1)]:[`${n}:${xk(e,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children.primary?`${_k(t)}/${e[0]}`:`${_k(t)}/(${e.join("//")})`}}function kk(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Sk(t){return kk(t).replace(/%3B/gi,";")}function Ck(t){return kk(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ik(t){return decodeURIComponent(t)}function Ek(t){return Ik(t.replace(/\+/g,"%20"))}function Tk(t){return`${Ck(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Ck(t)}=${Ck(e[t])}`).join("")}`;var e}const Nk=/^[^\/()?;=#]+/;function Ak(t){const e=t.match(Nk);return e?e[0]:""}const Rk=/^[^=?&#]+/,Ok=/^[^?&#]+/;class Dk{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new fk([],{}):new fk([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new fk(t,e)),n}parseSegment(){const t=Ak(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new mk(Ik(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Ak(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=Ak(this.remaining);t&&(n=t,this.capture(n))}t[Ik(e)]=Ik(n)}parseQueryParam(t){const e=function(t){const e=t.match(Rk);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Ok);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const r=Ek(e),s=Ek(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(e=[e],t[r]=e),e.push(s)}else t[r]=s}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Ak(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s=void 0;n.indexOf(":")>-1?(s=n.substr(0,n.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=Qx);const i=this.parseChildren();e[s]=1===Object.keys(i).length?i.primary:new fk([],i),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Fk{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=$k(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=$k(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Mk(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Mk(t,this._root).map(t=>t.value)}}function $k(t,e){if(t===e.value)return e;for(const n of e.children){const e=$k(t,n);if(e)return e}return null}function Mk(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Mk(t,n);if(r.length)return r.unshift(e),r}return[]}class Lk{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Pk(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class zk extends Fk{constructor(t,e){super(t),this.snapshot=e,Hk(this,t)}toString(){return this.snapshot.toString()}}function Bk(t,e){const n=function(t,e){const n=new Uk([],{},{},"",{},Qx,e,null,t.root,-1,{});return new jk("",new Lk(n,[]))}(t,e),r=new fx([new mk("",{})]),s=new fx({}),i=new fx({}),a=new fx({}),o=new fx(""),l=new Vk(r,s,a,o,i,Qx,e,n.root);return l.snapshot=n.root,new zk(new Lk(l,[]),n)}class Vk{constructor(t,e,n,r,s,i,a,o){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=i,this.component=a,this._futureSnapshot=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(et(t=>tk(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(et(t=>tk(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Wk(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Uk{constructor(t,e,n,r,s,i,a,o,l,u,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=i,this.component=a,this.routeConfig=o,this._urlSegment=l,this._lastPathIndex=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=tk(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tk(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class jk extends Fk{constructor(t,e){super(e),this.url=t,Hk(this,e)}toString(){return qk(this._root)}}function Hk(t,e){e.value._routerState=t,e.children.forEach(e=>Hk(t,e))}function qk(t){const e=t.children.length>0?` { ${t.children.map(qk).join(", ")} } `:"";return`${t.value}${e}`}function Gk(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,rk(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),rk(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!rk(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),rk(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Kk(t,e){var n,r;return rk(t.params,e.params)&&gk(n=t.url,r=e.url)&&n.every((t,e)=>rk(t.parameters,r[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||Kk(t.parent,e.parent))}function Xk(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const s=function(t,e,n){return e.children.map(e=>{for(const r of n.children)if(t.shouldReuseRoute(e.value,r.value.snapshot))return Xk(t,e,r);return Xk(t,e)})}(t,e,n);return new Lk(r,s)}{const n=t.retrieve(e.value);if(n){const t=n.route;return Yk(e,t),t}{const n=new Vk(new fx((r=e.value).url),new fx(r.params),new fx(r.queryParams),new fx(r.fragment),new fx(r.data),r.outlet,r.component,r),s=e.children.map(e=>Xk(t,e));return new Lk(n,s)}}var r}function Yk(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)Yk(t.children[n],e.children[n])}function Zk(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Qk(t){return"object"==typeof t&&null!=t&&t.outlets}function Jk(t,e,n,r,s){let i={};return r&&ok(r,(t,e)=>{i[e]=Array.isArray(t)?t.map(t=>""+t):""+t}),new pk(n.root===t?e:tS(n.root,t,e),i,s)}function tS(t,e,n){const r={};return ok(t.children,(t,s)=>{r[s]=t===e?n:tS(t,e,n)}),new fk(t.segments,r)}class eS{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&Zk(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(Qk);if(r&&r!==ak(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class nS{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function rS(t,e,n){if(t||(t=new fk([],{})),0===t.segments.length&&t.hasChildren())return sS(t,e,n);const r=function(t,e,n){let r=0,s=e;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<t.segments.length;){if(r>=n.length)return i;const e=t.segments[s],a=n[r];if(Qk(a))break;const o=""+a,l=r<n.length-1?n[r+1]:null;if(s>0&&void 0===o)break;if(o&&l&&"object"==typeof l&&void 0===l.outlets){if(!lS(o,l,e))return i;r+=2}else{if(!lS(o,{},e))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(t,e,n),s=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new fk(t.segments.slice(0,r.pathIndex),{});return e.children.primary=new fk(t.segments.slice(r.pathIndex),t.children),sS(e,0,s)}return r.match&&0===s.length?new fk(t.segments,{}):r.match&&!t.hasChildren()?iS(t,e,n):r.match?sS(t,0,s):iS(t,e,n)}function sS(t,e,n){if(0===n.length)return new fk(t.segments,{});{const r=function(t){return Qk(t[0])?t[0].outlets:{[Qx]:t}}(n),s={};return ok(r,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(s[r]=rS(t.children[r],e,n))}),ok(t.children,(t,e)=>{void 0===r[e]&&(s[e]=t)}),new fk(t.segments,s)}}function iS(t,e,n){const r=t.segments.slice(0,e);let s=0;for(;s<n.length;){const i=n[s];if(Qk(i)){const t=aS(i.outlets);return new fk(r,t)}if(0===s&&Zk(n[0])){r.push(new mk(t.segments[e].path,n[0])),s++;continue}const a=Qk(i)?i.outlets.primary:""+i,o=s<n.length-1?n[s+1]:null;a&&o&&Zk(o)?(r.push(new mk(a,oS(o))),s+=2):(r.push(new mk(a,{})),s++)}return new fk(r,{})}function aS(t){const e={};return ok(t,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=iS(new fk([],{}),0,t))}),e}function oS(t){const e={};return ok(t,(t,n)=>e[n]=""+t),e}function lS(t,e,n){return t==n.path&&rk(e,n.parameters)}class uS{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),Gk(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=Pk(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),ok(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,s=e?e.value:null;if(r===s)if(r.component){const s=n.getContext(r.outlet);s&&this.deactivateChildRoutes(t,e,s.children)}else this.deactivateChildRoutes(t,e,n);else s&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=Pk(t),s=t.value.component?n.children:e;ok(r,(t,e)=>this.deactivateRouteAndItsChildren(t,s)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=Pk(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new Yx(t.value.snapshot))}),t.children.length&&this.forwardEvent(new Kx(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,s=e?e.value:null;if(Gk(r),r===s)if(r.component){const s=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,s.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),cS(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),s=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=s,e.outlet&&e.outlet.activateWith(r,s),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function cS(t){Gk(t.value),t.children.forEach(cS)}class hS{constructor(t,e){this.routes=t,this.module=e}}function dS(t){return"function"==typeof t}function pS(t){return t instanceof pk}const fS=Symbol("INITIAL_VALUE");function mS(){return fd(t=>function(...t){let e=void 0,n=void 0;return tt(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&L(t[0])&&(t=t[0]),vt(t,n).lift(new vx(e))}(...t.map(t=>t.pipe(Gd(1),pd(fS)))).pipe(function(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Ox(t,e,n))}}((t,e)=>{let n=!1;return e.reduce((t,r,s)=>{if(t!==fS)return t;if(r===fS&&(n=!0),!n){if(!1===r)return r;if(s===e.length-1||pS(r))return r}return t},t)},fS),id(t=>t!==fS),et(t=>pS(t)?t:!0===t),Gd(1)))}let gS=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=fe({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&Qa(0,"router-outlet")},directives:function(){return[lC]},encapsulation:2}),t})();function yS(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];bS(r,vS(e,r))}}function bS(t,e){t.children&&yS(t.children,e)}function vS(t,e){return e?t||e.path?t&&!e.path?t+"/":!t&&e.path?e.path:`${t}/${e.path}`:"":t}function wS(t){const e=t.children&&t.children.map(wS),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Qx&&(n.component=gS),n}function _S(t){return t.outlet||Qx}class xS{constructor(t){this.segmentGroup=t||null}}class kS{constructor(t){this.urlTree=t}}function SS(t){return new G(e=>e.error(new xS(t)))}function CS(t){return new G(e=>e.error(new kS(t)))}function IS(t){return new G(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class ES{constructor(t,e,n,r,s){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(Pl)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,Qx).pipe(et(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ny(t=>{if(t instanceof kS)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof xS)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Qx).pipe(et(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(Ny(t=>{if(t instanceof xS)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new fk([],{[Qx]:t}):t;return new pk(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(et(t=>new fk([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return Uh({});const n=[],r=[],s={};return ok(t,(t,i)=>{const a=e(i,t).pipe(et(t=>s[i]=t));i===Qx?n.push(a):r.push(a)}),Uh.apply(null,n.concat(r)).pipe(hd(),function(t,e){const n=arguments.length>=2;return r=>r.pipe(t?id((e,n)=>t(e,n,r)):q,xx(1),n?Nx(e):Cx(()=>new _x))}(),et(()=>s))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,s,i){const a=function(t){return t.reduce((t,e)=>{const n=_S(e);return t.has(n)?t.get(n).push(e):t.set(n,[e]),t},new Map)}(n);a.has(s)||a.set(s,[]);const o=n=>ht(n).pipe($y(a=>this.expandSegmentAgainstRoute(t,e,n,a,r,s,i).pipe(Ny(t=>{if(t instanceof xS)return Uh(null);throw t}))),Fx(t=>null!==t),Ny(t=>{if(t instanceof _x||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,s))return Uh(new fk([],{}));throw new xS(e)}throw t}));return ht(Array.from(a.entries()).map(([t,e])=>{const n=o(e);return t===s?n:n.pipe(et(()=>null),Ny(()=>Uh(null)))})).pipe(t=>t.lift(new vx(void 0)),Fx(),et(t=>t.find(t=>null!==t)))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,s,i,a){return _S(r)!==i&&""!==r.path?SS(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,s):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,s,i):SS(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,s,i){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,i):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,s,i)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?CS(s):this.lineralizeSegments(n,s).pipe(mt(n=>{const s=new fk(n,{});return this.expandSegment(t,s,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,s,i){const{matched:a,consumedSegments:o,lastChild:l,positionalParamSegments:u}=TS(e,r,s);if(!a)return SS(e);const c=this.applyRedirectCommands(o,r.redirectTo,u);return r.redirectTo.startsWith("/")?CS(c):this.lineralizeSegments(r,c).pipe(mt(r=>this.expandSegment(t,e,n,r.concat(s.slice(l)),i,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(et(t=>(n._loadedConfig=t,new fk(r,{})))):Uh(new fk(r,{}));const{matched:s,consumedSegments:i,lastChild:a}=TS(e,n,r);if(!s)return SS(e);const o=r.slice(a);return this.getChildConfig(t,n,r).pipe(mt(t=>{const n=t.module,r=t.routes,{segmentGroup:s,slicedSegments:a}=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some(n=>AS(t,e,n)&&_S(n)!==Qx)}(t,n,r)?{segmentGroup:NS(new fk(e,function(t,e){const n={};n.primary=e;for(const r of t)""===r.path&&_S(r)!==Qx&&(n[_S(r)]=new fk([],{}));return n}(r,new fk(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some(n=>AS(t,e,n))}(t,n,r)?{segmentGroup:NS(new fk(t.segments,function(t,e,n,r){const s={};for(const i of n)AS(t,e,i)&&!r[_S(i)]&&(s[_S(i)]=new fk([],{}));return Object.assign(Object.assign({},r),s)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,i,o,r);return 0===a.length&&s.hasChildren()?this.expandChildren(n,r,s).pipe(et(t=>new fk(i,t))):0===r.length&&0===a.length?Uh(new fk(i,{})):this.expandSegment(n,s,r,a,Qx,!0).pipe(et(t=>new fk(i.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Uh(new hS(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Uh(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe(mt(n=>n?this.configLoader.load(t.injector,e).pipe(et(t=>(e._loadedConfig=t,t))):function(t){return new G(e=>e.error(ek(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Uh(new hS([],t))}runCanLoadGuards(t,e,n){const r=e.canLoad;return r&&0!==r.length?Uh(r.map(r=>{const s=t.get(r);let i;if(function(t){return t&&dS(t.canLoad)}(s))i=s.canLoad(e,n);else{if(!dS(s))throw new Error("Invalid CanLoad guard");i=s(e,n)}return lk(i)})).pipe(mS(),zd(t=>{if(!pS(t))return;const e=ek(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),et(t=>!0===t)):Uh(!0)}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Uh(n);if(r.numberOfChildren>1||!r.children.primary)return IS(t.redirectTo);r=r.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const s=this.createSegmentGroup(t,e.root,n,r);return new pk(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return ok(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const s=t.substring(1);n[r]=e[s]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const s=this.createSegments(t,e.segments,n,r);let i={};return ok(e.children,(e,s)=>{i[s]=this.createSegmentGroup(t,e,n,r)}),new fk(s,i)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function TS(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||nk)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function NS(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new fk(t.segments.concat(e.segments),e.children)}return t}function AS(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}class RS{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class OS{constructor(t,e){this.component=t,this.route=e}}function DS(t,e,n){const r=t._root;return $S(r,e?e._root:null,n,[r.value])}function FS(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function $S(t,e,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=Pk(e);return t.children.forEach(t=>{!function(t,e,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=t.value,a=e?e.value:null,o=n?n.getContext(t.value.outlet):null;if(a&&i.routeConfig===a.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!gk(t.url,e.url);case"pathParamsOrQueryParamsChange":return!gk(t.url,e.url)||!rk(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Kk(t,e)||!rk(t.queryParams,e.queryParams);case"paramsChange":default:return!Kk(t,e)}}(a,i,i.routeConfig.runGuardsAndResolvers);l?s.canActivateChecks.push(new RS(r)):(i.data=a.data,i._resolvedData=a._resolvedData),$S(t,e,i.component?o?o.children:null:n,r,s),l&&o&&o.outlet&&o.outlet.isActivated&&s.canDeactivateChecks.push(new OS(o.outlet.component,a))}else a&&MS(e,o,s),s.canActivateChecks.push(new RS(r)),$S(t,null,i.component?o?o.children:null:n,r,s)}(t,i[t.value.outlet],n,r.concat([t.value]),s),delete i[t.value.outlet]}),ok(i,(t,e)=>MS(t,n.getContext(e),s)),s}function MS(t,e,n){const r=Pk(t),s=t.value;ok(r,(t,r)=>{MS(t,s.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new OS(s.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,s))}function LS(t,e){return null!==t&&e&&e(new Xx(t)),Uh(!0)}function PS(t,e){return null!==t&&e&&e(new Gx(t)),Uh(!0)}function zS(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Uh(r.map(r=>F_(()=>{const s=FS(r,e,n);let i;if(function(t){return t&&dS(t.canActivate)}(s))i=lk(s.canActivate(e,t));else{if(!dS(s))throw new Error("Invalid CanActivate guard");i=lk(s(e,t))}return i.pipe(Fx())}))).pipe(mS()):Uh(!0)}function BS(t,e,n){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>F_(()=>Uh(e.guards.map(s=>{const i=FS(s,e.node,n);let a;if(function(t){return t&&dS(t.canActivateChild)}(i))a=lk(i.canActivateChild(r,t));else{if(!dS(i))throw new Error("Invalid CanActivateChild guard");a=lk(i(r,t))}return a.pipe(Fx())})).pipe(mS())));return Uh(s).pipe(mS())}class VS{}class WS{constructor(t,e,n,r,s,i){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=i}recognize(){try{const t=HS(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,Qx),n=new Uk([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Qx,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Lk(n,e),s=new jk(this.url,r);return this.inheritParamsAndData(s._root),Uh(s)}catch(t){return new G(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,n=Wk(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=yk(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};t.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(n),n.sort((t,e)=>t.value.outlet===Qx?-1:e.value.outlet===Qx?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const i of t)try{return this.processSegmentAgainstRoute(i,e,n,r)}catch(s){if(!(s instanceof VS))throw s}if(this.noLeftoversInUrl(e,n,r))return[];throw new VS}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new VS;if((t.outlet||Qx)!==r)throw new VS;let s,i=[],a=[];if("**"===t.path){const i=n.length>0?ak(n).parameters:{};s=new Uk(n,i,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,GS(t),r,t.component,t,US(e),jS(e)+n.length,KS(t))}else{const o=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new VS;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||nk)(n,t,e);if(!r)throw new VS;const s={};ok(r.posParams,(t,e)=>{s[e]=t.path});const i=r.consumed.length>0?Object.assign(Object.assign({},s),r.consumed[r.consumed.length-1].parameters):s;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:i}}(e,t,n);i=o.consumedSegments,a=n.slice(o.lastChild),s=new Uk(i,o.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,GS(t),r,t.component,t,US(e),jS(e)+i.length,KS(t))}const o=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:u}=HS(e,i,a,o,this.relativeLinkResolution);if(0===u.length&&l.hasChildren()){const t=this.processChildren(o,l);return[new Lk(s,t)]}if(0===o.length&&0===u.length)return[new Lk(s,[])];const c=this.processSegment(o,l,u,Qx);return[new Lk(s,c)]}}function US(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function jS(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function HS(t,e,n,r,s){if(n.length>0&&function(t,e,n){return n.some(n=>qS(t,e,n)&&_S(n)!==Qx)}(t,n,r)){const s=new fk(e,function(t,e,n,r){const s={};s.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const i of n)if(""===i.path&&_S(i)!==Qx){const n=new fk([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,s[_S(i)]=n}return s}(t,e,r,new fk(n,t.children)));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>qS(t,e,n))}(t,n,r)){const i=new fk(t.segments,function(t,e,n,r,s,i){const a={};for(const o of r)if(qS(t,n,o)&&!s[_S(o)]){const n=new fk([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===i?t.segments.length:e.length,a[_S(o)]=n}return Object.assign(Object.assign({},s),a)}(t,e,n,r,t.children,s));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:n}}const i=new fk(t.segments,t.children);return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:n}}function qS(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function GS(t){return t.data||{}}function KS(t){return t.resolve||{}}function XS(t){return function(e){return e.pipe(fd(e=>{const n=t(e);return n?ht(n).pipe(et(()=>e)):ht([e])}))}}class YS extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const ZS=new wr("ROUTES");class QS{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(et(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new hS(ik(r.injector.get(ZS)).map(wS),r)}))}loadModuleFactory(t){return"string"==typeof t?ht(this.loader.load(t)):lk(t()).pipe(mt(t=>t instanceof zl?Uh(t):ht(this.compiler.compileModuleAsync(t))))}}class JS{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new tC,this.attachRef=null}}class tC{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new JS,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class eC{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function nC(t){throw t}function rC(t,e,n){return e.parse("/")}function sC(t,e){return Uh(null)}let iC=(()=>{class t{constructor(t,e,n,r,s,i,a,o){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=o,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new Q,this.errorHandler=nC,this.malformedUriErrorHandler=rC,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:sC,afterPreactivation:sC},this.urlHandlingStrategy=new eC,this.routeReuseStrategy=new YS,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.ngModule=s.get(Pl),this.console=s.get(Du);const l=s.get(qu);this.isNgZoneEnabled=l instanceof qu,this.resetConfig(o),this.currentUrlTree=new pk(new fk([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new QS(i,a,t=>this.triggerEvent(new Hx(t)),t=>this.triggerEvent(new qx(t))),this.routerState=Bk(this.currentUrlTree,this.rootComponentType),this.transitions=new fx({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(id(t=>0!==t.id),et(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),fd(t=>{let n=!1,r=!1;return Uh(t).pipe(zd(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),fd(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Uh(t).pipe(fd(t=>{const n=this.transitions.getValue();return e.next(new Mx(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?yd:[t]}),fd(t=>Promise.resolve(t)),(r=this.ngModule.injector,s=this.configLoader,i=this.urlSerializer,a=this.config,function(t){return t.pipe(fd(t=>function(t,e,n,r,s){return new ES(t,e,n,r,s).apply()}(r,s,i,t.extractedUrl,a).pipe(et(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e})))))}),zd(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,s){return function(i){return i.pipe(mt(i=>function(t,e,n,r,s="emptyOnly",i="legacy"){return new WS(t,e,n,r,s,i).recognize()}(t,e,i.urlAfterRedirects,n(i.urlAfterRedirects),r,s).pipe(et(t=>Object.assign(Object.assign({},i),{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),zd(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),zd(t=>{const n=new Bx(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var r,s,i,a;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:s,restoredState:i,extras:a}=t,o=new Mx(n,this.serializeUrl(r),s,i);e.next(o);const l=Bk(r,this.rootComponentType).snapshot;return Uh(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:r,extras:Object.assign(Object.assign({},a),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),yd}),XS(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:s,extras:{skipLocationChange:i,replaceUrl:a}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:s,skipLocationChange:!!i,replaceUrl:!!a})}),zd(t=>{const e=new Vx(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),et(t=>Object.assign(Object.assign({},t),{guards:DS(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe(mt(n=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:a}}=n;return 0===a.length&&0===i.length?Uh(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return ht(t).pipe(mt(t=>function(t,e,n,r,s){const i=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return i&&0!==i.length?Uh(i.map(i=>{const a=FS(i,e,s);let o;if(function(t){return t&&dS(t.canDeactivate)}(a))o=lk(a.canDeactivate(t,e,n,r));else{if(!dS(a))throw new Error("Invalid CanDeactivate guard");o=lk(a(t,e,n,r))}return o.pipe(Fx())})).pipe(mS()):Uh(!0)}(t.component,t.route,n,e,r)),Fx(t=>!0!==t,!0))}(a,r,s,t).pipe(mt(n=>n&&"boolean"==typeof n?function(t,e,n,r){return ht(e).pipe($y(e=>ht([PS(e.route.parent,r),LS(e.route,r),BS(t,e.path,n),zS(t,e.route,n)]).pipe(hd(),Fx(t=>!0!==t,!0))),Fx(t=>!0!==t,!0))}(r,i,t,e):Uh(n)),et(t=>Object.assign(Object.assign({},n),{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),zd(t=>{if(pS(t.guardsResult)){const e=ek(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),zd(t=>{const e=new Wx(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),id(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new Px(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),XS(t=>{if(t.guards.canActivateChecks.length)return Uh(t).pipe(zd(t=>{const e=new Ux(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),fd(t=>{let n=!1;return Uh(t).pipe((r=this.paramsInheritanceStrategy,s=this.ngModule.injector,function(t){return t.pipe(mt(t=>{const{targetSnapshot:e,guards:{canActivateChecks:n}}=t;if(!n.length)return Uh(t);let i=0;return ht(n).pipe($y(t=>function(t,e,n,r){return function(t,e,n,r){const s=Object.keys(t);if(0===s.length)return Uh({});const i={};return ht(s).pipe(mt(s=>function(t,e,n,r){const s=FS(t,e,r);return lk(s.resolve?s.resolve(e,n):s(e,n))}(t[s],e,n,r).pipe(zd(t=>{i[s]=t}))),xx(1),mt(()=>Object.keys(i).length===s.length?Uh(i):yd))}(t._resolve,t,e,r).pipe(et(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Wk(t,n).resolve),null)))}(t.route,e,r,s)),zd(()=>i++),xx(1),mt(e=>i===n.length?Uh(t):yd))}))}),zd({next:()=>n=!0,complete:()=>{if(!n){const n=new Px(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(n),t.resolve(!1)}}}));var r,s}),zd(t=>{const e=new jx(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),XS(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:s,extras:{skipLocationChange:i,replaceUrl:a}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:s,skipLocationChange:!!i,replaceUrl:!!a})}),et(t=>{const e=function(t,e,n){const r=Xk(t,e._root,n?n._root:void 0);return new zk(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),zd(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(s=this.rootContexts,i=this.routeReuseStrategy,a=t=>this.triggerEvent(t),et(t=>(new uS(i,t.targetRouterState,t.currentRouterState,a).activate(s),t))),zd({next(){n=!0},complete(){n=!0}}),Oy(()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new Px(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null}),Ny(n=>{if(r=!0,(s=n)&&s.ngNavigationCancelingError){const r=pS(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const s=new Px(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(s),r?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);return this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new zx(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(i){t.reject(i)}}var s;return yd}));var s,i,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:n,urlTree:r}=e,s={replaceUrl:!0};if(n){const t=Object.assign({},n);delete t.navigationId,0!==Object.keys(t).length&&(s.state=t)}this.scheduleNavigation(r,t,n,s)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const n=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&n&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){yS(t),this.config=t.map(wS),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:s,queryParamsHandling:i,preserveFragment:a}=e,o=n||this.routerState.root,l=a?this.currentUrlTree.fragment:s;let u=null;switch(i){case"merge":u=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=r||null}return null!==u&&(u=this.removeEmptyProps(u)),function(t,e,n,r,s){if(0===n.length)return Jk(e.root,e.root,e,r,s);const i=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new eS(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,s)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return ok(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===s?(r.split("/").forEach((r,s)=>{0==s&&"."===r||(0==s&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new eS(n,e,r)}(n);if(i.toRoot())return Jk(e.root,new fk([],{}),e,r,s);const a=function(t,e,n){if(t.isAbsolute)return new nS(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new nS(t,t===e.root,0)}const r=Zk(t.commands[0])?0:1;return function(t,e,n){let r=t,s=e,i=n;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Error("Invalid number of '../'");s=r.segments.length}return new nS(r,!1,s-i)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(i,e,t),o=a.processChildren?sS(a.segmentGroup,a.index,i.commands):rS(a.segmentGroup,a.index,i.commands);return Jk(a.segmentGroup,o,e,r,s)}(o,this.currentUrlTree,t,u,l)}navigateByUrl(t,e={skipLocationChange:!1}){const n=pS(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(pS(t))return uk(this.currentUrlTree,t,e);const n=this.parseUrl(t);return uk(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Lx(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r,s){const i=this.getTransition(),a="imperative"!==e&&"imperative"===(null==i?void 0:i.source),o=(this.lastSuccessfulId===i.id||this.currentNavigation?i.rawUrl:i.urlAfterRedirects).toString()===t.toString();if(a&&o)return Promise.resolve(!0);let l,u,c;s?(l=s.resolve,u=s.reject,c=s.promise):c=new Promise((t,e)=>{l=t,u=e});const h=++this.navigationId;return this.setTransition({id:h,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:l,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const s=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(s)||e?this.location.replaceState(s,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(s,"",Object.assign(Object.assign({},r),{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(Wr(xr),Wr(bk),Wr(tC),Wr(Bc),Wr(Ra),Wr(mc),Wr(Uu),Wr(void 0))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),aC=(()=>{class t{constructor(t,e,n){this.router=t,this.route=e,this.locationStrategy=n,this.commands=[],this.onChanges=new Q,this.subscription=t.events.subscribe(t=>{t instanceof Lx&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,n,r,s){if(0!==t||e||n||r||s)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const i={skipLocationChange:oC(this.skipLocationChange),replaceUrl:oC(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,i),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:oC(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(Ga(iC),Ga(Vk),Ga($c))},t.\u0275dir=we({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&so("click",function(t){return e.onClick(t.button,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)}),2&t&&(Mo("href",e.href,Cs),Ua("target",e.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[Le]}),t})();function oC(t){return""===t||!!t}let lC=(()=>{class t{constructor(t,e,n,r,s){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new nu,this.deactivateEvents=new nu,this.name=r||Qx,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,s=new uC(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,s),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(Ga(tC),Ga(Vl),Ga(nl),yr("name"),Ga(Nl))},t.\u0275dir=we({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class uC{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Vk?this.route:t===tC?this.childContexts:this.parent.get(t,e)}}class cC{}class hC{preload(t,e){return Uh(null)}}let dC=(()=>{class t{constructor(t,e,n,r,s){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=new QS(e,n,e=>t.triggerEvent(new Hx(e)),e=>t.triggerEvent(new qx(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(id(t=>t instanceof Lx),$y(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Pl);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return ht(n).pipe(bt(),et(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(mt(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(Wr(iC),Wr(mc),Wr(Uu),Wr(Ra),Wr(cC))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})(),pC=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Mx?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Lx&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Zx&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new Zx(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Wr(iC),Wr(ih),Wr(void 0))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();const fC=new wr("ROUTER_CONFIGURATION"),mC=new wr("ROUTER_FORROOT_GUARD"),gC=[Bc,{provide:bk,useClass:vk},{provide:iC,useFactory:function(t,e,n,r,s,i,a,o={},l,u){const c=new iC(null,t,e,n,r,s,i,ik(a));if(l&&(c.urlHandlingStrategy=l),u&&(c.routeReuseStrategy=u),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(o,c),o.enableTracing){const t=Sc();c.events.subscribe(e=>{t.logGroup("Router Event: "+e.constructor.name),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return c},deps:[bk,tC,Bc,Ra,mc,Uu,ZS,fC,[class{},new Or],[class{},new Or]]},tC,{provide:Vk,useFactory:function(t){return t.routerState.root},deps:[iC]},{provide:mc,useClass:bc},dC,hC,class{preload(t,e){return e().pipe(Ny(()=>Uh(null)))}},{provide:fC,useValue:{enableTracing:!1}}];function yC(){return new lc("Router",iC)}let bC=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[gC,xC(e),{provide:mC,useFactory:_C,deps:[[iC,new Or,new Fr]]},{provide:fC,useValue:n||{}},{provide:$c,useFactory:wC,deps:[Ic,[new Rr(Lc),new Or],fC]},{provide:pC,useFactory:vC,deps:[iC,ih,fC]},{provide:cC,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:hC},{provide:lc,multi:!0,useFactory:yC},[kC,{provide:Cu,multi:!0,useFactory:SC,deps:[kC]},{provide:IC,useFactory:CC,deps:[kC]},{provide:Ou,multi:!0,useExisting:IC}]]}}static forChild(e){return{ngModule:t,providers:[xC(e)]}}}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)(Wr(mC,8),Wr(iC,8))}}),t})();function vC(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new pC(t,e,n)}function wC(t,e,n={}){return n.useHash?new zc(t,e):new Pc(t,e)}function _C(t){return"guarded"}function xC(t){return[{provide:_r,multi:!0,useValue:t},{provide:ZS,multi:!0,useValue:t}]}let kC=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new Q}appInitializer(){return this.injector.get(Tc,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(iC),r=this.injector.get(fC);return"disabled"===r.initialNavigation?(n.setUpLocationChangeListener(),t(!0)):"enabled"===r.initialNavigation||"enabledBlocking"===r.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?Uh(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()):t(!0),e})}bootstrapListener(t){const e=this.injector.get(fC),n=this.injector.get(dC),r=this.injector.get(pC),s=this.injector.get(iC),i=this.injector.get(pc);t===i.components[0]&&("enabledNonBlocking"!==e.initialNavigation&&void 0!==e.initialNavigation||s.initialNavigation(),n.setUpPreloading(),r.init(),s.resetRootComponentType(i.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return t.\u0275fac=function(e){return new(e||t)(Wr(Ra))},t.\u0275prov=Lt({token:t,factory:t.\u0275fac}),t})();function SC(t){return t.appInitializer.bind(t)}function CC(t){return t.bootstrapListener.bind(t)}const IC=new wr("Router Initializer");function EC(t,e,n,r){return new(n||(n=Promise))(function(s,i){function a(t){try{l(r.next(t))}catch(e){i(e)}}function o(t){try{l(r.throw(t))}catch(e){i(e)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,o)}l((r=r.apply(t,e||[])).next())})}var TC=n("/axO"),NC=n.n(TC);class AC{constructor(){this.data=[]}}class RC{constructor(){this.data=[]}}class OC{}var DC=function(t){return t[t.Started=0]="Started",t[t.Completed=1]="Completed",t[t.Error=2]="Error",t}({});class FC{constructor(t){this.status=t}}let $C=(()=>{class t{constructor(){this.rootkey="sqldbv1.",this.setkey="sqldbv1._list",this.wasm="worker.sql-wasm.js",this.apple_query="SELECT name FROM sqlite_master WHERE type='table' AND name in ('chat','message','handle');",this.apple_response=[{columns:["name"],values:[["handle"],["message"],["chat"]]}],this.platform={APPLE:"apple",ANDROID:"android",UNKNOWN:"unknown"},this.workers={},this.subject=new fx([]),this.chats_subject=new fx(new AC),this.messages_subject=new fx(new RC),this.genericdata_subject=new fx(new OC),this.workerstatus_subject=new fx(new FC(DC.Completed)),this.share=this.subject.asObservable(),this.chat_share=this.chats_subject.asObservable(),this.message_share=this.messages_subject.asObservable(),this.genericdata_share=this.genericdata_subject.asObservable(),this.workerstatus_share=this.workerstatus_subject.asObservable(),this.appleQuery=(function(t,e){const n=this.workers[t.toString()];JSON.stringify(e)===JSON.stringify(this.apple_response)?(n.type=this.platform.APPLE,this.subject.next(this.list())):n.type=this.platform.UNKNOWN}).bind(this),this.chatQuery="select   datetime(message.date / 1000000000 + strftime ('%s', '2001-01-01'), 'unixepoch', 'localtime') as date,                                        handle.id as id,                                        is_from_me,                                        text                                      from                                        message,                                        handle where message.handle_id = handle.ROWID                                        and                                          ((message.cache_roomnames = '{0}')                                          OR                                          ( message.cache_roomnames is null and handle.id='{0}'))                                      ORDER by date ASC",this.chatsQuery="select 'groups' as type,                                cache_roomnames as id,                                datetime(max(date) / 1000000000 + strftime ('%s', '2001-01-01'), 'unixepoch', 'localtime') as most_recent_message,                                chat.display_name as subject,                                group_concat(DISTINCT handle.id ) as participants                                FROM                                    message, chat, chat_handle_join, handle                                WHERE                                    cache_roomnames == chat.chat_identifier                                    AND                                    chat_handle_join.chat_id == chat.rowid                                    AND                                    handle.rowid == chat_handle_join.handle_id                                GROUP BY                                    cache_roomnames                              union                              select 'group' as type,                                handle.id as id,                                datetime(max(date) / 1000000000 + strftime ('%s', '2001-01-01'), 'unixepoch', 'localtime') as most_recent_message,                                '' as subject,                                handle.id as participants                                FROM                                    message,                                    handle                                WHERE                                    cache_roomnames IS NULL                                    AND                                    handle_id is handle.ROWID                                GROUP BY                                    handle_id                                ORDER BY                                    most_recent_message DESC",console.log("AppComponent:constructor"),this.loadWASM(this)}loadWASM(t){return EC(this,void 0,void 0,function*(){console.log("AppComponent:loadWASM start"),t.sql=yield NC()(),console.log("AppComponent:loadWASM end")})}getDBSetFromLocalStorage(){console.log("AppComponent:getDBSetFromLocalStorage start");var t=localStorage.getItem(this.setkey.toString()),e=new Set;return null!=t&&(e=JSON.parse(t)),console.log("AppComponent:getDBSetFromLocalStorage end"),e}reloadFromLocalStorage(t){console.log("AppComponent:reloadFromLocalStorage start");var e=this.getDBSetFromLocalStorage();if(e){for(let r of e){var n=this.rootkey.toString()+r.toString();const e=JSON.parse(localStorage.getItem(n.toString()));this.open(r.toString(),e,t)}console.log("AppComponent:reloadFromLocalStorage end")}}getChat(t,e,n){console.log("AppComponent:getChats start");const r=this;this.exec(t,this.chatQuery.replace(/\{0\}/g,e.toString()),function(t,e){if(0==e.length)return void r.workerstatus_subject.next(new FC(DC.Error));const n=e[0].values;var s=new RC;for(let r in n){var i={date:new Date(n[r][0]),id:Number(n[r][1]),from_me:Boolean(n[r][2]),text:n[r][3]};s.data.push(i)}r.messages_subject.next(s)}),console.log("AppComponent:getChats end")}getChats(t,e,n,r){console.log("AppComponent:getChats start");const s=this;this.exec(t,this.chatsQuery,function(t,e){const n=e[0].values;var r=new AC;for(let s in n){var i={type:n[s][0],id:String(n[s][1]),most_recent_message:n[s][2],subject:n[s][3],participants:String(n[s][4]).split(",")};r.data.push(i)}s.chats_subject.next(r)}),console.log("AppComponent:getChats end")}exec(t,e,n){if(null==t)return!1;if(!(t.toString()in this.workers))return console.log("AppComponent:getDBSetFromLocalStorage exec failed to find worker "+t),!1;const r=this.workers[t.toString()].worker,s=this;r.onmessage=function(e){s.workerstatus_subject.next(new FC(DC.Completed));var r=e.data.results;return r?(n(t,r),!0):(console.log("AppComponent:exec Error "+e.data.error),!1)},r.onerror=r.onmessageerror=r.onerror=function(){s.workerstatus_subject.next(new FC(DC.Error))},s.workerstatus_subject.next(new FC(DC.Started));try{r.postMessage({action:"exec",sql:e})}catch(i){return s.workerstatus_subject.next(new FC(DC.Error)),!1}return console.log("AppComponent:exec Getting results"),!0}list(){return Object.keys(this.workers)}persist(){var t=this.getDBSetFromLocalStorage();for(const n in this.workers)t.add(n),localStorage.setItem(this.rootkey+n.toString(),JSON.stringify(this.workers[n]));var e=JSON.stringify(t);localStorage.setItem(this.setkey.toString(),e)}open(t,e,n){this.workers[t.toString()]={worker:new Worker(this.wasm.toString()),type:null};const r=this.workers[t.toString()].worker,s=this;r.onmessage=function(){s.workerstatus_subject.next(new FC(DC.Completed)),s.exec(t,s.apple_query,s.appleQuery),n(t)},r.onerror=r.onmessageerror=r.onerror=function(){s.workerstatus_subject.next(new FC(DC.Error))},s.workerstatus_subject.next(new FC(DC.Started));try{r.postMessage({action:"open",buffer:e},[e])}catch(i){r.postMessage({action:"open",buffer:e})}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({token:t,factory:t.\u0275fac,providedIn:"any"}),t})();function MC(t,e){if(1&t&&(Ya(0,"mat-option",19),Do(1),Za()),2&t){const t=e.$implicit;Ka("value",t.value),vi(1),$o(" ",t.viewValue," ")}}let LC=(()=>{class t{constructor(t){this.dbservice=t,this.title="referee",this.sources=[],this.progress_bar_determinate="determinate",this.progress_bar_value=100,this.selected=null,this.db_change_subject=new fx(this.selected),this.db_change_share=this.db_change_subject.asObservable(),this.gotData=(function(t,e){}).bind(this),this.gotDB=(function(t){}).bind(this),console.log("Calling constructor"),this.dbservice.workerstatus_share.subscribe(t=>{this.progress_bar_determinate=t.status==DC.Completed?"determinate":t.status==DC.Started?"query":"indeterminate"}),this.dbservice.share.subscribe(t=>{console.log(t);for(let e in t)this.sources.push({value:t[e],viewValue:t[e]}),null===this.selected&&(this.selected=t[e],this.db_change_subject.next(this.selected))})}onDBSelectionChanged(t){console.log("AppComponent onDBSelectionChanged"),this.db_change_subject.next(this.selected)}fileAction(t){console.log("fileAction: Got: "+t);const e=t.target;if(!e.files)return void console.log("fileAction: Received event, but no files found");const n=this;for(var r=0;r<e.files.length;r++){const t=e.files.item(r);if(!t){console.log("fileAction: Unable to iterate over files");continue}const i=t.name;try{var s=new FileReader;new String("sqldb."+(null==t?void 0:t.name)),s.readAsArrayBuffer(t)}catch(xrt){console.log("fileAction: Failed to read file")}s.onloadstart=function(){console.log("fileAction: Started loading")},s.onabort=function(){console.log("fileAction: Aborted loading")},s.onprogress=function(){console.log("fileAction: Progress loading")},s.onloadend=function(){if(console.log("fileAction: Ended loading"),"string"!=typeof s.result){var t=new Uint8Array(s.result);n.dbservice.open(i,t,n.gotDB)}else console.log("fileAction: loading result is string, not array buffer ["+s.result+"]")},s.onerror=function(){console.log(s.error),alert("Error "+t.name+" "+s.readAsText)}}}}return t.\u0275fac=function(e){return new(e||t)(Ga($C))},t.\u0275cmp=fe({type:t,selectors:[["app-root"]],features:[Jo([])],decls:58,vars:8,consts:[["color","primary"],["mat-icon-button",""],[3,"click"],[1,"flexExpand"],["id","progress",2,"width","50px",3,"mode","value"],["sidenav",""],["disabled","","appearance","fill","matTooltip","Find a chat database on your computer and upload","matTooltipClass","tooltip-red",1,"source-chooser"],["placeholder","Chat Source",3,"value","valueChange","change"],[3,"value",4,"ngFor","ngForOf"],["type","file","id","file","name","file","accept",".db","multiple","",2,"display","none",3,"change"],["mat-list-item","",3,"routerLink"],[1,"home-icon"],[1,"chat-icon"],[1,"person-icon"],["mat-list-item","","onclick","document.getElementById('file').click()"],["matTooltip","Find a chat database on your computer and upload","matTooltipClass","tooltip-red",1,"chat-icon"],["matTooltip","Find a chat database on your computer and upload","matTooltipClass","tooltip-red",1,"chat-text"],["mat-list-item","","href","","mat-list-item","",3,"click"],[2,"height","88vh"],[3,"value"]],template:function(t,e){if(1&t){const t=eo();Ya(0,"mat-toolbar",0),Ya(1,"mat-toolbar-row"),Ya(2,"div"),Ya(3,"button",1),Ya(4,"mat-icon",2),so("click",function(){return ln(t),qa(14).toggle()}),Do(5,"menu"),Za(),Za(),Za(),Ya(6,"div"),Ya(7,"h1"),Do(8,"Message Referee"),Za(),Za(),Qa(9,"span",3),Ya(10,"div"),Qa(11,"mat-progress-bar",4),Za(),Za(),Za(),Ya(12,"mat-sidenav-container"),Ya(13,"mat-sidenav",null,5),Ya(15,"div"),Ya(16,"mat-form-field",6),Ya(17,"mat-label"),Do(18,"Chat Source"),Za(),Ya(19,"mat-select",7),so("valueChange",function(t){return e.selected=t})("change",function(){return e.onDBSelectionChanged}),Ha(20,MC,2,2,"mat-option",8),Za(),Za(),Za(),Ya(21,"mat-nav-list"),Ya(22,"input",9),so("change",function(t){return e.fileAction(t)}),Za(),Ya(23,"a",10),Ya(24,"mat-icon",11),Do(25,"home"),Za(),Qa(26,"span",3),Ya(27,"mat-label"),Do(28,"Home"),Za(),Za(),Ya(29,"a",10),Ya(30,"mat-icon",12),Do(31,"chat_bubble_outline"),Za(),Qa(32,"span",3),Ya(33,"mat-label"),Do(34,"Chat View"),Za(),Za(),Ya(35,"a",10),Ya(36,"mat-icon",13),Do(37,"person_search"),Za(),Qa(38,"span",3),Ya(39,"mat-label"),Do(40,"Entity View"),Za(),Za(),Ya(41,"a",10),Ya(42,"mat-icon",13),Do(43,"tag_faces"),Za(),Qa(44,"span",3),Ya(45,"mat-label"),Do(46,"Sentiment View"),Za(),Za(),Ya(47,"a",14),Ya(48,"mat-icon",15),Do(49,"cloud_upload"),Za(),Qa(50,"span",3),Ya(51,"mat-label",16),Do(52,"Load File..."),Za(),Za(),Ya(53,"a",17),so("click",function(){return ln(t),qa(14).toggle()}),Do(54,"Close"),Za(),Za(),Za(),Ya(55,"mat-sidenav-content"),Ya(56,"div",18),Qa(57,"router-outlet"),Za(),Za(),Za()}2&t&&(vi(11),Ka("mode",e.progress_bar_determinate)("value",e.progress_bar_value),vi(8),Ka("value",e.selected),vi(1),Ka("ngForOf",e.sources),vi(3),Ka("routerLink","/"),vi(6),Ka("routerLink","/chats"),vi(6),Ka("routerLink","/entities"),vi(6),Ka("routerLink","/sentiments"))},directives:[ty,Jg,zv,ub,hx,Sy,xy,O_,k_,ex,Kc,wv,Sv,aC,_y,lC,qg],styles:[".flexExpand[_ngcontent-%COMP%]{flex:1 1 auto}mat-grid-tile[_ngcontent-%COMP%]{background:#add8e6}.tooltip-red[_ngcontent-%COMP%]{background:#b71c1c}"]}),t})();class PC{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class zC{decComplexRef(t){}time(t){return BC("time")}read(t){return BC("read")}readSync(t){return BC("readSync")}numDataIds(){return BC("numDataIds")}disposeData(t){return BC("disposeData")}write(t,e,n){return BC("write")}move(t,e,n,r){return BC("move")}memory(){return BC("memory")}floatPrecision(){return BC("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}batchMatMul(t,e,n,r){return BC("batchMatMul")}fusedBatchMatMul({}){return BC("fusedBatchMatMul")}slice(t,e,n){return BC("slice")}stridedSlice(t,e,n,r){return BC("stridedSlice")}unstack(t,e){return BC("unstack")}reverse(t,e){return BC("reverse")}concat(t,e){return BC("concat")}neg(t){return BC("neg")}add(t,e){return BC("add")}addN(t){return BC("addN")}subtract(t,e){return BC("subtract")}multiply(t,e){return BC("multiply")}realDivide(t,e){return BC("realDivide")}floorDiv(t,e){return BC("floorDiv")}sum(t,e){return BC("sum")}prod(t,e){return BC("prod")}unsortedSegmentSum(t,e,n){return BC("unsortedSegmentSum")}argMin(t,e){return BC("argMin")}argMax(t,e){return BC("argMax")}equal(t,e){return BC("equal")}notEqual(t,e){return BC("notEqual")}less(t,e){return BC("less")}lessEqual(t,e){return BC("lessEqual")}greater(t,e){return BC("greater")}greaterEqual(t,e){return BC("greaterEqual")}logicalNot(t){return BC("logicalNot")}logicalAnd(t,e){return BC("logicalAnd")}logicalOr(t,e){return BC("logicalOr")}where(t){return BC("where")}select(t,e,n){return BC("select")}topk(t,e,n){return BC("topk")}min(t,e){return BC("min")}minimum(t,e){return BC("minimum")}mod(t,e){return BC("mod")}max(t,e){return BC("max")}maximum(t,e){return BC("maximum")}all(t,e){return BC("all")}any(t,e){return BC("any")}squaredDifference(t,e){return BC("squaredDifference")}ceil(t){return BC("ceil")}floor(t){return BC("floor")}round(t){return BC("round")}sign(t){return BC("sign")}isNaN(t){return BC("isNaN")}isInf(t){return BC("isInf")}isFinite(t){return BC("isFinite")}pow(t,e){return BC("pow")}exp(t){return BC("exp")}expm1(t){return BC("expm1")}softmax(t,e){return BC("softmax")}log(t){return BC("log")}log1p(t){return BC("log1p")}sqrt(t){return BC("sqrt")}rsqrt(t){return BC("rsqrt")}square(t){return BC("square")}reciprocal(t){return BC("reciprocal")}relu(t){return BC("relu")}relu6(t){return BC("relu6")}prelu(t,e){return BC("prelu")}elu(t){return BC("elu")}eluDer(t,e){return BC("eluDer")}selu(t){return BC("selu")}int(t){return BC("int")}clip(t,e,n){return BC("clip")}abs(t){return BC("abs")}complexAbs(t){return BC("complexAbs")}sigmoid(t){return BC("sigmoid")}softplus(t){return BC("softplus")}sin(t){return BC("sin")}cos(t){return BC("cos")}tan(t){return BC("tan")}asin(t){return BC("asin")}acos(t){return BC("acos")}atan(t){return BC("atan")}atan2(t,e){return BC("atan2")}sinh(t){return BC("sinh")}cosh(t){return BC("cosh")}tanh(t){return BC("tanh")}asinh(t){return BC("asinh")}acosh(t){return BC("acosh")}atanh(t){return BC("atanh")}erf(t){return BC("erf")}step(t,e){return BC("step")}fusedConv2d({}){return BC("fusedConv2d")}conv2d(t,e,n){return BC("conv2d")}conv2dDerInput(t,e,n){return BC("conv2dDerInput")}conv2dDerFilter(t,e,n){return BC("conv2dDerFilter")}fusedDepthwiseConv2D({}){return BC("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,n){return BC("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,n){return BC("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,n){return BC("depthwiseConv2DDerFilter")}conv3d(t,e,n){return BC("conv3d")}conv3dDerInput(t,e,n){return BC("conv3dDerInput")}conv3dDerFilter(t,e,n){return BC("conv3dDerFilter")}maxPool(t,e){return BC("maxPool")}maxPoolBackprop(t,e,n,r){return BC("maxPoolBackprop")}avgPool(t,e){return BC("avgPool")}avgPoolBackprop(t,e,n){return BC("avgPoolBackprop")}avgPool3d(t,e){return BC("avgPool3d")}avgPool3dBackprop(t,e,n){return BC("avgPool3dBackprop")}maxPool3d(t,e){return BC("maxPool3d")}maxPool3dBackprop(t,e,n,r){return BC("maxPool3dBackprop")}reshape(t,e){return BC("reshape")}cast(t,e){return BC("cast")}tile(t,e){return BC("tile")}pad(t,e,n){return BC("pad")}transpose(t,e){return BC("transpose")}gather(t,e,n,r=0){return BC("gather")}gatherND(t,e){return BC("gatherND")}scatterND(t,e,n){return BC("scatterND")}batchToSpaceND(t,e,n){return BC("batchToSpaceND")}spaceToBatchND(t,e,n){return BC("spaceToBatchND")}resizeBilinear(t,e,n,r,s){return BC("resizeBilinear")}resizeBilinearBackprop(t,e,n){return BC("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,n,r,s){return BC("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,n){return BC("resizeNearestNeighborBackprop")}batchNorm(t,e,n,r,s,i){return BC("batchNorm")}localResponseNormalization4D(t,e,n,r,s){return BC("localResponseNormalization4D")}LRNGrad(t,e,n,r,s,i,a){return BC("LRNGrad")}multinomial(t,e,n,r){return BC("multinomial")}oneHot(t,e,n,r){return BC("oneHot")}cumsum(t,e,n,r){return BC("cumsum")}nonMaxSuppression(t,e,n,r,s){return BC("nonMaxSuppression")}fft(t){return BC("fft")}ifft(t){return BC("ifft")}complex(t,e){return BC("complex")}real(t){return BC("real")}imag(t){return BC("imag")}cropAndResize(t,e,n,r,s,i){return BC("cropAndResize")}depthToSpace(t,e,n){return BC("depthToSpace")}split(t,e,n){return BC("split")}sparseToDense(t,e,n,r){return BC("sparseToDense")}diag(t){return BC("diag")}fill(t,e,n){return BC("fill")}onesLike(t){return BC("onesLike")}zerosLike(t){return BC("zerosLike")}linspace(t,e,n){return BC("linspace")}dispose(){return BC("dispose")}}function BC(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function VC(t){let e=t.length,n=0,r=0;for(;e>0;)r=Math.random()*e|0,e--,n=t[e],t[e]=t[r],t[r]=n}function WC(t,e,n){return Math.max(t,Math.min(e,n))}function UC(t){return t%2==0?t:t+1}function jC(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function HC(t,e){const n=Math.random();return e*n+(1-n)*t}function qC(t,e){let n=0;for(let r=0;r<t.length;r++){const s=Number(t[r])-Number(e[r]);n+=s*s}return n}function GC(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function KC(t,e,n=""){GC(JC(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function XC(t){GC(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function YC(t,e=[],n=!1){if(null==e&&(e=[]),Array.isArray(t)||fI(t)&&!n)for(let r=0;r<t.length;++r)YC(t[r],e,n);else e.push(t);return e}function ZC(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function QC(t){return 0===t.length}function JC(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function tI(t){return t%1==0}function eI(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function nI(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function rI(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return VC(e),e}function sI(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function iI(t,e=(t=>0),n){return new Promise((r,s)=>{let i=0;const a=()=>{if(t())return void r();i++;const o=e(i);null!=n&&i>=n?s():setTimeout(a,o)};a()})}function aI(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(-1===r){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===n)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function oI(t,e){const n=e.length;return GC((t=null==t?e.map((t,e)=>e):[].concat(t)).every(t=>t>=-n&&t<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis `+t),GC(t.every(t=>tI(t)),()=>"All values in axis param must be integers but got axis "+t),t.map(t=>t<0?n+t:t)}function lI(t,e){const n=[],r=[],s=null!=e&&Array.isArray(e)&&0===e.length,i=null==e||s?null:oI(e,t).sort();let a=0;for(let o=0;o<t.length;++o){if(null!=i){if(i[a]===o&&1!==t[o])throw new Error(`Can't squeeze axis ${o} since its dim '${t[o]}' is not 1`);(null==i[a]||i[a]>o)&&1===t[o]&&(n.push(t[o]),r.push(o)),i[a]<=o&&a++}1!==t[o]&&(n.push(t[o]),r.push(o))}return{newShape:n,keptDims:r}}function uI(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function cI(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function hI(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function dI(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function pI(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function fI(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function mI(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function gI(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}function yI(t){return"string"==typeof t||t instanceof String}function bI(t){return"boolean"==typeof t}function vI(t){return"number"==typeof t}function wI(t){return Array.isArray(t)?wI(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":vI(t)?"float32":yI(t)?"string":bI(t)?"bool":"float32"}function _I(t){return!!(t&&t.constructor&&t.call&&t.apply)}function xI(t,e){for(let n=e;n<t;++n)if(t%n==0)return n;return t}function kI(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function SI(t,e,n){const r=new Array;if(1===e.length){const s=e[0];for(let e=0;e<s;e++)r[e]=n[t+e]}else{const s=e[0],i=e.slice(1),a=i.reduce((t,e)=>t*e);for(let e=0;e<s;e++)r[e]=SI(t+e*a,i,n)}return r}function CI(t,e){if(0===t.length)return e[0];const n=t.reduce((t,e)=>t*e);if(0===n)return[];if(n!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}.`);return SI(0,t,e)}function II(t,e){const n=EI(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function EI(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function TI(t,e){const n=t.reduce((t,e)=>t*e,1);if(null==e||"float32"===e)return CI(t,new Float32Array(n));if("int32"===e)return CI(t,new Int32Array(n));if("bool"===e)return CI(t,new Uint8Array(n));throw new Error("Unknown data type "+e)}function NI(t){t.forEach(e=>{GC(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function AI(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function RI(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function OI(t){return t&&t.then&&"function"==typeof t.then}class DI{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(OI(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=function(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("="))),e}(this.global.location.search);"tfjsflags"in t&&t.tfjsflags.split(",").forEach(t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}(e,n)})}}function FI(){return MI}let $I,MI=null;function LI(){if(null==$I){let t;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}$I=t}return $I}function PI(t,e){const n=function(){const t=LI();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const zI="Abs",BI="Acos",VI="Acosh",WI="Add",UI="AddN",jI="All",HI="Any",qI="ArgMax",GI="ArgMin",KI="Asin",XI="Asinh",YI="Atan",ZI="Atanh",QI="Atan2",JI="AvgPool",tE="AvgPoolGrad",eE="AvgPool3D",nE="AvgPool3DGrad",rE="BatchMatMul",sE="BatchToSpaceND",iE="Bincount",aE="Cast",oE="Ceil",lE="ClipByValue",uE="Complex",cE="ComplexAbs",hE="Concat",dE="Conv2D",pE="Conv2DBackpropFilter",fE="Conv2DBackpropInput",mE="Conv3D",gE="Conv3DBackpropFilterV2",yE="Conv3DBackpropInputV2",bE="Cos",vE="Cosh",wE="Cumsum",_E="CropAndResize",xE="DenseBincount",kE="DepthToSpace",SE="DepthwiseConv2dNative",CE="DepthwiseConv2dNativeBackpropFilter",IE="DepthwiseConv2dNativeBackpropInput",EE="Diag",TE="Dilation2D",NE="Dilation2DBackpropInput",AE="Dilation2DBackpropFilter",RE="RealDiv",OE="Elu",DE="EluGrad",FE="Erf",$E="Equal",ME="Exp",LE="ExpandDims",PE="Expm1",zE="FFT",BE="Fill",VE="FlipLeftRight",WE="Floor",UE="FloorDiv",jE="FusedBatchNorm",HE="GatherV2",qE="GatherNd",GE="Greater",KE="GreaterEqual",XE="Identity",YE="IFFT",ZE="Imag",QE="IsFinite",JE="IsInf",tT="IsNan",eT="LeakyRelu",nT="Less",rT="LessEqual",sT="LinSpace",iT="Log",aT="Log1p",oT="LogicalAnd",lT="LogicalNot",uT="LogicalOr",cT="LRN",hT="LRNGrad",dT="Max",pT="Maximum",fT="MaxPool",mT="MaxPoolGrad",gT="MaxPool3D",yT="MaxPool3DGrad",bT="MaxPoolWithArgmax",vT="Mean",wT="Min",_T="Minimum",xT="MirrorPad",kT="Mod",ST="Multinomial",CT="Multiply",IT="Neg",ET="NotEqual",TT="NonMaxSuppressionV3",NT="NonMaxSuppressionV4",AT="NonMaxSuppressionV5",RT="OnesLike",OT="OneHot",DT="Pack",FT="PadV2",$T="Pow",MT="Prelu",LT="Prod",PT="Range",zT="Real",BT="Reciprocal",VT="Relu",WT="Reshape",UT="ResizeNearestNeighbor",jT="ResizeNearestNeighborGrad",HT="ResizeBilinear",qT="ResizeBilinearGrad",GT="Relu6",KT="Reverse",XT="Round",YT="Rsqrt",ZT="ScatterNd",QT="Select",JT="Selu",tN="Slice",eN="Sin",nN="Sinh",rN="Sign",sN="Sigmoid",iN="Softplus",aN="Sqrt",oN="Sum",lN="SpaceToBatchND",uN="SplitV",cN="Softmax",hN="SquaredDifference",dN="Square",pN="Sub",fN="SparseToDense",mN="StridedSlice",gN="Tan",yN="Tanh",bN="Tile",vN="TopK",wN="Transpose",_N="Unique",xN="Unpack",kN="UnsortedSegmentSum",SN="ZerosLike",CN="Step",IN="FromPixels",EN="RotateWithOffset",TN="_FusedMatMul",NN="FusedConv2D",AN="FusedDepthwiseConv2D",RN=PI("kernelRegistry",()=>new Map),ON=PI("gradRegistry",()=>new Map);function DN(t,e){const n=PN(t,e);return RN.get(n)}function FN(t){return ON.get(t)}function $N(t){const e=RN.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,a]=s,[o]=i.split("_");o===t&&n.push(a)}return n}function MN(t){const{kernelName:e,backendName:n}=t,r=PN(e,n);RN.has(r)&&console.warn(`The kernel '${e}' for backend '${n}' is already registered`),RN.set(r,t)}function LN(t){const{kernelName:e}=t;ON.has(e)&&FI().getBool("DEBUG")&&console.warn(`Overriding the gradient for '${e}'`),ON.set(e,t)}function PN(t,e){return`${e}_${t}`}class zN{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new VN)}profileKernel(t,e,n){let r;const s=this.backendTimer.time(()=>{r=n()});if(FI().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let i=0;i<r.length;i++){const e=r[i];e.data().then(n=>{BN(n,e.dtype,t)})}return{kernelName:t,outputs:r,inputs:e,timeMs:s.then(t=>t.kernelMs),extraInfo:s.then(t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:s,extraInfo:i}=t;n.forEach(t=>{Promise.all([t.data(),r,i]).then(n=>{this.logger.logKernelProfile(e,t,n[0],n[1],s,n[2])})})}}function BN(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn(`Found ${e} in the result of '${n}'`),!0}return!1}class VN{logKernelProfile(t,e,n,r,s,i){const a="number"==typeof r?sI(r+"ms",9):r.error,o=sI(t,25),l=e.rank,u=e.size,c=sI(e.shape.toString(),14);let h="";for(const d in s){const t=s[d];if(null!=t){const n=t.shape||e.shape,r=n.length;h+=`${d}: ${r}D ${r>0?n:""} `}}console.log(`%c${o}\t%c${a}\t%c${l}D ${c}\t%c${u}\t%c${h}\t%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function WN(t,e,n,r){const s=kI(e),i=function(t,e,n,r){const s=ZC(e),i=r[r.length-1],a=new Array(i).fill(0),o=e.length,l="complex64"===n?qN(t):t;if(o>1)for(let u=0;u<s/i;u++){const t=u*i;for(let e=0;e<i;e++)a[e]=Math.max(a[e],UN(l[t+e],0,n).length)}return a}(t,e,n,s),a=e.length,o=HN(t,e,n,s,i),l=["Tensor"];return r&&(l.push("  dtype: "+n),l.push("  rank: "+a),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(t=>"    "+t).join("\n")),l.join("\n")}function UN(t,e,n){let r;return r=Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":yI(t)?`'${t}'`:"bool"===n?jN(t):parseFloat(t.toFixed(7)).toString(),sI(r,e)}function jN(t){return 0===t?"false":"true"}function HN(t,e,n,r,s,i=!0){const a="complex64"===n?2:1,o=e[0],l=e.length;if(0===l)return"complex64"===n?[UN(qN(t)[0],0,n)]:"bool"===n?[jN(t[0])]:[t[0].toString()];if(1===l){if(o>20){let e=Array.from(t.slice(0,3*a)),r=Array.from(t.slice((o-3)*a,o*a));return"complex64"===n&&(e=qN(e),r=qN(r)),["["+e.map((t,e)=>UN(t,s[e],n)).join(", ")+", ..., "+r.map((t,e)=>UN(t,s[o-3+e],n)).join(", ")+"]"]}return["["+("complex64"===n?qN(t):Array.from(t)).map((t,e)=>UN(t,s[e],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),h=r[0]*a,d=[];if(o>20){for(let e=0;e<3;e++){const r=e*h;d.push(...HN(t.slice(r,r+h),u,n,c,s,!1))}d.push("...");for(let e=o-3;e<o;e++){const r=e*h;d.push(...HN(t.slice(r,r+h),u,n,c,s,e===o-1))}}else for(let m=0;m<o;m++){const e=m*h;d.push(...HN(t.slice(e,e+h),u,n,c,s,m===o-1))}const p=2===l?",":"";d[0]="["+d[0]+p;for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+p;let f=",\n";for(let m=2;m<l;m++)f+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":f),d}function qN(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}function GN(t,e){return"string"===e?ZN(t):KN([t],e)}function KN(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=YC(t)),FI().getBool("DEBUG")&&hI(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type "+e)}function XN(){return FI().platform.now()}function YN(t,e){return FI().platform.fetch(t,e)}function ZN(t,e="utf-8"){return e=e||"utf-8",FI().platform.encode(t,e)}function QN(t,e="utf-8"){return e=e||"utf-8",FI().platform.decode(t,e)}class JN{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=ZC(t),null!=n){const t=n.length;GC(t===this.size,()=>`Length of values '${t}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||cI(e,this.size),this.strides=kI(t)}set(t,...e){0===e.length&&(e=[0]),GC(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e])throw new Error(`Requested out of range element at ${t}.   Buffer shape=`+this.shape);e++}let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return tA().makeTensor(this.values,this.shape,this.dtype)}}let tA=null,eA=null,nA=null;class rA{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=ZC(t),this.strides=kI(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return eA.buffer(this.shape,this.dtype,t)}bufferSync(){return eA.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return CI(this.shape,t)}arraySync(){return CI(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=tA().read(this.dataId);if("string"===this.dtype){const e=await t;try{return e.map(t=>QN(t))}catch(xrt){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=tA().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>QN(t))}catch(xrt){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await tA().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(tA().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return eA.print(this,t)}clone(){return this.throwIfDisposed(),eA.clone(this)}toString(t=!1){return WN(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),eA.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),tA().makeVariable(this,t,e,n)}}Object.defineProperty(rA,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed});class sA extends rA{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!JC(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);tA().disposeTensor(this),this.dataId=t.dataId,tA().incRef(this,null)}dispose(){tA().disposeVariable(this),this.isDisposedInternal=!0}}var iA,aA,oA,lA,uA;Object.defineProperty(sA,Symbol.hasInstance,{value:t=>t instanceof rA&&null!=t.assign&&t.assign instanceof Function}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(iA||(iA={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(aA||(aA={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(oA||(oA={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(lA||(lA={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(uA||(uA={}));const cA={float32:lA,int32:aA,bool:oA,complex64:uA};function hA(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return cA[t][e]}function dA(t){return hA(t,"int32")}function pA(t,e){if(t.dtype===e.dtype)return[t,e];const n=hA(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function fA(t,e){GC(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function mA(t,e){return e.some(e=>e.id===t.id)}function gA(t){const e=[];return yA(t,e,new Set),e}function yA(t,e,n){if(null==t)return;if(t instanceof rA)return void e.push(t);if(r=t,!Array.isArray(r)&&"object"!=typeof r)return;var r;const s=t;for(const i in s){const t=s[i];n.has(t)||(n.add(t),yA(t,e,n))}}class bA{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class vA{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new bA}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void(await this.setBackend(n))}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new zN(this.backendInstance),!0}setupRegisteredKernels(){$N(this.backendName).forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){$N(t).forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(!n||n instanceof zC||"function"!=typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then(n=>!(e<this.pendingBackendInitId||(this.registry[t]=n,this.pendingBackendInit=null,0))).catch(n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:s}=this.initializeBackend(n);if(s||r)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,s=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,s,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return vA.nextTensorId++}nextVariableId(){return vA.nextVariableId++}clone(t){const e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype);return this.addTapeNode(this.state.activeScope.name,{x:t},[e],t=>({x:()=>{const e="float32";return _A.runKernelFunc(n=>n.cast(t,e),{x:t},null,aE,{dtype:e})}}),[],{}),e}runKernel(t,e,n,r,s){return this.runKernelFunc(null,e,null,t,n,r,s)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let s=0;n.forEach(t=>{s+="complex64"===t.dtype?3:1});const i=r-e-s-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${t}'`)}runKernelFunc(t,e,n,r,s,i,a){let o,l=[];const u=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");const c=this.state.numBytes,h=this.state.numTensors;let d;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const p=DN(r,this.backendName);let f,m;if(null!=p)d=()=>{const t=this.backend.numDataIds();f=p.kernelFunc({inputs:e,attrs:s,backend:this.backend});const n=Array.isArray(f)?f:[f];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(r,t,n);const o=n.map(t=>{if(null!=t.rank)return t;const{dataId:e,shape:n,dtype:r}=t;return this.makeTensorFromDataId(e,n,r)});if(u){let t=this.getTensorsForGradient(r,e,o);if(null==t){null==a&&(a=[]);const e=o.filter((t,e)=>a[e]);t=(i||[]).slice().concat(e)}l=this.saveTensorsForBackwardMode(t)}return o};else{if(null==t)throw new Error(`Error running ${r}: Neither modular kernel nor forward func passed`);const e=t=>{u&&(l=t.map(t=>this.keep(this.clone(t))))};d=()=>{const n=this.backend.numDataIds();f=this.tidy(()=>t(this.backend,e));const s=Array.isArray(f)?f:[f];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(r,n,s),s}}return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(m=this.profiler.profileKernel(r,e,()=>d()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),o=m.outputs):o=d()}),u&&this.addTapeNode(r,e,o,n,l,s),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-h,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(t=>null!=e[t]?e[t].shape:null),outputShapes:o.map(t=>t.shape),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(f)?o:o[0]}saveTensorsForBackwardMode(t){return t.map(t=>this.keep(this.clone(t)))}getTensorsForGradient(t,e,n){const r=FN(t);if(null!=r){const t=r.inputsToSave||[],s=r.outputsToSave||[];let i;r.saveAllInputs?(GC(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(e).map(t=>e[t])):i=t.map(t=>e[t]);const a=n.filter((t,e)=>s[e]);return i.concat(a)}return null}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");r=r||this.backend;let s=t;"string"===(n=n||"float32")&&yI(t[0])&&(s=t.map(t=>ZN(t)));const i=r.write(s,e,n),a=new rA(e,n,i,this.nextTensorId());if(this.incRef(a,r),"string"===n){const t=this.state.tensorInfo.get(i),e=gI(s);this.state.numBytes+=e-t.bytes,t.bytes=e}return a}makeTensorFromDataId(t,e,n,r){const s=new rA(e,n=n||"float32",t,this.nextTensorId());return this.incRef(s,r),s}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const s=new sA(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[s.name])throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}incRef(t,e){const n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*mI(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n,refCount:0}),this.state.numBytes+=n}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof sA||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;const e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):(e.backend.decComplexRef(t.dataId),this.state.tensorInfo.get(t.dataId).refCount--)}disposeVariables(){for(const t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,s,i){const a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:s},o=FN(t);null!=o&&(r=o.gradFunc),null!=r&&(a.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=n[e],r=EI(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t}),r(t.length>1?t:t[0],s,i))),this.state.activeTape.push(a)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=gA(t),n=new Set(e.map(t=>t.id));for(let s=0;s<this.state.activeScope.track.length;s++){const t=this.state.activeScope.track[s];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==r.id||this.track(t)})}gradients(t,e,n,r=!1){if(GC(e.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));GC(s instanceof rA,()=>"The result y returned by f() must be a tensor.");const i=function(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const n=t[l],i=n.inputs;for(const t in i){const a=i[t];let o=!1;for(let t=0;t<e.length;t++)if(r[a.id]){n.outputs.forEach(t=>r[t.id]=!0),o=!0,s[n.id]=!0;break}if(o)break}}const i={};i[n.id]=!0;const a={};for(let l=t.length-1;l>=0;l--){const e=t[l],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(i[e.outputs[t].id]){for(const t in n)i[n[t].id]=!0,a[e.id]=!0;break}}const o=[];for(let l=0;l<t.length;l++){const e=t[l];if(s[e.id]&&a[e.id]){const t={};for(const s in e.inputs){const n=e.inputs[s];r[n.id]&&(t[s]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,o.push(n)}}return o}(this.state.activeTape,e,s);if(!r&&0===i.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[s.id]=null==n?function(t){const e=II(ZC(t),"float32");return _A.makeTensor(e,t,"float32")}(s.shape):n,function(t,e,n,r){for(let s=e.length-1;s>=0;s--){const i=e[s],a=[];if(i.outputs.forEach(e=>{const n=t[e.id];a.push(null!=n?n:null)}),null==i.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const e in i.inputs){if(!(e in o))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(o)}.`);const s=n(()=>o[e]());if("float32"!==s.dtype)throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${s.dtype}'`);const a=i.inputs[e];if(!JC(s.shape,a.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${e}' has shape '${s.shape}', which does not match the shape of the input '${a.shape}'`);if(null==t[a.id])t[a.id]=s;else{const e=t[a.id];t[a.id]=r(e,s),e.dispose()}}}}(t,i,t=>this.tidy(t),xA);const r=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:s,grads:r}})}customGrad(t){return GC(_I(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{let n;GC(e.every(t=>t instanceof rA),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const r={};return e.forEach((t,e)=>{r[e]=t}),this.runKernelFunc((r,s)=>(n=t(...e,s),GC(n.value instanceof rA,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),GC(_I(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),r,(t,r)=>{const s=n.gradFunc(t,r),i=Array.isArray(s)?s:[s];GC(i.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),GC(i.every(t=>t instanceof rA),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const a={};return i.forEach((t,e)=>{a[e]=()=>t}),a})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=XN(),n=await this.backend.time(t);return n.wallMs=XN()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new bA;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function wA(){const t=LI();if(null==t._tfengine){const e=new DI(t);t._tfengine=new vA(e)}return MI=t._tfengine.ENV,tA=()=>t._tfengine,t._tfengine}vA.nextTensorId=0,vA.nextVariableId=0;const _A=wA();function xA(t,e){return _A.runKernel(WI,{a:t,b:e})}function kA(){if("undefined"!=typeof navigator&&null!=navigator){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function SA(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}const CA=FI();function IA(t,e){let n=t;if(fI(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||fI(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&FI().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&EA(t,r,[]),r}function EA(t,e,n){if(n=n||[],!Array.isArray(t)&&!fI(t))return void GC(0===e.length,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);GC(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),GC(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)EA(t[s],r,n.concat(s))}function TA(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function NA(t,e,n,r="numeric"){if(t instanceof rA)return TA(r,t.dtype,e,n),t;let s=wI(t);if("string"!==s&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),TA(r,s,e,n),null==t||!fI(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${null==t?"null":t.constructor.name}'`);const i=IA(t,s);fI(t)||Array.isArray(t)||(t=[t]);const a="string"!==s?KN(t,s):YC(t,[],!0);return _A.makeTensor(a,i,s)}function AA(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((t,s)=>NA(t,`${e}[${s}]`,n,r))}function RA(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const s=(...t)=>{_A.startScope(n);try{const e=r(...t);return OI(e)&&console.error("Cannot return a Promise inside of tidy."),_A.endScope(e),e}catch(e){throw _A.endScope(null),e}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}CA.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),CA.registerFlag("IS_BROWSER",()=>SA()),CA.registerFlag("IS_NODE",()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node),CA.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),CA.registerFlag("PROD",()=>!1),CA.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>CA.getBool("DEBUG")),CA.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),CA.registerFlag("IS_TEST",()=>!1),CA.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);const OA=RA({complex_:function(t,e){const n=NA(t,"real","complex"),r=NA(e,"imag","complex");return KC(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`),_A.runKernel(uE,{real:n,imag:r})}});function DA(t,e,n,r){if(null==r&&(r=wI(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!fI(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){NI(e);const t=ZC(e),r=ZC(n);GC(t===r,()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${r}`);for(let s=0;s<n.length;++s){const t=n[s],r=s!==n.length-1||t!==ZC(e.slice(s));GC(n[s]===e[s]||!r,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return fI(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?KN(t,r):YC(t,[],!0),_A.makeTensor(t,e,r)}function FA(t,e,n){return DA(t,e,IA(t,n),n)}const $A={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};async function MA(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);for(let i=0;i<s.length;++i){const a=s[i],o=Array.isArray(t)?t[i].tensor:t[a];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw new Error(`Unsupported dtype in weight '${a}': ${o.dtype}`);const l={name:a,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){const t=new Promise(async t=>{const e=await o.bytes(),n=e.reduce((t,e)=>t+e.length,0)+4*e.length,r=new Uint8Array(n);let s=0;for(let i=0;i<e.length;i++){const t=e[i],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,s),s+=4,r.set(t,s),s+=t.length}t(r)});r.push(t)}else r.push(o.data());null!=e&&(l.group=e),n.push(l)}return{data:PA(await Promise.all(r)),specs:n}}function LA(t,e){const n={};let r,s=0;for(const i of e){const e=i.name,a=i.dtype,o=i.shape,l=ZC(o);let u;if("quantization"in i){const n=i.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error(`Weight ${i.name} with quantization ${n.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==n.dtype)throw new Error(`Weight ${i.name} has unknown quantization dtype ${n.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==a)throw new Error(`Weight ${i.name} is quantized with ${n.dtype} which only supports weights of type float32 not ${a}.`)}const o=$A[n.dtype],c=t.slice(s,s+l*o),h="uint8"===n.dtype?new Uint8Array(c):new Uint16Array(c);if("float32"===a)if("uint8"===n.dtype||"uint16"===n.dtype){u=new Float32Array(h.length);for(let t=0;t<h.length;t++)u[t]=h[t]*n.scale+n.min}else{if("float16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type float32.`);void 0===r&&(r=jA()),u=r(h)}else{if("int32"!==a)throw new Error(`Unsupported dtype in weight '${e}': ${a}`);if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type int32.`);u=new Int32Array(h.length);for(let t=0;t<h.length;t++)u[t]=Math.round(h[t]*n.scale+n.min)}s+=l*o}else if("string"===a){const e=ZC(i.shape);u=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(s,s+4))[0];s+=4;const n=new Uint8Array(t.slice(s,s+e));u.push(n),s+=e}}else{const r=$A[a],i=t.slice(s,s+l*r);if("float32"===a)u=new Float32Array(i);else if("int32"===a)u=new Int32Array(i);else if("bool"===a)u=new Uint8Array(i);else{if("complex64"!==a)throw new Error(`Unsupported dtype in weight '${e}': ${a}`);{u=new Float32Array(i);const t=new Float32Array(u.length/2),r=new Float32Array(u.length/2);for(let e=0;e<t.length;e++)t[e]=u[2*e],r[e]=u[2*e+1];const s=FA(t,o,"float32"),a=FA(r,o,"float32");n[e]=OA(s,a),s.dispose(),a.dispose()}}s+=l*r}"complex64"!==a&&(n[e]=FA(u,o,a))}return n}function PA(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));let e=0;const n=[];t.forEach(t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)});const r=new Uint8Array(e);let s=0;return n.forEach(t=>{r.set(new Uint8Array(t.buffer),s),s+=t.byteLength}),r.buffer}const zA="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function BA(t){return zA?Buffer.byteLength(t):new Blob([t]).size}function VA(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(t=>{n.set(new Uint8Array(t),r),r+=t.byteLength}),n.buffer}function WA(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function UA(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:BA(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:BA(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function jA(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0==(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let a=0;a<r.length;a++){const s=r[a];i[a]=t[n[s>>10]+(1023&s)]+e[s>>10]}return new Float32Array(s)}}class HA{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==HA.instance&&(HA.instance=new HA),HA.instance}static registerSaveRouter(t){HA.getInstance().saveRouters.push(t)}static registerLoadRouter(t){HA.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return HA.getHandlers(t,"save")}static getLoadHandlers(t,e){return HA.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[];return("load"===e?HA.getInstance().loadRouters:HA.getInstance().saveRouters).forEach(e=>{const s=e(t,n);null!==s&&r.push(s)}),r}}const qA=t=>HA.registerSaveRouter(t),GA=t=>HA.registerLoadRouter(t),KA=t=>HA.getSaveHandlers(t),XA=(t,e)=>HA.getLoadHandlers(t,e),YA="tensorflowjs",ZA="models_store",QA="model_info_store";function JA(){if(!FI().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function tR(t){const e=t.result;e.createObjectStore(ZA,{keyPath:"modelPath"}),e.createObjectStore(QA,{keyPath:"modelPath"})}class eR{constructor(t){if(this.indexedDB=JA(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,n)=>{const r=this.indexedDB.open(YA,1);r.onupgradeneeded=()=>tR(r),r.onsuccess=()=>{const s=r.result;if(null==e){const e=s.transaction(ZA,"readonly"),r=e.objectStore(ZA).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return s.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(r.result.modelArtifacts)},r.onerror=t=>(s.close(),n(r.error)),e.oncomplete=()=>s.close()}else{const r=UA(e),i=s.transaction(QA,"readwrite");let a=i.objectStore(QA);const o=a.put({modelPath:this.modelPath,modelArtifactsInfo:r});let l;o.onsuccess=()=>{l=s.transaction(ZA,"readwrite");const o=l.objectStore(ZA).put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r});o.onsuccess=()=>t({modelArtifactsInfo:r}),o.onerror=t=>{a=i.objectStore(QA);const e=a.delete(this.modelPath);e.onsuccess=()=>(s.close(),n(o.error)),e.onerror=t=>(s.close(),n(o.error))}},o.onerror=t=>(s.close(),n(o.error)),i.oncomplete=()=>{null==l?s.close():l.oncomplete=()=>s.close()}}},r.onerror=t=>n(r.error)})}}eR.URL_SCHEME="indexeddb://";const nR=t=>{return FI().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(eR.URL_SCHEME)?(e=t.slice(eR.URL_SCHEME.length),new eR(e)):null;var e};HA.registerSaveRouter(nR),HA.registerLoadRouter(nR);class rR{constructor(){this.indexedDB=JA()}async listModels(){return new Promise((t,e)=>{const n=this.indexedDB.open(YA,1);n.onupgradeneeded=()=>tR(n),n.onsuccess=()=>{const r=n.result,s=r.transaction(QA,"readonly"),i=s.objectStore(QA).getAll();i.onsuccess=()=>{const e={};for(const t of i.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},i.onerror=t=>(r.close(),e(i.error)),s.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)})}async removeModel(t){var e;return t=(e=t).startsWith(eR.URL_SCHEME)?e.slice(eR.URL_SCHEME.length):e,new Promise((e,n)=>{const r=this.indexedDB.open(YA,1);r.onupgradeneeded=()=>tR(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(QA,"readwrite"),a=i.objectStore(QA),o=a.get(t);let l;o.onsuccess=()=>{if(null==o.result)return s.close(),n(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const r=a.delete(t),i=()=>{l=s.transaction(ZA,"readwrite");const r=l.objectStore(ZA).delete(t);r.onsuccess=()=>e(o.result.modelArtifactsInfo),r.onerror=t=>n(o.error)};r.onsuccess=i,r.onerror=t=>(i(),s.close(),n(o.error))}},o.onerror=t=>(s.close(),n(o.error)),i.oncomplete=()=>{null==l?s.close():l.oncomplete=()=>s.close()}},r.onerror=t=>n(r.error)})}}const sR="/",iR="tensorflowjs_models",aR="info",oR="model_topology",lR="weight_specs",uR="weight_data",cR="model_metadata";function hR(t){return{info:[iR,t,aR].join(sR),topology:[iR,t,oR].join(sR),weightSpecs:[iR,t,lR].join(sR),weightData:[iR,t,uR].join(sR),modelMetadata:[iR,t,cR].join(sR)}}function dR(t){const e=t.split(sR);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(sR)}class pR{constructor(t){if(!FI().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=hR(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),s=UA(t);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(t){if(zA)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};return null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:s}}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const s=this.LS.getItem(this.keys.modelMetadata);if(null!=s){const t=JSON.parse(s);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer)}const i=this.LS.getItem(this.keys.weightData);if(null==i)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=function(t){if(zA){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}(i),e}}pR.URL_SCHEME="localstorage://";const fR=t=>{return FI().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(pR.URL_SCHEME)?(e=t.slice(pR.URL_SCHEME.length),new pR(e)):null;var e};HA.registerSaveRouter(fR),HA.registerLoadRouter(fR);class mR{constructor(){GC(FI().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),GC("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=iR+sR,n=sR+aR;for(let r=0;r<this.LS.length;++r){const s=this.LS.key(r);s.startsWith(e)&&s.endsWith(n)&&(t[dR(s)]=JSON.parse(this.LS.getItem(s)))}return t}async removeModel(t){var e;const n=hR(t=(e=t).startsWith(pR.URL_SCHEME)?e.slice(pR.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),r}}const gR="://";class yR{constructor(){this.managers={}}static getInstance(){return null==yR.instance&&(yR.instance=new yR),yR.instance}static registerManager(t,e){GC(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(gR)&&(t=t.slice(0,t.indexOf(gR))),GC(t.length>0,()=>"scheme must not be an empty string.");const n=yR.getInstance();GC(null==n.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),n.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function bR(t){if(-1===t.indexOf(gR))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+yR.getSchemes().join(","));return{scheme:t.split(gR)[0],path:t.split(gR)[1]}}async function vR(t,e,n=!1){GC(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=HA.getLoadHandlers(t);GC(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),GC(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],i=HA.getSaveHandlers(e);GC(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),GC(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const a=i[0],o=bR(t).scheme,l=bR(t).path,u=o===bR(t).scheme,c=await s.load();n&&u&&await yR.getManager(o).removeModel(l);const h=await a.save(c);return n&&!u&&await yR.getManager(o).removeModel(l),h.modelArtifactsInfo}async function wR(){const t=yR.getSchemes(),e={};for(const n of t){const t=await yR.getManager(n).listModels();for(const r in t)e[n+gR+r]=t[r]}return e}async function _R(t){const e=bR(t);return yR.getManager(e.scheme).removeModel(e.path)}async function xR(t,e){return vR(t,e,!1)}async function kR(t,e){return vR(t,e,!0)}class SR{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}if(FI().get("IS_BROWSER")){FI().setPlatform("browser",new SR);try{yR.registerManager(pR.URL_SCHEME,new mR)}catch(krt){}try{yR.registerManager(eR.URL_SCHEME,new rR)}catch(krt){}}let CR;function IR(t,e="float32",n){return e=e||"float32",NI(t),new JN(t,e,n)}FI().get("IS_NODE")&&FI().setPlatform("node",new class{constructor(){this.util=n(5),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=FI().global.fetch?FI().global.fetch(t,e):(null==CR&&(CR=n(4)),CR(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}});const ER=RA({cast_:function(t,e){const n=NA(t,"x","cast");if(!dI(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return _A.runKernel(aE,{x:n},{dtype:e})}}),TR=RA({clone_:function(t){const e=NA(t,"x","clone","string_or_numeric");return _A.runKernel(XE,{x:e})}});function NR(t){return new Promise(t=>setTimeout(t)).then(t)}wA(),eA={buffer:IR,cast:ER,clone:TR,print:function(t,e=!1){console.log(t.toString(e))}};class AR{constructor(t){if(!FI().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(AR.URL_SCHEME)&&(t=t.slice(AR.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]};null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer);const r=window.URL.createObjectURL(new Blob([JSON.stringify(n)],{type:"application/json"})),s=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor;if(s.download=this.modelTopologyFileName,s.href=r,await NR(()=>s.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await NR(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:UA(t)}}}}AR.URL_SCHEME="downloads://";class RR{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}async load(){const t=this.files[0],e=this.files.slice(1);return new Promise((n,r)=>{const s=new FileReader;s.onload=s=>{const i=JSON.parse(s.target.result),a=i.modelTopology;if(null==a)return void r(new Error("modelTopology field is missing from file "+t.name));0===e.length&&n({modelTopology:a});const o=i.weightsManifest;if(null==o)return void r(new Error("weightManifest field is missing from file "+t.name));let l;try{l=this.checkManifestAndWeightFiles(o,e)}catch(krt){return void r(krt)}const u=[],c=[],h=[];o.forEach(t=>{t.paths.forEach(t=>{c.push(t),h.push(null)}),u.push(...t.weights)}),o.forEach(t=>{t.paths.forEach(t=>{const e=new FileReader;e.onload=e=>{const r=e.target.result,s=c.indexOf(t);if(h[s]=r,-1===h.indexOf(null)){const t={modelTopology:a,weightSpecs:u,weightData:VA(h),format:i.format,generatedBy:i.generatedBy,convertedBy:i.convertedBy};null!=i.signature&&(t.signature=i.signature),null!=i.userDefinedMetadata&&(t.userDefinedMetadata=i.userDefinedMetadata),null!=i.modelInitializer&&(t.modelInitializer=i.modelInitializer),n(t)}},e.onerror=e=>r(`Failed to weights data from file of path '${t}'.`),e.readAsArrayBuffer(l[t])})})},s.onerror=e=>r(`Failed to read model topology and weights manifest JSON from file '${t.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(t)})}checkManifestAndWeightFiles(t,e){const n=[],r=e.map(t=>WA(t.name)),s={};for(const i of t)i.paths.forEach(t=>{const i=WA(t);if(-1!==n.indexOf(i))throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(n.push(i),-1===r.indexOf(i))throw new Error(`Weight file with basename '${i}' is not provided.`);s[t]=e[r.indexOf(i)]});if(n.length!==e.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${e.length}).`);return s}}function OR(t){return new RR(t)}function DR(t,e,n,r){!function(t){GC(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}(t),function(t,e){GC(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction "+t),GC(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction "+e),GC(e>=t,()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction `+e)}(n=null==n?0:n,r=null==r?1:r);let s=0;return Promise.all(t.map(i=>(i.then(i=>{const a=n+ ++s/t.length*(r-n);return e(a),i}),i)))}async function FR(t,e){null==e&&(e={});const n=null==e.fetchFunc?FI().platform.fetch:e.fetchFunc,r=t.map(t=>n(t,e.requestInit,{isBinary:!0})),s=(null==e.onProgress?await Promise.all(r):await DR(r,e.onProgress,0,.5)).map(t=>t.arrayBuffer());return null==e.onProgress?await Promise.all(s):await DR(s,e.onProgress,.5,1)}async function $R(t,e="",n,r){return MR(t=>FR(t,{requestInit:r}))(t,e,n)}function MR(t){return async(e,n="",r)=>{const s=e.map(()=>!1),i={},a=null!=r?r.map(()=>!1):[],o=[];if(e.forEach((t,e)=>{let n=0;t.weights.forEach(t=>{const l=$A["quantization"in t?t.quantization.dtype:t.dtype]*ZC(t.shape),u=()=>{s[e]=!0,null==i[e]&&(i[e]=[]),i[e].push({manifestEntry:t,groupOffset:n,sizeBytes:l})};null!=r?r.forEach((e,n)=>{e===t.name&&(u(),a[n]=!0)}):u(),o.push(t.name),n+=l})}),!a.every(t=>t)){const t=r.filter((t,e)=>!a[e]);throw new Error("Could not find weights in manifest with names: "+t.join(", ")+". \nManifest JSON has weights with names: "+o.join(", ")+".")}const l=s.reduce((t,e,n)=>(e&&t.push(n),t),[]),u=[];l.forEach(t=>{e[t].paths.forEach(t=>{const e=n+(n.endsWith("/")?"":"/")+t;u.push(e)})});const c=await t(u),h={};let d=0;return l.forEach(t=>{const n=e[t].paths.length;let r=0;for(let e=0;e<n;e++)r+=c[d+e].byteLength;const s=new ArrayBuffer(r),a=new Uint8Array(s);let o=0;for(let e=0;e<n;e++){const t=new Uint8Array(c[d+e]);a.set(t,o),o+=t.byteLength}i[t].forEach(t=>{const e=LA(s.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(const n in e)h[n]=e[n]}),d+=n}),h}}HA.registerSaveRouter(t=>FI().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(AR.URL_SCHEME)?function(t="model"){return new AR(t)}(t.slice(AR.URL_SCHEME.length)):null);class LR{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(GC("function"==typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=FI().platform.fetch,GC(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&GC(2===t.length,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]};null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),e.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const r=await this.fetch(this.path,e);if(r.ok)return{modelArtifactsInfo:UA(t),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+r.status+".")}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code `+t.status+". Please verify this URL points to the model JSON of the model to load.");let e;try{e=await t.json()}catch(p){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,r=e.weightsManifest,s=e.generatedBy,i=e.convertedBy,a=e.format,o=e.signature,l=e.userDefinedMetadata;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let u,c;if(null!=r){const t=await this.loadWeights(r);[u,c]=t}const h={modelTopology:n,weightSpecs:u,weightData:c,generatedBy:s,convertedBy:i,format:a};null!=o&&(h.signature=o),null!=l&&(h.userDefinedMetadata=l);const d=e.modelInitializer;return d&&(h.modelInitializer=d),h}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),s=this.weightPathPrefix||n,i=[];for(const l of t)i.push(...l.weights);const a=[],o=[];for(const l of t)for(const t of l.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(t)):a.push(s+t+r);return this.weightUrlConverter&&a.push(...await Promise.all(o)),[i,VA(await FR(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress}))]}}function PR(t){return null!=t.match(LR.URL_SCHEME_REGEX)}LR.URL_SCHEME_REGEX=/^https?:\/\//;const zR=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every(t=>PR(t)):PR(t),n)return BR(t,e)}return null};function BR(t,e){return new LR(t,e)}function VR(t,e){return BR(t,e)}HA.registerSaveRouter(zR),HA.registerLoadRouter(zR);class WR{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class UR{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function jR(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new WR(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new WR({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new WR({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function HR(t){return new UR(t)}let qR;async function GR(t,e){let n=NA(t,"img","toPixels");if(!(t instanceof rA)){const t=n;n=ER(t,"int32"),t.dispose()}if(2!==n.rank&&3!==n.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,s]=n.shape.slice(0,2),i=2===n.rank?1:n.shape[2];if(i>4||2===i)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+i);if("float32"!==n.dtype&&"int32"!==n.dtype)throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const a=await n.data(),o="float32"===n.dtype?255:1,l=new Uint8ClampedArray(s*r*4);for(let u=0;u<r*s;++u){const t=[0,0,0,255];for(let r=0;r<i;r++){const e=a[u*i+r];if("float32"===n.dtype){if(e<0||e>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${e}.`)}else if("int32"===n.dtype&&(e<0||e>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${e}.`);1===i?(t[0]=e*o,t[1]=e*o,t[2]=e*o):t[r]=e*o}const e=4*u;l[e+0]=Math.round(t[0]),l[e+1]=Math.round(t[1]),l[e+2]=Math.round(t[2]),l[e+3]=Math.round(t[3])}if(null!=e){e.width=s,e.height=r;const t=e.getContext("2d"),n=new ImageData(l,s,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),l}const KR=RA({fromPixels_:function(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,i=!1,a=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)s=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)i=!0;else if(null!=t.getContext)a=!0;else{if(!("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);o=!0}if(s){const e=2;if(s&&t.readyState<e)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=DN(IN,_A.backendName))return _A.runKernel(IN,{pixels:t},{numChannels:e});const[l,u]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let c,h;if(a?c=t.getContext("2d").getImageData(0,0,l,u).data:r||n?c=t.data:(i||s||o)&&(null==qR&&(qR=document.createElement("canvas").getContext("2d")),qR.canvas.width=l,qR.canvas.height=u,qR.drawImage(t,0,0,l,u),c=qR.getImageData(0,0,l,u).data),4===e)h=new Int32Array(c);else{const t=l*u;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=c[4*n+t]}return function(t,e,n){if(XC(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=IA(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return DA(t,e,r,n)}(h,[u,l,e],"int32")}});function XR(t,e,n){const r=t.shape.length;GC(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),GC(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)GC(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function YR(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function ZR(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function QR(t,e,n,r){const s=[...t];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<n;i++)0===i?s[e]=1:(s.splice(e,0,1),s.pop());return s}function JR(t,e,n){return n<=t?n:n-(e-1)}function tO(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function eO(t,e,n,r,s,i,a,o,l){const u=t.length;let c=new Array(u),h=new Array(u),d=new Array(u);if(e.length&&n>0){const l=e[0],u=n+1;c=nO(a,l,u,r,t),h=rO(o,l,u,s,t),d=QR(i,l,u,t)}else for(let p=0;p<u;p++)c[p]=iO(a,r,i,t,p,l),h[p]=aO(o,s,i,t,p,l),d[p]=sO(i,p,l);return{begin:c,end:h,strides:d}}function nO(t,e,n,r,s){const i=[...s],a=tO(n,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=0;else{const s=JR(e,n,o);let a=r[s];t&1<<s&&(a=0),i[o]=a}return i}function rO(t,e,n,r,s){const i=[...s],a=tO(n,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{const s=JR(e,n,o);let a=r[s];t&1<<s&&(a=Number.MAX_SAFE_INTEGER),i[o]=a}for(let o=0;o<i.length;o++){const t=s[o];i[o]<0&&(i[o]+=t),i[o]=WC(0,i[o],s[o])}return i}function sO(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function iO(t,e,n,r,s,i){let a=e[s];(t&1<<s||i&1<<s||null==a)&&(a=(n[s]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const o=r[s];return a<0&&(a+=o),a=WC(0,a,o-1),a}function aO(t,e,n,r,s,i){let a=e[s];const o=n[s]||1;(t&1<<s||i&1<<s||null==a)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=r[s];return a<0&&(a+=l),a=o>0?WC(0,a,l):WC(-1,a,l-1),a}function oO(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function lO(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function uO(t,e,n){let r;const s=t.shape.length;let i;return r="number"==typeof e?[e,...new Array(s-1).fill(0)]:e.length<s?e.concat(new Array(s-e.length).fill(0)):e.slice(),r.forEach(t=>{GC(-1!==t,()=>"slice() does not support negative begin indexing.")}),i=null==n?new Array(s).fill(-1):"number"==typeof n?[n,...new Array(s-1).fill(-1)]:n.length<s?n.concat(new Array(s-n.length).fill(-1)):n,i=i.map((e,n)=>e>=0?e:(GC(-1===e,()=>`Negative size values should be exactly -1 but got ${e} for the slice() size at index ${n}.`),t.shape[n]-r[n])),[r,i]}function cO(t,e,n,r,s,i,a,o,l){let u=e.slice(),c=n.slice(),h=r;null==r&&(h=new Array(u.length));const d=YR(a);if(d.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==a&&0!==o)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==a&&0!==l)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");const p=t.length-u.length,f=YR(o),m=t.slice();f.forEach(t=>{u[t]=0,c[t]=1,m.splice(t,0,1)});const{begin:g,end:y,strides:b}=eO(m,d,p,u,c,h,s,i,a);u=g,c=y,h=b;const v=YR(l);v.forEach(t=>{c[t]=u[t]+1,h[t]=1});const w=ZR(u,c,h),_=w.filter((t,e)=>-1===v.indexOf(e));return{nonStrided:h.every(t=>1===t),$begin:u,$end:c,$strides:h,size:w,newShape:m,outShape:_}}class hO{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class dO{constructor(){this.classNameMap={}}static getMap(){return null==dO.instance&&(dO.instance=new dO),dO.instance}static register(t){dO.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function pO(t){GC(null!=t.className,()=>"Class being registered does not have the static className property defined."),GC("string"==typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),GC(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),dO.register(t)}function fO(t){FI().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function mO(){return _A}function gO(){return _A.memory()}function yO(t,e){return _A.tidy(t,e)}function bO(t){gA(t).forEach(t=>t.dispose())}function vO(t){return _A.keep(t)}function wO(t,e,n=1){return _A.registerBackend(t,e,n)}function _O(t){return _A.customGrad(t)}function xO(t,e){if((fI(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&fI(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return DA(t,[],[],e)}nA=fO;class kO extends hO{minimize(t,e=!1,n){const{value:r,grads:s}=this.computeGradients(t,n);if(null!=n){const t=n.map(t=>({name:t.name,tensor:s[t.name]}));this.applyGradients(t)}else this.applyGradients(s);return bO(s),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return function(t,e){GC(_I(t),()=>"The f passed in variableGrads(f) must be a function"),GC(null==e||Array.isArray(e)&&e.every(t=>t instanceof sA),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=e;if(!n){e=[];for(const t in _A.registeredVariables)e.push(_A.registeredVariables[t])}const r=n?e.filter(t=>!t.trainable):null,s=e.length;GC((e=e.filter(t=>t.trainable)).length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const{value:i,grads:a}=_A.gradients(t,e,null,!0);GC(a.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),GC(0===i.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const o={};return e.forEach((t,e)=>{null!=a[e]&&(o[t.name]=a[e])}),null!=r&&r.forEach(t=>o[t.name]=null),{value:i,grads:o}}(t,e)}dispose(){null!=this.iterations_&&bO(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:xO(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(kO,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});const SO=RA({abs_:function(t){const e=NA(t,"x","abs");return _A.runKernel("complex64"===e.dtype?cE:zI,{x:e})}}),CO=RA({add_:function(t,e){let n=NA(t,"a","add"),r=NA(e,"b","add");return[n,r]=pA(n,r),_A.runKernel(WI,{a:n,b:r})}}),IO=RA({all_:function(t,e=null,n=!1){const r=NA(t,"x","all","bool");return _A.runKernel(jI,{x:r},{axis:e,keepDims:n})}}),EO=RA({any_:function(t,e=null,n=!1){const r=NA(t,"x","any","bool");return _A.runKernel(HI,{x:r},{axis:e,keepDims:n})}}),TO=RA({argMax_:function(t,e=0){const n=NA(t,"x","argMax");return _A.runKernel(qI,{x:n},{axis:e})}});function NO(t,e,n,r,s="NHWC",i){return OO(t,[...e,t[3]],n,i,r,null,null,VO(s))}function AO(t,e,n,r,s,i,a="channelsLast"){const[o,l]=$O(e);let u;if("channelsLast"===a)u=[o,l,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);u=[o,l,t[1],t[1]]}return OO(t,u,n,r,s,i,!1,a)}function RO(t,e,n,r,s,i,a="NDHWC"){const[o,l,u]=MO(e);let c,h;if("NDHWC"===a)h="channelsLast",c=[o,l,u,t[4],t[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);h="channelsFirst",c=[o,l,u,t[1],t[1]]}return DO(t,c,n,r,s,!1,h,i)}function OO(t,e,n,r,s,i,a=!1,o="channelsLast"){let[l,u,c,h]=[-1,-1,-1,-1];if("channelsLast"===o)[l,u,c,h]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);[l,h,u,c]=t}const[d,p,,f]=e,[m,g]=$O(n),[y,b]=$O(r),v=LO(d,y),w=LO(p,b),{padInfo:_,outHeight:x,outWidth:k}=function(t,e,n,r,s,i,a,o,l){let u,c,h;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const s=function(t,e,n,r,s){null==r&&(r=FO(t,e,n));const i=t[1];return[PO((t[0]-e+2*r)/n+1,s),PO((i-e+2*r)/n+1,s)]}([e,n],i,r,t,o);c=s[0],h=s[1]}else if("same"===t){c=Math.ceil(e/r),h=Math.ceil(n/s);const t=Math.max(0,(c-1)*r+i-e),o=Math.max(0,(h-1)*s+a-n),l=Math.floor(t/2),d=t-l,p=Math.floor(o/2);u={top:l,bottom:d,left:p,right:o-p,type:"SAME"}}else if("valid"===t)u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),h=Math.ceil((n-a+1)/s);else{if("object"!=typeof t)throw Error("Unknown padding parameter: "+t);{const d="channelsLast"===l?t[1][0]:t[2][0],p="channelsLast"===l?t[1][1]:t[2][1],f="channelsLast"===l?t[2][0]:t[3][0],m="channelsLast"===l?t[2][1]:t[3][1];u={top:d,bottom:p,left:f,right:m,type:0===d&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},c=PO((e-i+d+p)/r+1,o),h=PO((n-a+f+m)/s+1,o)}}return{padInfo:u,outHeight:c,outWidth:h}}(s,u,c,m,g,v,w,i,o),S=a?f*h:f;let C;return"channelsFirst"===o?C=[l,S,x,k]:"channelsLast"===o&&(C=[l,x,k,S]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:h,outHeight:x,outWidth:k,outChannels:S,padInfo:_,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:v,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:b,inShape:t,outShape:C,filterShape:e}}function DO(t,e,n,r,s,i=!1,a="channelsLast",o){let[l,u,c,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===a)[l,u,c,h,d]=t;else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);[l,d,u,c,h]=t}const[p,f,m,,g]=e,[y,b,v]=MO(n),[w,_,x]=MO(r),k=LO(p,w),S=LO(f,_),C=LO(m,x),{padInfo:I,outDepth:E,outHeight:T,outWidth:N}=function(t,e,n,r,s,i,a,o,l,u,c){let h,d,p,f;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,s,i){null==s&&(s=FO(t,e,r));const a=t[1],o=t[2];return[PO((t[0]-e+2*s)/r+1,i),PO((a-e+2*s)/r+1,i),PO((o-e+2*s)/r+1,i),1]}([e,n,r,1],o,0,s,t,c);d=i[0],p=i[1],f=i[2]}else if("same"===t){d=Math.ceil(e/s),p=Math.ceil(n/i),f=Math.ceil(r/a);const t=(d-1)*s+o-e,c=(p-1)*i+l-n,m=(f-1)*a+u-r,g=Math.floor(t/2),y=t-g,b=Math.floor(c/2),v=c-b,w=Math.floor(m/2);h={top:b,bottom:v,left:w,right:m-w,front:g,back:y,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-o+1)/s),p=Math.ceil((n-l+1)/i),f=Math.ceil((r-u+1)/a)}return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}(s,u,c,h,y,b,v,k,S,C,o),A=i?g*d:g;let R;return"channelsFirst"===a?R=[l,A,E,T,N]:"channelsLast"===a&&(R=[l,E,T,N,A]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:c,inWidth:h,inChannels:d,outDepth:E,outHeight:T,outWidth:N,outChannels:A,padInfo:I,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:k,effectiveFilterHeight:S,effectiveFilterWidth:C,dilationDepth:w,dilationHeight:_,dilationWidth:x,inShape:t,outShape:R,filterShape:e}}function FO(t,e,n,r=1){const s=LO(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function $O(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function MO(t){return"number"==typeof t?[t,t,t]:t}function LO(t,e){return e<=1?t:t+(t-1)*(e-1)}function PO(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function zO(t){const[e,n,r]=$O(t);return 1===e&&1===n&&1===r}function BO(t,e){return zO(t)||zO(e)}function VO(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}const WO=RA({reshape_:function(t,e){const n=NA(t,"x","reshape","string_or_numeric");return _A.runKernel(WT,{x:n},{shape:e})}}),UO=RA({avgPool_:function(t,e,n,r,s){const i=NA(t,"x","avgPool","float32");GC(BO(n,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`);let a=i,o=!1;3===i.rank&&(o=!0,a=WO(i,[1,i.shape[0],i.shape[1],i.shape[2]])),GC(4===a.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),null!=s&&GC(tI(r),()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${s} but got pad ${r}.`);let l=_A.runKernel(JI,{x:a},{filterSize:e,strides:n,pad:r,dimRoundingMode:s});return l=ER(l,i.dtype),o?WO(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),jO=RA({avgPool3d_:function(t,e,n,r,s,i="NDHWC",a){null==a?a=[1,1,1]:fO("dilations is deprecated, this field will be gone in v3.0.0.");const o=NA(t,"x","avgPool3d","float32");let l=o,u=!1;4===o.rank&&(u=!0,l=WO(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),GC(5===l.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),GC("NDHWC"===i,()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i),GC(BO(n,a),()=>`Error in avgPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),null!=s&&GC(tI(r),()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${s} but got pad ${r}.`);let c=_A.runKernel(eE,{x:l},{filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i,dilations:a});return c=ER(c,l.dtype),u?WO(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),HO=RA({batchNorm_:function(t,e,n,r,s,i){null==i&&(i=.001);const a=NA(t,"x","batchNorm"),o=NA(e,"mean","batchNorm"),l=NA(n,"variance","batchNorm");let u,c;null!=s&&(u=NA(s,"scale","batchNorm")),null!=r&&(c=NA(r,"offset","batchNorm")),GC(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),GC(null==c||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),GC(null==u||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h=function(t){let e;return e=0===t.rank||1===t.rank?WO(t,[1,1,1,t.size]):2===t.rank?WO(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?WO(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(a),d=_A.runKernel(jE,{x:h,scale:u,offset:c,mean:o,variance:l},{varianceEpsilon:i});return WO(d,a.shape)}}),qO=RA({batchNorm2d_:function(t,e,n,r,s,i){const a=NA(t,"x","batchNorm"),o=NA(e,"mean","batchNorm"),l=NA(n,"variance","batchNorm");let u,c;return null!=s&&(u=NA(s,"scale","batchNorm")),null!=r&&(c=NA(r,"offset","batchNorm")),GC(2===a.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+a.rank+"."),GC(2===o.rank||1===o.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),GC(2===l.rank||1===l.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),null!=u&&GC(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),null!=c&&GC(2===c.rank||1===c.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),HO(a,o,l,c,u,i)}}),GO=RA({batchNorm3d_:function(t,e,n,r,s,i){const a=NA(t,"x","batchNorm"),o=NA(e,"mean","batchNorm"),l=NA(n,"variance","batchNorm");let u,c;return null!=s&&(u=NA(s,"scale","batchNorm")),null!=r&&(c=NA(r,"offset","batchNorm")),GC(3===a.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+a.rank+"."),GC(3===o.rank||1===o.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),GC(3===l.rank||1===l.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),null!=u&&GC(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),null!=c&&GC(3===c.rank||1===c.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),HO(a,o,l,c,u,i)}}),KO=RA({batchNorm4d_:function(t,e,n,r,s,i){const a=NA(t,"x","batchNorm"),o=NA(e,"mean","batchNorm"),l=NA(n,"variance","batchNorm");let u,c;return null!=s&&(u=NA(s,"scale","batchNorm")),null!=r&&(c=NA(r,"offset","batchNorm")),GC(4===a.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+a.rank+"."),GC(4===o.rank||1===o.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),GC(4===l.rank||1===l.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),null!=u&&GC(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),null!=c&&GC(4===c.rank||1===c.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),HO(a,o,l,c,u,i)}}),XO=RA({clipByValue_:function(t,e,n){const r=NA(t,"x","clipByValue");return GC(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),_A.runKernel(lE,{x:r},{clipValueMin:e,clipValueMax:n})}}),YO=RA({concat_:function(t,e=0){GC(t.length>=1,()=>"Pass at least one tensor to concat");const n=AA(t,"tensors","concat","string_or_numeric");return"complex64"===n[0].dtype&&n.forEach(t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)}),1===n.length?TR(n[0]):_A.runKernel(hE,n,{axis:e})}}),ZO=RA({concat1d_:function(t){return YO(t,0)}}),QO=RA({concat2d_:function(t,e){return YO(t,e)}}),JO=RA({concat3d_:function(t,e){return YO(t,e)}}),tD=RA({concat4d_:function(t,e){return YO(t,e)}}),eD=RA({conv2d_:function(t,e,n,r,s="NHWC",i=[1,1],a){const o=NA(t,"x","conv2d"),l=NA(e,"filter","conv2d");let u=o,c=!1;3===o.rank&&(c=!0,u=WO(o,[1,o.shape[0],o.shape[1],o.shape[2]])),GC(4===u.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),GC(4===l.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+l.rank+"."),null!=a&&GC(tI(r),()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`);const h="NHWC"===s?u.shape[3]:u.shape[1];GC(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),GC(BO(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const d=_A.runKernel(dE,{x:u,filter:l},{strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a});return c?WO(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),nD=RA({conv1d_:function(t,e,n,r,s="NWC",i=1,a){const o=NA(t,"x","conv1d"),l=NA(e,"filter","conv1d");let u=o,c=!1;2===o.rank&&(c=!0,u=WO(o,[1,o.shape[0],o.shape[1]])),GC(3===u.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),GC(3===l.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+l.rank+"."),null!=a&&GC(tI(r),()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`),GC(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),GC(BO(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),GC("NWC"===s,()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const h=WO(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=WO(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=eD(d,h,[1,n],r,"NHWC",[1,i],a);return WO(p,c?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}}),rD=RA({conv2DBackpropInput_:function(t,e,n,r,s,i="NHWC",a){GC(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,l=e,u=!1;3===e.rank&&(u=!0,l=WO(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,t[0],t[1],t[2]]),GC(4===o.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+o.length+"."),GC(4===l.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank),GC(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank);const c="NHWC"===i?o[3]:o[1],h="NHWC"===i?l.shape[3]:l.shape[1];GC(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),GC(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),null!=a&&GC(tI(s),()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${a} but got pad ${s}.`);const d=_A.runKernel(fE,{dy:l,filter:n},{strides:r,pad:s,dataFormat:i,dimRoundingMode:a,inputShape:o});return u?WO(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),sD=RA({conv2dTranspose_:function(t,e,n,r,s,i){const a=NA(t,"x","conv2dTranspose"),o=NA(e,"filter","conv2dTranspose");return rD(n,a,o,r,s,"NHWC",i)}}),iD=RA({conv3d_:function(t,e,n,r,s="NDHWC",i=[1,1,1]){const a=NA(t,"x","conv3d"),o=NA(e,"filter","conv3d");let l=a,u=!1;4===a.rank&&(u=!0,l=WO(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),GC(5===l.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),GC(5===o.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+o.rank+"."),GC(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),GC(BO(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),GC("NDHWC"===s,()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`);const c=_A.runKernel(mE,{x:l,filter:o},{strides:n,pad:r,dataFormat:s,dilations:i});return u?WO(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),aD=RA({depthwiseConv2d_:function(t,e,n,r,s="NHWC",i=[1,1],a){const o=NA(t,"x","depthwiseConv2d"),l=NA(e,"filter","depthwiseConv2d");let u=o,c=!1;3===o.rank&&(c=!0,u=WO(o,[1,o.shape[0],o.shape[1],o.shape[2]])),GC(4===u.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),GC(4===l.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+"."),GC(u.shape[3]===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),null!=a&&GC(tI(r),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`);const h=_A.runKernel(SE,{x:u,filter:l},{strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a});return c?WO(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),oD=RA({floorDiv_:function(t,e){let n=NA(t,"a","floorDiv"),r=NA(e,"b","floorDiv");return[n,r]=pA(n,r),_A.runKernel(UE,{a:n,b:r})}}),lD=RA({div_:function(t,e){let n=NA(t,"a","div"),r=NA(e,"b","div");return[n,r]=pA(n,r),"int32"===n.dtype&&"int32"===r.dtype?oD(n,r):_A.runKernel(RE,{a:n,b:r},{})}}),uD=RA({elu_:function(t){const e=NA(t,"x","elu");return _A.runKernel(OE,{x:e})}});function cD(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const i=n-1-s,a=t[i]||1;(e[e.length-1-s]||1)>1&&1===a&&r.unshift(i)}return r}function hD(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],i=e.length-r-1,a=e[i];(null==s||1===s&&a>1)&&n.unshift(i)}return n}function dD(t,e){const n=[],r=Math.max(t.length,e.length);for(let s=0;s<r;s++){let r=t[t.length-s-1];null==r&&(r=1);let i=e[e.length-s-1];if(null==i&&(i=1),1===r)n.unshift(i);else if(1===i)n.unshift(r);else{if(r!==i)throw Error(`Operands could not be broadcast together with shapes ${t} and ${e}.`);n.unshift(r)}}return n}const pD=RA({equal_:function(t,e){let n=NA(t,"a","equal"),r=NA(e,"b","equal");return[n,r]=pA(n,r),dD(n.shape,r.shape),_A.runKernel($E,{a:n,b:r})}}),fD=RA({expandDims_:function(t,e=0){const n=NA(t,"x","expandDims","string_or_numeric");return GC(e<=n.rank,()=>"Axis must be <= rank of the tensor"),_A.runKernel(LE,{input:n},{dim:e})}}),mD=RA({tile_:function(t,e){const n=NA(t,"x","tile","string_or_numeric");return GC(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`),_A.runKernel(bN,{x:n},{reps:e})}}),gD=RA({eye_:function(t,e,n,r="float32"){null==e&&(e=t);const s=IR([t,e],r),i=t<=e?t:e;for(let o=0;o<i;++o)s.set(1,o,o);const a=WO(s.toTensor(),[t,e]);if(null==n)return a;if(1===n.length)return mD(fD(a,0),[n[0],1,1]);if(2===n.length)return mD(fD(fD(a,0),0),[n[0],n[1],1,1]);if(3===n.length)return mD(fD(fD(fD(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});function yD(t,e,n){return _A.runKernel(BE,{},{shape:t,value:e,dtype:n})}const bD=RA({floor_:function(t){const e=NA(t,"x","floor");return _A.runKernel(WE,{x:e})}}),vD=RA({gather_:function(t,e,n=0,r=0){const s=NA(t,"x","gather"),i=NA(e,"indices","gather","int32");return _A.runKernel(HE,{x:s,indices:i},{axis:n,batchDims:r})}}),wD=RA({greater_:function(t,e){let n=NA(t,"a","greater"),r=NA(e,"b","greater");return[n,r]=pA(n,r),dD(n.shape,r.shape),_A.runKernel(GE,{a:n,b:r})}}),_D=RA({greaterEqual_:function(t,e){let n=NA(t,"a","greaterEqual"),r=NA(e,"b","greaterEqual");return[n,r]=pA(n,r),dD(n.shape,r.shape),_A.runKernel(KE,{a:n,b:r})}}),xD=RA({leakyRelu_:function(t,e=.2){const n=NA(t,"x","leakyRelu");return _A.runKernel(eT,{x:n},{alpha:e})}}),kD=RA({log_:function(t){const e=NA(t,"x","log");return _A.runKernel(iT,{x:e})}}),SD=RA({exp_:function(t){const e=NA(t,"x","exp");return _A.runKernel(ME,{x:e})}}),CD=RA({max_:function(t,e=null,n=!1){const r=NA(t,"x","max");return _A.runKernel(dT,{x:r},{reductionIndices:e,keepDims:n})}}),ID=RA({mul_:function(t,e){let n=NA(t,"a","mul"),r=NA(e,"b","mul");return[n,r]=pA(n,r),_A.runKernel(CT,{a:n,b:r})}}),ED=RA({sub_:function(t,e){let n=NA(t,"a","sub"),r=NA(e,"b","sub");return[n,r]=pA(n,r),_A.runKernel(pN,{a:n,b:r})}}),TD=RA({sum_:function(t,e=null,n=!1){let r=NA(t,"x","sum");return"bool"===r.dtype&&(r=ER(r,"int32")),_A.runKernel(oN,{x:r},{axis:e,keepDims:n})}}),ND=RA({logSoftmax_:function(t,e=-1){const n=NA(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return _O((t,n)=>{const r=CD(t,e,!0),s=ED(t,r),i=ED(ER(s,"float32"),kD(TD(SD(s),e,!0)));return n([i]),{value:i,gradFunc:(t,n)=>{const[r]=n,s=SD(r);return ED(t,ID(TD(t,e,!0),s))}}})(n)}}),AD=RA({logicalAnd_:function(t,e){const n=NA(t,"a","logicalAnd","bool"),r=NA(e,"b","logicalAnd","bool");return dD(n.shape,r.shape),_A.runKernel(oT,{a:n,b:r})}}),RD=RA({maxPool_:function(t,e,n,r,s){const i=NA(t,"x","maxPool");let a=i,o=!1;3===i.rank&&(o=!0,a=WO(i,[1,i.shape[0],i.shape[1],i.shape[2]])),GC(4===a.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),GC(BO(n,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`),null!=s&&GC(tI(r),()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${s} but got pad ${r}.`);const l=_A.runKernel(fT,{x:a},{filterSize:e,strides:n,pad:r,dimRoundingMode:s});return o?WO(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),OD=RA({maxPool3d_:function(t,e=[1,1,1],n,r,s,i="NDHWC",a){null==a?a=[1,1,1]:fO("dilations is deprecated, this field will be gone in v3.0.0.");const o=NA(t,"x","maxPool3d");let l=o,u=!1;4===o.rank&&(u=!0,l=WO(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),GC(5===l.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),GC("NDHWC"===i,()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i),GC(BO(n,a),()=>`Error in maxPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),null!=s&&GC(tI(r),()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${s} but got pad ${r}.`);const c=_A.runKernel(gT,{x:l},{filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i,dilations:a});return u?WO(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),DD=RA({maximum_:function(t,e){let n=NA(t,"a","maximum"),r=NA(e,"b","maximum");return[n,r]=pA(n,r),"bool"===n.dtype&&(n=ER(n,"int32"),r=ER(r,"int32")),dD(n.shape,r.shape),_A.runKernel(pT,{a:n,b:r})}}),FD=RA({mean_:function(t,e=null,n=!1){const r=NA(t,"x","mean");return _A.runKernel(vT,{x:r},{axis:e,keepDims:n})}}),$D=RA({min_:function(t,e=null,n=!1){const r=NA(t,"x","min");return _A.runKernel(wT,{x:r},{axis:e,keepDims:n})}}),MD=RA({minimum_:function(t,e){let n=NA(t,"a","minimum"),r=NA(e,"b","minimum");return[n,r]=pA(n,r),"bool"===n.dtype&&(n=ER(n,"int32"),r=ER(r,"int32")),dD(n.shape,r.shape),_A.runKernel(_T,{a:n,b:r})}});function LD(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function PD(t,e,n){const r=t.length+e.length,s=[];let i=0,a=0;for(let o=0;o<r;o++)-1===n.indexOf(o)?s.push(t[i++]):s.push(e[a++]);return s}function zD(t,e){const n=[],r=t.length;for(let s=0;s<r;s++)-1===e.indexOf(s)&&n.push(t[s]);return[n,e.map(e=>t[e])]}function BD(t,e){return PD(t,e.map(t=>1),e)}function VD(t,e,n){GC(LD(e,n),()=>t+" supports only inner-most axes for now. "+`Got axes ${e} and rank-${n} input.`)}function WD(t,e){if(LD(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach(t=>n.push(t)),n}function UD(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function jD(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}const HD=RA({square_:function(t){const e=NA(t,"x","square");return _A.runKernel("Square",{x:e},{})}}),qD=RA({moments_:function(t,e=null,n=!1){const r=oI(e,(t=NA(t,"x","moments")).shape),s=FD(t,r,n);let i=s.shape;n||(i=BD(s.shape,r));const a=HD(ED(ER(t,"float32"),WO(s,i)));return{mean:s,variance:FD(a,r,n)}}}),GD=RA({neg_:function(t){const e=NA(t,"x","neg");return _A.runKernel(IT,{x:e})}}),KD=RA({notEqual_:function(t,e){let n=NA(t,"a","notEqual"),r=NA(e,"b","notEqual");return[n,r]=pA(n,r),dD(n.shape,r.shape),_A.runKernel(ET,{a:n,b:r})}}),XD=RA({oneHot_:function(t,e,n=1,r=0){if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);const s=NA(t,"indices","oneHot","int32");return _A.runKernel(OT,{indices:s},{depth:e,onValue:n,offValue:r})}});function YD(t,e="float32"){if("complex64"===e){const e=YD(t,"float32"),n=YD(t,"float32");return OA(e,n)}const n=EI(ZC(t),e);return _A.makeTensor(n,t,e)}function ZD(t,e="float32"){if("complex64"===e){const e=ZD(t,"float32"),n=YD(t,"float32");return OA(e,n)}const n=II(ZC(t),e);return _A.makeTensor(n,t,e)}const QD=RA({onesLike_:function(t){const e=NA(t,"x","onesLike");return _A.runKernel(RT,{x:e})}}),JD=RA({pad_:function(t,e,n=0){const r=NA(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return _A.runKernel(FT,{x:r},{paddings:e,constantValue:n})}}),tF=RA({pow_:function(t,e){let n=NA(t,"base","pow"),r=NA(e,"exp","pow");return[n,r]=pA(n,r),_A.runKernel($T,{a:n,b:r})}}),eF=RA({prelu_:function(t,e){const n=NA(t,"x","prelu"),r=NA(e,"alpha","prelu");return _A.runKernel(MT,{x:n,alpha:r})}});var nF=n("YSVl");class rF{constructor(t,e,n,r,s){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const i=s||Math.random();this.random=nF.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,s,i;do{r=2*this.random()-1,s=2*this.random()-1,i=r*r+s*s}while(i>=1||0===i);const a=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*r*a,e=this.mean+this.stdDev*s*a,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class sF{constructor(t=0,e=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=nF.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const iF=RA({randomNormal_:function(t,e=0,n=1,r,s){if(null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);const i=new rF(e,n,r,!1,s),a=IR(t,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}}),aF=RA({randomUniform_:function(t,e=0,n=1,r="float32",s){const i=IR(t,r),a=new sF(e,n,null,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}}),oF=RA({relu_:function(t){const e=NA(t,"x","relu");return _A.runKernel(VT,{x:e})}}),lF=RA({reverse_:function(t,e){const n=NA(t,"x","reverse");return _A.runKernel(KT,{x:n},{dims:e})}}),uF=RA({selu_:function(t){const e=NA(t,"x","selu");return _A.runKernel(JT,{x:e})}}),cF=RA({separableConv2d_:function(t,e,n,r,s,i=[1,1],a="NHWC"){const o=NA(t,"x","separableConv2d"),l=NA(e,"depthwiseFilter","separableConv2d"),u=NA(n,"pointwiseFilter","separableConv2d");let c=o,h=!1;if(3===o.rank&&(h=!0,c=WO(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");GC(4===c.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),GC(4===l.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),GC(4===u.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),GC(1===u.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),GC(1===u.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const d=l.shape[2],p=l.shape[3];GC(u.shape[2]===d*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*p}, but got ${u.shape[2]}.`);const f=aD(c,l,r,s,a,i),m=eD(f,u,1,"valid",a);return h?WO(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),hF=RA({sigmoid_:function(t){const e=NA(t,"x","sigmoid");return _A.runKernel(sN,{x:e})}}),dF=RA({slice_:function(t,e,n){const r=NA(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");return _A.runKernel(tN,{x:r},{begin:e,size:n})}}),pF=RA({slice1d_:function(t,e,n){const r=NA(t,"x","slice1d");return GC(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),dF(r,[e],[n])}}),fF=RA({slice2d_:function(t,e,n){const r=NA(t,"x","slice2d");return GC(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),dF(r,e,n)}}),mF=RA({slice3d_:function(t,e,n){const r=NA(t,"x","slice3d");return GC(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),dF(r,e,n)}}),gF=RA({slice4d_:function(t,e,n){const r=NA(t,"x","slice4d");return GC(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),dF(r,e,n)}}),yF=RA({softmax_:function(t,e=-1){const n=NA(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);return _A.runKernel(cN,{logits:n},{dim:e})}}),bF=RA({softplus_:function(t){const e=NA(t,"x","softplus");return _A.runKernel(iN,{x:e})}}),vF=RA({split_:function(t,e,n=0){const r=NA(t,"x","split");return _A.runKernel(uN,{x:r},{numOrSizeSplits:e,axis:n})}}),wF=RA({sqrt_:function(t){const e=NA(t,"x","sqrt");return _A.runKernel(aN,{x:e})}}),_F=RA({squeeze_:function(t,e){const n=NA(t,"x","squeeze");return WO(n,lI(n.shape,e).newShape)}}),xF=RA({stack_:function(t,e=0){const n=AA(t,"tensors","stack","string_or_numeric");return GC(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&GC(e<=n[0].rank,()=>"Axis must be <= rank of the tensor"),_A.runKernel(DT,n,{axis:e})}}),kF=RA({tanh_:function(t){const e=NA(t,"x","tanh");return _A.runKernel(yN,{x:e})}});function SF(t,e){XC(t);const n=IA(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return DA(t,null,n,e)}function CF(t,e,n){if(XC(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=IA(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return DA(t,e,r,n)}const IF=RA({truncatedNormal_:function(t,e=0,n=1,r,s){if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const i=new rF(e,n,r,!0,s),a=IR(t,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}}),EF=RA({unstack_:function(t,e=0){const n=NA(t,"x","unstack","string_or_numeric");return GC(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`),_A.runKernel(xN,{value:n},{axis:e})}}),TF=RA({broadcastTo_:function(t,e){let n=NA(t,"broadcastTo","x");const r=n.shape;if(e.some(t=>!(t>0)||t%1!=0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=WO(n,t)}const s=n.shape,i=Array.from(e);for(let a=e.length-1;a>=0;a--)if(s[a]===e[a])i[a]=1;else if(1!==n.shape[a])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);return 0===i.map((t,e)=>t>1?e:-1).filter(t=>t>=0).length?TR(n):_A.runKernel(bN,{x:n},{reps:i})}}),NF=RA({where_:function(t,e,n){const r=NA(e,"a","where"),s=NA(n,"b","where"),i=NA(t,"condition","where","bool"),a=dD(r.shape,s.shape),o=TF(r,a),l=TF(s,a);return 1===i.rank&&GC(i.shape[0]===r.shape[0],()=>"The first dimension of `a` must match the size of `condition`."),1!==i.rank&&KC(i.shape,l.shape,"Error in where: "),_A.runKernel(QT,{condition:i,t:o,e:l})}}),AF=RA({zerosLike_:function(t){const e=NA(t,"x","zerosLike");return _A.runKernel(SN,{x:e})}}),RF=RA({transpose_:function(t,e){const n=NA(t,"x","transpose");return null==e&&(e=n.shape.map((t,e)=>e).reverse()),GC(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${e}.`),e.forEach(t=>{GC(t>=0&&t<n.rank,()=>"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e)}),n.rank<=1?n.clone():_A.runKernel(wN,{x:n},{perm:e})}}),OF=RA({dropout_:function(t,e,n,r){const s=NA(t,"x","dropout");if(GC("float32"===s.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),GC(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),0===e)return t instanceof rA?s.clone():s;const i=function(t,e){if(null==e)return t.shape.slice();if(JC(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)n.push(null==e[r]&&null!=t.shape[r]?t.shape[r]:e[r]);return n}return e}(s,n),a=1-e,o=lD(bD(CO(aF(i,0,1,"float32",r),a)),a);return ID(s,o)}}),DF=RA({imag_:function(t){const e=NA(t,"input","imag");return _A.runKernel(ZE,{input:e})}}),FF=RA({real_:function(t){const e=NA(t,"input","real");return _A.runKernel(zT,{input:e})}}),$F=RA({fft_:function(t){return GC("complex64"===t.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`),_A.runKernel(zE,{input:t})}}),MF=RA({rfft_:function(t,e){GC("float32"===t.dtype,()=>"The dtype for rfft() must be real value but got "+t.dtype);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(null!=e&&e<n){const r=t.shape.map(t=>0),i=t.shape.map(t=>t);i[t.shape.length-1]=e,s=dF(t,r,i),n=e}else if(null!=e&&e>n){const r=t.shape.map(t=>t);r[t.shape.length-1]=e-n,s=YO([t,YD(r)],t.shape.length-1),n=e}else s=t;const i=AF(s),a=WO(OA(s,i),[r,n]),o=$F(a),l=Math.floor(n/2)+1,u=FF(o),c=DF(o),h=vF(u,[l,n-l],u.shape.length-1),d=vF(c,[l,n-l],c.shape.length-1),p=s.shape.slice();return p[s.shape.length-1]=l,WO(OA(h[0],d[0]),p)}}),LF=RA({ifft_:function(t){return GC("complex64"===t.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`),_A.runKernel(YE,{input:t})}}),PF=RA({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=WO(t,[n,e]);r=LF(s)}else{const s=[n,2*(e-1)],i=WO(FF(t),[n,e]),a=WO(DF(t),[n,e]),o=lF(dF(i,[0,1],[n,e-2]),1),l=ID(lF(dF(a,[0,1],[n,e-2]),1),xO(-1)),u=YO([i,o],1),c=YO([a,l],1),h=WO(OA(u,c),[s[0],s[1]]);r=LF(h)}if(r=FF(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=WO(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}}),zF=RA({conv2DBackpropFilter_:function(t,e,n,r,s,i="NHWC",a){let o=t;3===t.rank&&(o=WO(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=WO(e,[1,e.shape[0],e.shape[1],e.shape[2]])),GC(4===o.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+o.shape+"."),GC(4===l.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+"."),GC(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+".");const u="NHWC"===i?o.shape[3]:o.shape[1],c="NHWC"===i?l.shape[3]:l.shape[1];return GC(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),GC(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),null!=a&&GC(tI(s),()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${a} but got pad ${s}.`),_A.runKernel(pE,{x:o,dy:l},{strides:r,pad:s,dataFormat:i,dimRoundingMode:a,filterShape:n})}}),BF=RA({relu6_:function(t){const e=NA(t,"x","relu6");return _A.runKernel(GT,{x:e})}}),VF=RA({step_:function(t,e=0){const n=NA(t,"x","step");return _A.runKernel(CN,{x:n},{alpha:e})}});function WF(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return ID(t,VF(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function UF(t,e){let n=e;const r=hD(t.shape,e.shape);return r.length>0&&(n=TD(n,r)),WO(n,t.shape)}function jF(t,e,n,r){if("linear"===e)return t;if("relu"===e)return oF(t);if("elu"===e)return uD(t);if("relu6"===e)return BF(t);if("prelu"===e)return eF(t,n);if("leakyrelu"===e)return xD(t,r);throw new Error(`Unknown fused activation ${e}.`)}const HF=(t,e)=>!(t>0)||"linear"===e,qF=RA({fusedConv2d_:function({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(!1===HF(_A.state.gradientDepth,l=l||"linear")){let h=eD(t,e,n,r,s,i,a);return null!=o&&(h=CO(h,o)),jF(h,l,u,c)}const h=NA(t,"x","conv2d"),d=NA(e,"filter","conv2d");let p=h,f=!1;3===h.rank&&(f=!0,p=WO(h,[1,h.shape[0],h.shape[1],h.shape[2]])),GC(4===p.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+p.rank+"."),GC(4===d.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+d.rank+"."),null!=a&&GC(tI(r),()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`),GC(p.shape[3]===d.shape[2],()=>`Error in conv2d: depth of input (${p.shape[3]}) must match input depth for filter ${d.shape[2]}.`),GC(BO(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),GC("NHWC"===s,()=>`Error in conv2d: got dataFormat of ${s} but only NHWC is currently supported.`);const m=OO(p.shape,d.shape,n,i,r,a);let g,y;null!=o&&(g=NA(o,"bias","fused conv2d"),[g]=pA(g,h),dD(m.outShape,g.shape)),null!=u&&(y=NA(u,"prelu weights","fused conv2d"));const b=(t,e)=>{const[s,a,o,u]=e,c=WF(t,o,l);GC(zO(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const h=[rD(a.shape,c,s,n,r),zF(a,c,s.shape,n,r)];if(null!=u){const t=UF(u,c);h.push(t)}return h},v={x:p,filter:d,bias:g,preluActivationWeights:y},w={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return null==o?_O((t,e,n)=>{let r=_A.runKernel(NN,v,w);return n([e,t,r]),f&&(r=WO(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}})(p,d):_O((t,e,n,r)=>{let s=_A.runKernel(NN,v,w);return r([e,t,s,n]),f&&(s=WO(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:b}})(p,d,g)}}),GF=RA({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,s,i=[1,1],a){let o=t;3===t.rank&&(o=WO(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;return 3===l.rank&&(l=WO(e,[1,e.shape[0],e.shape[1],e.shape[2]])),_A.runKernel(CE,{x:o,dy:l},{strides:r,pad:s,dimRoundingMode:a,dilations:i,filterShape:n})}}),KF=RA({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,s,i=[1,1],a){let o=e,l=!1;3===e.rank&&(l=!0,o=WO(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u=_A.runKernel(IE,{dy:o,filter:n},{strides:r,pad:s,dimRoundingMode:a,dilations:i,inputShape:t});return l?WO(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),XF=RA({fusedDepthwiseConv2d_:function({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(!1===HF(_A.state.gradientDepth,l)){let h=aD(t,e,n,r,s,i,a);return null!=o&&(h=CO(h,o)),jF(h,l,u,c)}const h=NA(t,"x","depthwiseConv2d"),d=NA(e,"filter","depthwiseConv2d");let p=h,f=!1;3===h.rank&&(f=!0,p=WO(h,[1,h.shape[0],h.shape[1],h.shape[2]])),GC(4===p.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),GC(4===d.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),GC(p.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),null==i&&(i=[1,1]),GC(BO(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),null!=a&&GC(tI(r),()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${a} but got pad ${r}.`);const m=OO(p.shape,d.shape,n,i,r,a,!0);let g,y;null!=o&&(g=NA(o,"bias","fused conv2d"),[g]=pA(g,h),dD(m.outShape,g.shape)),null!=u&&(y=NA(u,"prelu weights","fused depthwiseConv2d"));const b=(t,e)=>{GC(zO(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[s,o,u,c]=e,h=WF(t,u,l),d=KF(o.shape,h,s,n,r,i,a),p=GF(o,h,s.shape,n,r,i,a);return null!=c?[d,p,UF(g,h)]:[d,p]},v={x:p,filter:d,bias:g,preluActivationWeights:y},w={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a,activation:l,leakyreluAlpha:c};return null==o?_O((t,e,n)=>{let r=_A.runKernel(AN,v,w);return n([e,t,r]),f&&(r=WO(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}})(p,d):_O((t,e,n,r)=>{let s=_A.runKernel(AN,v,w);return r([e,t,s,n]),f&&(s=WO(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:b}})(p,d,g)}}),YF=RA({matMul_:function(t,e,n=!1,r=!1){let s=NA(t,"a","matMul"),i=NA(e,"b","matMul");return[s,i]=pA(s,i),_A.runKernel(rE,{a:s,b:i},{transposeA:n,transposeB:r})}}),ZF=RA({fusedMatMul_:function({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o}){if(!1===HF(_A.state.gradientDepth,i)){let l=YF(t,e,n,r);return null!=s&&(l=CO(l,s)),jF(l,i,a,o)}let l=NA(t,"a","fused matMul"),u=NA(e,"b","fused matMul");[l,u]=pA(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=r?u.shape[u.rank-1]:u.shape[u.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),m=u.shape.slice(0,-2),g=ZC(f),y=ZC(m);GC(l.rank>=2&&u.rank>=2&&l.rank===u.rank,()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${l.rank} and ${u.rank}.`),GC(JC(f,m),()=>`Error in fused matMul: outer dimensions (${f}) and (${m}) of Tensors with shapes ${l.shape} and `+u.shape+" must match."),GC(c===h,()=>`Error in fused matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=l.shape.slice(0,-2).concat([d,p]),v=WO(l,n?[g,c,d]:[g,d,c]),w=WO(u,r?[y,p,h]:[y,h,p]);let _,x;null!=s&&(_=NA(s,"bias","fused matMul"),[_]=pA(_,l),dD(b,_.shape)),null!=a&&(x=NA(a,"prelu weights","fused matMul"));const k=(t,e)=>{const[a,o,l,u]=e,c=WF(WO(t,l.shape),l,i);let h,d;return n||r?!n&&r?(h=YF(c,o,!1,!1),d=YF(c,a,!0,!1)):n&&!r?(h=YF(o,c,!1,!0),d=YF(a,c,!1,!1)):(h=YF(o,c,!0,!0),d=YF(c,a,!0,!0)):(h=YF(c,o,!1,!0),d=YF(a,c,!0,!1)),null!=s?[h,d,UF(u,c)]:[h,d]},S={a:v,b:w,bias:_,preluActivationWeights:x},C={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:o};return null==s?_O((t,e,n)=>{const r=_A.runKernel(TN,S,C);return n([t,e,r]),{value:WO(r,b),gradFunc:k}})(v,w):_O((t,e,n,r)=>{const s=_A.runKernel(TN,S,C);return r([t,e,s,n]),{value:WO(s,b),gradFunc:k}})(v,w,_)}});function QF(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let i=0;i<t;++i){const a=2*Math.PI*i/(t+r-1);s[i]=e-n*Math.cos(a)}return SF(s,"float32")}RA({hammingWindow_:function(t){return QF(t,.54,.46)}});const JF=RA({hannWindow_:function(t){return QF(t,.5,.5)}}),t$=RA({frame_:function(t,e,n,r=!1,s=0){let i=0;const a=[];for(;i+e<=t.size;)a.push(dF(t,i,e)),i+=n;if(r)for(;i<t.size;){const r=i+e-t.size,o=YO([dF(t,i,e-r),yD([r],s)]);a.push(o),i+=n}return 0===a.length?CF([],[0,e]):WO(YO(a),[a.length,e])}});RA({stft_:function(t,e,n,r,s=JF){null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));const i=t$(t,e,n),a=ID(i,s(e)),o=[];for(let l=0;l<i.shape[0];l++)o.push(MF(dF(a,[l,0],[1,e]),r));return YO(o)}});const e$=RA({cropAndResize_:function(t,e,n,r,s="bilinear",i=0){const a=NA(t,"image","cropAndResize"),o=NA(e,"boxes","cropAndResize","float32"),l=NA(n,"boxInd","cropAndResize","int32"),u=o.shape[0];return GC(4===a.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),GC(2===o.rank&&4===o.shape[1],()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),GC(1===l.rank&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),GC(2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),GC(r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was "+r),GC("bilinear"===s||"nearest"===s,()=>"method must be bilinear or nearest, but was "+s),_A.runKernel(_E,{image:a,boxes:o,boxInd:l},{method:s,extrapolationValue:i,cropSize:r})}}),n$=RA({flipLeftRight_:function(t){const e=NA(t,"image","flipLeftRight","float32");return GC(4===e.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`),_A.runKernel(VE,{image:e},{})}}),r$=RA({rotateWithOffset_:function(t,e,n=0,r=.5){const s=NA(t,"image","rotateWithOffset","float32");return GC(4===s.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`),_A.runKernel(EN,{image:s},{radians:e,fillValue:n,center:r})}});function s$(t,e,n,r,s,i){null==r&&(r=.5),null==s&&(s=Number.NEGATIVE_INFINITY),null==i&&(i=0);const a=t.shape[0];return n=Math.min(n,a),GC(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),GC(2===t.rank,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),GC(4===t.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]),GC(1===e.rank,()=>"scores must be a 1D tensor"),GC(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was `+e.shape[0]),GC(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}const i$=RA({nonMaxSuppression_:function(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=NA(t,"boxes","nonMaxSuppression"),a=NA(e,"scores","nonMaxSuppression"),o=s$(i,a,n,r,s);return _A.runKernel(TT,{boxes:i,scores:a},{maxOutputSize:n=o.maxOutputSize,iouThreshold:r=o.iouThreshold,scoreThreshold:s=o.scoreThreshold})}});function a$(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,s=t.length,i=0,a=!1;for(;r<s;){i=r+(s-r>>>1);const o=n(e,t[i]);o>0?r=i+1:(s=i,a=!o)}return a?r:-r-1}(t,e,n||o$)}(t,e,n);t.splice(r<0?-(r+1):r,0,e)}function o$(t,e){return t>e?1:t<e?-1:0}function l$(t,e,n,r,s){return h$(t,e,n,r,s,0)}function u$(t,e,n,r,s,i){return h$(t,e,n,r,s,0,!1,i,!0)}function c$(t,e,n,r,s,i){return h$(t,e,n,r,s,i,!0)}function h$(t,e,n,r,s,i,a=!1,o=!1,l=!1){const u=[];for(let g=0;g<e.length;g++)e[g]>s&&u.push({score:e[g],boxIndex:g,suppressBeginIndex:0});u.sort(f$);const c=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&u.length>0;){const e=u.pop(),{score:n,boxIndex:i,suppressBeginIndex:a}=e;if(n<s)break;let o=!1;for(let l=h.length-1;l>=a;--l){const n=d$(t,i,h[l]);if(n>=r){o=!0;break}if(e.score=e.score*p$(r,c,n),e.score<=s)break}e.suppressBeginIndex=h.length,o||(e.score===n?(h.push(i),d.push(e.score)):e.score>s&&a$(u,e,f$))}const p=h.length,f=n-p;o&&f>0&&(h.push(...new Array(f).fill(0)),d.push(...new Array(f).fill(0)));const m={selectedIndices:h};return a&&(m.selectedScores=d),l&&(m.validOutputs=p),m}function d$(t,e,n){const r=t.subarray(4*e,4*e+4),s=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),h=Math.max(s[0],s[2]),d=Math.max(s[1],s[3]),p=(o-i)*(l-a),f=(h-u)*(d-c);if(p<=0||f<=0)return 0;const m=Math.max(i,u),g=Math.max(a,c),y=Math.min(o,h),b=Math.min(l,d),v=Math.max(y-m,0)*Math.max(b-g,0);return v/(p+f-v)}function p$(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function f$(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}const m$=RA({nonMaxSuppressionWithScore_:function(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=NA(t,"boxes","nonMaxSuppression"),o=NA(e,"scores","nonMaxSuppression"),l=s$(a,o,n,r,s,i),u=_A.runKernel(AT,{boxes:a,scores:o},{maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:s=l.scoreThreshold,softNmsSigma:i=l.softNmsSigma});return{selectedIndices:u[0],selectedScores:u[1]}}}),g$=RA({nonMaxSuppressionPadded_:function(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=NA(t,"boxes","nonMaxSuppression"),o=NA(e,"scores","nonMaxSuppression"),l=s$(a,o,n,r,s,null),u=_A.runKernel(NT,{boxes:a,scores:o},{maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:i});return{selectedIndices:u[0],validOutputs:u[1]}}}),y$=RA({resizeBilinear_:function(t,e,n=!1,r=!1){const s=NA(t,"images","resizeBilinear");GC(3===s.rank||4===s.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),GC(2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."),GC(!1===r||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;3===s.rank&&(a=!0,i=WO(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=e,o=_A.runKernel(HT,{images:i},{alignCorners:n,halfPixelCenters:r,size:e});return a?WO(o,[o.shape[1],o.shape[2],o.shape[3]]):o}}),b$=RA({resizeNearestNeighbor_:function(t,e,n=!1,r=!1){const s=NA(t,"images","resizeNearestNeighbor");GC(3===s.rank||4===s.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),GC(2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."),GC("float32"===s.dtype||"int32"===s.dtype,()=>"`images` must have `int32` or `float32` as dtype"),GC(!1===r||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;3===s.rank&&(a=!0,i=WO(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=e,o=_A.runKernel(UT,{images:i},{alignCorners:n,halfPixelCenters:r,size:e});return a?WO(o,[o.shape[1],o.shape[2],o.shape[3]]):o}}),v$=RA({lessEqual_:function(t,e){let n=NA(t,"a","lessEqual"),r=NA(e,"b","lessEqual");return[n,r]=pA(n,r),dD(n.shape,r.shape),_A.runKernel(rT,{a:n,b:r})}});function w$(t,e,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");return _A.runKernel(PT,{},{start:t,stop:e,step:n,dtype:r})}const _$=RA({bandPart_:function(t,e,n){GC(e%1==0,()=>`bandPart(): numLower must be an integer, got ${e}.`),GC(n%1==0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=NA(t,"a","bandPart");GC(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,a]=r.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(n<=a))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${a}).`);e<0&&(e=i),n<0&&(n=a);const o=WO(w$(0,i,1,"int32"),[-1,1]),l=w$(0,a,1,"int32"),u=ED(o,l),c=AD(v$(u,xO(+e,"int32")),_D(u,xO(-n,"int32"))),h=YD([i,a],r.dtype);return WO(xF(EF(WO(r,[-1,i,a])).map(t=>NF(c,t,h))),s)}});function x$(t,e,n=null){if(0===t.rank)return SO(t);if(1!==t.rank&&null===n)return x$(WO(t,[-1]),e,n);if(1===t.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===e)return TD(SO(t),n);if(e===1/0)return CD(SO(t),n);if(e===-1/0)return $D(SO(t),n);if("euclidean"===e||2===e)return wF(TD(tF(SO(t),xO(2,"int32")),n));throw new Error("Error in norm: invalid ord value: "+e)}if(Array.isArray(n)&&2===n.length){if(1===e)return CD(TD(SO(t),n[0]),n[1]-1);if(e===1/0)return CD(TD(SO(t),n[1]),n[0]);if(e===-1/0)return $D(TD(SO(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return wF(TD(HD(t),n));throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+n)}const k$=RA({norm_:function(t,e="euclidean",n=null,r=!1){const s=x$(t=NA(t,"x","norm"),e,n);let i=s.shape;if(r){const e=oI(n,t.shape);i=BD(s.shape,e)}return WO(s,i)}}),S$=RA({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,GC(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=t[0].shape[0];for(let e=1;e<t.length;++e)GC(t[e].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[e].shape[0]} vs. ${n})`)}else e=!0,t=vF(t,t.shape[0],0).map(t=>_F(t,[0]));GC(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(_A.tidy(()=>{let t=r[s];if(s>0)for(let e=0;e<s;++e){const r=ID(TD(ID(n[e],t)),n[e]);t=ED(t,r)}return lD(t,k$(t,"euclidean"))}));return e?xF(n,0):n}});function C$(t,e=!1){return _A.tidy(()=>{GC(2===t.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=gD(n),i=TR(t);const a=CF([[1]],[1,1]);let o=TR(a);const l=n>=r?r:n;for(let t=0;t<l;++t){const e=i,l=o,u=s;[o,i,s]=_A.tidy(()=>{const e=dF(i,[t,t],[n-t,1]),l=k$(e),u=dF(i,[t,t],[1,1]),c=NF(wD(u,0),CF([[-1]]),CF([[1]])),h=ED(u,ID(c,l)),d=lD(e,h);o=1===d.shape[0]?TR(a):YO([a,dF(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const p=GD(lD(YF(c,h),l)),f=dF(i,[t,0],[n-t,r]),m=ID(p,o),g=RF(o);if(0===t)i=ED(f,YF(m,YF(g,f)));else{const e=ED(f,YF(m,YF(g,f)));i=YO([dF(i,[0,0],[t,r]),e],0)}const y=RF(m),b=dF(s,[0,t],[n,s.shape[1]-t]);if(0===t)s=ED(b,YF(YF(b,o),y));else{const e=ED(b,YF(YF(b,o),y));s=YO([dF(s,[0,0],[n,t]),e],1)}return[o,i,s]}),bO([e,l,u])}return!e&&n>r&&(s=dF(s,[0,0],[n,r]),i=dF(i,[0,0],[r,r])),[s,i]})}const I$=RA({qr_:function(t,e=!1){if(GC(t.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank "+t.rank),2===t.rank)return C$(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),r=EF(WO(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],i=[];return r.forEach(t=>{const[n,r]=C$(t,e);s.push(n),i.push(r)}),[WO(xF(s,0),t.shape),WO(xF(i,0),t.shape)]}}});var E$;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(E$||(E$={}));const T$=RA({computeWeightedLoss_:function(t,e,n=E$.SUM_BY_NONZERO_WEIGHTS){const r=NA(t,"losses","computeWeightedLoss");let s=null;null!=e&&(s=NA(e,"weights","computeWeightedLoss"));const i=null==s?r:ID(r,s);if(n===E$.NONE)return i;if(n===E$.SUM)return TD(i);if(n===E$.MEAN){if(null==s)return FD(i);{const t=r.size/s.size,e=lD(TD(i),TD(s));return t>1?lD(e,xO(t)):e}}if(n===E$.SUM_BY_NONZERO_WEIGHTS){if(null==s)return lD(TD(i),xO(r.size));{const t=ID(s,ZD(r.shape)),e=ER(TD(KD(t,xO(0))),"float32");return lD(TD(i),e)}}throw Error("Unknown reduction: "+n)}});RA({absoluteDifference_:function(t,e,n,r=E$.SUM_BY_NONZERO_WEIGHTS){const s=NA(t,"labels","absoluteDifference"),i=NA(e,"predictions","absoluteDifference");let a=null;null!=n&&(a=NA(n,"weights","absoluteDifference")),KC(s.shape,i.shape,"Error in absoluteDifference: ");const o=SO(ED(s,i));return T$(o,a,r)}}),RA({cosineDistance_:function(t,e,n,r,s=E$.SUM_BY_NONZERO_WEIGHTS){const i=NA(t,"labels","cosineDistance"),a=NA(e,"predictions","cosineDistance");let o=null;null!=r&&(o=NA(r,"weights","cosineDistance")),KC(i.shape,a.shape,"Error in cosineDistance: ");const l=xO(1),u=ED(l,TD(ID(i,a),n,!0));return T$(u,o,s)}}),RA({hingeLoss_:function(t,e,n,r=E$.SUM_BY_NONZERO_WEIGHTS){let s=NA(t,"labels","hingeLoss");const i=NA(e,"predictions","hingeLoss");let a=null;null!=n&&(a=NA(n,"weights","hingeLoss")),KC(s.shape,i.shape,"Error in hingeLoss: ");const o=xO(1);s=ED(ID(xO(2),s),o);const l=oF(ED(o,ID(s,i)));return T$(l,a,r)}}),RA({huberLoss_:function(t,e,n,r=1,s=E$.SUM_BY_NONZERO_WEIGHTS){const i=NA(t,"labels","huberLoss"),a=NA(e,"predictions","huberLoss");let o=null;null!=n&&(o=NA(n,"weights","huberLoss")),KC(i.shape,a.shape,"Error in huberLoss: ");const l=xO(r),u=SO(ED(a,i)),c=MD(u,l),h=ED(u,c),d=CO(ID(xO(.5),HD(c)),ID(l,h));return T$(d,o,s)}}),RA({logLoss_:function(t,e,n,r=1e-7,s=E$.SUM_BY_NONZERO_WEIGHTS){const i=NA(t,"labels","logLoss"),a=NA(e,"predictions","logLoss");let o=null;null!=n&&(o=NA(n,"weights","logLoss")),KC(i.shape,a.shape,"Error in logLoss: ");const l=xO(1),u=xO(r),c=GD(ID(i,kD(CO(a,u)))),h=ID(ED(l,i),kD(CO(ED(l,a),u))),d=ED(c,h);return T$(d,o,s)}});const N$=RA({squaredDifference_:function(t,e){let n=NA(t,"a","squaredDifference"),r=NA(e,"b","squaredDifference");return[n,r]=pA(n,r),dD(n.shape,r.shape),_A.runKernel(hN,{a:n,b:r},{})}});RA({meanSquaredError_:function(t,e,n,r=E$.SUM_BY_NONZERO_WEIGHTS){const s=NA(t,"labels","meanSquaredError"),i=NA(e,"predictions","meanSquaredError");let a=null;null!=n&&(a=NA(n,"weights","meanSquaredError")),KC(s.shape,i.shape,"Error in meanSquaredError: ");const o=N$(s,i);return T$(o,a,r)}});const A$=RA({log1p_:function(t){const e=NA(t,"x","log1p");return _A.runKernel(aT,{x:e})}});RA({sigmoidCrossEntropy_:function(t,e,n,r=0,s=E$.SUM_BY_NONZERO_WEIGHTS){let i=NA(t,"multiClassLabels","sigmoidCrossEntropy");const a=NA(e,"logits","sigmoidCrossEntropy");let o=null;if(null!=n&&(o=NA(n,"weights","sigmoidCrossEntropy")),KC(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=xO(r),e=xO(1),n=xO(.5);i=CO(ID(i,ED(e,t)),ID(n,t))}const l=function(t,e){const n=NA(t,"labels","sigmoidCrossEntropyWithLogits"),r=NA(e,"logits","sigmoidCrossEntropyWithLogits");KC(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=oF(r),i=ID(r,n),a=A$(SD(GD(SO(r))));return CO(ED(s,i),a)}(i,a);return T$(l,o,s)}});const R$=RA({logSumExp_:function(t,e=null,n=!1){const r=NA(t,"x","logSumExp"),s=oI(e,r.shape),i=CD(r,s,!0),a=ED(r,i),o=SD(a),l=TD(o,s),u=kD(l),c=CO(WO(i,u.shape),u);if(n){const t=BD(c.shape,s);return WO(c,t)}return c}});RA({softmaxCrossEntropy_:function(t,e,n,r=0,s=E$.SUM_BY_NONZERO_WEIGHTS){let i=NA(t,"onehotLabels","softmaxCrossEntropy");const a=NA(e,"logits","softmaxCrossEntropy");let o=null;if(null!=n&&(o=NA(n,"weights","softmaxCrossEntropy")),KC(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const t=xO(r),e=xO(1),n=xO(i.shape[1]);i=CO(ID(i,ED(e,t)),lD(t,n))}const l=function(t,e,n=-1){if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was `+n);return _O((t,e,r)=>{const s=R$(e,[n],!0),i=ED(ER(e,"float32"),s);r([t,i]);const a=GD(ID(i,t));return{value:TD(a,[n]),gradFunc:(t,e)=>{const[r,s]=e,i=BD(t.shape,[n]);return[ID(WO(t,i),ED(ER(r,"float32"),SD(s))),ID(WO(t,i),ED(SD(s),ER(r,"float32")))]}}})(t,e)}(i,a);return T$(l,o,s)}});const O$={flipLeftRight:n$,resizeNearestNeighbor:b$,resizeBilinear:y$,rotateWithOffset:r$,cropAndResize:e$,nonMaxSuppression:i$,nonMaxSuppressionAsync:async function(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=NA(t,"boxes","nonMaxSuppressionAsync"),a=NA(e,"scores","nonMaxSuppressionAsync"),o=s$(i,a,n,r,s);n=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const l=await Promise.all([i.data(),a.data()]),u=l[0],c=l[1],{selectedIndices:h}=l$(u,c,n,r,s);return i!==t&&i.dispose(),a!==e&&a.dispose(),SF(h,"int32")},nonMaxSuppressionWithScore:m$,nonMaxSuppressionWithScoreAsync:async function(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=NA(t,"boxes","nonMaxSuppressionAsync"),o=NA(e,"scores","nonMaxSuppressionAsync"),l=s$(a,o,n,r,s,i);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([a.data(),o.data()]),c=u[0],h=u[1],{selectedIndices:d,selectedScores:p}=c$(c,h,n,r,s,i);return a!==t&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:SF(d,"int32"),selectedScores:SF(p)}},nonMaxSuppressionPadded:g$,nonMaxSuppressionPaddedAsync:async function(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=NA(t,"boxes","nonMaxSuppressionAsync"),o=NA(e,"scores","nonMaxSuppressionAsync"),l=s$(a,o,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,h=l.scoreThreshold,[d,p]=await Promise.all([a.data(),o.data()]),{selectedIndices:f,validOutputs:m}=u$(d,p,u,c,h,i);return a!==t&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:SF(f,"int32"),validOutputs:xO(m,"int32")}}},D$={bandPart:_$,gramSchmidt:S$,qr:I$};class F$ extends kO{constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=_A.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=_A.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:e+"/accum_grad",variable:yO(()=>AF(r).variable(!1))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:e+"/accum_var",variable:yO(()=>AF(r).variable(!1))});const s=Array.isArray(t)?t[n].tensor:t[e];if(null==s)return;const i=this.accumulatedGrads[n].variable,a=this.accumulatedUpdates[n].variable;yO(()=>{const t=CO(ID(i,this.rho),ID(HD(s),1-this.rho)),e=ID(lD(wF(CO(a,this.epsilon)),wF(CO(i,this.epsilon))),s),n=CO(ID(a,this.rho),ID(HD(e),1-this.rho));i.assign(t),a.assign(n);const o=CO(ID(e,-this.learningRate),r);r.assign(o)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(bO(this.accumulatedGrads.map(t=>t.variable)),bO(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}F$.className="Adadelta",pO(F$);class $$ extends kO{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=_A.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:e+"/accumulator",variable:yO(()=>yD(r.shape,this.initialAccumulatorValue).variable(t))}}const s=Array.isArray(t)?t[n].tensor:t[e];if(null==s)return;const i=this.accumulatedGrads[n].variable;yO(()=>{const t=CO(i,HD(s));i.assign(t);const e=CO(ID(lD(s,wF(CO(t,_A.backend.epsilon()))),-this.learningRate),r);r.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&bO(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}$$.className="Adagrad",pO($$);class M$ extends kO{constructor(t,e,n,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],yO(()=>{this.accBeta1=xO(e).variable(),this.accBeta2=xO(n).variable()}),null==r&&(this.epsilon=_A.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);yO(()=>{const n=ED(1,this.accBeta1),r=ED(1,this.accBeta2);e.forEach((e,s)=>{const i=_A.registeredVariables[e];null==this.accumulatedFirstMoment[s]&&(this.accumulatedFirstMoment[s]={originalName:e+"/m",variable:yO(()=>AF(i).variable(!1))}),null==this.accumulatedSecondMoment[s]&&(this.accumulatedSecondMoment[s]={originalName:e+"/v",variable:yO(()=>AF(i).variable(!1))});const a=Array.isArray(t)?t[s].tensor:t[e];if(null==a)return;const o=this.accumulatedFirstMoment[s].variable,l=this.accumulatedSecondMoment[s].variable,u=CO(ID(o,this.beta1),ID(a,1-this.beta1)),c=CO(ID(l,this.beta2),ID(HD(a),1-this.beta2)),h=lD(u,n),d=lD(c,r);o.assign(u),l.assign(c);const p=CO(ID(lD(h,CO(wF(d),this.epsilon)),-this.learningRate),i);i.assign(p)}),this.accBeta1.assign(ID(this.accBeta1,this.beta1)),this.accBeta2.assign(ID(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&bO(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&bO(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),yO(()=>{this.accBeta1.assign(tF(this.beta1,this.iterations_+1)),this.accBeta2.assign(tF(this.beta2,this.iterations_+1))});const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}M$.className="Adam",pO(M$);class L$ extends kO{constructor(t,e,n,r=null,s=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],yO(()=>{this.iteration=xO(0).variable(),this.accBeta1=xO(e).variable()}),null==r&&(this.epsilon=_A.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);yO(()=>{const n=ED(1,this.accBeta1),r=lD(-this.learningRate,CO(ID(this.iteration,this.decay),1));e.forEach((e,s)=>{const i=_A.registeredVariables[e];null==this.accumulatedFirstMoment[s]&&(this.accumulatedFirstMoment[s]={originalName:e+"/m",variable:AF(i).variable(!1)}),null==this.accumulatedWeightedInfNorm[s]&&(this.accumulatedWeightedInfNorm[s]={originalName:e+"/v",variable:AF(i).variable(!1)});const a=Array.isArray(t)?t[s].tensor:t[e];if(null==a)return;const o=this.accumulatedFirstMoment[s].variable,l=this.accumulatedWeightedInfNorm[s].variable,u=CO(ID(o,this.beta1),ID(a,1-this.beta1)),c=ID(l,this.beta2),h=SO(a),d=DD(c,h);o.assign(u),l.assign(d);const p=CO(ID(lD(r,n),lD(u,CO(d,this.epsilon))),i);i.assign(p)}),this.iteration.assign(CO(this.iteration,1)),this.accBeta1.assign(ID(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&bO(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&bO(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}L$.className="Adamax",pO(L$);class P$ extends kO{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const s=_A.registeredVariables[e];yO(()=>{const t=CO(ID(this.c,r),s);s.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=vO(xO(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}P$.className="SGD",pO(P$);class z$ extends P${constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=xO(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=_A.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:e+"/momentum",variable:yO(()=>AF(r).variable(t))}}const s=this.accumulations[n].variable,i=Array.isArray(t)?t[n].tensor:t[e];null!=i&&yO(()=>{let t;const e=CO(ID(this.m,s),i);t=CO(ID(this.c,this.useNesterov?CO(i,ID(e,this.m)):e),r),s.assign(e),r.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&bO(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}z$.className="Momentum",pO(z$);class B$ extends kO{constructor(t,e=.9,n=0,r=null,s=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,null==r&&(this.epsilon=_A.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=_A.registeredVariables[e],s=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:e+"/rms",variable:yO(()=>AF(r).variable(s))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:e+"/momentum",variable:yO(()=>AF(r).variable(s))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:e+"/mg",variable:yO(()=>AF(r).variable(s))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;yO(()=>{const t=CO(ID(a,this.decay),ID(HD(i),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,s=CO(ID(e,this.decay),ID(i,1-this.decay)),l=lD(ID(i,this.learningRate),wF(ED(t,CO(HD(s),this.epsilon)))),u=CO(ID(o,this.momentum),l);a.assign(t),e.assign(s),o.assign(u);const c=ED(r,u);r.assign(c)}else{const t=CO(ID(a,this.decay),ID(HD(i),1-this.decay)),e=CO(ID(o,this.momentum),lD(ID(i,this.learningRate),wF(CO(t,this.epsilon))));a.assign(t),o.assign(e);const n=ED(r,e);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&bO(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&bO(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&bO(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}B$.className="RMSProp",pO(B$);class V${static sgd(t){return new P$(t)}static momentum(t,e,n=!1){return new z$(t,e,n)}static rmsprop(t,e=.9,n=0,r=null,s=!1){return new B$(t,e,n,r,s)}static adam(t=.001,e=.9,n=.999,r=null){return new M$(t,e,n,r)}static adadelta(t=.001,e=.95,n=null){return new F$(t,e,n)}static adamax(t=.002,e=.9,n=.999,r=null,s=0){return new L$(t,e,n,r,s)}static adagrad(t,e=.1){return new $$(t,e)}}const W$={sgd:V$.sgd,momentum:V$.momentum,adadelta:V$.adadelta,adagrad:V$.adagrad,rmsprop:V$.rmsprop,adamax:V$.adamax,adam:V$.adam},U$="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:t=>t();function j$(){return new Promise(t=>U$(()=>t()))}function H$(t,e){const n=t[0].length;t.forEach((t,e)=>{GC(t.length===n,()=>`Error in concat${n}D: rank of tensors[${e}] must be the same as the rank of the rest (${n})`)}),GC(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((t,s)=>{for(let i=0;i<n;i++)GC(i===e||t[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${s}] (${t}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function q$(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}const G$=30;function K$(t){return t<=G$?t:xI(t,Math.floor(Math.sqrt(t)))}function X$(t,e,n){return[n*("number"==typeof t?t:t[0]),e*("number"==typeof t?t:t[1])]}function Y$(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)s=s.concat([t[r+1]/e[r],e[r]]);s=s.concat(t.slice(n+1))}return s}function Z$(t,e,n=!0){const r=[];if(n){r.push(e);for(let n=e+1;n<t;++n)n<=2*e?(r.push(n),r.push(n-(e+1))):r.push(n)}else{const n=[],s=[];for(let r=1;r<t;++r)r>=2*e+1||r%2==1?s.push(r):n.push(r);r.push(...n),r.push(0),r.push(...s)}return r}function Q$(t,e,n,r=!0){const s=[];s.push(r?t[0]/n:t[0]*n);for(let i=1;i<t.length;++i)s.push(i<=e.length?r?e[i-1]*t[i]:t[i]/e[i-1]:t[i]);return s}function J$(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function tM(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}function eM(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==e.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(0===ZC(t.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,i=s[s.length-1];let a=1;for(let h=0;h<s.length-1;++h)a*=s[h];const o=t.shape,l=s.slice();l.pop();let u=1;for(let h=i;h<n;++h)u*=o[h],l.push(o[h]);const c=[...kI(t.shape).map(t=>t/u),1].slice(0,i);return[l,a,u,c]}function nM(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+`, indices.shape: ${e.shape}, shape: ${t}`+`, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(i+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(i+" Output shape length < "+(r+(n.rank-s)));if(n.rank!==s+t.length-r)throw new Error(i+" update.rank != "+(s+t.length-r));for(let a=0;a<s;++a)if(n.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${n.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<n.rank-s;++a)if(n.shape[a+s]!==t[a+r])throw new Error(i+` updates.shape[${a+s}] (${n.shape[a+s]}) != shape[${a+s}] (${t[a+s]})`)}function rM(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}nM(n,e,t)}function sM(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=n.length;let a=1;for(let l=s;l<i;++l)a*=n[l];const o=s<1?1:s;return{sliceRank:s,numUpdates:ZC(e.shape)/o,sliceSize:a,strides:[...kI(n.slice(0,s)),1],outputSize:ZC(n)}}const iM=1.7580993408473768,aM=1.0507009873554805,oM=.3275911,lM=.254829592,uM=-.284496736,cM=1.421413741,hM=-1.453152027,dM=1.061405429;function pM(...t){FI().getBool("IS_TEST")||console.warn(...t)}function fM(...t){FI().getBool("IS_TEST")||console.log(...t)}function mM(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function gM(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function yM(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function bM(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function vM(t,e){return{real:t[2*e],imag:t[2*e+1]}}function wM(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function _M(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const i=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:n,imag:r}}function xM(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function kM(t,e,n=0){let r=[];if("number"==typeof e)GC(t.shape[n]%e==0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{GC(e.reduce((t,e)=>(-1===e&&(t+=1),t),0)<=1,()=>"There should be only one negative value in split array.");const s=e.indexOf(-1);if(-1!==s){const r=e.reduce((t,e)=>e>0?t+e:t);e[s]=t.shape[n]-r}GC(t.shape[n]===e.reduce((t,e)=>t+e),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}function SM(t,e){let n,r=!1;for(t<=G$?(n=t,r=!0):n=xI(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=xI(t,n+1);return n}function CM(t,e,n){const r=[],s=t.length;for(let i=0;i<s;i++)r.push(i!==e?t[i]:n);return r}function IM(t,e,n,r){const s=e.shape.length,i=t.shape.length;if(0!==r&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const a=t.shape[n],o=[];let l=1,u=1,c=1;for(let h=0;h<r;++h)o.push(t.shape[h]),l*=t.shape[h];for(let h=r;h<n;h++)o.push(t.shape[h]),u*=t.shape[h];for(let h=r;h<s;h++)o.push(e.shape[h]);for(let h=n+1;h<i;h++)o.push(t.shape[h]),c*=t.shape[h];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:a,outputShape:o}}function EM(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();const e=YD(t.shape),r=ER(t,"float32"),s=n.complex(r,e);return e.dispose(),r.dispose(),s}if(!pI(t.dtype,e))return _A.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){const r=n.real(t),s=ER(r,e);return r.dispose(),s}if("int32"===e)return n.int(t);if("bool"===e){const e=xO(0,t.dtype),r=n.notEqual(t,e);return e.dispose(),r}throw new Error(`Error in Cast: failed to cast ${t.dtype} to ${e}`)}function TM(t,e){return _A.makeTensorFromDataId(t.dataId,e,t.dtype)}function NM(t){try{return t.map(t=>QN(t))}catch(krt){throw new Error("Failed to decode encoded string bytes into utf-8, error: "+krt)}}function AM(t){return t.map(t=>ZN(t))}function RM(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=IR(t,"int32"),s=IR([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const e=r.indexToLoc(n[i]);s.values.set(e,i*t.length)}return s.toTensor()}const OM={kernelName:zI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(t,VF(ER(n,"float32"),-1))}}},DM={kernelName:BI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=HD(ER(n,"float32")),r=wF(ED(xO(1),e));return GD(lD(t,r))}}}},FM={kernelName:VI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=wF(ED(HD(ER(n,"float32")),1));return lD(t,e)}}}},$M={kernelName:WI,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=dD(n.shape,r.shape);return{a:()=>{let e=t;const r=hD(n.shape,s);return r.length>0&&(e=TD(e,r)),WO(e,n.shape)},b:()=>{let e=t;const n=hD(r.shape,s);return n.length>0&&(e=TD(e,n)),WO(e,r.shape)}}}},MM={kernelName:UI,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((e,r)=>{n[r]=()=>t.clone()}),n}},LM={kernelName:qI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>AF(n)}}},PM={kernelName:GI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>AF(n)}}},zM={kernelName:KI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,wF(ED(xO(1),HD(ER(n,"float32")))))}}},BM={kernelName:XI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=wF(CO(xO(1),HD(ER(n,"float32"))));return lD(t,e)}}}},VM={kernelName:QI,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=dD(n.shape,r.shape);return{a:()=>{const e=CO(HD(n),HD(r));let i=ID(t,lD(r,e));const a=hD(n.shape,s);return a.length>0&&(i=TD(i,a)),WO(i,n.shape)},b:()=>{const e=CO(HD(n),HD(r));let i=GD(ID(t,lD(n,e)));const a=hD(r.shape,s);return a.length>0&&(i=TD(i,a)),WO(i,r.shape)}}}},WM={kernelName:YI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,CO(HD(ER(n,"float32")),1))}}},UM={kernelName:ZI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,ED(xO(1),HD(ER(n,"float32"))))}}},jM=RA({avgPool3dGrad_:function(t,e,n,r,s=[1,1,1],i,a){const o=NA(t,"dy","avgPool3dGrad"),l=NA(e,"input","avgPool3dGrad");let u=o,c=l,h=!1;4===l.rank&&(h=!0,u=WO(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=WO(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),GC(5===u.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+u.rank+"."),GC(5===c.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+c.rank+"."),GC(BO(r,s),()=>`Error in avgPool3dGrad: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`),null!=a&&GC(tI(i),()=>`Error in avgPool3dGrad: pad must be an integer when using, dimRoundingMode ${a} but got pad ${i}.`);const d=_A.runKernel(nE,{dy:u,input:c},{filterSize:n,strides:r,dilations:s,pad:i,dimRoundingMode:a});return h?WO(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),HM={kernelName:eE,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,dilations:a,pad:o,dimRoundingMode:l}=n,u=null==a?[1,1,1]:a;return{x:()=>jM(t,r,s,i,u,o,l)}}},qM=RA({avgPoolGrad_:function(t,e,n,r,s){const i=NA(t,"dy","avgPoolGrad"),a=NA(e,"input","avgPoolGrad");GC(a.rank===i.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${i.rank})`);let o=a,l=i,u=!1;3===a.rank&&(u=!0,o=WO(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=WO(i,[1,i.shape[0],i.shape[1],i.shape[2]])),GC(4===l.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+l.rank+"."),GC(4===o.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+o.rank+".");const c=_A.runKernel(tE,{dy:l,input:o},{filterSize:n,strides:r,pad:s});return u?WO(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),GM={kernelName:JI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:a}=n;return{x:()=>qM(t,r,s,i,a)}}},KM={kernelName:rE,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:i,transposeB:a}=n;return i||a?!i&&a?{a:()=>YF(t,s,!1,!1),b:()=>YF(t,r,!0,!1)}:i&&!a?{a:()=>YF(s,t,!1,!0),b:()=>YF(r,t,!1,!1)}:{a:()=>YF(s,t,!0,!0),b:()=>YF(t,r,!0,!0)}:{a:()=>YF(t,s,!1,!0),b:()=>YF(r,t,!0,!1)}}},XM=RA({spaceToBatchND_:function(t,e,n){const r=NA(t,"x","spaceToBatchND");return GC(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),GC(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),GC(r.shape.reduce((t,r,s)=>s>0&&s<=e.length?t&&(r+n[s-1][0]+n[s-1][1])%e[s-1]==0:t,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`),_A.runKernel(lN,{x:r},{blockShape:e,paddings:n})}}),YM={kernelName:sE,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>XM(t,r,s)}}},ZM={kernelName:"BroadcastTo",gradFunc:(t,e,n)=>{const r=n.inputShape,s=n.shape,i=Array.from(s);for(let o=r.length-1;o>=0;o--)if(r[o]===s[o])i[o]=1;else if(1!==r[o])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${s}].`);const a=[];for(let o=0;o<i.length;o++)i[o]>1&&a.push(o);return{x:()=>TD(t,a,!0)}}},QM={kernelName:aE,gradFunc:t=>({x:()=>t.clone()})},JM={kernelName:oE,gradFunc:t=>({x:()=>AF(t)})},tL={kernelName:lE,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=n;return{x:()=>NF(AD(_D(r,s),v$(r,i)),t,AF(t))}}},eL={kernelName:cE,inputsToSave:["x"],gradFunc:OM.gradFunc},nL={kernelName:hE,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(t=>t.shape),{axis:s}=n,i=oI(s,e[0].shape)[0],a=r.map(t=>t[i]);return vF(t,a,i).map(t=>()=>t)}},rL={kernelName:dE,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:i,strides:a,pad:o,dataFormat:l}=n;return GC(zO(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>rD(r.shape,t,s,a,o,l),filter:()=>zF(r,t,s.shape,a,o,l)}}},sL={kernelName:fE,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:i,pad:a,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>eD(t,s,i,a,o,1,l),filter:()=>zF(t,r,s.shape,i,a,o,l)}}},iL=RA({conv3DBackpropFilter_:function(t,e,n,r,s){let i=t;4===t.rank&&(i=WO(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let a=e;return 4===a.rank&&(a=WO(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),GC(5===i.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."),GC(5===a.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."),GC(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."),GC(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),GC(a.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${n[4]}).`),_A.runKernel(gE,{x:i,dy:a},{strides:r,pad:s,filterShape:n})}}),aL=RA({conv3DBackpropInput_:function(t,e,n,r,s){GC(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,a=e,o=!1;4===e.rank&&(o=!0,a=WO(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],u=a.shape[4];GC(5===i.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."),GC(5===a.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank),GC(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank),GC(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),GC(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c=_A.runKernel(yE,{dy:a,filter:n},{pad:s,strides:r,inputShape:i});return o?WO(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),oL={kernelName:mE,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i}=n;GC(zO(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[a,o]=e;return{x:()=>aL(a.shape,t,o,s,i),filter:()=>iL(a,t,o.shape,s,i)}}},lL=RA({sin_:function(t){const e=NA(t,"x","sin");return _A.runKernel(eN,{x:e})}}),uL={kernelName:bE,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(GD(lL(ER(n,"float32"))),t)}}},cL=RA({sinh_:function(t){const e=NA(t,"x","sinh");return _A.runKernel(nN,{x:e})}}),hL={kernelName:vE,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(cL(ER(n,"float32")),t)}}},dL=RA({cumsum_:function(t,e=0,n=!1,r=!1){const s=NA(t,"x","cumsum");return _A.runKernel(wE,{x:s},{axis:e,exclusive:n,reverse:r})}}),pL={kernelName:wE,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:i,reverse:a}=n;return{x:()=>{const e=WD([s],r.rank);let n=dL(t,s,i,!a);return null!=e&&(n=RF(n,e)),n}}}},fL={kernelName:SE,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:a}=n,o=null==r?[1,1]:r;GC(zO(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,u]=e;return GC(4===l.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),GC(4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),GC(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),GC(BO(s,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${o}'.`),null!=a&&GC(tI(i),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${a} but got pad ${i}.`),{x:()=>KF(l.shape,t,u,s,i,r,a),filter:()=>GF(l,t,u.shape,s,i,r,a)}}},mL={kernelName:TE,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,i={x:r,filter:s,dy:t},a={x:r,filter:s,dy:t};return{x:()=>_A.runKernel(NE,i,n),filter:()=>_A.runKernel(AE,a,n)}}},gL={kernelName:OE,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>_A.runKernel(DE,r)}}},yL={kernelName:FE,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=ID(SD(GD(HD(n))),2/Math.sqrt(Math.PI));return{x:()=>ID(t,r)}}},bL={kernelName:ME,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(t,n)}}},vL={kernelName:LE,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>WO(t,n.shape)}}},wL={kernelName:PE,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(t,SD(n))}}},_L={kernelName:WE,gradFunc:t=>({x:()=>AF(t)})},xL={kernelName:UE,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=dD(n.shape,r.shape);return{a:()=>{const e=lD(t,ER(r,"float32")),i=hD(n.shape,s);return i.length>0?WO(TD(e,i),n.shape):e},b:()=>{let e=ID(t,ER(n,"float32"));const i=hD(r.shape,s);i.length>0&&(e=WO(TD(e,i),r.shape));const a=HD(r);return GD(lD(e,ER(a,"float32")))}}}},kL=RA({rsqrt_:function(t){const e=NA(t,"x","rsqrt");return _A.runKernel(YT,{x:e})}}),SL={kernelName:jE,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,i,a,o]=e,l=null==o?xO(1):o,u=hD(i.shape,s.shape),c=[];if(1===i.rank){for(let t=0;t<s.shape.length-1;++t)c.push(s.shape[t]);c.push(1)}const h=ED(s,i),d=ID(t,l),p=kL(CO(a,xO(r))),f=ID(ID(ID(p,p),p),xO(-.5));return{x:()=>WO(ID(ID(t,1===i.rank?mD(WO(p,[1,1,1,i.shape[0]]),c):p),l),s.shape),mean:()=>{let t=ID(ID(p,xO(-1)),d);return 1===i.rank&&(t=TD(t,u)),WO(t,i.shape)},variance:()=>{let t=ID(ID(f,h),d);return 1===i.rank&&(t=TD(t,u)),WO(t,i.shape)},scale:()=>{const e=ID(h,p);let n=ID(t,e);return 1===i.rank&&(n=TD(n,u)),WO(n,i.shape)},offset:()=>{let e=t;return 1===i.rank&&(e=TD(e,u)),WO(e,i.shape)}}}},CL=RA({unsortedSegmentSum_:function(t,e,n){const r=NA(t,"x","unsortedSegmentSum"),s=NA(e,"segmentIds","unsortedSegmentSum","int32");return GC(tI(n),()=>"numSegments must be of dtype int"),_A.runKernel(kN,{x:r,segmentIds:s},{numSegments:n})}}),IL={kernelName:HE,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:i}=n,a=oI(i,r.shape)[0];return{x:()=>{const e=r.shape,n=s.size,o=e.slice(0,a),l=o.length,u=e.slice(i,e.length).slice(1),c=u.length,h=EL(0,l),d=EL(l+1,l+1+c),p=TL([o,[n],u]),f=WO(t,p),m=WO(s,[n]),g=TL([[l],h,d]),y=RF(f,g);let b=CL(y,m,r.shape[a]);const v=UD(g);return b=RF(b,v),b},indices:()=>s}}};function EL(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function TL(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}const NL={kernelName:KE,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>AF(n),b:()=>AF(r)}}},AL={kernelName:XE,gradFunc:t=>({x:()=>ER(t,"float32")})},RL={kernelName:QE,gradFunc:t=>({x:()=>AF(t)})},OL={kernelName:JE,gradFunc:t=>({x:()=>AF(t)})},DL={kernelName:tT,gradFunc:t=>({x:()=>AF(t)})},FL={kernelName:eT,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,i=wD(r,0);return{x:()=>NF(i,t,ID(t,s))}}},$L={kernelName:aT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,CO(n,1))}}},ML={kernelName:iT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,ER(n,"float32"))}}},LL={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const e=SD(r);return ED(t,ID(TD(t,s,!0),e))}}}},PL=RA({localResponseNormalizationBackprop_:function(t,e,n,r=5,s=1,i=1,a=.5){return _A.runKernel(hT,{x:t,y:e,dy:n},{depthRadius:r,bias:s,alpha:i,beta:a})}}),zL={kernelName:cT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:i,bias:a,alpha:o,beta:l}=n;return{x:()=>PL(r,s,t,i,a,o,l)}}};function BL(t,e,n,r){return e.rank<n.rank&&(e=WO(e,BD(e.shape,r))),t.rank<n.rank&&(t=WO(t,BD(t.shape,r))),{x:()=>ID(t,ER(pD(n,e),t.dtype))}}const VL={kernelName:dT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,i=e[0],a=BL(t,e[1],i,oI(s,i.shape));return{x:()=>a.x()}}},WL=RA({less_:function(t,e){let n=NA(t,"a","less"),r=NA(e,"b","less");return[n,r]=pA(n,r),dD(n.shape,r.shape),_A.runKernel(nT,{a:n,b:r})}}),UL={kernelName:pT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ID(t,ER(_D(n,r),"float32")),b:()=>ID(t,ER(WL(n,r),"float32"))}}},jL=RA({maxPool3dGrad_:function(t,e,n,r,s,i=[1,1,1],a,o){const l=NA(t,"dy","maxPool3dGrad"),u=NA(e,"input","maxPool3dGrad"),c=NA(n,"output","maxPool3dGrad");let h=l,d=u,p=c,f=!1;4===u.rank&&(f=!0,h=WO(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=WO(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=WO(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),GC(5===h.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+h.rank+"."),GC(5===d.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+d.rank+"."),GC(5===p.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+p.rank+"."),GC(BO(s,i),()=>`Error in maxPool3dGrad: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`),null!=o&&GC(tI(a),()=>`Error in maxPool3dGrad: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`);const m=_A.runKernel(yT,{dy:h,input:d,output:p},{filterSize:r,strides:s,dilations:i,pad:a,dimRoundingMode:o});return f?WO(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),HL={kernelName:gT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:a,dilations:o,pad:l,dimRoundingMode:u}=n,c=null==o?[1,1,1]:o;return{x:()=>jL(t,r,s,i,a,c,l,u)}}},qL=RA({maxPoolGrad_:function(t,e,n,r,s,i,a){const o=NA(t,"dy","maxPoolGrad"),l=NA(e,"input","maxPoolGrad"),u=NA(n,"output","maxPoolGrad");return GC(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),GC(4===o.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+o.rank+"."),GC(4===l.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+l.rank+"."),null!=a&&GC(tI(i),()=>`Error in maxPoolGrad: pad must be an integer when using, dimRoundingMode ${a} but got pad ${i}.`),_A.runKernel(mT,{dy:o,input:l,output:u},{filterSize:r,strides:s,pad:i,dimRoundingMode:a})}}),GL={kernelName:fT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:a,pad:o}=n;return{x:()=>qL(t,r,s,i,a,o)}}},KL={kernelName:vT,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,i=oI(s,r.shape),a=ZC(zD(r.shape,i)[1]);return{x:()=>{const e=r.shape.slice();i.forEach(t=>{e[t]=1});const n=WO(t,e);return lD(ID(n,ZD(r.shape,"float32")),a)}}}},XL={kernelName:wT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[i,a]=e,o=BL(t,a,i,oI(s,i.shape));return{x:()=>o.x()}}},YL={kernelName:_T,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ID(t,ER(v$(n,r),"float32")),b:()=>ID(t,ER(wD(n,r),"float32"))}}},ZL={kernelName:xT,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(t=>t[0]);return{x:()=>dF(t,i,r.shape)}}},QL={kernelName:kT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=dD(n.shape,r.shape);return{a:()=>{const e=hD(n.shape,s);return e.length>0?WO(TD(t,e),n.shape):t},b:()=>{const e=ID(t,GD(bD(lD(n,r)))),i=hD(r.shape,s);return i.length>0?WO(TD(e,i),r.shape):e}}}},JL={kernelName:CT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=dD(n.shape,r.shape);return{a:()=>{const e=ID(t,ER(r,"float32")),i=hD(n.shape,s);return i.length>0?WO(TD(e,i),n.shape):e},b:()=>{const e=ID(t,ER(n,"float32")),i=hD(r.shape,s);return i.length>0?WO(TD(e,i),r.shape):e}}}},tP={kernelName:IT,gradFunc:t=>({x:()=>GD(t)})},eP={kernelName:OT,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>YD(n.shape,"float32")}}},nP={kernelName:RT,gradFunc:t=>({x:()=>AF(t)})},rP={kernelName:DT,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return EF(t,r).map(t=>()=>t)}},sP={kernelName:FT,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(t=>t[0]);return{x:()=>dF(t,i,r.shape)}}},iP={kernelName:$T,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,i=n,a=r,o=dD(i.shape,a.shape);return{a:()=>{const e=ER(a,"float32");let n=ID(t,ID(e,tF(i,ED(e,xO(1)))));const r=hD(i.shape,o);return r.length>0&&(n=TD(n,r)),WO(n,i.shape)},b:()=>{const e=wD(i,0),n=NF(e,kD(i),AF(i));let r=ID(t,ID(s,n));const l=hD(a.shape,o);return l.length>0&&(r=TD(r,l)),WO(r,a.shape)}}}},aP={kernelName:MT,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=wD(n,0);return{x:()=>NF(s,t,ID(t,r)),alpha:()=>{let e=NF(s,AF(t),ID(t,n));const i=hD(r.shape,t.shape);return i.length>0&&(e=TD(e,i)),WO(e,r.shape)}}}},oP={kernelName:RE,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=dD(n.shape,r.shape);return{a:()=>{const e=lD(t,ER(r,"float32")),i=hD(n.shape,s);return i.length>0?WO(TD(e,i),n.shape):e},b:()=>{let e=ID(t,ER(n,"float32"));const i=hD(r.shape,s);i.length>0&&(e=WO(TD(e,i),r.shape));const a=HD(r);return GD(lD(e,ER(a,"float32")))}}}},lP={kernelName:BT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,GD(HD(n)))}}},uP={kernelName:GT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=ID(v$(n,6),VF(n));return{x:()=>ID(t,ER(r,"float32"))}}},cP={kernelName:VT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(t,ER(VF(n),"float32"))}}},hP={kernelName:WT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>WO(t,n.shape)}}},dP={kernelName:HT,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>_A.runKernel(qT,s,n)}}},pP={kernelName:UT,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>_A.runKernel(jT,s,n)}}},fP={kernelName:KT,gradFunc:(t,e,n)=>{const{dims:r}=n,s=oI(r,t.shape);return{x:()=>lF(t,s)}}},mP={kernelName:XT,gradFunc:t=>({x:()=>AF(t)})},gP={kernelName:YT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>GD(lD(t,ID(tF(n,1.5),2)))}}},yP=RA({logicalNot_:function(t){const e=NA(t,"x","logicalNot","bool");return _A.runKernel(lT,{x:e})}}),bP={kernelName:QT,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ER(AF(n),"float32"),t:()=>ID(t,ER(n,t.dtype)),e:()=>ID(t,ER(yP(n),t.dtype))}}},vP={kernelName:JT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=wD(n,xO(0)),r=xO(iM),s=xO(aM),i=ID(t,s),a=ID(ID(t,r),SD(ER(n,"float32")));return NF(e,i,a)}}}},wP={kernelName:sN,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(t,ID(n,ED(xO(1),n)))}}},_P={kernelName:rN,gradFunc:t=>({x:()=>AF(t)})},xP=RA({cos_:function(t){const e=NA(t,"x","cos");return _A.runKernel(bE,{x:e})}}),kP={kernelName:eN,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(xP(ER(n,"float32")),t)}}},SP=RA({cosh_:function(t){const e=NA(t,"x","cosh");return _A.runKernel(vE,{x:e})}}),CP={kernelName:nN,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(SP(ER(n,"float32")),t)}}},IP={kernelName:tN,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:i}=n,a=r.shape,[o,l]=uO(r,s,i),u=[];for(let c=0;c<t.rank;c++)u.push([o[c],a[c]-o[c]-l[c]]);return{x:()=>JD(t,u)}}},EP={kernelName:cN,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,i=ID(t,r);return{logits:()=>ED(i,ID(TD(i,[s],!0),r))}}},TP={kernelName:iN,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(t,hF(n))}}},NP=RA({batchToSpaceND_:function(t,e,n){const r=NA(t,"x","batchToSpaceND"),s=e.reduce((t,e)=>t*e);return GC(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),GC(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),GC(r.shape[0]%s==0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`),_A.runKernel(sE,{x:r},{blockShape:e,crops:n})}}),AP={kernelName:lN,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>NP(t,r,s)}}},RP={kernelName:uN,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>YO(t,r)}}},OP=[OM,DM,FM,$M,MM,LM,PM,zM,BM,VM,WM,UM,HM,GM,KM,YM,ZM,QM,JM,tL,eL,nL,sL,rL,oL,uL,hL,pL,fL,mL,oP,gL,yL,bL,vL,wL,xL,_L,SL,IL,NL,AL,RL,OL,DL,FL,$L,ML,LL,zL,VL,VL,UL,HL,GL,KL,XL,YL,ZL,QL,JL,tP,eP,nP,rP,sP,sP,iP,aP,lP,uP,cP,hP,dP,pP,fP,mP,gP,bP,vP,wP,_P,kP,CP,IP,EP,TP,AP,AP,RP,RP,{kernelName:aN,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,ID(wF(ER(n,"float32")),2))}}},{kernelName:hN,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=xO(2);return{a:()=>ID(t,ID(s,ED(n,r))),b:()=>ID(t,ID(s,ED(r,n)))}}},{kernelName:dN,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(t,ID(ER(n,"float32"),2))}}},{kernelName:CN,gradFunc:t=>({x:()=>AF(t)})},{kernelName:pN,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=dD(n.shape,r.shape);return{a:()=>{let e=t;const r=hD(n.shape,s);return r.length>0&&(e=TD(e,r)),WO(e,n.shape)},b:()=>{let e=t;const n=hD(r.shape,s);return n.length>0&&(e=TD(e,n)),WO(GD(e),r.shape)}}}},{kernelName:oN,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:i}=n;oI(i,r.shape).forEach(t=>{s[t]=1});const a=WO(t,s),o=ID(a,ZD(r.shape,"float32"));return{x:()=>o}}},{kernelName:gN,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lD(t,HD(xP(n)))}}},{kernelName:yN,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ID(ED(xO(1),HD(n)),t)}}},{kernelName:bN,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let e=AF(r);if(1===r.rank)for(let n=0;n<s[0];++n)e=CO(e,dF(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<s[0];++n)for(let i=0;i<s[1];++i)e=CO(e,dF(t,[n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<s[0];++n)for(let i=0;i<s[1];++i)for(let a=0;a<s[2];++a)e=CO(e,dF(t,[n*r.shape[0],i*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(let n=0;n<s[0];++n)for(let i=0;i<s[1];++i)for(let a=0;a<s[2];++a)for(let o=0;o<s[3];++o)e=CO(e,dF(t,[n*r.shape[0],i*r.shape[1],a*r.shape[2],o*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:wN,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,i=UD(s);return{x:()=>RF(t,i)}}},{kernelName:xN,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>xF(t,s)}}},{kernelName:kN,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=DD(e,AF(e)),r=vD(t,n);let s=_D(e,xO(0,"int32"));const i=r.rank-s.rank;for(let o=0;o<i;++o)s=fD(s,o+1);s=AD(s,ZD(r.shape,"bool"));const a=AF(r);return NF(s,r,a)}(t,n)}}},{kernelName:SN,gradFunc:t=>({x:()=>AF(t)})}];for(const Set of OP)LN(Set);rA.prototype.abs=function(){return this.throwIfDisposed(),SO(this)};const DP=RA({acos_:function(t){const e=NA(t,"x","acos");return _A.runKernel(BI,{x:e})}});rA.prototype.acos=function(){return this.throwIfDisposed(),DP(this)};const FP=RA({acosh_:function(t){const e=NA(t,"x","acosh");return _A.runKernel(VI,{x:e})}});rA.prototype.acosh=function(){return this.throwIfDisposed(),FP(this)};const $P=RA({mod_:function(t,e){let n=NA(t,"a","mod"),r=NA(e,"b","mod");return[n,r]=pA(n,r),_A.runKernel(kT,{a:n,b:r})}}),MP=RA({addStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","addStrict"),r=NA(e,"b","addStrict");return KC(n.shape,r.shape,"Error in addStrict: "),CO(n,r)}}),LP=RA({divStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","div"),r=NA(e,"b","div");return KC(n.shape,r.shape,"Error in divideStrict: "),lD(n,r)}}),PP=RA({maximumStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","maximumStrict"),r=NA(e,"b","maximumStrict");return KC(n.shape,r.shape,"Error in maximumStrict: "),DD(n,r)}}),zP=RA({minimumStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","minimumStrict"),r=NA(e,"b","minimumStrict");return KC(n.shape,r.shape,"Error in minimumStrict: "),MD(n,r)}}),BP=RA({modStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","modStrict"),r=NA(e,"b","modStrict");return KC(n.shape,r.shape,"Error in modStrict: "),$P(n,r)}}),VP=RA({mulStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","mul"),r=NA(e,"b","mul");return KC(n.shape,r.shape,"Error in multiplyStrict: "),ID(n,r)}}),WP=RA({powStrict_:function(t,e){return fO("strict variants of ops have been deprecated and will be removed in future"),KC(t.shape,e.shape,"Error in powStrict: "),tF(t,e)}}),UP=RA({squaredDifferenceStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","squaredDifferenceStrict"),r=NA(e,"b","squaredDifferenceStrict");return KC(n.shape,r.shape,"Error in squaredDifferenceStrict: "),N$(n,r)}}),jP=RA({subStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","subStrict"),r=NA(e,"b","subStrict");return KC(n.shape,r.shape,"Error in subStrict: "),ED(n,r)}});rA.prototype.addStrict=function(t){return this.throwIfDisposed(),MP(this,t)},rA.prototype.add=function(t){return this.throwIfDisposed(),CO(this,t)},rA.prototype.all=function(t,e){return this.throwIfDisposed(),IO(this,t,e)},rA.prototype.any=function(t,e){return this.throwIfDisposed(),EO(this,t,e)},rA.prototype.argMax=function(t){return this.throwIfDisposed(),TO(this,t)};const HP=RA({argMin_:function(t,e=0){const n=NA(t,"x","argMin");return _A.runKernel(GI,{x:n},{axis:e})}});rA.prototype.argMin=function(t){return this.throwIfDisposed(),HP(this,t)},rA.prototype.asScalar=function(){return this.throwIfDisposed(),GC(1===this.size,()=>"The array must have only 1 element."),WO(this,[])},rA.prototype.asType=function(t){return this.throwIfDisposed(),ER(this,t)},rA.prototype.as1D=function(){return this.throwIfDisposed(),WO(this,[this.size])},rA.prototype.as2D=function(t,e){return this.throwIfDisposed(),WO(this,[t,e])},rA.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),WO(this,[t,e,n])},rA.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),WO(this,[t,e,n,r])},rA.prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),WO(this,[t,e,n,r,s])};const qP=RA({asin_:function(t){const e=NA(t,"x","asin");return _A.runKernel(KI,{x:e})}});rA.prototype.asin=function(){return this.throwIfDisposed(),qP(this)};const GP=RA({asinh_:function(t){const e=NA(t,"x","asinh");return _A.runKernel(XI,{x:e})}});rA.prototype.asinh=function(){return this.throwIfDisposed(),GP(this)};const KP=RA({atan_:function(t){const e=NA(t,"x","atan");return _A.runKernel(YI,{x:e})}});rA.prototype.atan=function(){return this.throwIfDisposed(),KP(this)};const XP=RA({atan2_:function(t,e){let n=NA(t,"a","atan2"),r=NA(e,"b","atan2");return[n,r]=pA(n,r),_A.runKernel(QI,{a:n,b:r})}});rA.prototype.atan2=function(t){return this.throwIfDisposed(),XP(this,t)};const YP=RA({atanh_:function(t){const e=NA(t,"x","atanh");return _A.runKernel(ZI,{x:e})}});rA.prototype.atanh=function(){return this.throwIfDisposed(),YP(this)},rA.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),UO(this,t,e,n,r)},rA.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),NP(this,t,e)},rA.prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),HO(this,t,e,n,r,s)},rA.prototype.broadcastTo=function(t){return this.throwIfDisposed(),TF(this,t)},rA.prototype.cast=function(t){return this.throwIfDisposed(),ER(this,t)};const ZP=RA({ceil_:function(t){const e=NA(t,"x","ceil");return _A.runKernel(oE,{x:e})}});rA.prototype.ceil=function(){return this.throwIfDisposed(),ZP(this)},rA.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),XO(this,t,e)},rA.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof rA&&(t=[t]),YO([this,...t],e)},rA.prototype.conv1d=function(t,e,n,r,s,i){return this.throwIfDisposed(),nD(this,t,e,n,r,s,i)},rA.prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),sD(this,t,e,n,r,s)},rA.prototype.conv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),eD(this,t,e,n,r,s,i)},rA.prototype.cos=function(){return this.throwIfDisposed(),xP(this)},rA.prototype.cosh=function(){return this.throwIfDisposed(),SP(this)},rA.prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),dL(this,t,e,n)};const QP=RA({depthToSpace_:function(t,e,n="NHWC"){const r=NA(t,"x","depthToSpace"),s="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return GC(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${e}  for depthToSpace with input shape\n    ${r.shape}`),GC(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${e} for depthToSpace with input shape\n        ${r.shape}`),GC(a%(e*e)==0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${r.shape}`),_A.runKernel(kE,{x:r},{blockSize:e,dataFormat:n})}});rA.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),QP(this,t,e)},rA.prototype.depthwiseConv2D=function(t,e,n,r,s,i){return fO("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),aD(this,t,e,n,r,s,i)},rA.prototype.depthwiseConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),aD(this,t,e,n,r,s,i)};const JP=RA({dilation2d_:function(t,e,n,r,s=[1,1],i="NHWC"){const a=NA(t,"x","dilation2d"),o=NA(e,"filter","dilation2d");GC(3===a.rank||4===a.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+a.rank+"."),GC(3===o.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+o.rank+"."),GC("NHWC"===i,()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of "+i);let l=a,u=!1;3===a.rank&&(l=WO(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0);const c=_A.runKernel(TE,{x:l,filter:o},{strides:n,pad:r,dilations:s});return u?WO(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});rA.prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),JP(this,t,e,n,r,s)};const tz=RA({divNoNan_:function(t,e){let n=NA(t,"a","div"),r=NA(e,"b","div");[n,r]=pA(n,r);const s=lD(n,r),i=AF(s),a=pD(r,i);return NF(a,i,s)}});rA.prototype.divNoNan=function(t){return this.throwIfDisposed(),tz(this,t)},rA.prototype.divStrict=function(t){return this.throwIfDisposed(),LP(this,t)},rA.prototype.div=function(t){return this.throwIfDisposed(),lD(this,t)};const ez=RA({dot_:function(t,e){const n=NA(t,"t1","dot"),r=NA(e,"t2","dot");GC(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(GC(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),1===n.rank&&1===r.rank){const t=WO(n,[1,-1]),e=WO(r,[-1,1]),s=YF(t,e);return WO(s,[])}if(1===n.rank&&2===r.rank){const t=WO(n,[1,-1]),e=WO(r,[r.shape[0],r.shape[1]]),s=YF(t,e);return WO(s,[s.size])}if(2===n.rank&&1===r.rank){const t=WO(r,[-1,1]),e=YF(n,t);return WO(e,[e.size])}{const t=WO(r,[r.shape[0],r.shape[1]]);return YF(n,t)}}});rA.prototype.dot=function(t){return this.throwIfDisposed(),ez(this,t)},rA.prototype.elu=function(){return this.throwIfDisposed(),uD(this)};const nz=RA({equalStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","equalStrict"),r=NA(e,"b","equalStrict");return KC(n.shape,r.shape,"Error in equalStrict: "),pD(n,r)}}),rz=RA({greaterEqualStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","greaterEqualStrict"),r=NA(e,"b","greaterEqualStrict");return KC(n.shape,r.shape,"Error in greaterEqualStrict: "),_D(n,r)}}),sz=RA({greaterStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","greaterStrict"),r=NA(e,"b","greaterStrict");return KC(n.shape,r.shape,"Error in greaterStrict: "),wD(n,r)}}),iz=RA({lessEqualStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","lessEqualStrict"),r=NA(e,"b","lessEqualStrict");return KC(n.shape,r.shape,"Error in lessEqualStrict: "),v$(n,r)}}),az=RA({lessStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","lessStrict"),r=NA(e,"b","lessStrict");return KC(n.shape,r.shape,"Error in lessStrict: "),WL(n,r)}}),oz=RA({notEqualStrict_:function(t,e){fO("strict variants of ops have been deprecated and will be removed in future");const n=NA(t,"a","notEqualStrict"),r=NA(e,"b","notEqualStrict");return KC(n.shape,r.shape,"Error in notEqualStrict: "),KD(n,r)}});rA.prototype.equalStrict=function(t){return this.throwIfDisposed(),nz(this,t)},rA.prototype.equal=function(t){return this.throwIfDisposed(),pD(this,t)};const lz=RA({erf_:function(t){let e=NA(t,"x","erf");return GC("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=ER(e,"float32")),_A.runKernel(FE,{x:e})}});rA.prototype.erf=function(){return this.throwIfDisposed(),lz(this)},rA.prototype.exp=function(){return this.throwIfDisposed(),SD(this)},rA.prototype.expandDims=function(t){return this.throwIfDisposed(),fD(this,t)};const uz=RA({expm1_:function(t){const e=NA(t,"x","expm1");return _A.runKernel(PE,{x:e})}});rA.prototype.expm1=function(){return this.throwIfDisposed(),uz(this)},rA.prototype.fft=function(){return this.throwIfDisposed(),$F(this)},rA.prototype.flatten=function(){return this.throwIfDisposed(),WO(this,[this.size])},rA.prototype.floor=function(){return this.throwIfDisposed(),bD(this)},rA.prototype.floorDiv=function(t){return this.throwIfDisposed(),oD(this,t)},rA.prototype.gather=function(t,e){return this.throwIfDisposed(),vD(this,t,e)},rA.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),rz(this,t)},rA.prototype.greaterEqual=function(t){return this.throwIfDisposed(),_D(this,t)},rA.prototype.greaterStrict=function(t){return this.throwIfDisposed(),sz(this,t)},rA.prototype.greater=function(t){return this.throwIfDisposed(),wD(this,t)},rA.prototype.ifft=function(){return this.throwIfDisposed(),LF(this)},rA.prototype.irfft=function(){return this.throwIfDisposed(),PF(this)};const cz=RA({isFinite_:function(t){const e=NA(t,"x","isFinite");return _A.runKernel(QE,{x:e})}});rA.prototype.isFinite=function(){return this.throwIfDisposed(),cz(this)};const hz=RA({isInf_:function(t){const e=NA(t,"x","isInf");return _A.runKernel(JE,{x:e})}});rA.prototype.isInf=function(){return this.throwIfDisposed(),hz(this)};const dz=RA({isNaN_:function(t){const e=NA(t,"x","isNaN");return _A.runKernel(tT,{x:e})}});rA.prototype.isNaN=function(){return this.throwIfDisposed(),dz(this)},rA.prototype.leakyRelu=function(t){return this.throwIfDisposed(),xD(this,t)},rA.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),iz(this,t)},rA.prototype.lessEqual=function(t){return this.throwIfDisposed(),v$(this,t)},rA.prototype.lessStrict=function(t){return this.throwIfDisposed(),az(this,t)},rA.prototype.less=function(t){return this.throwIfDisposed(),WL(this,t)};const pz=RA({localResponseNormalization_:function(t,e=5,n=1,r=1,s=.5){const i=NA(t,"x","localResponseNormalization");GC(4===i.rank||3===i.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${i.rank}.`),GC(tI(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;3===i.rank&&(o=!0,a=WO(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l=_A.runKernel(cT,{x:a},{depthRadius:e,bias:n,alpha:r,beta:s});return o?WO(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});rA.prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),pz(this,t,e,n,r)};const fz=RA({logSigmoid_:function(t){const e=NA(t,"x","logSigmoid");return _O(t=>({value:GD(bF(GD(t))),gradFunc:e=>ID(e,hF(GD(t)))}))(e)}});rA.prototype.logSigmoid=function(){return this.throwIfDisposed(),fz(this)},rA.prototype.logSoftmax=function(t){return this.throwIfDisposed(),ND(this,t)},rA.prototype.logSumExp=function(t,e){return this.throwIfDisposed(),R$(this,t,e)},rA.prototype.log=function(){return this.throwIfDisposed(),kD(this)},rA.prototype.log1p=function(){return this.throwIfDisposed(),A$(this)},rA.prototype.logicalAnd=function(t){return this.throwIfDisposed(),AD(this,t)},rA.prototype.logicalNot=function(){return this.throwIfDisposed(),yP(this)};const mz=RA({logicalOr_:function(t,e){const n=NA(t,"a","logicalOr","bool"),r=NA(e,"b","logicalOr","bool");return dD(n.shape,r.shape),_A.runKernel(uT,{a:n,b:r})}});rA.prototype.logicalOr=function(t){return this.throwIfDisposed(),mz(this,t)};const gz=RA({logicalXor_:function(t,e){const n=NA(t,"a","logicalXor","bool"),r=NA(e,"b","logicalXor","bool");return dD(n.shape,r.shape),AD(mz(t,e),yP(AD(t,e)))}});rA.prototype.logicalXor=function(t){return this.throwIfDisposed(),gz(this,t)},rA.prototype.matMul=function(t,e,n){return this.throwIfDisposed(),YF(this,t,e,n)},rA.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),RD(this,t,e,n,r)},rA.prototype.max=function(t,e){return this.throwIfDisposed(),CD(this,t,e)},rA.prototype.maximumStrict=function(t){return this.throwIfDisposed(),PP(this,t)},rA.prototype.maximum=function(t){return this.throwIfDisposed(),DD(this,t)},rA.prototype.mean=function(t,e){return this.throwIfDisposed(),FD(this,t,e)},rA.prototype.min=function(t,e){return this.throwIfDisposed(),$D(this,t,e)},rA.prototype.minimumStrict=function(t){return this.throwIfDisposed(),zP(this,t)},rA.prototype.minimum=function(t){return this.throwIfDisposed(),MD(this,t)};const yz=RA({mirrorPad_:function(t,e,n){GC("reflect"===n||"symmetric"===n,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=NA(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");GC(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s="reflect"===n?1:0;for(let i=0;i<r.rank;i++)GC(2===e[i].length,()=>"Invalid number of paddings. Must be length of 2 each."),GC(e[i][0]>=0&&e[i][0]<=r.shape[i]-s&&e[i][1]>=0&&e[i][1]<=r.shape[i]-s,()=>`Padding in dimension ${i} cannot be greater than or equal to ${r.shape[i]-s} or less than 0 for input of shape `+r.shape);return _A.runKernel(xT,{x:r},{paddings:e,mode:n})}});rA.prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),yz(this,t,e)},rA.prototype.modStrict=function(t){return this.throwIfDisposed(),BP(this,t)},rA.prototype.mod=function(t){return this.throwIfDisposed(),$P(this,t)},rA.prototype.mulStrict=function(t){return this.throwIfDisposed(),VP(this,t)},rA.prototype.mul=function(t){return this.throwIfDisposed(),ID(this,t)},rA.prototype.neg=function(){return this.throwIfDisposed(),GD(this)},rA.prototype.norm=function(t,e,n){return this.throwIfDisposed(),k$(this,t,e,n)},rA.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),oz(this,t)},rA.prototype.notEqual=function(t){return this.throwIfDisposed(),KD(this,t)},rA.prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),XD(this,t,e,n)},rA.prototype.onesLike=function(){return this.throwIfDisposed(),QD(this)},rA.prototype.pad=function(t,e){return this.throwIfDisposed(),JD(this,t,e)};const bz=RA({pool_:function(t,e,n,r,s,i){null==s&&(s=[1,1]),null==i&&(i=1),0===r&&(r="valid");const a=NA(t,"x","maxPool");let o=a,l=!1;3===a.rank&&(l=!0,o=WO(a,[1,a.shape[0],a.shape[1],a.shape[2]])),GC(BO(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const u=AO(o.shape,e,i,s,r),c=[u.dilationHeight,u.dilationWidth];let h;h="same"===r?function(t,e){const n=t.map((t,n)=>t+(t-1)*(e[n]-1)).map(t=>t-1),r=n.map(t=>Math.floor(t/2)),s=n.map((t,e)=>t-r[e]);return n.map((t,e)=>[r[e],s[e]])}([u.filterHeight,u.filterWidth],c):[[0,0],[0,0]];const d=1===c[0]&&1===c[1],[p,f]=function(t,e,n){const r=n.map(t=>t[0]),s=n.map(t=>t[1]),i=t.concat(r,s),a=e.map((t,e)=>(t-i[e]%t)%t),o=s.map((t,e)=>t+a[e]);return[e.map((t,e)=>[r[e],o[e]]),e.map((t,e)=>[0,a[e]])]}([u.inHeight,u.inWidth],c,h),m=d?r:"valid",g=d?o:XM(o,c,p),y=("avg"===n?()=>UO(g,e,i,m):()=>RD(g,e,i,m))(),b=d?y:NP(y,c,f);return l?WO(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});rA.prototype.pool=function(t,e,n,r,s){return this.throwIfDisposed(),bz(this,t,e,n,r,s)},rA.prototype.powStrict=function(t){return this.throwIfDisposed(),WP(this,t)},rA.prototype.pow=function(t){return this.throwIfDisposed(),tF(this,t)},rA.prototype.prelu=function(t){return this.throwIfDisposed(),eF(this,t)};const vz=RA({prod_:function(t,e=null,n=!1){let r=NA(t,"x","prod");return"bool"===r.dtype&&(r=ER(r,"int32")),_A.runKernel(LT,{x:r},{axis:e,keepDims:n})}});rA.prototype.prod=function(t,e){return this.throwIfDisposed(),vz(this,t,e)};const wz=RA({reciprocal_:function(t){const e=NA(t,"x","reciprocal");return _A.runKernel(BT,{x:e})}});rA.prototype.reciprocal=function(){return this.throwIfDisposed(),wz(this)},rA.prototype.relu=function(){return this.throwIfDisposed(),oF(this)},rA.prototype.relu6=function(){return this.throwIfDisposed(),BF(this)},rA.prototype.reshapeAs=function(t){return this.throwIfDisposed(),WO(this,t.shape)},rA.prototype.reshape=function(t){return this.throwIfDisposed(),WO(this,t)},rA.prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),y$(this,t,e,n)},rA.prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),b$(this,t,e,n)},rA.prototype.reverse=function(t){return this.throwIfDisposed(),lF(this,t)},rA.prototype.rfft=function(){return this.throwIfDisposed(),MF(this)};const _z=RA({round_:function(t){const e=NA(t,"x","round");return _A.runKernel(XT,{x:e})}});rA.prototype.round=function(){return this.throwIfDisposed(),_z(this)},rA.prototype.rsqrt=function(){return this.throwIfDisposed(),kL(this)},rA.prototype.selu=function(){return this.throwIfDisposed(),uF(this)},rA.prototype.separableConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),cF(this,t,e,n,r,s,i)},rA.prototype.sigmoid=function(){return this.throwIfDisposed(),hF(this)};const xz=RA({sign_:function(t){const e=NA(t,"x","sign");return _A.runKernel(rN,{x:e})}});rA.prototype.sign=function(){return this.throwIfDisposed(),xz(this)},rA.prototype.sin=function(){return this.throwIfDisposed(),lL(this)},rA.prototype.sinh=function(){return this.throwIfDisposed(),cL(this)},rA.prototype.slice=function(t,e){return this.throwIfDisposed(),dF(this,t,e)},rA.prototype.softmax=function(t){return this.throwIfDisposed(),yF(this,t)},rA.prototype.softplus=function(){return this.throwIfDisposed(),bF(this)},rA.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),XM(this,t,e)},rA.prototype.split=function(t,e){return this.throwIfDisposed(),vF(this,t,e)},rA.prototype.sqrt=function(){return this.throwIfDisposed(),wF(this)},rA.prototype.square=function(){return this.throwIfDisposed(),HD(this)},rA.prototype.squaredDifference=function(t){return this.throwIfDisposed(),N$(this,t)},rA.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),UP(this,t)},rA.prototype.squeeze=function(t){return this.throwIfDisposed(),_F(this,t)},rA.prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof rA?[this,t]:[this,...t];return xF(n,e)},rA.prototype.step=function(t){return this.throwIfDisposed(),VF(this,t)};const kz=RA({stridedSlice_:function(t,e,n,r,s=0,i=0,a=0,o=0,l=0){const u=NA(t,"x","stridedSlice");return _A.runKernel(mN,{x:u},{begin:e,end:n,strides:r,beginMask:s,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l})}});rA.prototype.stridedSlice=function(t,e,n,r,s,i,a,o){return this.throwIfDisposed(),kz(this,t,e,n,r,s,i,a,o)},rA.prototype.subStrict=function(t){return this.throwIfDisposed(),jP(this,t)},rA.prototype.sub=function(t){return this.throwIfDisposed(),ED(this,t)},rA.prototype.sum=function(t,e){return this.throwIfDisposed(),TD(this,t,e)};const Sz=RA({tan_:function(t){const e=NA(t,"x","tan");return _A.runKernel(gN,{x:e})}});rA.prototype.tan=function(){return this.throwIfDisposed(),Sz(this)},rA.prototype.tanh=function(){return this.throwIfDisposed(),kF(this)},rA.prototype.tile=function(t){return this.throwIfDisposed(),mD(this,t)},rA.prototype.toBool=function(){return this.throwIfDisposed(),ER(this,"bool")},rA.prototype.toFloat=function(){return this.throwIfDisposed(),ER(this,"float32")},rA.prototype.toInt=function(){return this.throwIfDisposed(),ER(this,"int32")};const Cz=RA({topk_:function(t,e=1,n=!0){const r=NA(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got `+e);const i={x:r},a={k:e,sorted:n},[o,l]=_A.runKernel(vN,i,a);return{values:o,indices:l}}});rA.prototype.topk=function(t,e){return this.throwIfDisposed(),Cz(this,t,e)},rA.prototype.transpose=function(t){return this.throwIfDisposed(),RF(this,t)};const Iz=RA({unique_:function(t,e=0){const n=NA(t,"x","unique","string_or_numeric");GC(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[i,a]=_A.runKernel(_N,r,s);return{values:i,indices:a}}});var Ez,Tz;rA.prototype.unique=function(t){return this.throwIfDisposed(),Iz(this,t)},rA.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),CL(this,t,e)},rA.prototype.unstack=function(t){return this.throwIfDisposed(),EF(this,t)},rA.prototype.where=function(t,e){return this.throwIfDisposed(),NF(t,this,e)},rA.prototype.zerosLike=function(){return this.throwIfDisposed(),AF(this)},function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(Ez||(Ez={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(Tz||(Tz={}));const Nz={};function Az(t){return Nz[t]}function Rz(t,e,n,s,i){const a=e.inputParams[t];if(a&&void 0!==a.inputIndexStart){const t=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?t+1:a.inputIndexEnd;if("tensor"===a.type)return Oz(e.inputNames[a.inputIndexStart],n,s,i);if("tensors"===a.type)return e.inputNames.slice(t,o).map(t=>Oz(t,n,s,i));const l=Oz(e.inputNames.slice(t)[0],n,s,i),u=l.dataSync();return"number"===a.type?u[0]:r.toNestedArray(l.shape,u)}const o=e.attrParams[t];return o&&o.value}function Oz(t,e,n,r){const[s,i]=$z(t);if(null!=r){const t=r.getHashTableHandleByName(s);if(null!=t)return t}const a=n.currentContextIds.find(t=>!!e[Fz(s,t)]);return void 0!==a?e[Fz(s,a)][i]:void 0}function Dz(t,e){const[n,r]=$z(t);return[Fz(n,e&&e.currentContextId),r]}function Fz(t,e){return e?`${t}-${e}`:t}function $z(t){const e=t.split(":");return 1===e.length?[t,0]:[e[0],Number(e[e.length-1])]}function Mz(t,e,n){let r=Rz("pad",t,e,n);if("explicit"===r){r=Rz("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let t=0;t<4;t++)s[t][0]=r[2*t],s[t][1]=r[2*t+1];return s}return r}function Lz(t){return t.kept?t:TR(t)}const Pz=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],zz=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Bz=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],Vz=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Wz=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Uz=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jz=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Hz=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],qz=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}],Gz=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],Kz=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Xz=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Yz=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],Zz=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Qz=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Jz=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],tB=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}];class eB{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[].concat(...[f,m,g,y,b,v,w,S,k,_,C,I,E,T,N,A,x].map(t=>t.json));this.opMappers=t.reduce((t,e)=>(t[e.tfOpName]=e,t),{})}transformGraph(t,e={}){const n=[],r=[],s=[],i=t.node.reduce((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")?n.push(t[e.name]):"Const"===e.op?r.push(t[e.name]):null!=e.input&&0!==e.input.length||s.push(t[e.name]),t),{});let a=[];const o=[];let l={},u={};null!=e&&(l=this.mapSignatureEntries(e.inputs),u=this.mapSignatureEntries(e.outputs));const c=Object.keys(i);c.forEach(t=>{const e=i[t];e.inputNames.forEach(t=>{const[n]=Dz(t);e.inputs.push(i[n]),i[n].children.push(e)})}),0===Object.keys(u).length?c.forEach(t=>{const e=i[t];0===e.children.length&&o.push(e)}):Object.keys(u).forEach(t=>{const[e]=Dz(t),n=i[e];null!=n&&(n.signatureKey=u[t],o.push(n))}),Object.keys(l).length>0?Object.keys(l).forEach(t=>{const[e]=Dz(t),n=i[e];n&&(n.signatureKey=l[t],a.push(n))}):a=n;let h={};null!=t.library&&null!=t.library.function&&(h=t.library.function.reduce((t,e)=>(t[e.signature.name]=this.mapFunction(e),t),{}));const d={nodes:i,inputs:a,outputs:o,weights:r,placeholders:n,signature:e,functions:h};return s.length>0&&(d.initNodes=s),d}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,n)=>(e[t[n].name]=n,e),{})}mapNode(t){const e=Az(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(t=>t.startsWith("^")?t.substr(1):t),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((e,n)=>{const r=n.type;let s=void 0;switch(n.type){case"string":s=rB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=rB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":s=pB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=pB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":s=iB(t.attr,n.tfName,n.defaultValue||0),void 0===s&&n.tfDeprecatedName&&(s=iB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":s=dB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=dB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":s=sB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=sB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":s=mB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=mB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":s=hB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=hB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":s=fB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=fB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":s=lB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=lB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":s=uB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=uB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":s=oB(t.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=oB(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${t.op}`)}return e[n.name]={value:s,type:r},e},{})),n}mapFunction(t){const e=t.nodeDef,n=[];let r={};null!=e&&(r=e.reduce((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&n.push(t[e.name]),t),{}));const s=[],i=[];t.signature.inputArg.forEach(t=>{const[e]=Dz(t.name),n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:aB(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,s.push(n),r[e]=n}),Object.keys(r).forEach(t=>{const e=r[t];e.inputNames.forEach(t=>{const[n]=Dz(t);e.inputs.push(r[n]),r[n].children.push(e)})});const a=t.ret;t.signature.outputArg.forEach(t=>{const[e,n]=Dz(a[t.name]),s=r[e];null!=s&&(s.defaultOutput=n,i.push(s))});const o=this.mapArgsToSignature(t);return{nodes:r,inputs:s,outputs:i,weights:n,placeholders:[],signature:o}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t),{}),outputs:t.signature.outputArg.reduce((e,n)=>(e[n.name]=this.mapArgToTensorInfo(n,t.ret),e),{})}}mapArgToTensorInfo(t,e){let n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}function nB(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){const e=FI().global;if(void 0!==e.atob)return e.atob(t);if("undefined"!=typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function rB(t,e,n,r=!1){const s=t[e];return null!=s?nB(s.s,r):n}function sB(t,e,n){const r=t[e];return r?r.b:n}function iB(t,e,n){const r=t[e]||{},s=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof s?s:parseInt(s,10)}function aB(t){switch("string"==typeof t&&(t=Ez[t]),t){case Ez.DT_FLOAT:return"float32";case Ez.DT_INT32:case Ez.DT_INT64:case Ez.DT_INT8:case Ez.DT_UINT8:return"int32";case Ez.DT_BOOL:return"bool";case Ez.DT_DOUBLE:return"float32";case Ez.DT_STRING:return"string";default:return null}}function oB(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function lB(t,e,n){const r=t[e];return r&&r.type?aB(r.type):n}function uB(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(t=>aB(t)):n}function cB(t){if(!t.unknownRank)return null!=t.dim?t.dim.map(t=>"number"==typeof t.size?t.size:parseInt(t.size,10)):[]}function hB(t,e,n){const r=t[e];return r&&r.shape?cB(r.shape):n}function dB(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(t=>"number"==typeof t?t:parseInt(t,10)):n}function pB(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(t=>nB(t,r)):n}function fB(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(t=>cB(t)):n}function mB(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}class gB{constructor(t,e,n){this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(t=>this.getInput(t)),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((t,e)=>(t[e]=this.getAttr(e),t),{}))}getInput(t){return Oz(t,this.tensorMap,this.context)}getAttr(t,e){const n=this.node.rawAttrs[t];if(null!=n.tensor)return Oz(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return iB(this.node.rawAttrs,t,e);if(null!=n.s)return rB(this.node.rawAttrs,t,e);if(null!=n.b)return sB(this.node.rawAttrs,t,e);if(null!=n.shape)return hB(this.node.rawAttrs,t,e);if(null!=n.type)return lB(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return dB(this.node.rawAttrs,t,e);if(null!=n.list.s)return pB(this.node.rawAttrs,t,e);if(null!=n.list.shape)return fB(this.node.rawAttrs,t,e);if(null!=n.list.b)return mB(this.node.rawAttrs,t,e);if(null!=n.list.type)return uB(this.node.rawAttrs,t,e)}return e}}const yB=RA({addN_:function(t){GC(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),GC(t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+t.length);const e=t.map((t,e)=>NA(t,"tensors"+e,"addN")),n=e[0];return e.forEach(t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!JC(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),_A.runKernel(UI,e)}});function bB(t,e,n=""){r.assert(function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0}(t,e),()=>n+` Shapes ${t} and ${e} must match`)}class vB{constructor(t,e,n,r,s,i,a){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=s,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=xO(0),vO(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.tensor.id)||e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(t=>this.read(t))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),bB(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);n.tensor=e,vO(e),n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((t,n)=>this.write(t,e[n]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return FA([],[0].concat(this.elementShape));const n=this.readMany(t);return bB(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),xF(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return FA([],[0].concat(this.elementShape));const e=[];for(let r=0;r<this.size();r++)e.push(r);const n=this.readMany(e);return bB(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),YO(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(t,EF(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let n=0;const r=t.map(t=>(n+=t,n));if(n!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const s=0===n?0:e.size/n,i=[];yO(()=>{e=WO(e,[1,n,s]);for(let n=0;n<t.length;++n)i[n]=WO(dF(e,[0,0===n?0:r[n-1],0],[1,t[n],s]),this.elementShape);return i});const a=[];for(let o=0;o<t.length;o++)a[o]=o;this.writeMany(a,i)}}class wB{constructor(t,e,n,r=-1){this.tensors=t,this.elementShape=e,this.elementDtype=n,null!=t&&t.forEach(t=>{if(n!==t.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${t.dtype}`);bB(e,t.shape,"TensorList shape mismatch: "),vO(t)}),this.idTensor=xO(0),this.maxNumElements=r,vO(this.idTensor)}get id(){return this.idTensor.id}copy(){return new wB([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.id)||e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,n=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);return bB(t,this.elementShape,"TensorList shape mismatch: "),yO(()=>{const e=this.tensors.map(e=>WO(e,t));return xF(e,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=this.tensors.pop();return bB(n.shape,t,"TensorList shape mismatch: "),WO(n,t)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(bB(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");vO(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: "+t);if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=t}getItem(t,e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[t])throw new Error(`element at index ${t} is null.`);return bB(this.tensors[t].shape,e,"TensorList shape mismatch: "),this.tensors[t]}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);bB(this.elementShape,e.shape,"TensorList shape mismatch: "),vO(e),this.tensors[t]=e}gather(t,e,n){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);return bB(this.elementShape,n,"TensorList shape mismatch: "),0===(t=t.slice(0,this.size())).length?FA([],[0].concat(this.elementShape)):yO(()=>{const e=t.map(t=>WO(this.tensors[t],n));return xF(e,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);return bB(this.elementShape,e,"TensorList shape mismatch: "),0===this.size()?FA([],[0].concat(this.elementShape)):yO(()=>{const t=this.tensors.map(t=>WO(t,e));return YO(t,0)})}}const _B=RA({maxPoolWithArgmax_:function(t,e,n,r,s=!1){const i=NA(t,"x","maxPoolWithArgmax"),a=_A.runKernel(bT,{x:i},{filterSize:e,strides:n,pad:r,includeBatchInIndex:s});return{result:a[0],indexes:a[1]}}});function xB(t,e,n){const[r,s]=Rz("fusedOps",t,e,n),i="biasadd"===r,a="prelu"===s,o="fusedbatchnorm"===r,l=Rz("numArgs",t,e,n);if(i){if(a&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(o)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const u=Rz("strides",t,e,n),c=Mz(t,e,n),h=Rz("dataFormat",t,e,n).toUpperCase(),d=Rz("dilations",t,e,n),[p,f]=Rz("args",t,e,n);return{stride:u,pad:c,dataFormat:h,dilations:d,biasArg:p,preluArg:f,activationFunc:s,leakyreluAlpha:Rz("leakyreluAlpha",t,e,n)}}function kB(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return _A.runKernel(sT,{},{start:t,stop:e,num:n})}const SB=RA({multinomial_:function(t,e,n,r=!1){const s=NA(t,"logits","multinomial"),i=s.size,a=s.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();const o=1===a?WO(s,[1,-1]):s,l=_A.runKernel(ST,{logits:o},{numSamples:e,seed:n,normalized:r});return 1===a?WO(l,[l.size]):l}}),CB=async function(t){const e=NA(t,"condition","whereAsync","bool"),n=await e.data(),r=RM(e.shape,n);return t!==e&&e.dispose(),r};function IB(t,e,n){return{boxes:Rz("boxes",t,e,n),scores:Rz("scores",t,e,n),maxOutputSize:Rz("maxOutputSize",t,e,n),iouThreshold:Rz("iouThreshold",t,e,n),scoreThreshold:Rz("scoreThreshold",t,e,n),softNmsSigma:Rz("softNmsSigma",t,e,n)}}class EB{constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=xO(0),this.tensorMap=new Map,vO(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}async import(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),yO(()=>{const t=EF(e),s=n.length,i=t.length;r.assert(s===i,()=>`The number of elements doesn't match, keys has ${s} elements, the values has ${i} elements.`);for(let e=0;e<s;e++){const r=n[e],s=t[e];vO(s),this.tensorMap.set(r,s)}return this.handle})}async find(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return yO(()=>{const t=[];for(let r=0;r<n.length;r++){const s=this.findWithDefault(n[r],e);t.push(s)}return xF(t)})}findWithDefault(t,e){const n=this.tensorMap.get(t);return null!=n?n:e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got `+t.dtype);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got `+e.dtype)}}const TB=RA({sparseToDense_:function(t,e,n,r=0){const s=NA(t,"sparseIndices","sparseToDense","int32"),i=NA(e,"sparseValues","sparseToDense"),a=NA(r,"defaultValue","sparseToDense",i.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);if(0!==e.rank&&(1!==e.rank||e.size!==s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(s,i,n,a),_A.runKernel(fN,{sparseIndices:s,sparseValues:i,defaultValue:a},{outputShape:n})}}),NB=RA({bincount_:function(t,e,n){const r=NA(t,"x","bincount"),s=NA(e,"weights","bincount");return GC("int32"===r.dtype,()=>"Error in bincount: input dtype must be int32, but got "+r.dtype),GC(n>=0,()=>`size must be non-negative, but got ${n}.`),GC(s.size===r.size||0===s.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: `+s.shape+"."),_A.runKernel(iE,{x:r,weights:s},{size:n})}}),AB=RA({denseBincount_:function(t,e,n,r=!1){const s=NA(t,"x","denseBincount"),i=NA(e,"weights","denseBincount");return GC("int32"===s.dtype,()=>"Error in denseBincount: input dtype must be int32, but got "+s.dtype),GC(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),GC(n>=0,()=>`size must be non-negative, but got ${n}.`),GC(i.size===s.size||0===i.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: `+i.shape+"."),_A.runKernel(xE,{x:s,weights:i},{size:n,binaryOutput:r})}}),RB=RA({scatterND_:function(t,e,n){const r=NA(t,"indices","scatterND","int32"),s=NA(e,"updates","scatterND");return rM(s,r,n),_A.runKernel(ZT,{indices:r,updates:s},{shape:n})}}),OB=RA({gatherND_:function(t,e){const n=NA(e,"indices","gatherND","int32"),r=NA(t,"x","gatherND");return _A.runKernel(qE,{params:r,indices:n})}});function DB(t,e,n,s){const i=((t,e,n)=>{switch(t.category){case"arithmetic":return yO(()=>((t,e,n)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[CO(Rz("a",t,e,n),Rz("b",t,e,n))];case"AddN":return[yB(Rz("tensors",t,e,n))];case"FloorMod":case"Mod":return[$P(Rz("a",t,e,n),Rz("b",t,e,n))];case"Mul":return[ID(Rz("a",t,e,n),Rz("b",t,e,n))];case"RealDiv":case"Div":return[lD(Rz("a",t,e,n),Rz("b",t,e,n))];case"DivNoNan":return[tz(Rz("a",t,e,n),Rz("b",t,e,n))];case"FloorDiv":return[oD(Rz("a",t,e,n),Rz("b",t,e,n))];case"Sub":return[ED(Rz("a",t,e,n),Rz("b",t,e,n))];case"Minimum":return[MD(Rz("a",t,e,n),Rz("b",t,e,n))];case"Maximum":return[DD(Rz("a",t,e,n),Rz("b",t,e,n))];case"Pow":return[tF(Rz("a",t,e,n),Rz("b",t,e,n))];case"SquaredDifference":return[N$(Rz("a",t,e,n),Rz("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"basic_math":return yO(()=>((t,e,n)=>{switch(t.op){case"Abs":case"ComplexAbs":return[SO(Rz("x",t,e,n))];case"Acos":return[DP(Rz("x",t,e,n))];case"Acosh":return[FP(Rz("x",t,e,n))];case"Asin":return[qP(Rz("x",t,e,n))];case"Asinh":return[GP(Rz("x",t,e,n))];case"Atan":return[KP(Rz("x",t,e,n))];case"Atan2":return[XP(Rz("x",t,e,n),Rz("y",t,e,n))];case"Atanh":return[YP(Rz("x",t,e,n))];case"Ceil":return[ZP(Rz("x",t,e,n))];case"Complex":return[OA(Rz("real",t,e,n),Rz("imag",t,e,n))];case"Cos":return[xP(Rz("x",t,e,n))];case"Cosh":return[SP(Rz("x",t,e,n))];case"Elu":return[uD(Rz("x",t,e,n))];case"Erf":return[lz(Rz("x",t,e,n))];case"Exp":return[SD(Rz("x",t,e,n))];case"Expm1":return[uz(Rz("x",t,e,n))];case"Floor":return[bD(Rz("x",t,e,n))];case"Log":return[kD(Rz("x",t,e,n))];case"Log1p":return[A$(Rz("x",t,e,n))];case"Imag":return[DF(Rz("x",t,e,n))];case"Neg":return[GD(Rz("x",t,e,n))];case"Reciprocal":return[wz(Rz("x",t,e,n))];case"Real":return[FF(Rz("x",t,e,n))];case"Relu":return[oF(Rz("x",t,e,n))];case"Round":return[_z(Rz("x",t,e,n))];case"Selu":return[uF(Rz("x",t,e,n))];case"Sigmoid":return[hF(Rz("x",t,e,n))];case"Sin":return[lL(Rz("x",t,e,n))];case"Sign":return[xz(Rz("x",t,e,n))];case"Sinh":return[cL(Rz("x",t,e,n))];case"Softplus":return[bF(Rz("x",t,e,n))];case"Sqrt":return[wF(Rz("x",t,e,n))];case"Square":return[HD(Rz("x",t,e,n))];case"Tanh":return[kF(Rz("x",t,e,n))];case"Tan":return[Sz(Rz("x",t,e,n))];case"ClipByValue":return[XO(Rz("x",t,e,n),Rz("clipValueMin",t,e,n),Rz("clipValueMax",t,e,n))];case"Relu6":return[BF(Rz("x",t,e,n))];case"Rsqrt":return[kL(Oz(t.inputNames[0],e,n))];case"Prod":return[vz(Rz("x",t,e,n),Rz("axes",t,e,n))];case"LeakyRelu":return[xD(Rz("x",t,e,n),Rz("alpha",t,e,n))];case"Prelu":return[eF(Rz("x",t,e,n),Rz("alpha",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"control":return(async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=Rz("thenBranch",t,e,n),s=Rz("elseBranch",t,e,n),i=Rz("cond",t,e,n),a=Rz("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=Rz("body",t,e,n),s=Rz("cond",t,e,n),i=Rz("args",t,e,n),a=await n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),o=i.map(t=>t.id);let l=await a[0].data();a.forEach(t=>{t.kept||-1!==o.indexOf(t.id)||t.dispose()});let u=i;for(;l[0];){const t=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const e=u.map(t=>t.id);t.forEach(t=>{t.kept||-1!==o.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()});const i=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await i[0].data(),i.forEach(t=>{t.kept||-1!==o.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()})}return u}case"LoopCond":return[Lz(Rz("pred",t,e,n))];case"Switch":{const r=Rz("pred",t,e,n);let s=Rz("data",t,e,n);return s.kept||(s=Lz(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(t=>void 0!==Oz(t,e,n));return r?[Lz(Oz(r,e,n))]:void 0}case"Enter":{const r=Rz("frameName",t,e,n),s=Rz("tensor",t,e,n);return n.enterFrame(r),[Lz(s)]}case"Exit":{const r=Rz("tensor",t,e,n);return n.exitFrame(),[Lz(r)]}case"NextIteration":{const r=Rz("tensor",t,e,n);return n.nextIteration(),[Lz(r)]}case"TensorArrayV3":{const r=Rz("size",t,e,n),s=Rz("dtype",t,e,n),i=Rz("elementShape",t,e,n),a=Rz("dynamicSize",t,e,n),o=Rz("clearAfterRead",t,e,n),l=Rz("identicalElementShapes",t,e,n),u=Rz("name",t,e,n),c=new vB(u,s,r,i,l,a,o);return n.addTensorArray(c),[c.idTensor,xO(1)]}case"TensorArrayWriteV3":{const r=Rz("tensorArrayId",t,e,n),s=Rz("index",t,e,n),i=Rz("tensor",t,e,n),a=n.getTensorArray(r.id);return a.write(s,i),[a.idTensor]}case"TensorArrayReadV3":{const r=Rz("tensorArrayId",t,e,n),s=Rz("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=Rz("tensorArrayId",t,e,n),s=Rz("indices",t,e,n),i=Rz("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,i)]}case"TensorArrayScatterV3":{const r=Rz("tensorArrayId",t,e,n),s=Rz("indices",t,e,n),i=Rz("tensor",t,e,n),a=n.getTensorArray(r.id);return a.scatter(s,i),[a.idTensor]}case"TensorArrayConcatV3":{const r=Rz("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),i=Rz("dtype",t,e,n);return[s.concat(i)]}case"TensorArraySplitV3":{const r=Rz("tensorArrayId",t,e,n),s=Rz("tensor",t,e,n),i=Rz("lengths",t,e,n),a=n.getTensorArray(r.id);return a.split(i,s),[a.idTensor]}case"TensorArraySizeV3":{const r=Rz("tensorArrayId",t,e,n);return[xO(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=Rz("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=Rz("tensorListId",t,e,n),s=Rz("index",t,e,n),i=Rz("tensor",t,e,n),a=n.getTensorList(r.id);return a.setItem(s,i),[a.idTensor]}case"TensorListGetItem":{const r=Rz("tensorListId",t,e,n),s=Rz("index",t,e,n),i=Rz("elementShape",t,e,n),a=Rz("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,i,a)]}case"TensorListScatterV2":case"TensorListScatter":{const r=Rz("indices",t,e,n),s=function(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(null!=r&&-1!==r&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const i=new wB([],n,t.dtype,r),a=EF(t,0);return e.forEach((t,e)=>{i.setItem(t,a[e])}),i}(Rz("tensor",t,e,n),r,Rz("elementShape",t,e,n),Rz("numElements",t,e,n));return n.addTensorList(s),[s.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=Rz("elementShape",t,e,n),s=Rz("elementDType",t,e,n);let i;i="TensorListReserve"===t.op?"numElements":"maxNumElements";const a=function(t,e,n){return new wB([],t,e,n)}(r,s,Rz(i,t,e,n));return n.addTensorList(a),[a.idTensor]}case"TensorListGather":{const r=Rz("tensorListId",t,e,n),s=Rz("indices",t,e,n),i=Rz("elementShape",t,e,n),a=Rz("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,a,i)]}case"TensorListStack":{const r=Rz("tensorListId",t,e,n),s=Rz("elementShape",t,e,n),i=Rz("elementDType",t,e,n),a=Rz("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,i,a)]}case"TensorListFromTensor":{const r=function(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: "+t.shape);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);bB(t.shape.slice(1),e,"TensorList shape mismatch: ");const s=EF(t);return new wB(s,e,r)}(Rz("tensor",t,e,n),Rz("elementShape",t,e,n),Rz("elementDType",t,e,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":{const r=Rz("tensorListId",t,e,n),s=n.getTensorList(r.id),i=Rz("dtype",t,e,n),a=Rz("elementShape",t,e,n);return[s.concat(i,a)]}case"TensorListPushBack":{const r=Rz("tensorListId",t,e,n),s=Rz("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(s),[i.idTensor]}case"TensorListPopBack":{const r=Rz("tensorListId",t,e,n),s=Rz("elementShape",t,e,n),i=Rz("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,i)]}case"TensorListSplit":{const r=Rz("tensor",t,e,n),s=Rz("elementShape",t,e,n),i=function(t,e,n){let r=0;const s=e.map(t=>(r+=t,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${t.shape}`);const i=0===r?0:t.size/r,a=yO(()=>{const a=[];t=WO(t,[1,r,i]);for(let r=0;r<e.length;++r)a[r]=WO(dF(t,[0,0===r?0:s[r-1],0],[1,e[r],i]),n);return t.dispose(),a}),o=new wB([],n,t.dtype,e.length);for(let l=0;l<a.length;l++)o.setItem(l,a[l]);return o}(r,Rz("lengths",t,e,n),s);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n);case"convolution":return yO(()=>((t,e,n)=>{switch(t.op){case"Conv1D":{const r=Rz("stride",t,e,n),s=Rz("pad",t,e,n),i=Rz("dataFormat",t,e,n).toUpperCase(),a=Rz("dilation",t,e,n);return[nD(Rz("x",t,e,n),Rz("filter",t,e,n),r,s,i,a)]}case"Conv2D":{const r=Rz("strides",t,e,n),s=Mz(t,e,n),i=Rz("dataFormat",t,e,n).toUpperCase(),a=Rz("dilations",t,e,n);return[eD(Rz("x",t,e,n),Rz("filter",t,e,n),[r[1],r[2]],s,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:s,dataFormat:i,dilations:a,biasArg:o,preluArg:l,activationFunc:u,leakyreluAlpha:h}=xB(t,e,n);return[c.conv2d({x:Rz("x",t,e,n),filter:Rz("filter",t,e,n),strides:[r[1],r[2]],pad:s,dataFormat:i,dilations:[a[1],a[2]],bias:o,activation:u,preluActivationWeights:l,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:s,dataFormat:i,dilations:a,biasArg:o,preluArg:l,activationFunc:u,leakyreluAlpha:h}=xB(t,e,n);return[c.depthwiseConv2d({x:Rz("x",t,e,n),filter:Rz("filter",t,e,n),strides:[r[1],r[2]],pad:s,dataFormat:i,dilations:[a[1],a[2]],bias:o,activation:u,preluActivationWeights:l,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=Rz("outputShape",t,e,n),s=Rz("strides",t,e,n),i=Mz(t,e,n);return[sD(Rz("x",t,e,n),Rz("filter",t,e,n),r,[s[1],s[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=Rz("strides",t,e,n),s=Mz(t,e,n),i=Rz("dilations",t,e,n),a=Rz("dataFormat",t,e,n).toUpperCase();return[aD(Rz("input",t,e,n),Rz("filter",t,e,n),[r[1],r[2]],s,a,[i[1],i[2]])]}case"Conv3D":{const r=Rz("strides",t,e,n),s=Rz("pad",t,e,n),i=Rz("dataFormat",t,e,n).toUpperCase(),a=Rz("dilations",t,e,n);return[iD(Rz("x",t,e,n),Rz("filter",t,e,n),[r[1],r[2],r[3]],s,i,[a[1],a[2],a[3]])]}case"AvgPool":{const r=Rz("strides",t,e,n),s=Rz("pad",t,e,n),i=Rz("kernelSize",t,e,n);return[UO(Rz("x",t,e,n),[i[1],i[2]],[r[1],r[2]],s)]}case"MaxPool":{const r=Rz("strides",t,e,n),s=Rz("pad",t,e,n),i=Rz("kernelSize",t,e,n);return[RD(Rz("x",t,e,n),[i[1],i[2]],[r[1],r[2]],s)]}case"MaxPoolWithArgmax":{const r=Rz("strides",t,e,n),s=Rz("pad",t,e,n),i=Rz("kernelSize",t,e,n),a=Rz("includeBatchInIndex",t,e,n),{result:o,indexes:l}=_B(Rz("x",t,e,n),[i[1],i[2]],[r[1],r[2]],s,a);return[o,l]}case"AvgPool3D":{const r=Rz("strides",t,e,n),s=Rz("pad",t,e,n),i=Rz("kernelSize",t,e,n);return[jO(Rz("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],s)]}case"MaxPool3D":{const r=Rz("strides",t,e,n),s=Rz("pad",t,e,n),i=Rz("kernelSize",t,e,n);return[OD(Rz("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],s)]}case"Dilation2D":{const r=Rz("strides",t,e,n),s=Rz("pad",t,e,n),i=Rz("dilations",t,e,n),a=r[1],o=r[2],l=i[1],u=i[2];return[JP(Rz("x",t,e,n),Rz("filter",t,e,n),[a,o],s,[l,u],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"creation":return yO(()=>((t,e,n)=>{switch(t.op){case"Fill":{const r=Rz("shape",t,e,n),s=Rz("dtype",t,e,n);return[yD(r,Rz("value",t,e,n),s)]}case"LinSpace":return[kB(Rz("start",t,e,n),Rz("stop",t,e,n),Rz("num",t,e,n))];case"Multinomial":{const r=Rz("logits",t,e,n),s=Rz("numSamples",t,e,n),i=Rz("seed",t,e,n);return[SB(r,s,i)]}case"OneHot":{const r=Rz("indices",t,e,n),s=Rz("depth",t,e,n),i=Rz("onValue",t,e,n),a=Rz("offValue",t,e,n);return[XD(r,s,i,a)]}case"Ones":return[ZD(Rz("shape",t,e,n),Rz("dtype",t,e,n))];case"OnesLike":return[QD(Rz("x",t,e,n))];case"RandomUniform":return[aF(Rz("shape",t,e,n),Rz("minval",t,e,n),Rz("maxval",t,e,n),Rz("dtype",t,e,n))];case"Range":return[w$(Rz("start",t,e,n),Rz("stop",t,e,n),Rz("step",t,e,n),Rz("dtype",t,e,n))];case"TruncatedNormal":{const r=Rz("shape",t,e,n),s=Rz("mean",t,e,n),i=Rz("stdDev",t,e,n),a=Rz("seed",t,e,n);return[IF(r,s,i,Rz("dtype",t,e,n),a)]}case"Zeros":return[YD(Rz("shape",t,e,n),Rz("dtype",t,e,n))];case"ZerosLike":return[AF(Rz("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"dynamic":return(async(t,e,n)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:s,maxOutputSize:i,iouThreshold:a,scoreThreshold:o,softNmsSigma:l}=IB(t,e,n),u=await O$.nonMaxSuppressionWithScoreAsync(r,s,i,a,o,l);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:s,maxOutputSize:i,iouThreshold:a,scoreThreshold:o}=IB(t,e,n),l=Rz("padToMaxOutputSize",t,e,n),u=await O$.nonMaxSuppressionPaddedAsync(r,s,i,a,o,l);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:s,maxOutputSize:i,iouThreshold:a,scoreThreshold:o}=IB(t,e,n);return[await O$.nonMaxSuppressionAsync(r,s,i,a,o)]}case"Where":{const r=ER(Rz("condition",t,e,n),"bool"),s=[await CB(r)];return r.dispose(),s}case"ListDiff":return async function(t,e){const n=NA(t,"x","setdiff1d"),r=NA(e,"y","setdiff1d");GC(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),GC(1===n.rank,()=>`x should be 1D tensor, but got x (${n.shape}).`),GC(1===r.rank,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),i=await r.data(),a=new Set(i);let o=0;for(let c=0;c<s.length;c++)a.has(s[c])||o++;const l=new JN([o],n.dtype),u=new JN([o],"int32");for(let c=0,h=0;c<s.length;c++)a.has(s[c])||(l.values[h]=s[c],u.values[h]=c,h++);return[l.toTensor(),u.toTensor()]}(Rz("x",t,e,n),Rz("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n);case"evaluation":return yO(()=>((t,e,n)=>{switch(t.op){case"TopKV2":{const r=Rz("x",t,e,n),s=Rz("k",t,e,n),i=Rz("sorted",t,e,n),a=Cz(r,s,i);return[a.values,a.indices]}case"Unique":{const r=Rz("x",t,e,n),s=Iz(r);return[s.values,s.indices]}case"UniqueV2":{const r=Rz("x",t,e,n),s=Rz("axis",t,e,n),i=Iz(r,s);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"image":return yO(()=>((t,e,n)=>{switch(t.op){case"ResizeBilinear":{const r=Rz("images",t,e,n),s=Rz("size",t,e,n),i=Rz("alignCorners",t,e,n),a=Rz("halfPixelCenters",t,e,n);return[O$.resizeBilinear(r,[s[0],s[1]],i,a)]}case"ResizeNearestNeighbor":{const r=Rz("images",t,e,n),s=Rz("size",t,e,n),i=Rz("alignCorners",t,e,n),a=Rz("halfPixelCenters",t,e,n);return[O$.resizeNearestNeighbor(r,[s[0],s[1]],i,a)]}case"CropAndResize":{const r=Rz("image",t,e,n),s=Rz("boxes",t,e,n),i=Rz("boxInd",t,e,n),a=Rz("cropSize",t,e,n),o=Rz("method",t,e,n),l=Rz("extrapolationValue",t,e,n);return[O$.cropAndResize(r,s,i,a,o,l)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"graph":return yO(()=>((t,e,n)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=Rz("default",t,e,n);return[Oz(t.name,e,n)||r];case"Placeholder":return[Oz(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[Lz(Rz("x",t,e,n))];case"IdentityN":return Rz("x",t,e,n).map(t=>Lz(t));case"Snapshot":return[Lz(Rz("x",t,e,n))];case"Shape":return[SF(Rz("x",t,e,n).shape,"int32")];case"ShapeN":return Rz("x",t,e,n).map(t=>SF(t.shape));case"Size":return[xO(Rz("x",t,e,n).size,"int32")];case"Rank":return[xO(Rz("x",t,e,n).rank,"int32")];case"NoOp":return[xO(1)];case"Print":const s=Rz("x",t,e,n),i=Rz("data",t,e,n),a=Rz("message",t,e,n),o=Rz("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(a);for(let t=0;t<i.length;t++)console.log(Array.prototype.slice.call(i[t].dataSync()).slice(0,o));return[s];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"logical":return yO(()=>((t,e,n)=>{switch(t.op){case"Equal":return[pD(Rz("a",t,e,n),Rz("b",t,e,n))];case"NotEqual":return[KD(Rz("a",t,e,n),Rz("b",t,e,n))];case"Greater":return[wD(Rz("a",t,e,n),Rz("b",t,e,n))];case"GreaterEqual":return[_D(Rz("a",t,e,n),Rz("b",t,e,n))];case"Less":return[WL(Rz("a",t,e,n),Rz("b",t,e,n))];case"LessEqual":return[v$(Rz("a",t,e,n),Rz("b",t,e,n))];case"LogicalAnd":return[AD(Rz("a",t,e,n),Rz("b",t,e,n))];case"LogicalNot":return[yP(Rz("a",t,e,n))];case"LogicalOr":return[mz(Rz("a",t,e,n),Rz("b",t,e,n))];case"Select":case"SelectV2":return[NF(Rz("condition",t,e,n),Rz("a",t,e,n),Rz("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"matrices":return yO(()=>((t,e,n)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[YF(Rz("a",t,e,n),Rz("b",t,e,n),Rz("transposeA",t,e,n),Rz("transposeB",t,e,n))];case"Transpose":return[RF(Rz("x",t,e,n),Rz("perm",t,e,n))];case"_FusedMatMul":const[r,s]=Rz("fusedOps",t,e,n),i="biasadd"===r,a="prelu"===s,o=Rz("numArgs",t,e,n),l=Rz("leakyreluAlpha",t,e,n);if(i){if(a&&2!==o)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&1!==o)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,h]=Rz("args",t,e,n);return[c.matMul({a:Rz("a",t,e,n),b:Rz("b",t,e,n),transposeA:Rz("transposeA",t,e,n),transposeB:Rz("transposeB",t,e,n),bias:u,activation:s,preluActivationWeights:h,leakyreluAlpha:l})];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"normalization":return yO(()=>((t,e,n)=>{switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[HO(Rz("x",t,e,n),Rz("mean",t,e,n),Rz("variance",t,e,n),Rz("offset",t,e,n),Rz("scale",t,e,n),Rz("epsilon",t,e,n))];case"LRN":return[pz(Rz("x",t,e,n),Rz("radius",t,e,n),Rz("bias",t,e,n),Rz("alpha",t,e,n),Rz("beta",t,e,n))];case"Softmax":return[yF(Rz("x",t,e,n))];case"LogSoftmax":return[ND(Rz("x",t,e,n))];case"SparseToDense":return[TB(Rz("sparseIndices",t,e,n),Rz("outputShape",t,e,n),Rz("sparseValues",t,e,n),Rz("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"reduction":return yO(()=>((t,e,n)=>{switch(t.op){case"Max":{const r=Rz("axis",t,e,n),s=Rz("keepDims",t,e,n);return[CD(Rz("x",t,e,n),r,s)]}case"Mean":{const r=Rz("axis",t,e,n),s=Rz("keepDims",t,e,n);return[FD(Rz("x",t,e,n),r,s)]}case"Min":{const r=Rz("axis",t,e,n),s=Rz("keepDims",t,e,n);return[$D(Rz("x",t,e,n),r,s)]}case"Sum":{const r=Rz("axis",t,e,n),s=Rz("keepDims",t,e,n);return[TD(Rz("x",t,e,n),r,s)]}case"All":{const r=Rz("axis",t,e,n),s=Rz("keepDims",t,e,n);return[IO(Rz("x",t,e,n),r,s)]}case"Any":{const r=Rz("axis",t,e,n),s=Rz("keepDims",t,e,n);return[EO(Rz("x",t,e,n),r,s)]}case"ArgMax":{const r=Rz("axis",t,e,n);return[TO(Rz("x",t,e,n),r)]}case"ArgMin":{const r=Rz("axis",t,e,n);return[HP(Rz("x",t,e,n),r)]}case"Prod":{const r=Rz("axis",t,e,n),s=Rz("keepDims",t,e,n);return[vz(Rz("x",t,e,n),r,s)]}case"Cumsum":{const r=Rz("axis",t,e,n),s=Rz("exclusive",t,e,n),i=Rz("reverse",t,e,n);return[dL(Rz("x",t,e,n),r,s,i)]}case"Bincount":const r=Rz("x",t,e,n),s=Rz("weights",t,e,n),i=Rz("size",t,e,n);return[NB(r,s,i)];case"DenseBincount":{const r=Rz("x",t,e,n),s=Rz("weights",t,e,n),i=Rz("size",t,e,n),a=Rz("binaryOutput",t,e,n);return[AB(r,s,i,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"slice_join":return yO(()=>((t,e,n)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=Rz("n",t,e,n),s=Rz("axis",t,e,n);let i=Rz("tensors",t,e,n);return i=i.slice(0,r),[YO(i,s)]}case"Gather":{const r=Rz("x",t,e,n),s=Rz("indices",t,e,n);return[vD(r,ER(s,"int32"),0)]}case"GatherV2":{const r=Rz("axis",t,e,n),s=Rz("batchDims",t,e,n),i=Rz("x",t,e,n),a=Rz("indices",t,e,n);return[vD(i,ER(a,"int32"),r,s)]}case"Reverse":{const r=Rz("dims",t,e,n),s=[];for(let t=0;t<r.length;t++)r[t]&&s.push(t);const i=Rz("x",t,e,n);return[lF(i,s)]}case"ReverseV2":{const r=Rz("axis",t,e,n),s=Rz("x",t,e,n);return[lF(s,r)]}case"Slice":{const r=Rz("begin",t,e,n),s=Rz("size",t,e,n);return[dF(Rz("x",t,e,n),r,s)]}case"StridedSlice":{const r=Rz("begin",t,e,n),s=Rz("end",t,e,n),i=Rz("strides",t,e,n),a=Rz("beginMask",t,e,n),o=Rz("endMask",t,e,n),l=Rz("ellipsisMask",t,e,n),u=Rz("newAxisMask",t,e,n),c=Rz("shrinkAxisMask",t,e,n),h=Rz("x",t,e,n);return[kz(h,r,s,i,a,o,l,u,c)]}case"Pack":return yO(()=>{const s=Rz("axis",t,e,n),i=Rz("tensors",t,e,n),a=i[0].shape,o=_F(i[0]).shape,l=i.map(t=>{const e=r.arraysEqual(t.shape,a);if(!e&&!r.arraysEqual(_F(t).shape,o))throw new Error("the input tensors shape does not match");return e?t:WO(t,a)});return[xF(l,s)]});case"Unpack":{const r=Rz("axis",t,e,n),s=Rz("tensor",t,e,n);return EF(s,r)}case"Tile":{const r=Rz("reps",t,e,n);return[mD(Rz("x",t,e,n),r)]}case"Split":case"SplitV":{const r=Rz("axis",t,e,n),s=Rz("numOrSizeSplits",t,e,n),i=Rz("x",t,e,n);return vF(i,s,r)}case"ScatterNd":{const r=Rz("indices",t,e,n),s=Rz("values",t,e,n),i=Rz("shape",t,e,n);return[RB(r,s,i)]}case"GatherNd":{const r=Rz("x",t,e,n),s=Rz("indices",t,e,n);return[OB(r,s)]}case"SparseToDense":{const r=Rz("sparseIndices",t,e,n),s=Rz("outputShape",t,e,n),i=Rz("sparseValues",t,e,n),a=Rz("defaultValue",t,e,n);return[TB(r,i,s,i.dtype===a.dtype?a:ER(a,i.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"spectral":return yO(()=>((t,e,n)=>{switch(t.op){case"FFT":return[$F(Rz("x",t,e,n))];case"IFFT":return[LF(Rz("x",t,e,n))];case"RFFT":return[MF(Rz("x",t,e,n))];case"IRFFT":return[PF(Rz("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"transformation":return yO(()=>((t,e,n)=>{switch(t.op){case"Cast":return[ER(Rz("x",t,e,n),Rz("dtype",t,e,n))];case"ExpandDims":{const r=Rz("axis",t,e,n);return[fD(Rz("x",t,e,n),r)]}case"Squeeze":{const r=Rz("axis",t,e,n);return[_F(Rz("x",t,e,n),r)]}case"Reshape":return[WO(Rz("x",t,e,n),Rz("shape",t,e,n))];case"MirrorPad":return[yz(Rz("x",t,e,n),Rz("padding",t,e,n),Rz("mode",t,e,n))];case"PadV2":case"Pad":return[JD(Rz("x",t,e,n),Rz("padding",t,e,n),Rz("constantValue",t,e,n))];case"SpaceToBatchND":{const r=Rz("blockShape",t,e,n),s=Rz("paddings",t,e,n);return[XM(Rz("x",t,e,n),r,s)]}case"BatchToSpaceND":{const r=Rz("blockShape",t,e,n),s=Rz("crops",t,e,n);return[NP(Rz("x",t,e,n),r,s)]}case"DepthToSpace":{const r=Rz("blockSize",t,e,n),s=Rz("dataFormat",t,e,n).toUpperCase();return[QP(Rz("x",t,e,n),r,s)]}case"BroadcastTo":return[TF(Rz("x",t,e,n),Rz("shape",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"hash_table":return(async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=Rz("keyDType",t,e,n),i=Rz("valueDType",t,e,n),a=new EB(s,i);return r.addHashTable(t.name,a),[a.handle]}case"LookupTableImport":case"LookupTableImportV2":{const s=Rz("tableHandle",t,e,n,r),i=Rz("keys",t,e,n),a=Rz("values",t,e,n),o=r.getHashTableById(s.id);return[await o.import(i,a)]}case"LookupTableFind":case"LookupTableFindV2":{const s=Rz("tableHandle",t,e,n,r),i=Rz("keys",t,e,n),a=Rz("defaultValue",t,e,n),o=r.getHashTableById(s.id);return[await o.find(i,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n,s);case"custom":const i=Az(t.op);if(i&&i.customExecutor)return i.customExecutor(new gB(t,e,n));throw TypeError(`Custom op ${t.op} is not registered.`);default:throw TypeError(`Unknown op '${t.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return r.isPromise(i)?i.then(t=>[].concat(t)):[].concat(i)}class FB{constructor(t={},e={},n={},r={}){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=n,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(t=>0===t.id&&0===t.iterationId?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}function $B(t,e,n,r){const s=new Set,i=[];let a=null,o=null;const l=new Set,u=Object.keys(t).map(t=>$z(t)[0]);let c=[];null!=r&&(c=r.map(t=>$z(t.name)[0]));const h=[...e];for(;h.length>0;){const t=h.pop();(zB(t)||BB(t)||VB(t))&&null==a&&(a=t,o=a.children.map(t=>t.name).filter(t=>s.has(t))),s.add(t.name),null==n[t.name]&&-1===u.indexOf(t.name)&&-1===c.indexOf(t.name)&&(0!==t.inputs.length?t.inputs.forEach(t=>{l.has(t.name)||(l.add(t.name),h.push(t))}):i.push(t.name))}return{inputs:t,outputs:e,usedNodes:s,missingInputs:i,dynamicNode:a,syncInputs:o}}const MB=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],LB=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],PB=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"];function zB(t){return MB.indexOf(t.op)>=0}function BB(t){return LB.indexOf(t.op)>=0}function VB(t){return PB.indexOf(t.op)>=0}class WB{constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(e=>{this._functionExecutorMap[e]=new WB(t.functions[e],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(e=>t[e].map(t=>t.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}getCompilationKey(t,e){const n=t.map(t=>t.name).sort(),r=e.map(t=>t.name).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(t,e){const n=$B(t,e,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:s,syncInputs:i}=n;if(null!=s)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const n=e.map(t=>t.name),s=Object.keys(t);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${s}]. Missing the following inputs: [${r}]`)}return function(t,e,n){const{usedNodes:r,inputs:s}=n,i=[],a=Object.keys(s).map(t=>$z(t)[0]).map(e=>t.nodes[e]),o=t.initNodes;a.forEach(t=>{r.has(t.name)&&i.push(t)}),t.weights.forEach(t=>{r.has(t.name)&&i.push(t)}),null!=o&&o.forEach(t=>{r.has(t.name)&&i.push(t)});const l=new Set,u=[];for(;i.length>0;){const t=i.pop();l.add(t.name),e[t.name]||u.push(t),t.children.forEach(t=>{!l.has(t.name)&&r.has(t.name)&&t.inputs.every(t=>l.has(t.name))&&i.push(t)})}return u}(this.graph,this.weightMap,n)}execute(t,e){t=this.mapInputs(t);const n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const s=n.map(t=>this.graph.nodes[$z(t)[0]]),i=e.map(t=>$z(t)[0]);let a=i.map(t=>this.graph.nodes[t]);0===a.length&&(a=this._outputs);const o=this.getCompilationKey(s,a);let l=this.compiledMap.get(o);null==l&&(l=this.compile(t,a),this.compiledMap.set(o,l));const u={},c={};return yO(()=>{const n=new FB(this.weightMap,u,c,this.functionExecutorMap),s=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,r]=$z(e),i=[];i[r]=t[e],s[n]=i});const a=this.getFrozenTensorIds(s),o={};for(let t=0;t<l.length;t++){const e=l[t];if(!s[e.name]){const t=DB(e,s,n,this._resourceManager);if(r.isPromise(t))throw new Error(`The execution of the op '${e.op}' returned a promise. Please use model.executeAsync() instead.`);s[e.name]=t,this.checkTensorForDisposal(e.name,e,s,n,a,i,o)}}return null==this.parent&&n.dispose(a),e.map(t=>Oz(t,s,n))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(e=>t[e]).map(t=>t.map(t=>t.id)));return new Set(e)}checkTensorForDisposal(t,e,n,r,s,i,a){"control"!==e.category&&-1===i.indexOf(t)&&(n[t].forEach(t=>{null!=t&&(a[t.id]=(a[t.id]||0)+e.children.length)}),e.inputs.forEach(t=>{if("control"!==t.category){const e=function(t,e,n){return e[Fz(t,n.currentContextId)]}(t.name,n,r);null!=e&&e.forEach(t=>{if(t&&!s.has(t.id)){const e=a[t.id];1===e?(t.dispose(),delete a[t.id]):null!=e&&a[t.id]--}})}}))}async executeAsync(t,e){return this._executeAsync(t,e)}async _executeAsync(t,e,n=!1,r={},s={}){n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));const i=new FB(this.weightMap,r,s,this.functionExecutorMap),a=await this.executeWithControlFlow(t,i,e,n),o=e.map(t=>Oz(t,a,i)),l=o.map(t=>t.id),u=Object.keys(t).map(e=>t[e].id),c=new Set([...l,...u,...this.weightIds]);return Object.keys(a).forEach(t=>{a[t].forEach(t=>{!t||t.isDisposed||c.has(t.id)||t.dispose()})}),null==this.parent&&i.dispose(c),o}async executeFunctionAsync(t,e,n){const r=t.reduce((t,e,n)=>(t[this.inputs[n].name]=e,t),{});return this._executeAsync(r,this.outputNodes,!0,e,n)}async executeWithControlFlow(t,e,n,r){const s=Object.keys(t),i=s.map(t=>this.graph.nodes[$z(t)[0]]),a=n.map(t=>$z(t)[0]);let o=a.map(t=>this.graph.nodes[t]);0===o.length&&(o=this._outputs);const{usedNodes:l,missingInputs:u,dynamicNode:c,syncInputs:h}=$B(t,o,this.weightMap,this._initNodes),d=[...i,...this.graph.weights,...this._initNodes||[]].map(t=>({node:t,contexts:e.currentContext})),p=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,r]=$z(e),s=[];s[r]=t[e],p[n]=s});const f={},m=this.getFrozenTensorIds(p),g={};for(;d.length>0;){const t=this.processStack(i,d,e,p,g,m,a,f,l);await Promise.all(t)}null!=c||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const y=o.filter(t=>!zB(t)&&!Oz(t.name,p,e)).map(t=>t.name);if(y.length>0){let t="";throw null!=c&&(t=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${y}] from the provided inputs [${s}]. Consider providing the following inputs: [${u}]. ${t}`)}return p}processStack(t,e,n,s,i,a,o,l,u){const c=[];for(;e.length>0;){const t=e.pop();n.currentContext=t.contexts;let h="";if("Enter"===t.node.op&&Rz("isConstant",t.node,s,n)&&([h]=Dz(t.node.name,n)),null==s[t.node.name]){const d=DB(t.node,s,n,this._resourceManager);h||([h]=Dz(t.node.name,n));const p=n.currentContext;r.isPromise(d)?c.push(d.then(r=>(s[h]=r,n.currentContext=p,this.checkTensorForDisposal(h,t.node,s,n,a,o,l),this.processChildNodes(t.node,e,n,s,i,u),r))):(s[h]=d,this.checkTensorForDisposal(h,t.node,s,n,a,o,l),this.processChildNodes(t.node,e,n,s,i,u))}else this.processChildNodes(t.node,e,n,s,i,u)}return c}processChildNodes(t,e,n,r,s,i){t.children.forEach(t=>{const[a]=Dz(t.name,n);!s[a]&&i.has(t.name)&&("Merge"===t.op?t.inputNames.some(t=>!!Oz(t,r,n))&&(s[a]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every(t=>!!Oz(t,r,n))&&(s[a]=!0,e.push({contexts:n.currentContext,node:t})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(t=>t.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const n=t[e],[s]=$z(e),i=this.graph.nodes[s];if(i.attrParams.shape&&i.attrParams.shape.value){const t=i.attrParams.shape.value,e=t.length===n.shape.length&&n.shape.every((e,n)=>-1===t[n]||t[n]===e);r.assert(e,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${t}], but was [${n.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&r.assert(n.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${n.dtype}`)})}mapInputs(t){const e={};for(const n in t)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?e[this._signature.inputs[n].name]=t[n]:e[n]=t[n];return e}checkInputs(t){const e=Object.keys(t).filter(t=>{const[e]=$z(t);return null==this.graph.nodes[e]});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(t=>null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[t]?this._signature.outputs[t].name:t,{})}checkOutputs(t){t.forEach(t=>{const[e]=$z(t);if(!this.graph.nodes[e])throw new Error(`The output '${t}' is not found in the graph`)})}}class UB{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}class jB{constructor(t,e={}){this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={}),this.resourceManager=new UB}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=a.browserHTTPRequest(t,this.loadOptions);else{const e=a.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(a.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}async load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=await this.handler.load();return this.loadSync(t)}loadSync(t){this.artifacts=t;const e=this.artifacts.modelTopology;let n;n=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=n,this.version=`${e.versions.producer}.${e.versions.minConsumer}`;const r=a.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new WB(eB.Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const e=eB.Instance.transformGraph(t.modelInitializer);this.initializer=new WB(e),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(t,e){if("string"==typeof t){const e=a.getSaveHandlers(t);if(0===e.length)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new Error(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}predict(t,e){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof rA||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((e,n,r)=>(e[n]=t[r],e),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=this.executor.execute(t,e);return n.length>1?n:n[0]}async executeAsync(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=await this.executor.executeAsync(t,e);return n.length>1?n:n[0]}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,n)=>(e[n]=[t[n]],e),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function HB(t,e={}){if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t+="model.json?tfjs-format=file");const n=new jB(t,e);return await n.load(),n}function qB(t,e,n,r){return new(n||(n=Promise))(function(s,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function o(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){t.done?s(t.value):new n(function(e){e(t.value)}).then(a,o)}l((r=r.apply(t,e||[])).next())})}function GB(t,e){var n,r,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(6===i[0]&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}function KB(t,e,n,r){return new(n||(n=Promise))(function(s,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function o(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){t.done?s(t.value):new n(function(e){e(t.value)}).then(a,o)}l((r=r.apply(t,e||[])).next())})}function XB(t,e){var n,r,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(6===i[0]&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}var YB=function(t){for(var e=[],n=0,r=t;n<r.length;n++)e.push(r[n]);return e},ZB=function(){this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]},QB=function(){function t(){this.root=new ZB}return t.prototype.insert=function(t,e,n){for(var r=this.root,s=YB(t),i=0;i<s.length;i++)r.children[s[i]]||(r.children[s[i]]=new ZB,r.children[s[i]].parent=r,r.children[s[i]].word[0]=r.word[0].concat(s[i])),r=r.children[s[i]],i===s.length-1&&(r.end=!0,r.word[1]=e,r.word[2]=n)},t.prototype.commonPrefixSearch=function(t){for(var e=[],n=this.root.children[t[0]],r=0;r<t.length&&n;r++)n.end&&e.push(n.word),n=n.children[t[r+1]];return e.length||e.push([[t[0]],0,0]),e},t}(),JB=function(){function t(t){this.vocabulary=t,this.trie=new QB;for(var e=6;e<this.vocabulary.length;e++)this.trie.insert(this.vocabulary[e][0],this.vocabulary[e][1],e)}return t.prototype.encode=function(t){var e=[],n=[],r=[];t=function(t){return"\u2581"+t.normalize("NFKC").replace(/ /g,"\u2581")}(t);for(var s=YB(t),i=0;i<=s.length;i++)e.push({}),n.push(0),r.push(0);for(i=0;i<s.length;i++)for(var a=this.trie.commonPrefixSearch(s.slice(i)),o=0;o<a.length;o++){var l=a[o],u={key:l[0],score:l[1],index:l[2]};null==e[i+(c=l[0].length)][i]&&(e[i+c][i]=[]),e[i+c][i].push(u)}for(var c=0;c<=s.length;c++)for(var h in e[c]){var d=e[c][h];for(o=0;o<d.length;o++){var p=d[o],f=p.score+r[c-p.key.length];(0===r[c]||f>=r[c])&&(r[c]=f,n[c]=d[o].index)}}for(var m=[],g=n.length-1;g>0;)m.push(n[g]),g-=this.vocabulary[n[g]][0].length;var y=[],b=!1;for(i=0;i<m.length;i++){var v=m[i];b&&0===v||y.push(v),b=0===v}return y.reverse()},t}();function tV(t){return KB(this,void 0,void 0,function(){var e;return XB(this,function(n){switch(n.label){case 0:return[4,eV(t)];case 1:return e=n.sent(),[2,new JB(e)]}})})}function eV(t){return void 0===t&&(t="https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder/vocab.json"),KB(this,void 0,void 0,function(){return XB(this,function(e){switch(e.label){case 0:return[4,r.fetch(t)];case 1:return[2,e.sent().json()]}})})}var nV=function(){function t(t,e){void 0===t&&(t=.85),void 0===e&&(e=[]),this.threshold=t,this.toxicityLabels=e}return t.prototype.loadModel=function(){return qB(this,void 0,void 0,function(){return GB(this,function(t){return[2,HB("https://tfhub.dev/tensorflow/tfjs-model/toxicity/1/default/1",{fromTFHub:!0})]})})},t.prototype.loadTokenizer=function(){return qB(this,void 0,void 0,function(){return GB(this,function(t){return[2,tV()]})})},t.prototype.load=function(){return qB(this,void 0,void 0,function(){var t,e,n,s=this;return GB(this,function(i){switch(i.label){case 0:return[4,Promise.all([this.loadModel(),this.loadTokenizer()])];case 1:return t=i.sent(),n=t[1],this.model=e=t[0],this.tokenizer=n,this.labels=e.outputs.map(function(t){return t.name.split("/")[0]}),0===this.toxicityLabels.length?this.toxicityLabels=this.labels:r.assert(this.toxicityLabels.every(function(t){return s.labels.indexOf(t)>-1}),function(){return"toxicityLabels argument must contain only items from the model heads "+s.labels.join(", ")+", got "+s.toxicityLabels.join(", ")}),[2]}})})},t.prototype.classify=function(t){return qB(this,void 0,void 0,function(){var e,n,s,i,a,o,l,u=this;return GB(this,function(c){switch(c.label){case 0:for("string"==typeof t&&(t=[t]),e=t.map(function(t){return u.tokenizer.encode(t)}),n=e.map(function(t,e){return t.map(function(t,n){return[e,n]})}),s=[],i=0;i<n.length;i++)s=s.concat(n[i]);return a=CF(s,[s.length,2],"int32"),o=SF(r.flatten(e),"int32"),[4,this.model.executeAsync({Placeholder_1:a,Placeholder:o})];case 1:return l=c.sent(),a.dispose(),o.dispose(),[2,l.map(function(t,e){return{data:t,headIndex:e}}).filter(function(t){return u.toxicityLabels.indexOf(u.labels[t.headIndex])>-1}).map(function(e){for(var n=e.data.dataSync(),r=[],s=0;s<t.length;s++){var i=n.slice(2*s,2*s+2),a=null;Math.max(i[0],i[1])>u.threshold&&(a=i[0]<i[1]),r.push({probabilities:i,match:a})}return{label:u.labels[e.headIndex],results:r}})]}})})},t}();let rV;function sV(){return null==rV&&(rV=_A.backend.epsilon()),rV}class iV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,iV.prototype)}}class aV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,aV.prototype)}}class oV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,oV.prototype)}}class lV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,lV.prototype)}}class uV extends Error{constructor(t){super(t),Object.setPrototypeOf(this,uV.prototype)}}function cV(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function hV(t,e){if(!t)throw new uV(e)}function dV(t,e){let n=0;for(const r of t)r===e&&n++;return n}function pV(t){return 1===t.length?t[0]:t}function fV(t){return Array.isArray(t)?t:[t]}function mV(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function gV(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}Error;let yV={};function bV(t){if(null==t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function vV(t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach(t=>vV(t));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"==typeof e&&(Array.isArray(e)||"ndarray"!==e.type||"number"!=typeof e.value?vV(e):t[n]=e.value)}}}function wV(t,e={},n={},r="object",s=!1){if("string"==typeof t){const s=t;let i;if(s in n)i=n[s];else if(s in yV)i=yV[s];else if(i=e[s],null==i)throw new oV(`Unknown ${r}: ${t}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}{const i=t;if(null==i.className||null==i.config)throw new oV(r+": Improper config format: "+JSON.stringify(i)+".\n'className' and 'config' must set.");const a=i.className;let o,l;if(a in n?[o,l]=n[a]:a in yV?[o,l]=yV.className:a in e&&([o,l]=e[a]),null==o)throw new oV(`Unknown ${r}: ${a}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=l){const t={};for(const n of Object.keys(yV))t[n]=yV[n];for(const s of Object.keys(n))t[s]=n[s];i.config.customObjects=t;const e=Object.assign({},yV);for(const s of Object.keys(n))yV[s]=n[s];vV(i.config);const r=l(o,i.config,n,s);return yV=Object.assign({},e),r}{const t=Object.assign({},yV);for(const r of Object.keys(n))yV[r]=n[r];const e=new o(i.config);return yV=Object.assign({},t),e}}}function _V(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function xV(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function kV(t){if(null==t)throw new oV("Invalid value in obj: "+JSON.stringify(t));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function SV(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new oV(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function CV(t,e,n=0,r=1/0){return hV(n>=0),hV(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(t=>typeof t===e)}function IV(t,e){Array.isArray(t)?(r.assert(t.length>0,()=>e+" is unexpectedly an empty array."),t.forEach((t,n)=>IV(t,`element ${n+1} of ${e}`))):r.assert(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got `+EV(t)+".")}function EV(t){return null===t?"null":Array.isArray(t)?"["+t.map(t=>EV(t)).join(",")+"]":"string"==typeof t?`"${t}"`:""+t}function TV(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function NV(t,e){return yO(()=>wF(TD(ID(t,t),e,!0)))}class AV extends u.Serializable{getConfig(){return{}}}class RV extends AV{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return yO(()=>{const e=NV(t,this.axis),n=XO(e,0,this.maxValue);return ID(t,lD(n,CO(sV(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}RV.className="MaxNorm",u.registerClass(RV);class OV extends AV{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return yO(()=>lD(t,CO(sV(),NV(t,this.axis))))}getConfig(){return{axis:this.axis}}}OV.className="UnitNorm",u.registerClass(OV);class DV extends AV{apply(t){return oF(t)}}DV.className="NonNeg",u.registerClass(DV);class FV extends AV{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return yO(()=>{const e=NV(t,this.axis),n=CO(ID(this.rate,XO(e,this.minValue,this.maxValue)),ID(1-this.rate,e));return ID(t,lD(n,CO(sV(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}FV.className="MinMaxNorm",u.registerClass(FV);const $V={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function MV(t){return bV(t)}function LV(t,e={}){return wV(t,u.SerializationMap.getMap().classNameMap,e,"constraint")}function PV(t){return null==t?null:"string"==typeof t?LV({className:t in $V?$V[t]:t,config:{}}):t instanceof AV?t:LV(t)}const zV=["channelsFirst","channelsLast"],BV=["nearest","bilinear"],VV=["valid","same","causal"],WV=["max","avg"],UV=["sum","mul","concat","ave"],jV=new Map;function HV(t){SV(zV,"DataFormat",t)}function qV(t){SV(VV,"PaddingMode",t)}function GV(t){SV(WV,"PoolMode",t)}const KV=[];function XV(t,e){KV.push(t);try{const t=e();return KV.pop(),t}catch(n){throw KV.pop(),n}}function YV(t){if(!JV(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===KV.length?"":KV.join("/")+"/")+t}function ZV(t){if(!JV(t))throw new Error("Not a valid tensor name: '"+t+"'");jV.has(t)||jV.set(t,0);const e=jV.get(t);if(jV.set(t,jV.get(t)+1),e>0){const n=`${t}_${e}`;return jV.set(n,1),n}return t}const QV=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function JV(t){return!!t.match(QV)}function tW(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function eW(t){return SF(t=Array.isArray(t)?new Float32Array(t):t)}function nW(t){return $D(eW(t)).dataSync()[0]}function rW(t){return CD(eW(t)).dataSync()[0]}function sW(t,e){if(e<t)throw new oV(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}function iW(t,e){return t.asType(e)}function aW(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function oW(t,e,n){return yO(()=>{switch(t.rank){case 1:return pF(t,e,n);case 2:return fF(t,[e,0],[n,t.shape[1]]);case 3:return mF(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return gF(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return dF(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return dF(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new oV("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}})}function lW(t,e,n){return yO(()=>{switch(t.rank){case 1:return pF(t,e,n);case 2:return fF(t,[0,e],[t.shape[0],n]);case 3:return mF(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return gF(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new oV("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function uW(t,e,n,r){return yO(()=>{switch(t.rank){case 1:return pF(t,e,n);case 2:switch(r){case 1:return oW(t,e,n);case 2:return lW(t,e,n);default:throw new oV("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return oW(t,e,n);case 2:return mF(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return lW(t,e,n);default:throw new oV("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return oW(t,e,n);case 2:return gF(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return gF(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return lW(t,e,n);default:throw new oV("The axis is not within the rank of the tensor "+r)}default:throw new oV("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function cW(t,e=-1){let n;return e<0&&(n=t[0].rank,e=0!==n?n:0),e===t[0].rank&&(e=-1),YO(t,e)}function hW(t,e){switch(t.rank){case 1:return ZO([t,e]);case 2:return QO([t,e],0);case 3:return JO([t,e],0);case 4:return tD([t,e],0);default:throw new oV("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function dW(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new oV(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return mD(t,e)}function pW(t,e=0,n=1,r,s){return iF(t,e,n,r,s)}function fW(t,e,n,r){if(t.rank<2||e.rank<2)throw new lV(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3&&t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new lV(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = `+e.shape);if(2===t.rank&&2===e.rank)return c.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?yW(t.rank,r,"channelsLast"):null,activation:n});{const s=t.shape.slice(),i=s.pop();t=t.reshape([-1,i]);const a=e.shape.slice(),o=a.pop(),l=a.pop(),u=[...a,o],h=Array.from({length:e.rank},(t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n);e=e.transpose(h).reshape([l,-1]);const d=[...s,...u];return c.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?yW(t.rank,r,"channelsLast"):null,activation:n}).reshape(d)}}function mW(t,e,n){return yO(()=>(e=Array.isArray(e)?SF(e,"int32"):e.toInt(),vD(t,e,n)))}function gW(t){return ID(t,t)}function yW(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new oV("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(t<3)return e;throw new oV("Unsupported input rank by biasAdd: "+e.rank)}function bW(t,e,n){return yO(()=>(null==n&&(n="channelsLast"),HV(n),t.add(yW(t.rank,e,n))))}function vW(t,e,n,r){return yO(()=>OF(t,e,n,r))}function wW(t,e,n=!1){return n?t():e()}const _W=["fanIn","fanOut","fanAvg"],xW=["normal","uniform","truncatedNormal"];class kW extends u.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class SW extends kW{apply(t,e){return YD(t,e)}}SW.className="Zeros",u.registerClass(SW);class CW extends kW{apply(t,e){return ZD(t,e)}}CW.className="Ones",u.registerClass(CW);class IW extends kW{constructor(t){if(super(),"object"!=typeof t)throw new oV("Expected argument of type ConstantConfig but got "+t);if(void 0===t.value)throw new oV("config must have value set but got "+t);this.value=t.value}apply(t,e){return yO(()=>ID(xO(this.value),ZD(t,e)))}getConfig(){return{value:this.value}}}IW.className="Constant",u.registerClass(IW);class EW extends kW{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return aF(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}EW.className="RandomUniform",u.registerClass(EW);class TW extends kW{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new lV(`randomNormal does not support dType ${e}.`);return pW(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}TW.className="RandomNormal",u.registerClass(TW);class NW extends kW{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new lV(`truncatedNormal does not support dType ${e}.`);return IF(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}NW.className="TruncatedNormal",u.registerClass(NW);class AW extends kW{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return yO(()=>{if(2!==t.length||t[0]!==t[1])throw new oV("Identity matrix initializer can only be used for 2D square matrices.");return ID(this.gain,gD(t[0]))})}getConfig(){return{gain:this.gain}}}AW.className="Identity",u.registerClass(AW);class RW extends kW{constructor(t){if(super(),t.scale<0)throw new oV("scale must be a positive float. Got: "+t.scale);this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,SV(_W,"FanMode",this.mode),this.distribution=null==t.distribution?"normal":t.distribution,SV(xW,"Distribution",this.distribution),this.seed=t.seed}apply(t,e){const n=function(t,e="channelsLast"){let n,r;if(HV(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=tW(t,2);n=t[1]*e,r=t[0]*e}else if("channelsLast"===e){const e=tW(t,0,t.length-2);n=t[t.length-2]*e,r=t[t.length-1]*e}}else{const e=tW(t);n=Math.sqrt(e),r=Math.sqrt(e)}return[n,r]}(t),r=n[0],s=n[1];let i=this.scale;if(i/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,s):Math.max(1,(r+s)/2),"normal"===this.distribution){const n=Math.sqrt(i);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new lV(`${this.getClassName()} does not support dType ${e}.`);return IF(t,0,n,e,this.seed)}{const n=Math.sqrt(3*i);return aF(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}RW.className="VarianceScaling",u.registerClass(RW);class OW extends RW{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return RW.className}}OW.className="GlorotUniform",u.registerClass(OW);class DW extends RW{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return RW.className}}DW.className="GlorotNormal",u.registerClass(DW);class FW extends RW{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return RW.className}}FW.className="HeNormal",u.registerClass(FW);class $W extends RW{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return RW.className}}$W.className="HeUniform",u.registerClass($W);class MW extends RW{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return RW.className}}MW.className="LeCunNormal",u.registerClass(MW);class LW extends RW{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return RW.className}}LW.className="LeCunNormal",u.registerClass(LW);class PW extends kW{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new lV("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return yO(()=>{if(t.length<2)throw new lV("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const e=pW(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let n=D$.gramSchmidt(e);return t[0]>t[1]&&(n=n.transpose()),ID(this.gain,n)})}getConfig(){return{gain:this.gain,seed:this.seed}}}PW.className="Orthogonal",u.registerClass(PW);const zW={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function BW(t,e={}){return wV(t,u.SerializationMap.getMap().classNameMap,e,"initializer")}function VW(t){return bV(t)}function WW(t){if("string"==typeof t){const e=t in zW?zW[t]:t;if("GlorotNormal"===e)return new DW;if("GlorotUniform"===e)return new OW;if("HeNormal"===e)return new FW;if("HeUniform"===e)return new $W;if("LeCunNormal"===e)return new MW;if("LeCunUniform"===e)return new LW;{const t={};return t.className=e,t.config={},BW(t)}}return t instanceof kW?t:BW(t)}let UW=0;function jW(){return UW++}const HW={};function qW(t=""){return t in HW||(HW[t]=0),HW[t]+=1,t+HW[t].toString()}function GW(t){return Array.isArray(t)&&Array.isArray(t[0])}function KW(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function XW(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new oV("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function YW(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new oV("Expected exactly 1 Shape; got "+t.length)}return t}function ZW(t){let e=0;for(const n of t)e+=0===n.shape.length?1:n.shape.reduce((t,e)=>t*e);return e}class QW{constructor(t,e="float32",n="Variable",r=!0,s=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=jW(),this.originalName=YV(n=null==n?"Variable":n),this.name=ZV(this.originalName),this.trainable_=r,this.constraint=s,this.val=function(t,e=!0,n,r){return _A.makeVariable(t,e,n,r)}(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function JW(t){return t.map(t=>t.read())}function tU(t){t.forEach(t=>{t[0].write(t[1])})}class eU{constructor(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class nU{constructor(t,e,n,r,s,i,a){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=s,this.outputTensorIndex=a,this.id=jW(),null!=i&&(this.originalName=YV(i),this.name=ZV(this.originalName)),this.rank=e.length}}let rU=0;class sU{constructor(t,e){this.callArgs=e,this.id=rU++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)t.push(null!=e?e.name:null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let iU=0;class aU extends u.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=iU++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=mV(t)+"_"+qW(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}this.initialWeights=null!=t.weights?t.weights:null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new aV(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new oV(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return pV(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return pV(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new iV("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new iV("Layer "+this.name+" is not connected, no input to return.");return pV(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new iV("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new iV("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return pV(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=fV(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=fV(this.inputSpec);if(t.length!==e.length)throw new oV(`Layer ${this.name} expects ${e.length} inputs, but it received ${t.length} input tensors. Input received: `+t);for(let n=0;n<t.length;n++){const r=t[n],s=e[n];if(null==s)continue;const i=r.rank;if(null!=s.ndim&&i!==s.ndim)throw new oV(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${i}`);if(null!=s.maxNDim&&i>s.maxNDim)throw new oV(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${i}`);if(null!=s.minNDim&&i<s.minNDim)throw new oV(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${i}.`);if(null!=s.dtype&&r.dtype!==s.dtype)throw new oV(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${r.dtype}.`);if(s.axes){const t=r.shape;for(const e in s.axes){const r=Number(e),i=s.axes[e],a=r>=0?t[r]:t[t.length+r];if(null!=i&&-1===[i,null].indexOf(a))throw new oV(`Input ${n} is incompatible with layer ${this.name}: expected axis ${r} of input shape to have value ${i} but got shape ${t}.`)}}if(null!=s.shape)for(let t=0;t<s.shape.length;++t){const e=s.shape[t],i=r.shape[t];if(null!=e&&null!=i&&e!==i)throw new oV(`Input ${n} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${r.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=fV(t);let r=!0;for(const i of n)if(!(i instanceof nU)){r=!1;break}let s=!0;for(const i of n)if(i instanceof nU){s=!1;break}if(r===s)throw new oV("Arguments to apply() must be all SymbolicTensors or all Tensors");return XV(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of fV(t))e.push(n.shape);this.build(pV(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let r=this.call(t,e);const s=fV(r),i=[];for(let t of s)-1!==n.indexOf(t)&&(t=t.clone()),i.push(t);if(r=pV(i),null!=this.activityRegularizer)throw new lV("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(t){t=fV(t);const e=[];for(const n of t)e.push(n.shape);return pV(e)}(t),r=this.computeOutputShape(n);let s;const i="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),s=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,r)=>new nU(i,n,this,fV(t),e,this.name,r)):new nU(i,r,this,fV(t),e,this.name),this.addInboundNode(t,s,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new lV("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the "+`batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer `+this.name);else{let e=!1;this.batchInputShape.forEach((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: `+JSON.stringify(this.batchInputShape))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new iV(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new iV(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new aV(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return ZW(this.weights)}build(t){this.built=!0}getWeights(t=!1){return JW(t?this.trainableWeights:this.weights)}setWeights(t){yO(()=>{const e=this.weights;if(e.length!==t.length)throw new oV(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const n=[],s=JW(e);for(let i=0;i<s.length;++i){const a=s[i],o=e[i],l=t[i];if(!r.arraysEqual(a.shape,l.shape))throw new oV(`Layer weight shape ${a.shape} not compatible with provided weight shape `+l.shape);n.push([o,l])}tU(n)})}addWeight(t,e,n,r,s,i,a){if(-1!==this._addedWeightNames.indexOf(t))throw new oV(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=WW("zeros"));const o=r.apply(e,n),l=new QW(o,n,t,i,a);return o.dispose(),null!=s&&this.addLoss(()=>s.apply(l.read())),null==i&&(i=!0),i?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=fV(t),null!=this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach(t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return e}addInboundNode(t,e,n,r,s,i,a=null){const o=fV(t);e=fV(e),n=fV(n),r=fV(r),s=KW(s),i=KW(i);const l=[],u=[],c=[];for(const h of o)l.push(h.sourceLayer),u.push(h.nodeIndex),c.push(h.tensorIndex);new sU({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:o,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:s,outputShapes:i},a);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function oU(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const r=oU(t.inputTensors[n],t.inboundLayers[n],t.nodeIndices[n]);for(const t of r)-1===e.indexOf(t)&&e.push(t)}return e}}}class lU extends aU{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:qW("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new oV("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new oV("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new oV("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new nU(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new sU({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new oV("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}async function uU(t){if(null==t)return;const e=[],n=[],r=[];for(const s in t){const i=t[s];if("number"!=typeof i){const t=i;e.push(t.data()),n.push(s),r.push(t)}}if(e.length>0){const s=await Promise.all(e);for(let e=0;e<s.length;++e)t[n[e]]=s[e][0];bO(r)}}function cU(t){if(null!=t)for(const e in t){const n=t[e];"number"!=typeof n&&n.dispose()}}var hU;lU.className="InputLayer",u.registerClass(lU),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(hU||(hU={}));class dU{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class pU{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class fU extends dU{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const r in e){const t=e[r];if("number"==typeof t)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+t*n;else{let e;r in this.totals?e=this.totals[r]:this.totals[r]=0;const s=yO(()=>CO(this.totals[r],ID(t,n)));this.totals[r]=s,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params.metrics)null!=this.totals[n]&&("number"==typeof this.totals[n]?e[n]=this.totals[n]/this.seen:yO(()=>{const t=ID(lD(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),vO(e[n])}))}}class mU extends dU{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const s in this.history){const r=this.history[s];for(let i=0;i<r.length;++i)"number"!=typeof r[i]&&(t.push(r[i].data()),e.push(s),n.push(i))}const r=await Promise.all(t);for(let s=0;s<r.length;++s)this.history[e[s]][n[s]].dispose(),this.history[e[s]][n[s]]=r[s][0]}}class gU extends dU{constructor(t,e){if(super(),this.currentEpoch=0,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");r.isNumber(this.yieldEvery)&&(this.maybeWait=function(t,e){let n,s=r.now();return(...i)=>{const a=r.now();return a-s<e||(s=a,n=t(...i)),n}}(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await uU(n),r.push(this.yield(t,e,n))),r.push(j$()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await uU(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await uU(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(j$()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await uU(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await uU(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(j$()):r.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await uU(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await uU(t),await this.trainEnd(t))}}function yU(t,e){return null==t&&(t={}),t instanceof dU?[t]:Array.isArray(t)&&t[0]instanceof dU?t:fV(t).map(t=>new gU(t,e))}class bU{constructor(){}static registerCallbackConstructor(t,e){r.assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, but got "+t),bU.checkForDuplicate(e),null==bU.constructors[t]&&(bU.constructors[t]=[]),bU.constructors[t].push(e)}static checkForDuplicate(t){for(const e in bU.constructors)bU.constructors[+e].forEach(e=>{if(e===t)throw new oV("Duplicate callback constructor.")})}static clear(){bU.constructors={}}static createCallbacks(t){const e=[];for(const n in bU.constructors){const r=+n;t>=r&&e.push(...bU.constructors[r])}return e.map(t=>new t)}}function vU(t,e,n,r,s,i,a,o,l){const u=new mU,c=[new fU,...bU.createCallbacks(e)];null!=t&&c.push(...t),c.push(u);const h=new pU(c);return h.setParams({epochs:n,initialEpoch:r,samples:s,steps:i,batchSize:a,verbose:e,doValidation:o,metrics:l}),{callbackList:h,history:u}}function wU(t,e={},n=!1){return wV(t,u.SerializationMap.getMap().classNameMap,e,"layer",n)}function _U(t,e){return yO(()=>{"float32"!==t.dtype&&(t=t.asType("float32"));const n=TD(gW(t),e,!0),r=yD(n.shape,sV()),s=wF(DD(n,r));return lD(t,s)})}function xU(t,e){return yO(()=>FD(gW(ED(e,t)),-1))}function kU(t,e){return yO(()=>FD(SO(ED(e,t)),-1))}function SU(t,e){return yO(()=>{const n=ED(t,e),r=XO(SO(t),sV(),Number.MAX_VALUE),s=SO(lD(n,r));return ID(100,FD(s,-1))})}function CU(t,e,n=!1){return yO(()=>{if(n)e=yF(e);else{const t=TD(e,e.shape.length-1,!0);e=lD(e,t)}return e=XO(e,sV(),1-sV()),GD(TD(ID(t.toFloat(),kD(e)),e.shape.length-1))})}function IU(t,e,n=!1){return yO(()=>{const r=bD(function(t){const e=[tW(t.shape)];return t.reshape(e)}(t)).toInt(),s=(e=XO(e,sV(),1-sV())).shape;return CU(XD(r,s[s.length-1]).reshape(s),e,n)})}function EU(t,e){return yO(()=>{let n;return n=XO(e,sV(),1-sV()),n=kD(lD(n,ED(1,n))),FD(function(t,e){if(!r.arraysEqual(t.shape,e.shape))throw new oV(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return yO(()=>{const n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())})}(t,n),-1)})}function TU(t,e){return yO(()=>{const n=_U(t,-1),r=_U(e,-1),s=ID(n,r);return GD(TD(s,-1))})}bU.constructors={};const NU={meanSquaredError:xU,meanAbsoluteError:kU,meanAbsolutePercentageError:SU,meanSquaredLogarithmicError:function(t,e){return yO(()=>{const n=XO(e,sV(),Number.MAX_VALUE),r=kD(CO(1,n)),s=XO(t,sV(),Number.MAX_VALUE),i=kD(CO(1,s));return FD(gW(ED(r,i)),-1)})},squaredHinge:function(t,e){return yO(()=>{const n=DD(0,ED(1,ID(t,e)));return FD(gW(n),-1)})},hinge:function(t,e){return yO(()=>{const n=DD(0,ED(1,ID(t,e)));return FD(n,-1)})},categoricalHinge:function(t,e){return yO(()=>{const n=TD(ID(t,e),-1),r=CD(ID(ED(1,t),e),-1);return DD(0,CO(1,ED(r,n)))})},logcosh:function(t,e){return yO(()=>{const n=Math.log(2),r=ED(e,t),s=ED(CO(r,bF(ID(-2,r))),n);return FD(s,-1)})},categoricalCrossentropy:CU,sparseCategoricalCrossentropy:IU,binaryCrossentropy:EU,kullbackLeiblerDivergence:function(t,e){return yO(()=>{const n=XO(t,sV(),1),r=XO(e,sV(),1);return TD(ID(t,kD(lD(n,r))),-1)})},poisson:function(t,e){return yO(()=>{const n=kD(CO(sV(),e));return FD(ED(e,ID(t,n)),-1)})},cosineProximity:TU};function AU(t){if("string"==typeof t){if(t in NU)return NU[t];let e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new oV(e)}return t}function RU(t,e){return yO(()=>{const n=ID(.5,QD(e)),r=iW(wD(e,n),t.dtype);return FD(pD(t,r),-1)})}function OU(t,e){return yO(()=>iW(pD(TO(t,-1),TO(e,-1)),"float32"))}function DU(t,e){return EU(t,e)}function FU(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),pD(t,e).asType("float32")}const $U=CU,MU=IU,LU={binaryAccuracy:RU,categoricalAccuracy:OU,precision:function(t,e){return yO(()=>{const n=function(t,e){return yO(()=>AD(t.equal(1),e.equal(1)).sum().cast("float32"))}(t,e),r=function(t,e){return yO(()=>AD(t.equal(0),e.equal(1)).sum().cast("float32"))}(t,e),s=n.add(r);return NF(wD(s,0),n.div(s),0).cast("float32")})},categoricalCrossentropy:$U,sparseCategoricalCrossentropy:MU,mse:xU,MSE:xU,mae:kU,MAE:kU,mape:SU,MAPE:SU,cosine:TU};function PU(t){if("string"==typeof t&&t in LU)return LU[t];if("string"!=typeof t&&null!=t)return t;throw new oV("Unknown metric "+t)}function zU(t){if(hV(null!==t,"Unknown LossOrMetricFn "+t),"string"==typeof t)return t;{let e;for(const n of Object.keys(NU))if(NU[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(LU))if(LU[n]===t){e=n;break}return void 0!==e?e:t.name}}function BU(t,e,n=!1){if(null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!VU(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>1048576&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function VU(t){if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!=typeof n)return!1;if(!VU(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!VU(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}function WU(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function UU(t,e,n){let r;try{r=JSON.stringify(t.outputShape)}catch(krt){r="multiple"}WU([`${t.name} (${t.getClassName()})`,r,t.countParams().toString()],e,n)}function jU(t,e,n,r){let s;try{s=JSON.stringify(t.outputShape)}catch(krt){s="multiple"}const i=[];for(const u of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(let t=0;t<u.inboundLayers.length;++t)i.push(`${u.inboundLayers[t].name}[${u.nodeIndices[t]}][${u.tensorIndices[t]}]`);const a=t.name,o=t.getClassName(),l=0===i.length?"":i[0];WU([`${a} (${o})`,s,t.countParams().toString(),l],e,r);for(let u=1;u<i.length;++u)WU(["","","",i[u]],e,r)}function HU(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function qU(t,e){if(null===t)return null;if("string"==typeof t)return gV(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const r=t[s];HU(e,s,r)?n.push(r):n.push(qU(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"==typeof r)e[n]=r;else{const t=gV(n);e[t]=qU(r,t)}}return e}}function GU(t,e){if(null==t)return null;if("string"==typeof t)return mV(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const r=t[s];HU(e,s,r)?n.push(r):n.push(GU(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];e[mV(n)]="name"!==n&&"className"!==n||"string"!=typeof r?GU(r,n):r}return e}}class KU{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof KU)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new oV(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return ER(e,t.dtype)}catch(krt){throw new oV(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof nU){if(null==this.id2Value[t.id])throw new oV("Nonexistent key: "+t.name);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new oV("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]}}getMask(t){if(t instanceof nU){if(null==this.id2Value[t.id])throw new oV("Nonexistent key: "+t.name);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new oV("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&bO(this.id2Mask)}}const XU={},YU={};function ZU(t,e,n,s){const i=null!=n&&n.training,a=Array.isArray(t),o=a?t:[t],l=o.map(t=>t.name),u=[],c=e.names();for(const r of l)-1!==c.indexOf(r)?u.push(e.getValue(r)):u.push(null);null!=s&&(s.maxNumTensors=-1/0,s.minNumTensors=1/0);const h=l.join(",")+"|"+e.names().join(",");let d,p;if(null==XU[h]){const t=function(t,e){r.assert(null!=t&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(1===t.length){const r=JU(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:t,recipientMap:a}=JU(i,e);for(const e of t)r.has(e.name)||(n.push(e),r.add(e.name));for(const e in a)null==s[e]&&(s[e]=new Set),a[e].forEach(t=>s[e].add(t))}}return{sorted:n,recipientCounts:QU(s)}}(o,e);d=t.sorted,p=t.recipientCounts,XU[h]=d,YU[h]=p}d=XU[h],p={},i||Object.assign(p,YU[h]);const f=new KU(e);for(let r=0;r<d.length;++r){if(null!=s){const t=gO().numTensors;t>s.maxNumTensors&&(s.maxNumTensors=t),t<s.minNumTensors&&(s.minNumTensors=t)}const t=d[r],a=t.sourceLayer;if(a instanceof lU)continue;const o=[],c=[],h=[];let m=!1;for(const n of t.inputs){const t=f.getValue(n),r=f.getMask(n);o.push(t),c.push(r),null!=r&&(m=!0),i||(p[n.name]--,0!==p[n.name]||e.hasKey(n)||-1!==l.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||h.push(t))}m&&((n=n||{}).mask=c[0]);const g=fV(a.apply(o,n));let y=null;a.supportsMasking&&(y=a.computeMask(o,c));const b=tj(t),v=Array.isArray(b)?b:[b];for(let e=0;e<v.length;++e){f.hasKey(v[e])||f.add(v[e],g[e],Array.isArray(y)?y[0]:y);const t=l.indexOf(v[e].name);-1!==t&&(u[t]=g[e])}i||bO(h)}return f.disposeMasks(),a?u:u[0]}function QU(t){const e={};for(const n in t)e[n]=t[n].size;return e}function JU(t,e){const n=new Set,r=[],s={};for(const o of e.names())n.add(o);const i=[],a=[];for(i.push(t);i.length>0;){const t=i[i.length-1];if(n.has(t.name)){i.pop();continue}const e=a[a.length-1]===i.length-1;if(0===t.inputs.length||e)i.pop(),r.push(t),n.add(t.name),e&&a.pop();else{a.push(i.length-1);for(const e of t.inputs)null==s[e.name]&&(s[e.name]=new Set),s[e.name].add(t.name),n.has(e.name)||i.push(e)}}return{sorted:r,recipientMap:s}}function tj(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}class ej extends aU{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=qW(t)}if(this.supportsMasking=!1,this.trainable_=!0,this.inputs=Array.isArray(t.inputs)?t.inputs.slice():[t.inputs],this.outputs=Array.isArray(t.outputs)?t.outputs.slice():[t.outputs],xV(this.inputs).length!==this.inputs.length)throw new oV("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+this.inputs.map(t=>t.name));xV(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+this.outputs.map(t=>t.name)),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const t=y.nodeIndex,e=y.tensorIndex;this.outputLayers.push(y.sourceLayer),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(e)}for(const y of this.inputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;hV(0===e,"input layer has >1 nodes"),hV(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const e=this.inputLayers[y];if(!(e instanceof lU))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${y} (0-based) originates from layer type ${e.getClassName()}.`);this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(t=>t.shape),this.internalOutputShapes=this.outputs.map(t=>t.shape);const e={},n={},r={},s={},i={},a=[],o=(t,e,n,r,s,l)=>{null!=r&&null!=s&&null!=l||(r=t.sourceLayer,s=t.nodeIndex,l=t.tensorIndex);const u=r.inboundNodes[s];if(-1!==n.indexOf(u))throw new aV(`The tensor ${t.name} at layer "${r.name}" is part of a cycle.`);if(-1!==e.indexOf(u))return;this.containerNodes.add(ej.nodeKey(r,s)),r.id in i||(i[r.id]=Object.keys(i).length),-1===n.indexOf(u)&&n.push(u);const c=u.inboundLayers.length;for(let i=0;i<c;i++)o(u.inputTensors[i],e,n,u.inboundLayers[i],u.nodeIndices[i],u.tensorIndices[i]);for(e.push(u);n.indexOf(u)>=0;)n.splice(n.indexOf(u),1);a.push(u)},l=[],u=[];for(const y of this.outputs)o(y,l,u);const c=a.slice().reverse();for(const y of c){n[y.id]=y,y.id in e||(e[y.id]=0);let t=e[y.id];t=Math.max(t,null==r[y.outboundLayer.id]?0:r[y.outboundLayer.id]),r[y.outboundLayer.id]=t,s[y.outboundLayer.id]=y.outboundLayer,e[y.id]=t;for(let r=0;r<y.inboundLayers.length;r++){const s=y.inboundLayers[r].inboundNodes[y.nodeIndices[r]];e[s.id]=Math.max(t+1,null==e[s.id]?0:e[s.id]),n[s.id]=s}}const h={};for(const y in e){const t=e[y];t in h||(h[t]=[]),h[t].push(n[y])}const d={};for(const y in r){const t=r[y];t in d||(d[t]=[]),d[t].push(s[y])}let p=Object.keys(d).map(t=>parseInt(t,10)).sort(_V);this.layers=[];for(const y of p){const t=d[y];t.sort((t,e)=>{const n=i[t.id],r=i[e.id];return n<r?-1:n>r?1:0});for(const e of t)e instanceof ej&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,p=Object.keys(h).map(t=>parseInt(t,10)).sort(_V);const f=this.inputs.slice(),m=[];for(const y of p)for(const t of h[y]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===f.indexOf(n))throw new aV("Graph disconnected: cannot obtain value for tensor "+n+` at layer "${e.name}". The following previous layers were accessed without issue: `+m);for(const e of t.outputTensors)f.push(e);m.push(e.name)}}this.nodesByDepth=h;const g=this.layers.map(t=>t.name);for(const y of g){const t=g.filter(t=>t===y).length;if(1!==t)throw new aV(`The name "${y}" is used ${t} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new sU({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(t=>null),outputMasks:this.outputs.map(t=>null),inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs.map(t=>t.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(e=>e.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new oV("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const n={};let r=0;for(const i of this.layers)for(const t of i.weights){if(null!=n[t.originalName])throw new oV("Duplicate weight name: "+t.originalName);n[t.originalName]=t,r++}const s=[];for(const i in t){let r=i;if(null==n[i]){const t=i.split("/");r=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[r])s.push([n[r],t[i]]);else if(e)throw new oV("Provided weight data has no target variable: "+i);delete n[r]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new oV(`${t.length} of ${r} weights are not set: `+t)}tU(s)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 2.8.5",e.backend="TensorFlow.js",e}toJSON(t,e=!0){const n=GU(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return yO(()=>{t=fV(t);const n=new KU;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return ZU(this.outputs,n,e)})}computeMask(t,e){return yO(()=>{let n;return t=fV(t),n=null==e?cV(null,t.length):fV(e),this.runInternalGraph(t,n)[1]})}computeOutputShape(t){const e=KW(t);if(e.length!==this.inputLayers.length)throw new oV(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let a=0;a<e.length;a++)n[this.inputLayers[a].name+"_0_0"]=e[a];const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(_V);if(r.length>1)for(const a of r){const t=this.nodesByDepth[a];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map(t=>t.id).indexOf(t.id))continue;const r=[];for(let a=0;a<e.inboundLayers.length;a++)r.push(n[`${e.inboundLayers[a].name}_${e.nodeIndices[a]}_${e.tensorIndices[a]}`]);const s=KW(t.computeOutputShape(pV(r))),i=t.inboundNodes.indexOf(e);for(let e=0;e<s.length;e++)n[`${t.name}_${i}_${e}`]=s[e]}}const s=[],i=[];for(let a=0;a<this.outputLayers.length;a++)i.push(`${this.outputLayers[a].name}_${this.outputLayersNodeIndices[a]}_${this.outputLayersTensorIndices[a]}`);for(let a=0;a<i.length;a++){const t=i[a];hV(t in n),s.push(n[t])}return pV(s)}runInternalGraph(t,e){null==e&&(e=cV(null,t.length));const n={};for(let o=0;o<this.inputs.length;++o)n[this.inputs[o].id]=[t[o],e[o]];const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(_V);for(const o of r){const t=this.nodesByDepth[o];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,s=e.outputTensors,i=new Array;for(const e of r)e.id in n&&i.push(n[e.id]);if(i.length===r.length){let r,a,o,l,u={};if(null!=e.callArgs&&(u=e.callArgs),1===i.length){const[e,n]=i[0];null==u.mask&&(u.mask=n),o=fV(t.call(e,u)),l=fV(t.computeMask(e,n)),r=[e],a=[n]}else r=i.map(t=>t[0]),a=i.map(t=>t[1]),null==u.mask&&(u.mask=a),o=fV(t.call(r,u)),l=fV(t.computeMask(r,a));if(t.activityRegularizer)throw new lV("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<s.length;++t)n[s[t].id]=[o[t],l[t]]}}}const s=[],i=[],a=[];for(const o of this.outputs){hV(o.id in n,`Could not compute output ${o.name} : ${o.id}`);const[t,e]=n[o.id];a.push(t.shape),s.push(t),i.push(e)}return[s,i,a]}buildNodeConversionMap(t){const e={};let n;for(const r of this.layers){n=r instanceof ej?1:0;for(let t=0;t<r.inboundNodes.length;t++){const s=ej.nodeKey(r,t);this.containerNodes.has(s)&&(e[s]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new oV(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new oV("Provide either a layer name or layer index");for(const n of this.layers)if(n.name===t)return n;throw new oV("No such layer: "+t)}calculateLosses(){return yO(()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=ej.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const i of this.layers){const t=i.getClassName(),r=i.getConfig(),s=[];for(let n=0;n<i.inboundNodes.length;n++){const t=i.inboundNodes[n],r=ej.nodeKey(i,n);let a={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),a=t.callArgs}catch(krt){console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: `+t.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),a={}}if(t.inboundLayers.length>0){const n=[];for(let r=0;r<t.inboundLayers.length;r++){const s=t.inboundLayers[r],i=t.tensorIndices[r];let o=e[ej.nodeKey(s,t.nodeIndices[r])];null==o&&(o=0),n.push([s.name,o,i,a])}s.push(n)}}}const a={};a.name=i.name,a.className=t,a.config=r,a.inboundNodes=s,n.push(a)}t.layers=n;const r=[];for(let i=0;i<this.inputLayers.length;i++){const t=this.inputLayers[i],n=ej.nodeKey(t,this.inputLayersNodeIndices[i]);if(!this.containerNodes.has(n))continue;let s=e[n];null==s&&(s=0),r.push([t.name,s,this.inputLayersTensorIndices[i]])}t.inputLayers=r;const s=[];for(let i=0;i<this.outputLayers.length;i++){const t=this.outputLayers[i],n=ej.nodeKey(t,this.outputLayersNodeIndices[i]);if(!this.containerNodes.has(n))continue;let r=e[n];null==r&&(r=0),s.push([t.name,r,this.outputLayersTensorIndices[i]])}return t.outputLayers=s,t}static fromConfig(t,e,n={},r=!1){const s={},i={};function a(t,e){t.name in i?i[t.name].push(e):i[t.name]=[e]}function o(t,e){const n=[];let r;for(const i of e){const o=i[0],l=i[1],u=i[2];if(r=null==i[3]?{}:i[3],!(o in s))return void a(t,e);const c=s[o];if(c.inboundNodes.length<=l)return void a(t,e);n.push(c.inboundNodes[l].outputTensors[u])}n.length>0&&t.apply(pV(n),r)}function l(t){const n=t.name,i=wU(t,null!=e.customObjects?e.customObjects:{});i.setFastWeightInitDuringBuild(r),s[n]=i,t.inboundNodes.forEach(t=>{if(!(t instanceof Array))throw new oV("Corrupted configuration, expected array for nodeData: "+t);a(i,t)})}const u=e.name,c=e.layers;for(const m of c)l(m);for(;!kV(i);)for(const t of c){const e=s[t.name];if(e.name in i){const t=i[e.name];delete i[e.name];for(const n of t)o(e,n)}}const h=[],d=[],p=e.inputLayers;for(const m of p){const t=m[0],e=m[1],n=m[2];hV(t in s),h.push(s[t].inboundNodes[e].outputTensors[n])}const f=e.outputLayers;for(const m of f){const t=m[0],e=m[1],n=m[2];hV(t in s),d.push(s[t].inboundNodes[e].outputTensors[n])}return new t({inputs:h,outputs:d,name:u})}get stateful(){if(this._stateful)throw new oV("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){yO(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}function nj(t,e){return function(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>null);if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided classWeight is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){const n=[];return e.forEach(e=>{n.push(e in t?t[e]:null)}),n}throw new Error(`The model has multiple (${r}) outputs, so classWeight must be either an array with ${r} elements or an object with ${e} keys. Provided classWeight not understood: ${JSON.stringify(t)}`)}(t,e)}async function rj(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=yO(()=>{if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await e.data());bO(e);const s=[];return r.forEach(t=>{if(null==n[t])throw new Error(`classWeight must contain all classes in the training data. The class ${t} exists in the data but not in classWeight`);s.push(n[t])}),SF(s,"float32")}return null}function sj(t,e){return ID(t,e)}function ij(t,e){let n,s;n=e.xs,s=e.ys,r.assert(null!=n&&null!=s,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e);const i=aj("input",t.inputNames,n),a=aj("output",t.outputNames,s),o=i[0].shape[0];r.assert(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: `+JSON.stringify(t.inputNames)+")"),r.assert(a.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: `+JSON.stringify(t.outputNames)+")");for(let l=0;l<i.length;l++)r.assert(i[l].shape[0]===o,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);for(let l=0;l<a.length;l++)r.assert(a[l].shape[0]===o,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);return{xs:i,ys:a}}function aj(t,e,n){if(n instanceof rA)return[n];if(Array.isArray(n))return r.assert(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(null==n[s])throw new oV(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function oj(t){return"function"==typeof t.iterator}function lj(t){r.assert(t>0&&Number.isInteger(t),()=>"batchSize is required to be a positive integer, but got "+t)}function uj(t,e,n){return null==t?[null]:Array.isArray(t)?t.map(t=>oW(t,e,n-e)):oW(t,e,n-e)}function cj(t,e){return yO(()=>null==t?null:Array.isArray(t)?t.map(t=>cj(t,e)):mW(t,"int32"===e.dtype?e:e.toInt()))}function hj(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function dj(t){const e=[];t instanceof rA&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(aW(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function pj(t,e){if(null==t)return;const n=[];if(e instanceof rA)n.push(e.id);else if(Array.isArray(e))e.forEach(t=>n.push(t.id));else if(null!=e)for(const s in e)n.push(e[s].id);const r=[];if(t instanceof rA)-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach(t=>{-1===n.indexOf(t.id)&&r.push(t)});else if(null!=t)for(const s in t){const e=t[s];-1===n.indexOf(e.id)&&r.push(e)}r.forEach(t=>{t.isDisposed||t.dispose()})}function fj(t){return Array.isArray(t)}function mj(t){return!function(t){return t instanceof rA}(t)&&!fj(t)}function gj(t,e,n,r=!0,s=""){if(null==e||0===e.length){if(null!=t){let e=!1;if(fj(t)&&t.length>0)e=!0;else if(mj(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new oV(`Error when checking model ${s} expected no data, but got `+t)}return[]}if(null==t)return e.map(t=>null);let i;if(mj(t)){t=t,i=[];for(const n of e){if(null==t[n])throw new oV(`No data provided for "${n}". Need data for each key in: `+e);i.push(t[n])}}else if(fj(t)){if((t=t).length!==e.length)throw new oV(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): `+t);i=t}else{if(t=t,e.length>1)throw new oV(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape `+t.shape);i=[t]}if(i=dj(i),null!=n)for(let a=0;a<e.length;++a){if(null==n[a])continue;const t=i[a];if(t.shape.length!==n[a].length)throw new oV(`Error when checking ${s}: expected ${e[a]} to have ${n[a].length} dimension(s). but got array with shape `+t.shape);for(let i=0;i<n[a].length;++i){if(0===i&&!r)continue;const o=t.shape[i],l=n[a][i];if(null!=l&&l>=0&&o!==l)throw new oV(`Error when checking ${s}: expected ${e[a]} to have shape [${n[a]}], but got array with shape [${t.shape}].`)}}return i}function yj(t,e,n,r=!0,s=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new oV(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new oV(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape `+JSON.stringify(t.shape)+".");i=[t]}if(null!=n)for(let a=0;a<e.length;++a){if(null==n[a])continue;const t=i[a];if(t.shape.length!==n[a].length)throw new oV(`Error when checking ${s}: expected ${e[a]} to have ${n[a].length} dimension(s), but got array with shape `+JSON.stringify(t.shape));for(let i=0;i<n[a].length;++i){if(0===i&&!r)continue;const o=t.shape[i],l=n[a][i];if(null!=l&&l!==o)throw new oV(`Error when checking ${s}: expected ${e[a]} to have shape ${JSON.stringify(n[a])} but got array with shape ${JSON.stringify(t.shape)}.`)}}}class bj extends ej{constructor(t){super(t),this.isTraining=!1}summary(t,e,n=console.log){if(!this.built)throw new oV("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,r=console.log){const s=function(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let t=!1;for(const n of s.inboundNodes)if(-1!==r.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),i=["Layer (type)","Output shape","Param #"];let a;if(s?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(t=>Math.floor(e*t))),!s){i.push("Receives inputs"),a=[];for(const e in t.nodesByDepth)a.push(...t.nodesByDepth[e])}r("_".repeat(e)),WU(i,n,r),r("=".repeat(e));const o=t.layers;for(let c=0;c<o.length;++c)s?UU(o[c],n,r):jU(o[c],n,a,r),r((c===o.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=function(t){let e;return e=ZW(null!=t.collectedTrainableWeights?t.collectedTrainableWeights:t.trainableWeights),e}(t),u=ZW(t.nonTrainableWeights);r("Total params: "+(l+u)),r("Trainable params: "+l),r("Non-trainable params: "+u),r("_".repeat(e))}(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>W$.adagrad(.01),Adadelta:()=>W$.adadelta(1,.95,sV()),Adam:()=>W$.adam(.001,.9,.999,sV()),Adamax:()=>W$.adamax(.002,.9,.999,sV(),0),RMSProp:()=>W$.rmsprop(.001,.9,0,sV()),SGD:()=>W$.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new oV("Unknown Optimizer "+t)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof kO))throw new oV("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new oV(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);e=t.loss.map(t=>AU(t))}else{const n=AU(t.loss);this.outputs.forEach(t=>{e.push(n)})}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new oV(`Unknown entry in loss dictionary: "${e}". Only expected the following keys: `+this.outputNames);for(const n of this.outputNames)null==t.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),e.push(AU(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const t=this.internalOutputShapes[i];this.feedOutputNames.push(this.outputNames[i]),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[i])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],XV("loss",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}});const r=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>[]);let n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map(t=>n);{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),s=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};XV("metric",()=>{for(let t=0;t<this.outputs.length;++t)-1===n.indexOf(t)&&(e=>{let n,r,i;for(const a of e){if("string"==typeof a&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(a)){const e=this.internalOutputShapes[t];let s;1===e[e.length-1]||this.lossFunctions[t]===EU?-1!==["accuracy","acc"].indexOf(a)?r=RU:-1!==["crossentropy","ce"].indexOf(a)&&(r=DU):this.lossFunctions[t]===IU?-1!==["accuracy","acc"].indexOf(a)?r=FU:-1!==["crossentropy","ce"].indexOf(a)&&(r=MU):-1!==["accuracy","acc"].indexOf(a)?r=OU:-1!==["crossentropy","ce"].indexOf(a)&&(r=$U),-1!==["accuracy","acc"].indexOf(a)?s="acc":-1!==["crossentropy","ce"].indexOf(a)&&(s="ce"),i=r,n=""+s}else{const t=PU(a);i=t,n=""+zU(a)}let e;XV(n,()=>{e=i}),s(t,n,e)}})(r[t])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,n={}){const r=null==n.batchSize?32:n.batchSize;lj(r);const s=this.standardizeUserDataXY(t,e,!0,r);try{const i=s[0].concat(s[1]);return this.makeTestFunction(),pV(this.testLoop(this.testFunction,i,r,n.verbose,n.steps))}finally{pj(s[0],t),pj(s[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const s=null!=(n=n||{}).batches,i=t.testFunction;let a=[];if(n.verbose>0)throw new lV("Verbose mode is not implemented yet.");r.assert(!s||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches));const o="function"==typeof e.next?e:await e.iterator();let l=0,u=0;for(;!s||u<n.batches;){const e=await o.next();if(a=yO(()=>{if(e.value){const{xs:n,ys:r}=ij(t,e.value),s=n.concat(r),o=yO(()=>i(s));if(bO(s),0===u)for(let t=0;t<o.length;++t)a.push(xO(0));const c=s[0].shape[0];for(let t=0;t<o.length;++t){const e=o[t],n=a[t];a[t]=yO(()=>CO(a[t],ID(c,e))),u>0&&bO(n)}bO(o),l+=c,++u}return a}),e.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let r=0;r<a.length;++r){const t=a[r];a[r]=lD(a[r],l),bO(t)}return pV(a)}(this,t,e)}checkNumSamples(t,e,n,r="steps"){let s;if(null!=n){if(s=null,null!=e)throw new oV(`If ${r} is set, batchSize must be null or undefined.Got batchSize = `+e)}else{if(null==t)throw new oV("Either the input data should have a defined shape, or "+r+" shoud be specified.");s=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return s}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new oV("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=this.retrieveSymbolicTensors(n?e:[e]),s=new KU;if(t instanceof rA&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new oV(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)s.add(this.inputs[e],t[e])}else for(const a of this.inputs){const e=t[a.name];if(null==e)throw new oV("No value is provided for the model's input "+a.name);s.add(a,e)}const i=ZU(r,s);return n?i:i[0]}retrieveSymbolicTensors(t){const e=cV(null,t.length);let n=t.length;for(const r of this.layers){const s=Array.isArray(r.output)?r.output:[r.output],i=s.map(t=>t.name);for(let r=0;r<t.length;++r){const a=i.indexOf(t[r]);if(-1!==a&&(e[r]=s[a],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach((e,r)=>{null==e&&n.push(t[r])}),new oV("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(n))}return e}predictLoop(t,e=32,n=!1){return yO(()=>{const r=this.checkNumSamples(t);if(n)throw new lV("Verbose predictLoop() is not implemented yet.");const s=hj(r,e),i=this.outputs.map(t=>[]);for(let e=0;e<s.length;++e)yO(()=>{const n=uj(t,s[e][0],s[e][1]),r=[];if(Array.isArray(n))for(let t=0;t<n.length;++t)r.push({key:this.inputs[t],value:n[t]});else r.push({key:this.inputs[0],value:n});const i=new KU(r);return ZU(this.outputs,i)}).forEach((t,e)=>i[e].push(t));return pV(i.map(t=>YO(t,0)))})}predict(t,e={}){const n=dj(t);yj(n,this.inputNames,this.feedInputShapes,!1);try{const r=null==e.batchSize?32:e.batchSize;return lj(r),this.predictLoop(n,r)}finally{pj(n,t)}}predictOnBatch(t){yj(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,n=!0,s){if(null==this.optimizer_)throw new aV("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let r=0;r<this.feedOutputShapes.length;++r){const t=this.feedOutputShapes[r];i.push(this.feedLossFns[r]===IU?t.slice(0,t.length-1).concat([1]):t)}if(function(t,e,n){const s=xV(t.map(t=>t.shape[0]));s.sort();const i=xV(e.map(t=>t.shape[0]));if(i.sort(),s.length>1)throw new oV("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(t=>t.shape)));if(i.length>1)throw new oV("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(t=>t.shape)));if(s.length>0&&i.length>0&&!r.arraysEqual(s,i))throw new oV(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${i[0]} target sample(s).`)}(t=gj(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=gj(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){const r=[xU,EU,CU];for(let s=0;s<t.length;++s){const i=t[s],a=e[s],o=n[s];if(null!=a){if(a===CU&&1===i.shape[i.shape.length-1])throw new oV(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(a)){const t=i.shape.slice(1),e=o.slice(1);for(let n=0;n<t.length;++n){const r=t[n],s=e[n];if(null!=s&&r!==s)throw new oV(`A target Tensor with shape ${i.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=s&&s>0&&t[0].shape[0]%s!=0)throw new oV(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,n,r,s=!0,i){const[a,o]=this.standardizeUserDataXY(t,e,s,i);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){const t=nj(r,this.outputNames);l=[];for(let e=0;e<t.length;++e)l.push(await rj(o[e],null,t[e]))}return[a,o,l]}testLoop(t,e,n,r=0,s){return yO(()=>{const i=this.checkNumSamples(e,n,s,"steps"),a=[];if(r>0)throw new lV("Verbose mode is not implemented yet.");if(null!=s)throw new lV("steps mode in testLoop() is not implemented yet");{const r=hj(i,n),s=SF(sW(0,i));for(let n=0;n<r.length;++n){const i=r[n][0],o=r[n][1],l=oW(s,i,o-i),u=cj(e,l),c=t(u);if(0===n)for(let t=0;t<c.length;++t)a.push(xO(0));for(let t=0;t<c.length;++t)a[t]=CO(a[t],ID(o-i,c[t]))}for(let t=0;t<a.length;++t)a[t]=lD(a[t],i)}return a})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let s=r;dV(t,r)>1&&(s+="_"+dV(t.slice(0,n),r)),e.push(s)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],a=this.collectedTrainableWeights.map(t=>t.read());return[this.optimizer_.minimize(()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const a=new KU(t),o=ZU(this.outputs,a,{training:!0});let l;for(let n=0;n<this.lossFunctions.length;++n){let t=(0,this.lossFunctions[n])(r[n],o[n]);null!=s[n]&&(t=sj(t,s[n]));const i=FD(t);e.push(i),l=0===n?t:CO(l,t)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][1];t=FD((0,this.metricsTensors[n][0])(r[e],o[e]))}vO(t),i.push(t)}return l=FD(l),this.calculateLosses().forEach(t=>{l=CO(l,t)}),l},!0,a)].concat(i)}}makeTestFunction(){this.testFunction=t=>yO(()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),s=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let t=0;t<this.inputs.length;++t)i.push({key:this.inputs[t],value:r[t]});const a=new KU(i),o=ZU(this.outputs,a);for(let t=0;t<this.lossFunctions.length;++t){const r=FD((0,this.lossFunctions[t])(s[t],o[t]));n=0===t?r:CO(n,r),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][1],r=FD((0,this.metricsTensors[t][0])(s[n],o[n]));e.push(r)}return e})}async fit(t,e,n={}){return async function(t,e,n,s={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let i,a,o,l,u,c,h;t.isTraining=!0;try{const d=null==s.batchSize?32:s.batchSize;lj(d);const p=!1,f=await t.standardizeUserData(e,n,s.sampleWeight,s.classWeight,p,d);i=f[0],a=f[1],h=f[2];let m,g=!1;if(null!=s.validationData&&s.validationData.length>0){if(g=!0,2!==s.validationData.length)throw 3===s.validationData.length?new lV("validationData including sample weights is not supported yet."):new oV("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+s.validationData+" is invalid.");o=s.validationData[0],l=s.validationData[1];const e=!0,n=await t.standardizeUserData(o,l,null,null,e,d);u=n[0],c=n[1],m=u.concat(c)}else if(null!=s.validationSplit&&s.validationSplit>0&&s.validationSplit<1){g=!0;const t=Math.floor(i[0].shape[0]*(1-s.validationSplit)),e=i[0].shape[0];u=uj(i,t,e),i=uj(i,0,t),c=uj(a,t,e),a=uj(a,0,t),m=u.concat(c)}else null!=s.validationSteps&&(g=!0);const y=i.concat(a).concat(h);t.checkTrainableWeightsConsistency();const b=t.makeTrainFunction(),v=t.getDedupedMetricsNames();let w,_;g?(t.makeTestFunction(),w=t.testFunction,_=v.slice().concat(v.map(t=>"val_"+t))):(w=null,m=[],_=v.slice());const x=yU(s.callbacks,s.yieldEvery);return await async function(t,e,n,s,i,a,o,l,u,c,h,d,p,f,m){null==i&&(i=32),null==a&&(a=1),null==h&&(h=!0),null==p&&(p=0);let g=!1;null!=u&&null!=c&&(g=!0);const y=t.checkNumSamples(n,i,null,"steps_per_epoch");let b;null!=y&&(b=sW(0,y)),null==o&&(o=1);const{callbackList:v,history:w}=vU(l,o,a,p,y,null,i,g,d);v.setModel(t),t.history=w,await v.onTrainBegin(),t.stopTraining_=!1;for(let _=p;_<a;++_){await v.onEpochBegin(_);const a={};{if("batch"===h)throw new lV("batch shuffling is not implemneted yet");h&&r.shuffle(b);const o=SF(b),l=hj(y,i);for(let r=0;r<l.length;++r){const h={};if(await v.onBatchBegin(r,h),yO(()=>{const d=l[r][0],p=l[r][1],f=oW(o,d,p-d);h.batch=r,h.size=p-d;const m=cj(n,f),y=e(m);for(let t=0;t<s.length;++t){const e=y[t];h[s[t]]=e,vO(e)}if(r===l.length-1&&g){const e=t.testLoop(u,c,i);for(let t=0;t<s.length;++t){const n=s[t],r=e[t];vO(r),a["val_"+n]=r}}}),await v.onBatchEnd(r,h),cU(h),t.stopTraining_)break}o.dispose()}if(await v.onEpochEnd(_,a),t.stopTraining_)break}return await v.onTrainEnd(),await t.history.syncData(),t.history}(t,b,y,v,d,s.epochs,s.verbose,x,w,m,s.shuffle,_,s.initialEpoch)}finally{t.isTraining=!1,pj(i,e),pj(a,n),pj(u,o),pj(c,l),null!=h&&bO(h)}}(this,t,e,n)}async fitDataset(t,e){return async function(t,e,n){const s=null!=n.batchesPerEpoch;if(r.assert(null!=t.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),r.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),r.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs),r.assert(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch),r.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const i=null!=n.validationData;let a,o;if(i)if(oj(n.validationData))r.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches);else{const t=function(t){if(3===t.length)throw new lV("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);a=t.xs,o=t.ys}const l=t.makeTrainFunction(),u=t.getDedupedMetricsNames();let c;c=i?u.slice().concat(u.map(t=>"val_"+t)):u.slice();const h=yU(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:p,history:f}=vU(h,d,n.epochs,null,null,function(t,e){let n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,i,c);p.setModel(t),t.history=f,await p.onTrainBegin(),t.stopTraining_=!1;let m=null==n.initialEpoch?0:n.initialEpoch,g=await e.iterator();for(;m<n.epochs;){const r={};await p.onEpochBegin(m);let c=0,h=0;for(s||(g=await e.iterator());!s||c<n.batchesPerEpoch;){const e=await g.next();if(s&&e.done){console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+c+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:s}=ij(t,e.value),i={};i.batch=h,i.size=r[0].shape[0],await p.onBatchBegin(h,i);const a=[];if(null!=n.classWeight){const e=nj(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)a.push(await rj(s[t],null,e[t]))}const o=r.concat(s).concat(a),d=l(o);bO(o);for(let t=0;t<u.length;++t){const e=d[t];i[u[t]]=e,vO(e)}await p.onBatchEnd(h,i),cU(i),h++,c++}if(s?c>=n.batchesPerEpoch:e.done){if(i){let e;e=oj(n.validationData)?fV(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):fV(t.evaluate(a,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)r["val_"+t.metricsNames[n]]=e[n]}break}if(t.stopTraining_)break}if(await p.onEpochEnd(m,r),m++,t.stopTraining_)break}return await p.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],s=n[1],i=this.makeTrainFunction()(r.concat(s)),a=[];for(const o of i){const t=await o.data();a.push(t[0])}return bO(i),pV(a)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,s=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||e.push({name:r[i].originalName,tensor:s[i]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=gO().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-gO().numTensors}return t}getLossIdentifiers(){let t;if("string"==typeof this.loss)t=mV(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!=typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(t=>mV(t))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!=typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=mV(n[r])}}return t}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[mV(zU(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>mV(zU(t)));{const t={};for(const e in this.metrics)t[e]=mV(zU(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=wU(qU(t.optimizer_config));let n,r;if("string"==typeof t.loss)n=gV(t.loss);else if(Array.isArray(t.loss))n=t.loss.map(t=>gV(t));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=gV(t.loss[e])}if(Array.isArray(t.metrics))r=t.metrics.map(t=>gV(t));else if(null!=t.metrics){r={};for(const e in t.metrics)r[e]=gV(t.metrics[e])}this.compile({loss:n,metrics:r,optimizer:e})}async save(t,e){if("string"==typeof t){const e=a.getSaveHandlers(t);if(0===e.length)throw new oV(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new oV(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new oV("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await a.encodeWeights(this.getNamedWeights(e)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v2.8.5",convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:s}=await a.encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...s),n.data=a.concatenateArrayBuffers([n.data,e])}return null!=this.userDefinedMetadata&&(BU(this.userDefinedMetadata,this.name,!0),r.userDefinedMetadata=this.userDefinedMetadata),r.weightData=n.data,r.weightSpecs=n.specs,t.save(r)}setUserDefinedMetadata(t){BU(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}bj.className="Model",u.registerClass(bj);class vj extends bj{}vj.className="Functional",u.registerClass(vj);class wj extends bj{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:qW("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new oV("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")}add(t){const e=t instanceof wj||t instanceof bj;let n;if(e){if(n=t,1!==n.outputs.length)throw new oV("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new oV("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new oV("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=function(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new oV("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;return null==n&&(n="float32"),new lU({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new oV(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(1!==t.inboundNodes[0].outputTensors.length)throw new oV("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=oU(this.outputs[0])}this.inboundNodes=[],new sU({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:cV(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(YW(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new bj({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,n=console.log){this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,n={}){if(!this.built)throw new aV("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new aV("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,n={}){if(!this.built)throw new aV("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new aV("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,n={},s=!1){let i,a={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new oV("Legacy serialization format not supported yet.");i=e}else r.assert(null!=e.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=e.layers,delete e.layers,a=e;const o=new t(a);if(!(o instanceof wj))throw new lV("Sequential.fromConfig called on non-Sequential input: "+o);for(const r of i){const t=wU(r,void 0,s);s&&t.setFastWeightInitDuringBuild(!0),o.add(t)}return o}set stopTraining(t){if(null==this.model)throw new oV("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new oV("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}wj.className="Sequential",u.registerClass(wj);class _j extends u.Serializable{getConfig(){return{}}}class xj extends _j{apply(t,e=1){return function(t,e=1){if(1!==e)throw new lV(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return uD(t)}(t,e)}}xj.className="elu",u.registerClass(xj);class kj extends _j{apply(t){return uF(t)}}kj.className="selu",u.registerClass(kj);class Sj extends _j{apply(t){return oF(t)}}Sj.className="relu",u.registerClass(Sj);class Cj extends _j{apply(t){return yO(()=>MD(6,oF(t)))}}Cj.className="relu6",u.registerClass(Cj);class Ij extends _j{apply(t){return t}}Ij.className="linear",u.registerClass(Ij);class Ej extends _j{apply(t){return hF(t)}}Ej.className="sigmoid",u.registerClass(Ej);class Tj extends _j{apply(t){return function(t){return yO(()=>{const e=CO(.5,ID(.2,t));return XO(e,0,1)})}(t)}}Tj.className="hardSigmoid",u.registerClass(Tj);class Nj extends _j{apply(t){return bF(t)}}Nj.className="softplus",u.registerClass(Nj);class Aj extends _j{apply(t){return function(t){return yO(()=>lD(t,SO(t).add(1)))}(t)}}Aj.className="softsign",u.registerClass(Aj);class Rj extends _j{apply(t){return kF(t)}}Rj.className="tanh",u.registerClass(Rj);class Oj extends _j{apply(t,e=-1){return yF(t,e)}}Oj.className="softmax",u.registerClass(Oj);class Dj extends _j{apply(t,e=-1){return ND(t,e)}}Dj.className="logSoftmax",u.registerClass(Dj);class Fj extends _j{apply(t,e=1){return yO(()=>hF(t.mul(e)).mul(t))}}function $j(t){return t.getClassName()}function Mj(t,e={}){return wV(t,u.SerializationMap.getMap().classNameMap,e,"activation")}function Lj(t){if(null==t)return Mj({className:"linear",config:{}});if("string"==typeof t){const e={};return e.className=t,e.config={},Mj(e)}return t instanceof _j?t:Mj(t)}Fj.className="swish",u.registerClass(Fj);class Pj extends u.Serializable{}class zj extends Pj{constructor(t){super(),function(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return yO(()=>{let e=YD([1]);return this.hasL1&&(e=CO(e,TD(ID(this.l1,SO(t))))),this.hasL2&&(e=CO(e,TD(ID(this.l2,gW(t))))),e.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}zj.className="L1L2",u.registerClass(zj);const Bj={l1l2:"L1L2"};function Vj(t){return bV(t)}function Wj(t,e={}){return wV(t,u.SerializationMap.getMap().classNameMap,e,"regularizer")}function Uj(t){return null==t?null:"string"==typeof t?Wj({className:t in Bj?Bj[t]:t,config:{}}):t instanceof Pj?t:Wj(t)}class jj extends aU{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=XW(t);let n=oF(t);return null!=this.maxValue&&(n=XO(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}jj.className="ReLU",u.registerClass(jj);class Hj extends aU{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=XW(t);return xD(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Hj.className="LeakyReLU",u.registerClass(Hj);class qj extends aU{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=WW(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Uj(t.alphaRegularizer),this.alphaConstraint=PV(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!=typeof t.sharedAxes)throw new oV("Expected sharedAxes to be a number or an array of numbers, but got "+t.sharedAxes);this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=YW(t)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<t.length;++r)n[r]=t[r];this.inputSpec=[new eU({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=XW(t),eF(t,this.alpha.read())}getConfig(){const t={alphaInitializer:VW(this.alphaInitializer),alphaRegularizer:Vj(this.alphaRegularizer),alphaConstraint:MV(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}qj.className="PReLU",u.registerClass(qj);class Gj extends aU{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new lV(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=XW(t);return uD(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Gj.className="ELU",u.registerClass(Gj);class Kj extends aU{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=XW(t);return n.mul(iW(n.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}Kj.className="ThresholdedReLU",u.registerClass(Kj);class Xj extends aU{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new Oj).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=XW(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Yj(t,e,n){if("number"==typeof t)return cV(t,e);if(t.length!==e)throw new oV(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const i=t[s];if((r=i)!==parseInt(r.toString(),10))throw new oV(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number `+i)}return t;var r}function Zj(t,e,n,r,s=1){if(null==t)return t;let i;return i="same"===n?t:t-(e+(e-1)*(s-1))+1,Math.floor((i+r-1)/r)}function Qj(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+rW([n-e,0]);else{if("same"!==r)throw new oV(`Unsupport padding mode: ${r}.`);t*=e}return t}function Jj(t,e){return yO(()=>(HV(e),"channelsFirst"===e?RF(t,[0,2,3,1]):t))}function tH(t,e){return yO(()=>(HV(e),"channelsFirst"===e?RF(t,[0,2,3,4,1]):t))}function eH(t,e,n,r=[1,1],s="valid",i,a,o=null){return yO(()=>{if(null==i&&(i="channelsLast"),HV(i),3!==t.rank&&4!==t.rank)throw new oV(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new oV(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=Jj(t,i);if("causal"===s)throw new lV("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=c.conv2d({x:l,filter:e,strides:r,pad:"same"===s?"same":"valid",dilations:a,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===i&&(l=RF(l,[0,3,1,2])),l})}Xj.className="Softmax",u.registerClass(Xj);class nH extends aU{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",nH.verifyArgs(e),this.rank=t,IV(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new lV(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Yj(e.kernelSize,t,"kernelSize"),this.strides=Yj(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,qV(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,HV(this.dataFormat),this.activation=Lj(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=WW(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=PV(e.biasConstraint),this.biasRegularizer=Uj(e.biasRegularizer),this.activityRegularizer=Uj(e.activityRegularizer),this.dilationRate=Yj(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new oV("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(this.dilationRate));if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new oV("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(this.dilationRate))}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new oV("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(this.dilationRate))}static verifyArgs(t){if(hV("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!CV(t.kernelSize,"number",1,3))throw new oV(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:$j(this.activation),useBias:this.useBias,biasInitializer:VW(this.biasInitializer),biasRegularizer:Vj(this.biasRegularizer),activityRegularizer:Vj(this.activityRegularizer),biasConstraint:MV(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class rH extends nH{constructor(t,e){super(t,e),this.kernel=null,rH.verifyArgs(e),this.filters=e.filters,IV(this.filters,"filters"),this.kernelInitializer=WW(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=PV(e.kernelConstraint),this.kernelRegularizer=Uj(e.kernelRegularizer)}build(t){t=YW(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new oV("The channel dimension of the input should be defined. Found "+t[e]);const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return yO(()=>{let e;t=XW(t);const n=null==this.bias?null:this.bias.read(),r=TV(this.activation.getClassName());if(null!=r&&2===this.rank)e=eH(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=function(t,e,n,r=1,s="valid",i,a=1){return yO(()=>{if(null==i&&(i="channelsLast"),HV(i),3!==t.shape.length)throw new oV("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new oV("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new oV("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===i&&(t=RF(t,[0,2,1])),"causal"===s)throw new lV("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=nD(t,e,r,"same"===s?"same":"valid","NWC",a);return null!=n&&(o=bW(o,n)),o})}(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=eH(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new lV("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r=[1,1,1],s="valid",i,a){return yO(()=>{if(null==i&&(i="channelsLast"),HV(i),4!==t.rank&&5!==t.rank)throw new oV("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new oV("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");let o=tH(t,i);if("causal"===s)throw new lV("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=iD(o,e,r,"same"===s?"same":"valid","NDHWC",a),null!=n&&(o=bW(o,n)),"channelsFirst"===i&&(o=RF(o,[0,4,1,2,3])),o})}(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e})}computeOutputShape(t){t=YW(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<n.length;++s){const t=Zj(n[s],this.kernelSize[s],this.padding,this.strides[s],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[s]);e.push(t)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:VW(this.kernelInitializer),kernelRegularizer:Vj(this.kernelRegularizer),kernelConstraint:MV(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new oV("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))}}class sH extends rH{constructor(t){super(2,t),sH.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!CV(t.kernelSize,"number",1,2))throw new oV(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}sH.className="Conv2D",u.registerClass(sH);class iH extends rH{constructor(t){super(3,t),iH.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new oV(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}iH.className="Conv3D",u.registerClass(iH);class aH extends sH{constructor(t){if(super(t),this.inputSpec=[new eU({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new oV("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+this.padding)}build(t){if(4!==(t=YW(t)).length)throw new oV("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new oV("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new eU({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return yO(()=>{let e=XW(t);if(4!==e.shape.length)throw new oV("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);const n=e.shape;let r,s;"channelsFirst"===this.dataFormat?(r=2,s=3):(r=1,s=2);const i=n[s],a=this.kernelSize[1],o=this.strides[1],l=[n[0],Qj(n[r],this.strides[0],this.kernelSize[0],this.padding),Qj(i,o,a,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=RF(e,[0,2,3,1]));let u=sD(e,this.kernel.read(),l,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(u=RF(u,[0,3,1,2])),null!=this.bias&&(u=bW(u,this.bias.read(),this.dataFormat)),null!=this.activation&&(u=this.activation.apply(u)),u})}computeOutputShape(t){const e=(t=YW(t)).slice();let n,r,s;"channelsFirst"===this.dataFormat?(n=1,r=2,s=3):(n=3,r=1,s=2);const i=this.kernelSize[0],a=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return e[n]=this.filters,e[r]=Qj(e[r],o,i,this.padding),e[s]=Qj(e[s],l,a,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}aH.className="Conv2DTranspose",u.registerClass(aH);class oH extends rH{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new oV("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new oV("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new oV(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received `+JSON.stringify(e.padding));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=WW(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Uj(e.depthwiseRegularizer),this.depthwiseConstraint=PV(e.depthwiseConstraint),this.pointwiseInitializer=WW(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Uj(e.pointwiseRegularizer),this.pointwiseConstraint=PV(e.pointwiseConstraint)}build(t){if((t=YW(t)).length<this.rank+2)throw new oV(`Inputs to SeparableConv${this.rank}D should have rank `+(this.rank+2)+", but received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new oV("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[e]));const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),s=[];for(let a=0;a<this.rank;++a)s.push(1);s.push(n*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):null,this.inputSpec=[new eU({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return yO(()=>{let e;if(t=XW(t),1===this.rank)throw new lV("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=RF(t,[0,2,3,1])),e=cF(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=bW(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=RF(e,[0,3,1,2])),e})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=VW(this.depthwiseInitializer),t.pointwiseInitializer=VW(this.pointwiseInitializer),t.depthwiseRegularizer=Vj(this.depthwiseRegularizer),t.pointwiseRegularizer=Vj(this.pointwiseRegularizer),t.depthwiseConstraint=MV(this.depthwiseConstraint),t.pointwiseConstraint=MV(this.pointwiseConstraint),t}}oH.className="SeparableConv";class lH extends oH{constructor(t){super(2,t)}}lH.className="SeparableConv2D",u.registerClass(lH);class uH extends rH{constructor(t){super(1,t),uH.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!CV(t.kernelSize,"number",1,1))throw new oV(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}uH.className="Conv1D",u.registerClass(uH);class cH extends aU{constructor(t){super(t),this.cropping="number"==typeof t.cropping?[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return yO(()=>{if(t=XW(t),"channelsLast"===this.dataFormat){const e=uW(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return uW(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=uW(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return uW(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}cH.className="Cropping2D",u.registerClass(cH);class hH extends aU{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,HV(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,SV(BV,"InterpolationFormat",this.interpolation)}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],null==t[2]?null:this.size[0]*t[2],null==t[3]?null:this.size[1]*t[3]]:[t[0],null==t[1]?null:this.size[0]*t[1],null==t[2]?null:this.size[1]*t[2],t[3]]}call(t,e){return yO(()=>{let e=XW(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=RF(e,[0,2,3,1]);const t=this.size[0]*n[2],r=this.size[1]*n[3],s="nearest"===this.interpolation?e.resizeNearestNeighbor([t,r]):e.resizeBilinear([t,r]);return RF(s,[0,3,1,2])}{const t=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?e.resizeNearestNeighbor([t,r]):e.resizeBilinear([t,r])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}hH.className="UpSampling2D",u.registerClass(hH);class dH extends nH{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=WW(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=PV(t.depthwiseConstraint),this.depthwiseRegularizer=Uj(t.depthwiseRegularizer)}build(t){if((t=YW(t)).length<4)throw new oV(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new oV(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const n=t[e];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return yO(()=>{let e=function(t,e,n=[1,1],r="valid",s,i){return yO(()=>{null==s&&(s="channelsLast"),HV(s);let a=Jj(t,s);if(4!==t.rank)throw new oV("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new oV("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return a=aD(a,e,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===s&&(a=RF(a,[0,3,1,2])),a})}(t=XW(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=bW(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e})}computeOutputShape(t){t=YW(t);const e="channelsFirst"===this.dataFormat?t[3]:t[2],n="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,r=Zj("channelsFirst"===this.dataFormat?t[2]:t[1],this.kernelSize[0],this.padding,this.strides[0]),s=Zj(e,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],n,r,s]:[t[0],r,s,n]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=VW(this.depthwiseInitializer),t.depthwiseRegularizer=Vj(this.depthwiseRegularizer),t.depthwiseConstraint=MV(this.depthwiseRegularizer),t}}function pH(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new oV("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=s(e),constants:n=s(n)}}function fH(t,e,n,r=!1,s,i,a=!1,o=!1){return yO(()=>{const l=e.shape.length;if(l<3)throw new oV(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(sW(2,l));if(e=RF(e,u),null!=i)throw new lV("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=s&&((s=s.asType("bool").asType("float32")).rank===l-1&&(s=fD(s,-1)),s=RF(s,u)),r&&(e=lF(e,0),null!=s&&(s=lF(s,0)));const c=[];let h,d=n;const p=e.shape[0],f=EF(e);let m,g;null!=s&&(m=EF(s));for(let e=0;e<p;++e){const n=f[e],r=yO(()=>t(n,d));if(null==s)h=r[0],d=r[1];else{const t=yO(()=>{const t=m[e],n=QD(t).sub(t);return{output:r[0].mul(t).add(d[0].mul(n)),newStates:d.map((e,s)=>r[1][s].mul(t).add(e.mul(n)))}});h=t.output,d=t.newStates}o&&c.push(h)}return o&&(g=xF(c,1)),[h,g,d]})}dH.className="DepthwiseConv2D",u.registerClass(dH);class mH extends aU{constructor(t){let e;if(super(t),null==t.cell)throw new oV("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new kH({cells:t.cell}):t.cell,null==e.stateSize)throw new oV("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new eU({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?sW(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(t=>null):this.states_}setStates(t){this.states_=t}computeOutputShape(t){GW(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return yO(()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map(t=>null);return[t].concat(e)}return t})}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new lV("Constants support is not implemented in RNN yet.");GW(t)&&(t=t[0]),t=t;const e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new eU({shape:[e,null,...n]});const s=[t[0]].concat(t.slice(2));let i;if(this.cell.build(s),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!r.arraysEqual(this.stateSpec.map(t=>t.shape[t.shape.length-1]),i))throw new oV(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is `+this.cell.stateSize)}else this.stateSpec=i.map(t=>new eU({shape:[null,t]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){yO(()=>{if(!this.stateful)throw new iV("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new oV("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>YD([n,t])):[YD([n,this.cell.stateSize])];else if(null==t)bO(this.states_),null!=this.keptStates&&(bO(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>YD([n,t])):this.states_[0]=YD([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new oV(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: `+t);!0===e?this.keptStates.push(this.states_.slice()):bO(this.states_);for(let e=0;e<this.states_.length;++e){const s=t[e],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,a=[n,i];if(!r.arraysEqual(s.shape,a))throw new oV(`State ${e} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${s.shape}`);this.states_[e]=s}}this.states_=this.states_.map(t=>vO(t.clone()))})}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const s=pH(t,n,r,this.numConstants);t=s.inputs,n=s.initialState,r=s.constants;let i=[],a=[];if(null!=n){e.initialState=n,i=i.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new eU({shape:t.shape}));a=a.concat(this.stateSpec)}if(null!=r&&(e.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof nU){const n=[t].concat(i),r=this.inputSpec.concat(a),s=this.inputSpec;this.inputSpec=r;const o=super.apply(n,e);return this.inputSpec=s,o}return super.apply(t,e)}call(t,e){return yO(()=>{const n=null==e?null:e.mask,r=null==e?null:e.training;let s=null==e?null:e.initialState;t=XW(t),null==s&&(s=this.stateful?this.states_:this.getInitialState(t));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==i)throw new oV(`RNN Layer has ${i} state(s) but was passed `+s.length+" initial state(s).");this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},o=fH((t,e)=>{const n=this.cell.call([t].concat(e),a);return[n[0],n.slice(1)]},t,s,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],u=o[1],c=o[2];this.stateful&&this.resetStates(c,r);const h=this.returnSequences?u:l;return this.returnState?[h].concat(c):h})}getInitialState(t){return yO(()=>{let e=YD(t.shape);return e=TD(e,[1,2]),e=aW(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>t>1?dW(e,[1,t]):e):this.cell.stateSize>1?[dW(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===mH.className&&(e.cell={className:this.cell.getClassName(),config:n}),Object.assign({},n,t,e)}static fromConfig(t,e,n={}){const r=wU(e.cell,n);return new t(Object.assign(e,{cell:r}))}}mH.className="RNN",u.registerClass(mH);class gH extends aU{}class yH extends gH{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,IV(this.units,"units"),this.activation=Lj(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=WW(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=WW(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=WW(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Uj(t.kernelRegularizer),this.recurrentRegularizer=Uj(t.recurrentRegularizer),this.biasRegularizer=Uj(t.biasRegularizer),this.kernelConstraint=PV(t.kernelConstraint),this.recurrentConstraint=PV(t.recurrentConstraint),this.biasConstraint=PV(t.biasConstraint),this.dropout=nW([1,rW([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=nW([1,rW([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=YW(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return yO(()=>{if(2!==(t=t).length)throw new oV(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let n=t[1];t=t[0];const r=null!=e.training&&e.training;let s;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=SH({ones:()=>QD(t),rate:this.dropout,training:r})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=SH({ones:()=>QD(n),rate:this.recurrentDropout,training:r}));const i=this.dropoutMask,a=this.recurrentDropoutMask;s=fW(null!=i?ID(t,i):t,this.kernel.read()),null!=this.bias&&(s=bW(s,this.bias.read())),null!=a&&(n=ID(n,a));let o=CO(s,fW(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:$j(this.activation),useBias:this.useBias,kernelInitializer:VW(this.kernelInitializer),recurrentInitializer:VW(this.recurrentInitializer),biasInitializer:VW(this.biasInitializer),kernelRegularizer:Vj(this.kernelRegularizer),recurrentRegularizer:Vj(this.recurrentRegularizer),biasRegularizer:Vj(this.biasRegularizer),activityRegularizer:Vj(this.activityRegularizer),kernelConstraint:MV(this.kernelConstraint),recurrentConstraint:MV(this.recurrentConstraint),biasConstraint:MV(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,e)}}yH.className="SimpleRNNCell",u.registerClass(yH);class bH extends mH{constructor(t){t.cell=new yH(t),super(t)}call(t,e){return yO(()=>(null!=this.cell.dropoutMask&&(bO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(bO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}static fromConfig(t,e){return new t(e)}}bH.className="SimpleRNN",u.registerClass(bH);class vH extends gH{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new oV("GRUCell does not support reset_after parameter set to true.");this.units=t.units,IV(this.units,"units"),this.activation=Lj(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Lj(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=WW(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=WW(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=WW(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Uj(t.kernelRegularizer),this.recurrentRegularizer=Uj(t.recurrentRegularizer),this.biasRegularizer=Uj(t.biasRegularizer),this.kernelConstraint=PV(t.kernelConstraint),this.recurrentConstraint=PV(t.recurrentConstraint),this.biasConstraint=PV(t.biasConstraint),this.dropout=nW([1,rW([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=nW([1,rW([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=YW(t),this.kernel=this.addWeight("kernel",[t[t.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return yO(()=>{if(2!==(t=t).length)throw new oV("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");const n=null!=e.training&&e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=SH({ones:()=>QD(t),rate:this.dropout,training:n,count:3})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=SH({ones:()=>QD(r),rate:this.recurrentDropout,training:n,count:3}));const s=this.recurrentDropoutMask;let i,a,o;0<this.dropout&&this.dropout<1&&(t=ID(t,this.dropoutMask[0]));let l=fW(t,this.kernel.read());this.useBias&&(l=bW(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ID(r,s[0]));const u=this.recurrentKernel.read(),[c,h]=vF(u,[2*this.units,this.units],u.rank-1),d=fW(r,c),[p,f,m]=vF(l,3,l.rank-1),[g,y]=vF(d,2,d.rank-1);i=this.recurrentActivation.apply(CO(p,g)),a=this.recurrentActivation.apply(CO(f,y));const b=fW(ID(a,r),h);o=this.activation.apply(CO(m,b));const v=CO(ID(i,r),ID(CO(1,GD(i)),o));return[v,v]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:$j(this.activation),recurrentActivation:$j(this.recurrentActivation),useBias:this.useBias,kernelInitializer:VW(this.kernelInitializer),recurrentInitializer:VW(this.recurrentInitializer),biasInitializer:VW(this.biasInitializer),kernelRegularizer:Vj(this.kernelRegularizer),recurrentRegularizer:Vj(this.recurrentRegularizer),biasRegularizer:Vj(this.biasRegularizer),activityRegularizer:Vj(this.activityRegularizer),kernelConstraint:MV(this.kernelConstraint),recurrentConstraint:MV(this.recurrentConstraint),biasConstraint:MV(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,e)}}vH.className="GRUCell",u.registerClass(vH);class wH extends mH{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new vH(t),super(t)}call(t,e){return yO(()=>(null!=this.cell.dropoutMask&&(bO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(bO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}wH.className="GRU",u.registerClass(wH);class _H extends gH{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,IV(this.units,"units"),this.activation=Lj(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Lj(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=WW(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=WW(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=WW(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Uj(t.kernelRegularizer),this.recurrentRegularizer=Uj(t.recurrentRegularizer),this.biasRegularizer=Uj(t.biasRegularizer),this.kernelConstraint=PV(t.kernelConstraint),this.recurrentConstraint=PV(t.recurrentConstraint),this.biasConstraint=PV(t.biasConstraint),this.dropout=nW([1,rW([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=nW([1,rW([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;let n;if(t=YW(t),this.kernel=this.addWeight("kernel",[t[t.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,r=this.units;n=new((e=class extends kW{apply(e,n){const s=t.apply([r]),i=(new CW).apply([r]),a=t.apply([2*r]);return hW(hW(s,i),a)}}).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return yO(()=>{const n=null!=e.training&&e.training;if(3!==(t=t).length)throw new oV("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");let r=t[1];const s=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=SH({ones:()=>QD(t),rate:this.dropout,training:n,count:4})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=SH({ones:()=>QD(r),rate:this.recurrentDropout,training:n,count:4}));const i=this.recurrentDropoutMask;let a,o,l,u;0<this.dropout&&this.dropout<1&&(t=ID(t,this.dropoutMask[0]));let c=fW(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ID(r,i[0])),c=CO(c,fW(r,this.recurrentKernel.read())),this.useBias&&(c=bW(c,this.bias.read()));const[h,d,p,f]=vF(c,4,c.rank-1);a=this.recurrentActivation.apply(h),o=this.recurrentActivation.apply(d),l=CO(ID(o,s),ID(a,this.activation.apply(p))),u=this.recurrentActivation.apply(f);const m=ID(u,this.activation.apply(l));return[m,m,l]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:$j(this.activation),recurrentActivation:$j(this.recurrentActivation),useBias:this.useBias,kernelInitializer:VW(this.kernelInitializer),recurrentInitializer:VW(this.recurrentInitializer),biasInitializer:VW(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vj(this.kernelRegularizer),recurrentRegularizer:Vj(this.recurrentRegularizer),biasRegularizer:Vj(this.biasRegularizer),activityRegularizer:Vj(this.activityRegularizer),kernelConstraint:MV(this.kernelConstraint),recurrentConstraint:MV(this.recurrentConstraint),biasConstraint:MV(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,e)}}_H.className="LSTMCell",u.registerClass(_H);class xH extends mH{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new _H(t),super(t)}call(t,e){return yO(()=>(null!=this.cell.dropoutMask&&(bO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(bO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}xH.className="LSTM",u.registerClass(xH);class kH extends gH{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return yO(()=>{let n=(t=t).slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const s=[];let i;for(let a=0;a<this.cells.length;++a){const o=this.cells[a];n=r[a],i=0===a?[t[0]].concat(n):[i[0]].concat(n),i=o.call(i,e),s.push(i.slice(1))}n=[];for(const t of s.slice().reverse())n.push(...t);return[i[0]].concat(n)})}build(t){let e;GW(t)&&(t=t[0]),t=t,this.cells.forEach((n,r)=>{XV("RNNCell_"+r,()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=super.getConfig(),e=this.cells.map(t=>({className:t.getClassName(),config:t.getConfig()}));return Object.assign({},t,{cells:e})}static fromConfig(t,e,n={}){const r=[];for(const s of e.cells)r.push(wU(s,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return JW(t)}setWeights(t){const e=[];for(const n of this.cells){const r=t.splice(n.weights.length);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],r[t]])}tU(e)}}function SH(t){const{ones:e,rate:n,training:r=!1,count:s=1}=t,i=()=>vW(e(),n),a=()=>wW(i,e,r);return!s||s<=1?vO(a().clone()):Array(s).fill(void 0).map(a).map(t=>vO(t.clone()))}var CH;kH.className="StackedRNNCells",u.registerClass(kH);class IH extends mH{constructor(t){if(t.unroll)throw new lV("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new lV("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new eU({ndim:5})]}call(t,e){return yO(()=>{if(null!=this.cell.dropoutMask&&(bO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(bO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new oV("ConvRNN2D cell does not support constants");return super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})})}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return yO(()=>{const{stateSize:e}=this.cell,n=this.computeSingleOutputShape(t.shape),r=YD([n[0],...n.slice(2)]);return Array.isArray(e)?Array(e.length).fill(r):[r]})}resetStates(t,e=!1){yO(()=>{if(!this.stateful)throw new iV("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,s=this.computeSingleOutputShape(n),i=[s[0],...s.slice(2)];if(null==n[0])throw new oV("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(()=>YD(i)):[YD(i)];else if(null==t)bO(this.states_),null!=this.keptStates&&(bO(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>YD(i)):this.states_[0]=YD(i);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new oV(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: `+t);e?this.keptStates.push(this.states_.slice()):bO(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],s=i;if(!r.arraysEqual(n.shape,s))throw new oV(`State ${e} is incompatible with layer ${this.name}: expected shape=${s}, received shape=${n.shape}`);this.states_[e]=n}}this.states_=this.states_.map(t=>vO(t.clone()))})}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:s,strides:i,dilationRate:a}=this.cell,o="channelsFirst"===e,l=t[o?4:3],u=Zj(t[o?3:2],r[0],s,i[0],a[0]),c=Zj(l,r[1],s,i[1],a[1]);return[...t.slice(0,2),...o?[n,u,c]:[u,c,n]]}}IH.className="ConvRNN2D";class EH extends _H{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:s,dataFormat:i,dilationRate:a}=t;super(Object.assign({},t,{units:e})),this.filters=e,IV(this.filters,"filters"),this.kernelSize=Yj(n,2,"kernelSize"),this.kernelSize.forEach(t=>IV(t,"kernelSize")),this.strides=Yj(r||1,2,"strides"),this.strides.forEach(t=>IV(t,"strides")),this.padding=s||"valid",qV(this.padding),this.dataFormat=i||"channelsLast",HV(this.dataFormat),this.dilationRate=Yj(a||1,2,"dilationRate"),this.dilationRate.forEach(t=>IV(t,"dilationRate"))}build(t){var e;t=YW(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new oV("The channel dimension of the input should be defined. Found "+t[n]);const r=this.kernelSize.concat([t[n],4*this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const s=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;t=new((e=class extends kW{apply(t,e){return cW([n.apply([r]),ZD([r]),n.apply([2*r])])}}).className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return yO(()=>{if(3!==t.length)throw new oV("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");const n=e.training||!1,r=t[0],s=t[1],i=t[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=SH({ones:()=>QD(r),rate:this.dropout,training:n,count:4}));const a=this.dropoutMask,o=(t,e,n)=>e&&e[n]?ID(e[n],t):t;let l=o(r,a,0),u=o(r,a,1),c=o(r,a,2),h=o(r,a,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=SH({ones:()=>QD(s),rate:this.recurrentDropout,training:n,count:4}));const d=this.recurrentDropoutMask;let p=o(s,d,0),f=o(s,d,1),m=o(s,d,2),g=o(s,d,3);const[y,b,v,w]=vF(this.kernel.read(),4,3),[_,x,k,S]=this.useBias?vF(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,y,_,this.padding),u=this.inputConv(u,b,x,this.padding),c=this.inputConv(c,v,k,this.padding),h=this.inputConv(h,w,S,this.padding);const[C,I,E,T]=vF(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,C),f=this.recurrentConv(f,I),m=this.recurrentConv(m,E),g=this.recurrentConv(g,T);const N=this.recurrentActivation.apply(CO(l,p)),A=this.recurrentActivation.apply(CO(u,f)),R=CO(ID(A,i),ID(N,this.activation.apply(CO(c,m)))),O=ID(this.recurrentActivation.apply(CO(h,g)),this.activation.apply(R));return[O,O,R]})}getConfig(){const t=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]])}return n}(super.getConfig(),["units"]);return Object.assign({},t,{filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides})}inputConv(t,e,n,r){const s=eD(t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?bW(s,n,this.dataFormat):s}recurrentConv(t,e){return eD(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}EH.className="ConvLSTM2DCell",u.registerClass(EH);class TH extends IH{constructor(t){const e=new EH(t);super(Object.assign({},t,{cell:e}))}static fromConfig(t,e){return new t(e)}}TH.className="ConvLSTM2D",u.registerClass(TH);class NH extends aU{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}call(t,e){return yO(()=>{this.invokeCallHook(t,e);const n=XW(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,r=this.getNoiseShape(n);return wW(()=>vW(n,this.rate,r,this.seed),()=>n,t)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}NH.className="Dropout",u.registerClass(NH);class AH extends NH{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}AH.className="SpatialDropout1D",u.registerClass(AH);class RH extends aU{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,IV(this.units,"units"),this.activation=Lj(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=WW(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=WW(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=PV(t.kernelConstraint),this.biasConstraint=PV(t.biasConstraint),this.kernelRegularizer=Uj(t.kernelRegularizer),this.biasRegularizer=Uj(t.biasRegularizer),this.activityRegularizer=Uj(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=YW(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=YW(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return yO(()=>{this.invokeCallHook(t,e);const n=XW(t),r=TV(this.activation.getClassName());let s;return null!=r?s=fW(n,this.kernel.read(),r,this.bias?this.bias.read():null):(s=fW(n,this.kernel.read()),null!=this.bias&&(s=bW(s,this.bias.read())),null!=this.activation&&(s=this.activation.apply(s))),s})}getConfig(){const t={units:this.units,activation:$j(this.activation),useBias:this.useBias,kernelInitializer:VW(this.kernelInitializer),biasInitializer:VW(this.biasInitializer),kernelRegularizer:Vj(this.kernelRegularizer),biasRegularizer:Vj(this.biasRegularizer),activityRegularizer:Vj(this.activityRegularizer),kernelConstraint:MV(this.kernelConstraint),biasConstraint:MV(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}RH.className="Dense",u.registerClass(RH);class OH extends aU{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=YW(t);for(const e of t.slice(1))if(null==e)throw new oV(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],tW(t,1)]}call(t,e){return yO(()=>{this.invokeCallHook(t,e);let n=XW(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=n.transpose(t)}return function(t){if(t.rank<=1)throw new oV(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],tW(t.shape,1)];return t.reshape(e)}(n)})}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}OH.className="Flatten",u.registerClass(OH);class DH extends aU{constructor(t){super(t),this.supportsMasking=!0,this.activation=Lj(t.activation)}call(t,e){return yO(()=>{this.invokeCallHook(t,e);const n=XW(t);return this.activation.apply(n)})}getConfig(){const t={activation:$j(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}DH.className="Activation",u.registerClass(DH);class FH extends aU{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return yO(()=>{return t=XW(t),e=t,n=this.n,yO(()=>{if(2!==e.shape.length)throw new oV(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);return dW(aW(e,1),[1,n,1])});var e,n})}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}FH.className="RepeatVector",u.registerClass(FH);class $H extends aU{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let s=1,i=null;for(let o=0;o<r.length;++o){const t=r[o];if(this.isUnknown(t)){if(null!==i)throw new oV("Can only specifiy one unknown dimension.");i=o}else s*=t}const a=tW(t);if(null!==i){if(0===s||a%s!=0)throw new oV(n);r[i]=a/s}else if(a!==s)throw new oV(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return yO(()=>{this.invokeCallHook(t,e);const n=XW(t),r=n.shape,s=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return n.reshape(s)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}$H.className="Reshape",u.registerClass($H);class MH extends aU{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+t.dims+" instead.");const e=sW(1,t.dims.length+1);if(!r.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new eU({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=YW(t)).slice();return this.dims.forEach((n,r)=>{e[r+1]=t[n]}),e}call(t,e){return RF(XW(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}MH.className="Permute",u.registerClass(MH);class LH extends aU{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=XW(t);return EO(KD(n,this.maskValue),-1)}call(t,e){return yO(()=>{this.invokeCallHook(t,e);const n=XW(t),r=EO(KD(n,this.maskValue),-1,!0);return n.mul(r.asType(n.dtype))})}}LH.className="Masking",u.registerClass(LH);class PH extends aU{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=null==t.inputLength?[e,null]:[e].concat(fV(t.inputLength))}this.inputDim=t.inputDim,IV(this.inputDim,"inputDim"),this.outputDim=t.outputDim,IV(this.outputDim,"outputDim"),this.embeddingsInitializer=WW(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Uj(t.embeddingsRegularizer),this.activityRegularizer=Uj(t.activityRegularizer),this.embeddingsConstraint=PV(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return yO(()=>this.maskZero?(t=XW(t),KD(t,AF(t))):null)}computeOutputShape(t){if(t=YW(t),null==this.inputLength)return[...t,this.outputDim];const e=fV(this.inputLength);if(e.length!==t.length-1)throw new oV(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);{let n=0;for(let r=0;r<e.length;++r){const s=e[r],i=t[r+1];if(null!=s&&null!=i&&s!==i)throw new oV(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);null==s&&(e[n]=i),n++}}return[t[0],...e,this.outputDim]}call(t,e){return yO(()=>{this.invokeCallHook(t,e);let n=XW(t);return"int32"!==n.dtype&&(n=iW(n,"int32")),mW(this.embeddings.read(),n.as1D()).reshape(YW(this.computeOutputShape(n.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:VW(this.embeddingsInitializer),embeddingsRegularizer:Vj(this.embeddingsRegularizer),activityRegularizer:Vj(this.activityRegularizer),embeddingsConstraint:MV(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}PH.className="Embedding",u.registerClass(PH);class zH extends aU{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new lV}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const s=t[t.length-e.length+r],i=e[r];if(null==s||null==i||s<0||i<0)n.push(null);else if(1===s)n.push(i);else if(1===i)n.push(s);else{if(s!==i)throw new oV("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(s)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[YW(t)]),(t=t).length<2)throw new oV(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const s of t)null!=s&&null!==s[0]&&e.push(s[0]);if(e=xV(e),e.length>1)throw new oV(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let n=null==t[0]?null:t[0].slice(1);for(let s=1;s<t.length;++s){const e=null==t[s]?null:t[s].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const r=t.map(t=>t.length);this.reshapeRequired=-1!==t.indexOf(null)||1!==xV(r).length}call(t,e){return yO(()=>{if(t=t,this.reshapeRequired){const e=[],n=t.map(t=>t.rank);if(-1===n.indexOf(null)){const r=rW(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=aW(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const i of t){const t=i.rank;if(null==t){const t=i.shape,r=t[0],s=t.slice(1).concat([r]);let a=i.reshape([r].concat(tW(t.slice(1))));a=RF(a,[1,0]),a=a.reshape(s),e.push(a),n=!0}else if(t>1){const r=sW(1,t).concat([0]);e.push(RF(i,r)),n=!0}else e.push(i)}let r=this.mergeFunction(e);const s=r.rank;if(n)if(null==s){const t=r.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));r=RF(r.reshape([-1,e]),[1,0]).reshape(n)}else if(s>1){const t=[s-1].concat(sW(0,s-1));r=RF(r,t)}return r}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==(t=t)[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const n=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const r of t)null!=r&&null!==r[0]&&n.push(r[0]);return n=xV(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return yO(()=>{if(null==e)return null;if(!Array.isArray(e))throw new oV("`mask` should be an Array");if(!Array.isArray(t))throw new oV("`inputs` should be an Array");if(e.length!==t.length)throw new oV(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(t=>null==t))return null;let n=(e=e.map(t=>null==t?t:fD(t,0)))[0];for(let t=1;t<e.length-1;++t)n=AD(n,e[t]);return n})}}class BH extends zH{constructor(t){super(t)}mergeFunction(t){return yO(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=CO(e,t[n]);return e})}}BH.className="Add",u.registerClass(BH);class VH extends zH{constructor(t){super(t)}mergeFunction(t){return yO(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=ID(e,t[n]);return e})}}VH.className="Multiply",u.registerClass(VH);class WH extends zH{constructor(t){super(t)}mergeFunction(t){return yO(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=CO(e,t[n]);return ID(1/t.length,e)})}}WH.className="Average",u.registerClass(WH);class UH extends zH{constructor(t){super(t)}mergeFunction(t){return yO(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=DD(e,t[n]);return e})}}UH.className="Maximum",u.registerClass(UH);class jH extends zH{constructor(t){super(t)}mergeFunction(t){return yO(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=MD(e,t[n]);return e})}}jH.className="Minimum",u.registerClass(jH);class HH extends zH{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new oV("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const n=[];for(let s=0;s<t.length;++s){const e=t[s].slice();e.splice(this.axis,1);let i=!1;for(const t of n)if(r.arraysEqual(t,e)){i=!0;break}i||n.push(e)}if(n.length>1)throw new oV("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return yO(()=>cW(t,this.axis))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new oV("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const s of e.slice(1)){if(null==n[r]||null==s[r]){n[r]=null;break}n[r]+=s[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new oV("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new oV("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new oV(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return yO(()=>{let n=!0;if(e.forEach(t=>{null==t||(n=!1)}),n)return null;const r=[];for(let i=0;i<t.length;++i)r.push(null==e[i]?QD(t[i]).asType("bool"):e[i].rank<t[i].rank?fD(e[i],-1):e[i]);const s=YO(r,this.axis);return IO(s,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function qH(t,e){for(;t<0;)t+=e;return t}HH.className="Concatenate",u.registerClass(HH);class GH extends zH{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){r.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new lV("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(e,n);if(e[s[0]]!==n[s[1]])throw new oV(`Dimension incompatibility: ${e[s[0]]} !== ${n[s[1]]}`)}mergeFunction(t){if(2!==t.length)throw new oV(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e,n=t[0],s=t[1];return e=Array.isArray(this.axes)?this.axes.map((e,n)=>qH(e,t[n].shape.length)):[qH(this.axes,n.shape.length),qH(this.axes,s.shape.length)],this.normalize&&(n=_U(n,e[0]),s=_U(s,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new lV("batchDot is not implemented for tensors of 4D or higher rank yet");if(r.assert(t.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, but got "+t.shape.length),r.assert(t.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, but got "+e.shape.length),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new lV("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,i=e.shape.length;null==n&&(n=[s-1,i-2]);const a=n;return yO(()=>{let n,r;if(s>i){n=s-i;const t=[];for(let e=0;e<n;++e)t.push(1);e=e.reshape(e.shape.concat(t))}else if(i>s){n=i-s;const e=[];for(let t=0;t<n;++t)e.push(1);t=t.reshape(t.shape.concat(e))}else n=0;if(r=2===t.shape.length&&2===e.shape.length?a[0]===a[1]?t.mul(e).sum(a[0]):t.transpose([1,0]).mul(e).sum(a[1]):t.matMul(e,a[0]!==t.shape.length-1,a[1]===e.shape.length-1),n>0){let t;t=s>i?s+i-3:s-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);r=r.squeeze(e)}return 1===r.shape.length&&(r=r.expandDims(1)),r})}(n,s,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[qH(this.axes,t.length),qH(this.axes,e.length)],n}computeOutputShape(t){r.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new lV("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(e,n);e.splice(s[0],1),n.splice(s[1],1),n.splice(0,1);const i=e.concat(n);return 1===i.length&&i.push(1),i}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}GH.className="Dot",u.registerClass(GH);class KH extends aU{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return yO(()=>{this.invokeCallHook(t,e);const n=XW(t);return wW(()=>pW(n.shape,0,this.stddev).add(n),()=>n,e.training||!1)})}}KH.className="GaussianNoise",u.registerClass(KH);class XH extends aU{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return yO(()=>{this.invokeCallHook(t,e);const n=XW(t);return this.rate>0&&this.rate<1?wW(()=>{const t=Math.sqrt(this.rate/(1-this.rate));return n.mul(pW(n.shape,1,t))},()=>n,e.training||!1):n})}}XH.className="GaussianDropout",u.registerClass(XH);class YH extends aU{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||XW(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return yO(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t);return wW(()=>{const e=XW(t),r=-1.7580993408473766;let s=_D(aF(n),this.rate);s=iW(s,"float32");const i=((1-this.rate)*(1+this.rate*r**2))**-.5,a=-i*r*this.rate;return e.mul(s).add(s.add(-1).mul(r)).mul(i).add(a)},()=>XW(t),e.training||!1)}return t})}}function ZH(t,e,n,r,s,i=.001){let a;if(2===t.rank)a=qO(t,e,n,r,s,i);else if(3===t.rank)a=GO(t,e,n,r,s,i);else{if(4!==t.rank)throw new lV(`batchNormalization is not implemented for array of rank ${t.rank} yet`);a=KO(t,e,n,r,s,i)}return a}YH.className="AlphaDropout",u.registerClass(YH);class QH extends aU{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=WW(t.betaInitializer||"zeros"),this.gammaInitializer=WW(t.gammaInitializer||"ones"),this.movingMeanInitializer=WW(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=WW(t.movingVarianceInitializer||"ones"),this.betaConstraint=PV(t.betaConstraint),this.gammaConstraint=PV(t.gammaConstraint),this.betaRegularizer=Uj(t.betaRegularizer),this.gammaRegularizer=Uj(t.gammaRegularizer)}build(t){t=YW(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new oV(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape `+JSON.stringify(t)+".");this.inputSpec=[new eU({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return yO(()=>{const n=null!=e.training&&e.training,s=XW(t),i=s.shape,a=i.length,o=sW(0,a),l=this.axis>=0?this.axis:this.axis+a;o.splice(l,1);const u=cV(1,a);u[l]=i[l];const c=o.slice();c.sort();const h=!r.arraysEqual(c,sW(0,a).slice(0,a-1));if(!n)return(()=>{if(h){const t=this.movingMean.read().reshape(u),e=this.movingVariance.read().reshape(u),n=this.center?this.beta.read().reshape(u):null,r=this.scale?this.gamma.read().reshape(u):null;return ZH(s,t,e,n,r,this.epsilon)}return ZH(s,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,p,f]=function(t,e,n,s,i=.001){return r.arraysEqual(s.slice().sort(),sW(0,t.rank-1))?function(t,e,n,r,s=.001){return yO(()=>{const i=qD(t,r),a=i.mean,o=i.variance;return[ZH(t,a,o,n,e,s),a,o]})}(t,e,n,s,i):function(t,e,n,r,s=.001){return yO(()=>{const i=qD(t,r),a=i.mean,o=i.variance,l=[];for(const e of sW(0,t.rank))-1!==r.indexOf(e)?l.push(1):l.push(t.shape[e]);const u=a.reshape(l),c=o.reshape(l),h=null==e?null:e.reshape(l),d=null==n?null:n.reshape(l);return[ZH(t,u,c,d,h,s),a,o]})}(t,e,n,s,i)}(s,this.gamma.read(),this.beta.read(),o,this.epsilon),m=(t,e,n)=>{yO(()=>{const r=1-n,s=t.read(),i=s.sub(e).mul(r);t.write(s.sub(i))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,f,this.momentum)})(),d})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:VW(this.betaInitializer),gammaInitializer:VW(this.gammaInitializer),movingMeanInitializer:VW(this.movingMeanInitializer),movingVarianceInitializer:VW(this.movingVarianceInitializer),betaRegularizer:Vj(this.betaRegularizer),gammaRegularizer:Vj(this.gammaRegularizer),betaConstraint:MV(this.betaConstraint),gammaConstraint:MV(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}QH.className="BatchNormalization",u.registerClass(QH);class JH extends aU{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received "+this.axis)}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(this.axis));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(this.axis))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=WW(t.betaInitializer||"zeros"),this.gammaInitializer=WW(t.gammaInitializer||"ones"),this.betaRegularizer=Uj(t.betaRegularizer),this.gammaRegularizer=Uj(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=YW(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=e);for(const r of this.axis)if(r<0||r>=e)throw new Error("Invalid axis: "+r);if(this.axis.length!==xV(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);const n=this.axis.map(e=>t[e]);this.gamma=this.scale?this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}call(t,e){const n=XW(t),r=n.shape,s=r.length;return yO(()=>{let{mean:t,variance:e}=qD(n,this.axis,!0);const i=cV(1,s);for(const n of this.axis)i[n]=r[n];const a=t=>null!=t&&t.shape.length!==s&&this.axis!==[s-1]?t.reshape(i):t;let o=a(this.gamma.read()),l=a(this.beta.read());const u=[],c=[];for(let n=0;n<s;++n)-1!==this.axis.indexOf(n)?(u.push(r[n]),c.push(1)):(u.push(1),c.push(r[n]));return t=t.tile(u),e=e.tile(u),o=o.tile(c),l=l.tile(c),ZH(n,t,e,l,o,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:VW(this.betaInitializer),gammaInitializer:VW(this.gammaInitializer),betaRegularizer:Vj(this.betaRegularizer),gammaRegularizer:Vj(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}JH.className="LayerNormalization",u.registerClass(JH);class tq extends aU{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new oV(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,n;if("number"==typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new oV(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new oV(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new eU({ndim:4})]}computeOutputShape(t){let e,n;return t=YW(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return yO(()=>{return e=XW(t),n=this.padding,r=this.dataFormat,yO(()=>{if(4!==e.rank)throw new oV("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new oV("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new oV(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let t;return t="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],JD(e,t)});var e,n,r})}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}function eq(t,e,n,r,s,i){return yO(()=>{let a;HV(s),GV(i),qV(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==s&&(s="channelsLast"),null==i&&(i="max"),t=Jj(t,s);const o="same"===r?"same":"valid";return a="max"===i?RD(t,e,n,o):UO(t,e,n,o),"channelsFirst"===s&&(a=RF(a,[0,3,1,2])),a})}function nq(t,e,n,r,s,i){return yO(()=>{let a;HV(s),GV(i),qV(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==s&&(s="channelsLast"),null==i&&(i="max"),t=tH(t,s);const o="same"===r?"same":"valid";return a="max"===i?OD(t,e,n,o):jO(t,e,n,o),"channelsFirst"===s&&(a=RF(a,[0,4,1,2,3])),a})}tq.className="ZeroPadding2D",u.registerClass(tq);class rq extends aU{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new oV("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));this.poolSize=t.poolSize}if(IV(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new oV("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));this.strides=t.strides}IV(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,qV(this.padding),this.inputSpec=[new eU({ndim:3})]}computeOutputShape(t){const e=Zj((t=YW(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return yO(()=>{this.invokeCallHook(t,e),t=aW(XW(t),2);const n=this.poolingFunction(XW(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return _F(n,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class sq extends rq{constructor(t){super(t)}poolingFunction(t,e,n,r,s){return HV(s),qV(r),eq(t,e,n,r,s,"max")}}sq.className="MaxPooling1D",u.registerClass(sq);class iq extends rq{constructor(t){super(t)}poolingFunction(t,e,n,r,s){return HV(s),qV(r),eq(t,e,n,r,s,"avg")}}iq.className="AveragePooling1D",u.registerClass(iq);class aq extends aU{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new oV("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides];IV(this.poolSize,"poolSize"),IV(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,HV(this.dataFormat),qV(this.padding),this.inputSpec=[new eU({ndim:4})]}computeOutputShape(t){t=YW(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=Zj(e,this.poolSize[0],this.padding,this.strides[0]),n=Zj(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return yO(()=>(this.invokeCallHook(t,e),this.poolingFunction(XW(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class oq extends aq{constructor(t){super(t)}poolingFunction(t,e,n,r,s){return HV(s),qV(r),eq(t,e,n,r,s,"max")}}oq.className="MaxPooling2D",u.registerClass(oq);class lq extends aq{constructor(t){super(t)}poolingFunction(t,e,n,r,s){return HV(s),qV(r),eq(t,e,n,r,s,"avg")}}lq.className="AveragePooling2D",u.registerClass(lq);class uq extends aU{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new oV("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];IV(this.poolSize,"poolSize"),IV(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,HV(this.dataFormat),qV(this.padding),this.inputSpec=[new eU({ndim:5})]}computeOutputShape(t){t=YW(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=Zj(e,this.poolSize[0],this.padding,this.strides[0]),n=Zj(n,this.poolSize[1],this.padding,this.strides[1]),r=Zj(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return yO(()=>(this.invokeCallHook(t,e),this.poolingFunction(XW(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class cq extends uq{constructor(t){super(t)}poolingFunction(t,e,n,r,s){return HV(s),qV(r),nq(t,e,n,r,s,"max")}}cq.className="MaxPooling3D",u.registerClass(cq);class hq extends uq{constructor(t){super(t)}poolingFunction(t,e,n,r,s){return HV(s),qV(r),nq(t,e,n,r,s,"avg")}}hq.className="AveragePooling3D",u.registerClass(hq);class dq extends aU{constructor(t){super(t),this.inputSpec=[new eU({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new lV}}class pq extends dq{constructor(t){super(t||{})}call(t,e){return yO(()=>{const e=XW(t);return FD(e,1)})}}pq.className="GlobalAveragePooling1D",u.registerClass(pq);class fq extends dq{constructor(t){super(t||{})}call(t,e){return yO(()=>{const e=XW(t);return CD(e,1)})}}fq.className="GlobalMaxPooling1D",u.registerClass(fq);class mq extends aU{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,HV(this.dataFormat),this.inputSpec=[new eU({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new lV}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class gq extends mq{call(t,e){return yO(()=>{const e=XW(t);return FD(e,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}gq.className="GlobalAveragePooling2D",u.registerClass(gq);class yq extends mq{call(t,e){return yO(()=>{const e=XW(t);return CD(e,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}yq.className="GlobalMaxPooling2D",u.registerClass(yq);class bq extends aU{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,n={}){const r=wU(e.layer,n);delete e.layer;const s={layer:r};return Object.assign(s,e),new t(s)}}class vq extends bq{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=YW(t)).length<3)throw new oV("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=YW(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e);return[n[0],t[1]].concat(n.slice(1))}call(t,e){return yO(()=>fH((t,n)=>[XW(this.layer.call(t,e)),[]],t=XW(t),[],!1,null,null,!1,!0)[1])}}vq.className="TimeDistributed",u.registerClass(vq);class wq extends bq{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=wU(n),e.goBackwards=!0!==e.goBackwards;const r={};if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=wU(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,SV(UV,"BidirectionalMergeMode",this.mergeMode),t.weights)throw new lV("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=Math.floor(t.length/2);this.forwardLayer.setWeights(t.slice(0,e)),this.backwardLayer.setWeights(t.slice(e))}computeOutputShape(t){let e,n,r,s=this.forwardLayer.computeOutputShape(t);return Array.isArray(s)&&Array.isArray(s[0])||(s=[s]),s=s,this.returnState?(r=s.slice(1),e=s[0]):e=s[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):pV(n)}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const s=pH(t,n,r,this.numConstants);if(t=s.inputs,n=s.initialState,r=s.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const i=[],a=[];if(null!=n){const t=n.length;if(t%2>0)throw new oV("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,i.push(...n);const r=n.map(t=>new eU({shape:t.shape}));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),a.push(...r)}if(null!=r)throw new lV("Support for constants in Bidirectional layers is not implemented yet.");const o=i[0]instanceof nU;for(const l of i)if(l instanceof nU!==o)throw new oV("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){const n=[t].concat(i),r=this.inputSpec.concat(a),s=this.inputSpec;this.inputSpec=r;const o=super.apply(n,e);return this.inputSpec=s,o}return super.apply(t,e)}call(t,e){return yO(()=>{const n=e.initialState;let r,s,i,a;if(null==n)r=this.forwardLayer.call(t,e),s=this.backwardLayer.call(t,e);else{const i=n.slice(0,n.length/2),a=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:i})),s=this.backwardLayer.call(t,Object.assign(e,{initialState:a}))}return this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(s.slice(1))),r=r[0],s=s[0]),this.returnSequences&&(s=lF(s,1)),"concat"===this.mergeMode?a=cW([r,s]):"sum"===this.mergeMode?a=CO(r,s):"ave"===this.mergeMode?a=ID(.5,CO(r,s)):"mul"===this.mergeMode?a=ID(r,s):null==this.mergeMode&&(a=[r,s]),this.returnState?null==this.mergeMode?a.concat(i):[a].concat(i):a})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){XV(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),XV(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map(t=>null);return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=wU(e.layer);if(delete e.layer,null!=e.numConstants)throw new lV("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=n,new t(r)}}function _q(t,e,n=new Map,r=new Set){if(null==t)return null;if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const s=e(t);if(s.recurse&&null!==s.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(s.recurse){if(Cq(t)){const s=Array.isArray(t)?[]:{};r.add(t);for(const i in t){const a=_q(t[i],e,n,r);s[i]=a}return r.delete(t),s}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,s.value),s.value}function xq(t,e=Sq){return kq(t,e)}function kq(t,e,n=new Set){const r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");const s=e(t);if(s.recurse&&null!==s.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(s.recurse){if(Cq(r)){const s=Array.isArray(r)?[]:{};n.add(r);for(const i in r){const r=kq(t.map(t=>t[i]),e,n);s[i]=r}return n.delete(r),s}throw new Error("Can't recurse into non-iterable type: "+r)}return s.value}function Sq(t){return null===t?null:Cq(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function Cq(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof rA))}function Iq(t){return _q(t,Eq)}function Eq(t){return t instanceof rA?{value:t.clone(),recurse:!1}:Cq(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}wq.className="Bidirectional",u.registerClass(wq);class Tq{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}class Nq extends Tq{constructor(){super(Nq.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}Nq.INITIAL_CAPACITY=32;class Aq{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new zq(this,t)}filter(t){return new Lq(this,t)}map(t){return new Pq(this,t)}mapAsync(t){return new Bq(this,t)}serialMapAsync(t){return new Bq(this,t).serial()}flatmap(t){return new Wq(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(t=>!0===t)}rowMajorBatch(t,e=!0){return new Mq(this,t,e)}columnMajorBatch(t,e=!0,n=Sq){return this.rowMajorBatch(t,e).map(t=>xq(t,n))}concatenate(t,e){return new Uq(new Rq([this,t]),e)}take(t){return t<0||null==t?this:new $q(this,t)}skip(t){return t<0||null==t?this:new Fq(this,t)}prefetch(t){return new jq(this,t)}shuffle(t,e){return new Hq(this,t,e)}serial(){return new Dq(this)}}class Rq extends Aq{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:Iq(t),done:!1}}}class Oq extends Aq{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}}}class Dq extends Aq{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Serial"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class Fq extends Aq{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Skip"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;bO(t.value)}return this.upstream.next()}}class $q extends Aq{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return this.upstream.summary()+" -> Take"}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class Mq extends Aq{constructor(t,e,n=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> RowMajorBatch"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class Lq extends Aq{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Filter"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;bO(t.value)}}}class Pq extends Aq{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Map"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=s.getTensorsInContainer(t.value),n=this.transform(t.value),r=s.getTensorsInContainer(n);for(const i of e)s.isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}}class zq extends Aq{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> handleErrors"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class Bq extends Aq{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> AsyncMap"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=s.getTensorsInContainer(t.value),n=await this.transform(t.value),r=s.getTensorsInContainer(n);for(const i of e)s.isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}}class Vq extends Aq{constructor(){super(),this.outputQueue=new Nq,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!(await this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class Wq extends Vq{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Flatmap"}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=s.getTensorsInContainer(t.value),n=this.transform(t.value),r=s.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const i of e)s.isTensorInList(i,r)||i.dispose();return!0}}class Uq extends Aq{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(CH||(CH={}));class jq extends Aq{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new Tq(e)}summary(){return this.upstream.summary()+" -> Prefetch"}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class Hq extends jq{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=nF.alea(n||r.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}class qq{constructor(){this.size=null}batch(t,e=!0){const n=this;let s;return r.assert(t>0,()=>"batchSize needs to be positive, but it is\n      "+t),s=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),Gq(async()=>(await n.iterator()).columnMajorBatch(t,e,Kq),s)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,Gq(async()=>(await e.iterator()).concatenate(await t.iterator()),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,Gq(async()=>(await e.iterator()).filter(e=>yO(()=>t(e))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return Gq(async()=>(await e.iterator()).map(e=>yO(()=>t(e))),this.size)}mapAsync(t){const e=this;return Gq(async()=>(await e.iterator()).mapAsync(t),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return Gq(async()=>(await e.iterator()).prefetch(t),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,Gq(async()=>{return n=(r=async()=>({value:await e.iterator(),done:!1}),new Oq(r)).take(t),new Uq(n,undefined);var n,r},n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,Gq(async()=>(await e.iterator()).skip(t),n)}shuffle(t,e,n=!0){if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const s=this,i=nF.alea(e||r.now().toString());return Gq(async()=>{let e=i.int32();return n&&(e+=i.int32()),(await s.iterator()).shuffle(t,e.toString())},this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,Gq(async()=>(await e.iterator()).take(t),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function Gq(t,e=null){return new class extends qq{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function Kq(t){return null===t?null:null==(e=t[0])||null===(n=e)||"object"!=typeof n&&"function"!=typeof n||Array.isArray(e)||"object"==typeof e&&e instanceof rA||r.isTypedArray(e)?{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof rA?xF(t):FA(t)}(t),recurse:!1}:{value:null,recurse:!0};var e,n}function Xq(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&r.assert("complex64"!==t.dtype,()=>e+" does not support complex64 tensors in the CPU backend.")})}qq.MAX_BUFFER_SIZE=1e4,Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");const Yq=p.whereImpl;class Zq extends zC{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new PC(this,mO())}write(t,e,n){this.firstUse&&(this.firstUse=!1,FI().get("IS_NODE")&&d.warn("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));const r={};return this.data.set(r,{values:t,dtype:n,refCount:1}),r}makeTensorInfo(t,e,n){let s;if("string"===e&&null!=n&&n.length>0&&r.isString(n[0])){const i=n.map(t=>r.encodeString(t));s=this.write(i,t,e)}else s=this.write(n,t,e);return{dataId:s,shape:t,dtype:e}}incRef(t){this.data.get(t).refCount++}decRef(t){this.data.has(t)&&this.data.get(t).refCount--}move(t,e,n,r){this.data.set(t,{values:e,dtype:r,refCount:1})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return d.mergeRealAndImagArrays(t,e)}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map(t=>r.decodeString(t))}catch(xrt){throw new Error("Failed to decode encoded string bytes into utf-8")}return IR(t.shape,t.dtype,n)}makeOutput(t,e,n){const r=this.write(t,e,n);return mO().makeTensorFromDataId(r,e,n,this)}disposeData(t){if(this.data.has(t)){const{complexTensorInfos:e}=this.data.get(t);null!=e&&(this.disposeData(e.real.dataId),this.disposeData(e.imag.dataId)),this.data.delete(t)}}disposeIntermediateTensorInfo(t){const e=t.dataId;if(this.data.has(e)){const t=this.data.get(e);t.refCount--,t.refCount<1&&this.disposeData(e)}}async time(t){const e=r.now();return t(),{kernelMs:r.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Xq([t],"where");const e=this.readSync(t.dataId);return Yq(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}function Qq(t,e,n){return({inputs:s,attrs:i,backend:a})=>{const{x:o}=s;if(Xq(o,t),"string"===o.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const l=a,u=l.data.get(o.dataId).values,c=r.sizeFromShape(o.shape),h=n||o.dtype,d=r.getArrayFromDType(h,c);for(let t=0;t<c;++t)d[t]=e(u[t],i);return l.makeTensorInfo(o.shape,h,d)}}function Jq(t,e,n){return({inputs:r,attrs:s,backend:i})=>{const{x:a}=r;if(Xq(a,t),"string"===a.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const o=i,l=o.data.get(a.dataId).values,u=n||a.dtype,c=e(l,u,s);return o.makeTensorInfo(a.shape,u,c)}}wO("cpu",()=>new Zq,1);const tG=Qq(OE,t=>t>=0?t:Math.exp(t)-1),eG={kernelName:OE,backendName:"cpu",kernelFunc:tG};function nG(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const rG={kernelName:XE,backendName:"cpu",kernelFunc:nG};function sG(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{alpha:a}=s;Xq([i],"leakyRelu");const o=r.sizeFromShape(i.shape),l=n.data.get(i.dataId).values,u=r.getTypedArrayFromDType("float32",o);for(let r=0;r<l.length;r++)u[r]=l[r]<0?a*l[r]:l[r];return n.makeTensorInfo(i.shape,"float32",u)}const iG={kernelName:eT,backendName:"cpu",kernelFunc:sG};function aG(t){return(e,n,s,i,a)=>{const o=d.assertAndGetBroadcastShape(e,n),l=o.length,u=r.computeStrides(o),c=r.sizeFromShape(o),h=r.getTypedArrayFromDType(a,c),p=e.length,f=n.length,m=r.computeStrides(e),g=r.computeStrides(n),y=d.getBroadcastDims(e,o),b=d.getBroadcastDims(n,o);if(y.length+b.length===0)for(let r=0;r<h.length;++r)h[r]=t(s[r%s.length],i[r%i.length]);else for(let d=0;d<h.length;++d){const e=r.indexToLoc(d,l,u),n=e.slice(-p);y.forEach(t=>n[t]=0);const a=r.locToIndex(n,p,m),o=e.slice(-f);b.forEach(t=>o[t]=0);const c=r.locToIndex(o,f,g);h[d]=t(s[a],i[c])}return[h,o]}}const oG=aG((t,e)=>t<0?e*t:t);function lG(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;Xq([r,s],"prelu");const i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,[o,l]=oG(r.shape,s.shape,i,a,r.dtype);return n.makeTensorInfo(l,r.dtype,o)}const uG={kernelName:MT,backendName:"cpu",kernelFunc:lG},cG=Qq(VT,t=>Math.max(0,t)),hG={kernelName:VT,backendName:"cpu",kernelFunc:cG},dG=Qq(GT,t=>Math.min(Math.max(0,t),6)),pG={kernelName:GT,backendName:"cpu",kernelFunc:dG};function fG(t,e,n,r,s){if("linear"===n)return nG({inputs:{x:e},backend:t});if("relu"===n)return cG({inputs:{x:e},backend:t});if("elu"===n)return tG({inputs:{x:e},backend:t});if("relu6"===n)return dG({inputs:{x:e},backend:t});if("prelu"===n)return lG({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return sG({inputs:{x:e},backend:t,attrs:{alpha:s}});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function mG(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,o=n.makeTensorInfo(r.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(s.shape,"float32",a)},o}const gG={kernelName:uE,backendName:"cpu",kernelFunc:mG};function yG(t,e,n="float32"){if("complex64"===n)return mG({inputs:{real:yG(t,e,"float32"),imag:yG(t,e,"float32")},backend:t});const s=r.makeZerosTypedArray(r.sizeFromShape(e),n);return t.makeTensorInfo(e,n,s)}function bG(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const vG={kernelName:zT,backendName:"cpu",kernelFunc:bG};function wG(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{dtype:a}=s;if("complex64"===a){if("complex64"===i.dtype)return nG({inputs:{x:i},backend:n});const t=yG(n,i.shape,i.dtype),e=wG({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=mG({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===i.dtype){const t=bG({inputs:{input:i},backend:n}),e=wG({inputs:{x:t},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(t),e}if(!r.hasEncodingLoss(i.dtype,a)){const t=nG({inputs:{x:i},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:a}}if("int32"===a){const t=n.data.get(i.dataId).values,e=Int32Array.from(t);return n.makeTensorInfo(i.shape,"int32",e)}if("bool"===a){const t=n.data.get(i.dataId).values,e=r.toTypedArray([0],i.dtype),[s,a]=aG((t,e)=>t!==e?1:0)(i.shape,[],t,e,"bool");return n.makeTensorInfo(a,"bool",s)}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${a}`)}const _G={kernelName:aE,backendName:"cpu",kernelFunc:wG};function xG(t,e,n,r){return null==n?({inputs:n,backend:s})=>{const{a:i,b:a}=n,o=s;Xq([i,a],t);const l=o.data.get(i.dataId).values,u=o.data.get(a.dataId).values,c=r||i.dtype,[h,d]=e(i.shape,a.shape,l,u,c);return o.makeTensorInfo(d,c,h)}:({inputs:t,backend:s})=>{const{a:i,b:a}=t,o=s;if("complex64"===i.dtype||"complex64"===a.dtype){const t=wG({inputs:{x:i},backend:o,attrs:{dtype:"complex64"}}),e=o.data.get(t.dataId),r=e.complexTensorInfos.imag,s=o.data.get(e.complexTensorInfos.real.dataId).values,l=o.data.get(r.dataId).values,u=wG({inputs:{x:a},backend:o,attrs:{dtype:"complex64"}}),c=o.data.get(u.dataId),h=c.complexTensorInfos.imag,d=o.data.get(c.complexTensorInfos.real.dataId).values,p=o.data.get(h.dataId).values,[f,m,g]=n(i.shape,a.shape,s,l,d,p),y=o.makeTensorInfo(g,"float32",f),b=o.makeTensorInfo(g,"float32",m),v=mG({inputs:{real:y,imag:b},backend:o});return o.disposeIntermediateTensorInfo(t),o.disposeIntermediateTensorInfo(u),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(b),v}{const t=o.data.get(i.dataId).values,n=o.data.get(a.dataId).values,s=r||i.dtype,[l,u]=e(i.shape,a.shape,t,n,s);return o.makeTensorInfo(u,s,l)}}}function kG(t){return(e,n,s,i,a,o)=>{const l=d.assertAndGetBroadcastShape(e,n),u=r.sizeFromShape(l),c=l.length,h=r.computeStrides(l),p=r.getTypedArrayFromDType("float32",u),f=r.getTypedArrayFromDType("float32",u),m=d.getBroadcastDims(e,l),g=d.getBroadcastDims(n,l),y=d.mergeRealAndImagArrays(s,i),b=d.mergeRealAndImagArrays(a,o),v=e.length,w=r.computeStrides(e),_=n.length,x=r.computeStrides(n);if(m.length+g.length===0)for(let r=0;r<p.length;r++){const e=r%y.length,n=r%b.length,s=t(y[2*e],y[2*e+1],b[2*n],b[2*n+1]);p[r]=s.real,f[r]=s.imag}else for(let d=0;d<p.length;d++){const e=r.indexToLoc(d,c,h),n=e.slice(-v);m.forEach(t=>n[t]=0);const s=r.locToIndex(n,v,w),i=e.slice(-_);g.forEach(t=>i[t]=0);const a=r.locToIndex(i,_,x),o=t(y[2*s],y[2*s+1],b[2*a],b[2*a+1]);p[d]=o.real,f[d]=o.imag}return[p,f,l]}}const SG=aG((t,e)=>t+e),CG=kG((t,e,n,r)=>({real:t+n,imag:e+r})),IG=xG(WI,SG,CG),EG={kernelName:WI,backendName:"cpu",kernelFunc:IG};function TG(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{shape:a}=s,o=r.sizeFromShape(i.shape),l=r.inferFromImplicitShape(a,o),u=r.sizeFromShape(l);r.assert(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const c=n.data.get(i.dataId);if(null!=c.complexTensorInfos){const t=c.complexTensorInfos.imag;c.complexTensorInfos.real.shape=l,t.shape=l}return{dataId:i.dataId,shape:l,dtype:i.dtype}}const NG={kernelName:WT,backendName:"cpu",kernelFunc:TG};function AG(t){const{inputs:e,backend:n,attrs:s}=t,{a:i,b:a}=e,{transposeA:o,transposeB:l}=s;Xq([i,a],"matMul");const u=i.shape.length,c=a.shape.length,h=o?i.shape[u-2]:i.shape[u-1],d=l?a.shape[c-1]:a.shape[c-2],p=o?i.shape[u-1]:i.shape[u-2],f=l?a.shape[c-2]:a.shape[c-1],m=i.shape.slice(0,-2),g=a.shape.slice(0,-2),y=r.sizeFromShape(m),b=r.sizeFromShape(g);r.assert(u>=2&&c>=2&&(y===b||1===y||1===b),()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${m}) and (${g}).`);const v=(y>b?i.shape.slice(0,-2):a.shape.slice(0,-2)).concat([p,f]);r.assert(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${i.shape} and ${a.shape} and transposeA=${o} and transposeB=${l} must match.`);const w=l?[b,f,d]:[b,d,f],_=TG({inputs:{x:i},backend:n,attrs:{shape:o?[y,h,p]:[y,p,h]}}),x=TG({inputs:{x:a},backend:n,attrs:{shape:w}}),k=o?_.shape[1]:_.shape[2],S=o?_.shape[2]:_.shape[1],C=l?x.shape[1]:x.shape[2],I=Math.max(y,b),E=n.data.get(_.dataId).values,T=n.data.get(x.dataId).values,N=r.computeStrides(_.shape),A=r.computeStrides(x.shape),[R,O,D]=o?[N[0],1,N[1]]:[N[0],N[1],1],[F,$,M]=l?[1,A[1],A[0]]:[A[1],1,A[0]],L=S*C,P=IR([I,S,C],_.dtype),z=P.values,B=n.blockSize;for(let r=0;r<I;r++)for(let t=0;t<S;t+=B)for(let e=0;e<C;e+=B)for(let n=0;n<k;n+=B){const s=Math.min(t+B,S),i=Math.min(e+B,C),a=Math.min(n+B,k);for(let o=t;o<s;o++)for(let t=e;t<i;t++){let e=0;for(let s=n;s<a;s++){const n=Math.min(r,y-1)*R,i=Math.min(r,b-1)*M;e+=E[n+o*O+s*D]*T[s*F+t*$+i]}z[r*L+(o*C+t)]+=e}}return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(x),n.makeTensorInfo(v,P.dtype,P.values)}const RG={kernelName:rE,backendName:"cpu",kernelFunc:AG},OG={kernelName:TN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;let d,p,f;const m=[];d=AG({inputs:{a:s,b:i},attrs:{transposeA:l,transposeB:u},backend:n}),a&&(p=IG({inputs:{a:d,b:a},backend:n}),m.push(d),d=p),c&&(f=fG(n,d,c,o,h),m.push(d),d=f);for(const g of m)n.disposeIntermediateTensorInfo(g);return d}};function DG(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const FG={kernelName:zI,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;Xq(e,"abs");let s=new Float32Array(r.sizeFromShape(e.shape));return s=DG(n.data.get(e.dataId).values),n.makeOutput(s,e.shape,"float32")}},$G=Qq(BI,t=>Math.acos(t)),MG={kernelName:BI,backendName:"cpu",kernelFunc:$G},LG=Qq(VI,t=>Math.acosh(t)),PG={kernelName:VI,backendName:"cpu",kernelFunc:LG},zG={kernelName:UI,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,r=e;Xq(e,"addN");const s=r.map(t=>n.data.get(t.dataId).values),i=IR(r[0].shape,r[0].dtype),a=i.values;for(let o=0;o<r.length;o++){const t=s[o];for(let e=0;e<a.length;e++)a[e]+=t[e]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function BG(t,e,n,s,i){const a=e.length,o=r.sizeFromShape(e),l=r.computeStrides(e),u=r.computeStrides(i),c=r.getTypedArrayFromDType(n,r.sizeFromShape(i));for(let h=0;h<o;++h){const e=r.indexToLoc(h,a,l),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[s[t]];c[r.locToIndex(n,a,u)]=t[h]}return c}function VG(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:i}=n;Xq(s,"transpose");const a=new Array(s.shape.length);for(let l=0;l<a.length;l++)a[l]=s.shape[i[l]];const o=BG(r.data.get(s.dataId).values,s.shape,s.dtype,i,a);return{dataId:r.write(o,a,s.dtype),shape:a,dtype:s.dtype}}const WG={kernelName:wN,backendName:"cpu",kernelFunc:VG},UG={kernelName:jI,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s;Xq(i,"all");const l=r.parseAxisParam(a,i.shape);let u=l;const c=d.getAxesPermutation(u,i.shape.length);let h=i;null!=c&&(h=VG({inputs:{x:i},backend:n,attrs:{perm:c}}),u=d.getInnerMostAxes(u.length,i.shape.length)),d.assertAxesAreInnerMostDims("all",u,h.shape.length);const[p,f]=d.computeOutAndReduceShapes(h.shape,u),m=r.sizeFromShape(f),g=r.makeZerosTypedArray(r.sizeFromShape(p),h.dtype),y=n.data.get(h.dataId).values;for(let r=0;r<g.length;++r){const t=r*m;let e=y[t];for(let n=0;n<m;++n){const r=y[t+n];e=e&&r}g[r]=e}null!=c&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(p,h.dtype,g);if(o){const t=TG({inputs:{x:b},backend:n,attrs:{shape:d.expandShapeToKeepDim(p,l)}});return n.disposeIntermediateTensorInfo(b),t}return b}},jG={kernelName:HI,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s;Xq(i,"any");const l=r.parseAxisParam(a,i.shape);let u=l;const c=d.getAxesPermutation(u,i.shape.length);let h=i;null!=c&&(h=VG({inputs:{x:i},backend:n,attrs:{perm:c}}),u=d.getInnerMostAxes(u.length,i.shape.length)),d.assertAxesAreInnerMostDims("any",u,h.shape.length);const[p,f]=d.computeOutAndReduceShapes(h.shape,u),m=r.sizeFromShape(f),g=r.makeZerosTypedArray(r.sizeFromShape(p),h.dtype),y=n.data.get(h.dataId).values;for(let r=0;r<g.length;++r){const t=r*m;let e=y[t];for(let n=0;n<m;++n){const r=y[t+n];e=e||r}g[r]=e}null!=c&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(p,h.dtype,g);if(o){const t=TG({inputs:{x:b},backend:n,attrs:{shape:d.expandShapeToKeepDim(p,l)}});return n.disposeIntermediateTensorInfo(b),t}return b}},HG={kernelName:qI,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a}=s;Xq(i,"argMax");let o=r.parseAxisParam(a,i.shape);const l=d.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=l&&(u=VG({inputs:{x:i},backend:n,attrs:{perm:l}}),c.push(u),o=d.getInnerMostAxes(o.length,u.shape.length)),o=[o[0]],d.assertAxesAreInnerMostDims("argMax",o,u.shape.length);const[h,p]=d.computeOutAndReduceShapes(u.shape,o),f=r.sizeFromShape(h),m=r.makeZerosTypedArray(f,"int32"),g=r.sizeFromShape(p),y=n.data.get(u.dataId).values;for(let r=0;r<m.length;++r){const t=r*g;let e=y[t],n=0;for(let r=0;r<g;++r){const s=y[t+r];s>e&&(e=s,n=r)}m[r]=n}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(h,"int32",m)}},qG={kernelName:GI,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a}=s;Xq(i,"argMin");let o=r.parseAxisParam(a,i.shape);const l=d.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=l&&(u=VG({inputs:{x:i},backend:n,attrs:{perm:l}}),c.push(u),o=d.getInnerMostAxes(o.length,u.shape.length)),o=[o[0]],d.assertAxesAreInnerMostDims("argMin",o,u.shape.length);const[h,p]=d.computeOutAndReduceShapes(u.shape,o),f=r.sizeFromShape(h),m=r.makeZerosTypedArray(f,"int32"),g=r.sizeFromShape(p),y=n.data.get(u.dataId).values;for(let r=0;r<m.length;++r){const t=r*g;let e=y[t],n=0;for(let r=0;r<g;++r){const s=y[t+r];s<e&&(e=s,n=r)}m[r]=n}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(h,"int32",m)}},GG=Qq(KI,t=>Math.asin(t)),KG={kernelName:KI,backendName:"cpu",kernelFunc:GG},XG=Qq(XI,t=>Math.asinh(t)),YG={kernelName:XI,backendName:"cpu",kernelFunc:XG},ZG=Qq(YI,t=>Math.atan(t)),QG={kernelName:YI,backendName:"cpu",kernelFunc:ZG},JG=aG((t,e)=>Math.atan2(t,e)),tK=xG(QI,JG),eK={kernelName:QI,backendName:"cpu",kernelFunc:tK},nK=Qq(ZI,t=>Math.atanh(t)),rK={kernelName:ZI,backendName:"cpu",kernelFunc:nK};function sK(t,e,n,r,s,i){const a=s.strideHeight,o=s.strideWidth,l=s.dilationHeight,u=s.dilationWidth,c=s.effectiveFilterHeight,h=s.effectiveFilterWidth,d=s.padInfo.top,p=s.padInfo.left,f="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=IR(s.outShape,n),g=m.values,y=s.outShape[1]*s.outShape[2]*s.outShape[3],b=s.outShape[2]*s.outShape[3],v=s.outShape[3];for(let w=0;w<s.batchSize;++w){const e=w*y,n=w*r[0];for(let m=0;m<s.inChannels;++m)for(let y=0;y<s.outHeight;++y){const w=y*a-d,_=Math.max(0,w),x=Math.min(s.inHeight,c+w),k=e+y*b;for(let e=0;e<s.outWidth;++e){const a=e*o-p,c=Math.max(0,a),d=Math.min(s.inWidth,h+a);let y=f,b=0,w=0;for(let e=_;e<x;e+=l){const s=n+e*r[1];for(let e=c;e<d;e+=u){const n=t[s+e*r[2]+m];"max"===i&&n>y?y=n:"avg"===i&&(b+=n,w++)}if(isNaN(y))break}g[k+e*v+m]="avg"===i?b/w:y}}}return m}function iK(t,e,n,r,s=!1,i=!1){const a=IR(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,m=IR(e,n,t);for(let g=0;g<r.batchSize;++g)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.outHeight;++e){const n=e*o-p;let y=n;for(;y<0;)y+=u;const b=Math.min(r.inHeight,h+n);for(let o=0;o<r.outWidth;++o){const h=o*l-f;let p=h;for(;p<0;)p+=c;const v=Math.min(r.inWidth,d+h);let w=Number.NEGATIVE_INFINITY,_=-1;for(let e=y;e<b;e+=u){const a=e-n;for(let n=p;n<v;n+=c){const o=n-h,l=m.get(g,e,n,t);l>w&&(w=l,_=s?i?((g*r.inHeight+e)*r.inWidth+n)*r.inChannels+t:(e*r.inWidth+n)*r.inChannels+t:a*d+o)}}a.set(_,g,e,o,t)}}return a}function aK(t,e,n,r,s,i){const a=s.strideDepth,o=s.strideHeight,l=s.strideWidth,u=s.dilationDepth,c=s.dilationHeight,h=s.dilationWidth,d=s.effectiveFilterDepth,p=s.effectiveFilterHeight,f=s.effectiveFilterWidth,m=s.padInfo.front,g=s.padInfo.top,y=s.padInfo.left,b="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=IR(s.outShape,n),w=v.values,_=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],x=s.outShape[2]*s.outShape[3]*s.outShape[4],k=s.outShape[3]*s.outShape[4],S=s.outShape[4];for(let C=0;C<s.batchSize;++C){const e=C*_,n=C*r[0];for(let v=0;v<s.inChannels;++v)for(let _=0;_<s.outDepth;++_){const C=_*a-m;let I=C;for(;I<0;)I+=u;const E=Math.min(s.inDepth,d+C),T=e+_*x;for(let e=0;e<s.outHeight;++e){const a=e*o-g;let d=a;for(;d<0;)d+=c;const m=Math.min(s.inHeight,p+a),_=T+e*k;for(let e=0;e<s.outWidth;++e){const a=e*l-y;let o=a;for(;o<0;)o+=h;const p=Math.min(s.inWidth,f+a),g=_+e*S;let x=b,k=0,C=0;for(let e=I;e<E;e+=u){const s=n+e*r[1];for(let e=d;e<m;e+=c){const n=s+e*r[2];for(let e=o;e<p;e+=h){const s=t[n+e*r[3]+v];if("max"===i&&s>x?x=s:"avg"===i&&(k+=s,C++),isNaN(x))break}if(isNaN(x))break}if(isNaN(x))break}w[g+v]="avg"===i?k/C:x}}}}return v}const oK={kernelName:JI,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e;Xq(i,"avgPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=s;r.assert(d.eitherStridesOrDilationsAreOne(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.computePool2DInfo(i.shape,a,o,1,l,u);let h;if(1===c.filterWidth&&1===c.filterHeight&&r.arraysEqual(c.inShape,c.outShape))h=nG({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=r.computeStrides(i.shape),s=sK(t,0,i.dtype,e,c,"avg");h=n.makeTensorInfo(c.outShape,i.dtype,s.values)}return h}},lK={kernelName:eE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:u,dataFormat:c,dilations:h}=s;Xq(i,"avgPool3d");let p=h;null==p&&(p=[1,1,1]);const f=d.computePool3DInfo(i.shape,a,o,p,l,u,c),m=aK(n.data.get(i.dataId).values,0,i.dtype,r.computeStrides(i.shape),f,"avg");return n.makeTensorInfo(m.shape,"float32",m.values)}},uK={kernelName:nE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:a,strides:o,pad:l,dilations:u,dimRoundingMode:c}=r;Xq([s,i],"avgPool3DGrad");const h=d.computePool3DInfo(i.shape,a,o,u,l,c),p=h.strideDepth,f=h.strideHeight,m=h.strideWidth,g=h.filterDepth,y=h.filterHeight,b=h.filterWidth,v=h.dilationDepth,w=h.dilationHeight,_=h.dilationWidth,x=h.effectiveFilterDepth,k=h.effectiveFilterHeight,S=h.effectiveFilterWidth,C=x-1-h.padInfo.front,I=S-1-h.padInfo.left,E=k-1-h.padInfo.top,T=IR(i.shape,"float32"),N=1/(g*y*b),A=n.bufferSync(s);for(let d=0;d<h.batchSize;++d)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let r=0;r<h.inWidth;++r){const s=e-C,i=n-E,a=r-I;let o=0;for(let e=0;e<x;e+=v){const n=(s+e)/p;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let e=0;e<k;e+=w){const r=(i+e)/f;if(!(r<0||r>=h.outHeight||Math.floor(r)!==r))for(let e=0;e<S;e+=_){const s=(a+e)/m;s<0||s>=h.outWidth||Math.floor(s)!==s||(o+=A.get(d,n,r,s,t))}}}T.set(o*N,d,e,n,r,t)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}},cK={kernelName:tE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,a=i;Xq([s,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=d.computePool2DInfo(a.shape,o,l,1,u),h=c.strideHeight,p=c.strideWidth,f=c.filterHeight,m=c.filterWidth,g=c.dilationHeight,y=c.dilationWidth,b=c.effectiveFilterHeight,v=c.effectiveFilterWidth,w=v-1-c.padInfo.left,_=b-1-c.padInfo.top,x=IR(a.shape,"float32"),k=1/(f*m),S=n.data.get(s.dataId).values,C=IR(s.shape,"float32",S);for(let d=0;d<c.batchSize;++d)for(let t=0;t<c.inChannels;++t)for(let e=0;e<c.inHeight;++e)for(let n=0;n<c.inWidth;++n){const r=e-_,s=n-w;let i=0;for(let e=0;e<b;e+=g){const n=(r+e)/h;if(!(n<0||n>=c.outHeight||Math.floor(n)!==n))for(let e=0;e<v;e+=y){const r=(s+e)/p;r<0||r>=c.outWidth||Math.floor(r)!==r||(i+=C.get(d,n,r,t))}}x.set(i*k,d,e,n,t)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}},hK={kernelName:jE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,scale:a,offset:o,mean:l,variance:u}=e;r.assert(l.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),r.assert(null==o||l.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),r.assert(null==a||l.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Xq([i,l,u,a,o],"batchNorm");let{varianceEpsilon:c}=s;null==c&&(c=.001);const h=n.data.get(i.dataId).values,d=n.data.get(l.dataId).values,p=n.data.get(u.dataId).values,f=a?n.data.get(a.dataId).values:new Float32Array([1]),m=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(h.length),y=m.length,b=f.length,v=p.length,w=d.length;let _=0,x=0,k=0,S=0;for(let r=0;r<h.length;++r)g[r]=m[_++]+(h[r]-d[x++])*f[k++]/Math.sqrt(p[S++]+c),_>=y&&(_=0),x>=w&&(x=0),k>=b&&(k=0),S>=v&&(S=0);return n.makeTensorInfo(i.shape,i.dtype,g)}};function dK(t,e,n,s,i){const a=l.isSliceContinous(s,e,n),o=r.sizeFromShape(n),u=r.computeStrides(s);if(a){const n=l.computeFlatOffset(e,u);return"string"===i?t.slice(n,n+o):t.subarray(n,n+o)}const c=IR(s,i,"string"===i?d.fromUint8ToStringArray(t):t),h=IR(n,i);for(let r=0;r<h.size;++r){const t=h.indexToLoc(r),n=t.map((t,n)=>t+e[n]);h.set(c.get(...n),...t)}return"string"===i?d.fromStringArrayToUint8(h.values):h.values}function pK(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:a}=r;Xq(s,"slice");const[o,u]=l.parseSliceParams(s,i,a);l.assertParamsValid(s,o,u);const c=dK(n.data.get(s.dataId).values,o,u,s.shape,s.dtype);return n.makeTensorInfo(u,s.dtype,c)}const fK={kernelName:tN,backendName:"cpu",kernelFunc:pK},mK={kernelName:sE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:a}=r;Xq([s],"batchToSpaceND");const o=i.reduce((t,e)=>t*e),l=d.getReshaped(s.shape,i,o),u=d.getPermuted(l.length,i.length),c=d.getReshapedPermuted(s.shape,i,o),h=d.getSliceBeginCoords(a,i.length),p=d.getSliceSize(c,a,i.length),f=TG({inputs:{x:s},backend:n,attrs:{shape:l}}),m=VG({inputs:{x:f},backend:n,attrs:{perm:u}}),g=TG({inputs:{x:m},backend:n,attrs:{shape:c}}),y=pK({inputs:{x:g},backend:n,attrs:{begin:h,size:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}};function gK(t,e,n,s,i){const a=r.sizeFromShape(s),o=r.makeZerosTypedArray(i,n);for(let r=0;r<t.length;r++){const n=t[r];if(n<0)throw new Error("Input x must be non-negative!");n>=i||(o[n]+=a>0?e[r]:1)}return o}function yK(t,e,n,r=!1){const s=t.shape[0],i=t.shape[1],a=IR([s,n],e.dtype);for(let o=0;o<s;o++)for(let s=0;s<i;s++){const i=t.get(o,s);if(i<0)throw new Error("Input x must be non-negative!");i>=n||a.set(r?1:e.size>0?a.get(o,i)+e.get(o,s):a.get(o,i)+1,o,i)}return a}const bK={kernelName:iE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:a}=r,o=gK(n.data.get(s.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,a);return n.makeTensorInfo([a],i.dtype,o)}};function vK(t){return(e,n,s)=>{const i=r.getTypedArrayFromDType(n,e.length);for(let r=0;r<e.length;++r)i[r]=t(e[r],s);return i}}const wK=vK(t=>Math.ceil(t)),_K=Jq(oE,wK),xK={kernelName:oE,backendName:"cpu",kernelFunc:_K},kK=Qq(lE,(t,e)=>t>e.clipValueMax?e.clipValueMax:t<e.clipValueMin?e.clipValueMin:t),SK={kernelName:lE,backendName:"cpu",kernelFunc:kK},CK={kernelName:cE,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(r.sizeFromShape(e.shape)),i=n.data.get(e.dataId),a=i.complexTensorInfos.imag,o=n.data.get(i.complexTensorInfos.real.dataId).values,l=n.data.get(a.dataId).values;for(let r=0;r<o.length;r++)s[r]=Math.hypot(o[r],l[r]);return n.makeOutput(s,e.shape,"float32")}};function IK(t,e,n,s){const i=r.getArrayFromDType(n,r.sizeFromShape(e));if(s&&"string"!==n){let e=0;t.forEach(t=>{const n=r.sizeFromShape(t.shape);i.set(t.vals,e),e+=n})}else{let r=0;t.forEach(t=>{const s="string"===n?d.fromUint8ToStringArray(t.vals):t.vals;let a=0;for(let n=0;n<t.shape[0];++n){const o=n*e[1]+r;for(let e=0;e<t.shape[1];++e)i[o+e]=s[a++]}r+=t.shape[1]})}return i}function EK(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const TK={kernelName:ZE,backendName:"cpu",kernelFunc:EK};function NK(t){const{inputs:e,backend:n,attrs:s}=t,{axis:i}=s,a=r.parseAxisParam(i,e[0].shape)[0];let o=d.computeOutShape(e.map(t=>t.shape),a);if(0===r.sizeFromShape(o))return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(t=>r.sizeFromShape(t.shape)>0);if(1===l.length)return nG({inputs:{x:l[0]},backend:n});const u=l.map(t=>t.shape);if(d.assertParamsConsistent(u,a),"complex64"===l[0].dtype){const t=l.map(t=>bG({inputs:{input:t},backend:n})),e=l.map(t=>EK({inputs:{input:t},backend:n})),r=NK({inputs:t,backend:n,attrs:{axis:a}}),s=NK({inputs:e,backend:n,attrs:{axis:a}}),i=mG({inputs:{real:r,imag:s},backend:n});return t.forEach(t=>n.disposeIntermediateTensorInfo(t)),e.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),i}const c=l.map(t=>{const e=r.sizeFromShape(t.shape.slice(a));return TG({inputs:{x:t},backend:n,attrs:{shape:[-1,e]}})}),h=c.map(t=>({vals:n.data.get(t.dataId).values,shape:t.shape}));o=d.computeOutShape(c.map(t=>t.shape),1);const p=IK(h,o,e[0].dtype,1===c[0].shape[0]),f=d.computeOutShape(l.map(t=>t.shape),a),m=n.makeTensorInfo(f,e[0].dtype,p);return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),m}const AK={kernelName:hE,backendName:"cpu",kernelFunc:NK};function RK(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,filter:a}=e,{strides:o,pad:l,dataFormat:u,dilations:c,dimRoundingMode:h}=s;Xq([i,a],"conv2d");const p=d.convertConv2DDataFormat(u),f=d.computeConv2DInfo(i.shape,a.shape,o,c,l,h,!1,p),m=f.filterHeight,g=f.filterWidth,y=f.dilationHeight,b=f.dilationWidth,v=f.padInfo.left,w=f.padInfo.top,_="channelsLast"===f.dataFormat,x=new JN(f.outShape,i.dtype),k=r.computeStrides(i.shape),S=r.computeStrides(a.shape),C=k[0],I=_?k[1]:k[2],E=_?k[2]:1,T=_?1:k[1],N=x.strides[0],A=_?x.strides[1]:x.strides[2],R=_?x.strides[2]:1,O=_?1:x.strides[1],D=n.data.get(i.dataId).values,F=n.data.get(a.dataId).values,$=x.values;for(let r=0;r<f.batchSize;++r){const t=r*C,e=r*N;for(let n=0;n<f.outHeight;++n){const r=e+n*A,s=n*f.strideHeight-w;for(let e=0;e<m;++e){const n=s+e*y;if(n<0||n>=f.inHeight)continue;const i=e*S[0],a=t+n*I;for(let t=0;t<f.outWidth;++t){const e=r+t*R,n=t*f.strideWidth-v;for(let t=0;t<g;++t){const r=n+t*b;if(r<0||r>=f.inWidth)continue;const s=a+r*E;let o=i+t*S[1];for(let t=0;t<f.inChannels;++t){const n=D[s+t*T];for(let t=0;t<f.outChannels;++t)$[e+t*O]+=n*F[o+t];o+=f.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,$)}const OK={kernelName:dE,backendName:"cpu",kernelFunc:RK},DK={kernelName:pE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;Xq([s,i],"conv2dBackpropFilter");const h=d.convertConv2DDataFormat(l),p=d.computeConv2DInfo(s.shape,c,a,1,o,u,!1,h),{strideHeight:f,strideWidth:m,filterHeight:g,filterWidth:y}=p,b="channelsLast"===p.dataFormat,v=new JN(p.filterShape,"float32"),w=p.padInfo.left,_=p.padInfo.top,x=n.data.get(s.dataId).values,k=n.data.get(i.dataId).values,S=new JN(s.shape,s.dtype,x),C=new JN(i.shape,i.dtype,k);for(let d=0;d<g;++d){const t=Math.max(0,Math.ceil((_-d)/f)),e=Math.min(p.outHeight,(p.inHeight+_-d)/f);for(let n=0;n<y;++n){const r=Math.max(0,Math.ceil((w-n)/m)),s=Math.min(p.outWidth,(p.inWidth+w-n)/m);for(let i=0;i<p.inChannels;++i)for(let a=0;a<p.outChannels;++a){let o=0;for(let l=0;l<p.batchSize;++l)for(let u=t;u<e;++u){const t=d+u*f-_;for(let e=r;e<s;++e){const r=n+e*m-w;o+=b?S.get(l,t,r,i)*C.get(l,u,e,a):S.get(l,i,t,r)*C.get(l,a,u,e)}}v.set(o,d,n,i,a)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}},FK={kernelName:fE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{dy:i,filter:a}=e,{inputShape:o,strides:l,pad:u,dataFormat:c,dimRoundingMode:h}=s;Xq([i,a],"conv2dBackpropInput");const p=r.computeStrides(a.shape),f=r.computeStrides(i.shape);let m=d.convertConv2DDataFormat(c);const g=d.computeConv2DInfo(o,a.shape,l,1,u,h,!1,m),y=new JN(g.inShape,"float32"),b=y.values,v=n.data.get(i.dataId).values,w=n.data.get(a.dataId).values,[_,x,k]=p,{batchSize:S,filterHeight:C,filterWidth:I,inChannels:E,inHeight:T,inWidth:N,outChannels:A,outHeight:R,outWidth:O,strideHeight:D,strideWidth:F}=g;m=g.dataFormat;const $=C-1-g.padInfo.top,M=I-1-g.padInfo.left,L="channelsLast"===m,P=y.strides[0],z=L?y.strides[1]:y.strides[2],B=L?y.strides[2]:1,V=L?1:y.strides[1],W=f[0],U=L?f[1]:f[2],j=L?f[2]:1,H=L?1:f[1];for(let r=0;r<S;++r)for(let t=0;t<E;++t)for(let e=0;e<T;++e){const n=e-$,s=Math.max(0,Math.ceil(n/D)),i=Math.min(R,(C+n)/D);for(let a=0;a<N;++a){const o=a-M,l=Math.max(0,Math.ceil(o/F)),u=Math.min(O,(I+o)/F);let c=0;for(let e=s;e<i;++e){const s=e*D-n;for(let n=l;n<u;++n){const i=W*r+U*e+j*n,a=_*(C-1-s)+x*(I-1-(n*F-o))+k*t;for(let t=0;t<A;++t)c+=v[i+H*t]*w[a+t]}}b[P*r+z*e+B*a+V*t]=c}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},$K={kernelName:mE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,filter:a}=e,{strides:o,pad:l,dilations:u}=s;Xq([i,a],"conv3d");const c=d.computeConv3DInfo(i.shape,a.shape,o,u,l),{filterDepth:h,filterHeight:p,filterWidth:f,dilationDepth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=c,v=b.front,w=b.left,_=b.top,x=new JN(c.outShape,i.dtype),k=n.data.get(i.dataId).values,S=n.data.get(a.dataId).values,C=x.values,I=r.computeStrides(i.shape),E=r.computeStrides(a.shape);for(let r=0;r<c.batchSize;++r){const t=r*I[0],e=r*x.strides[0];for(let n=0;n<c.outDepth;++n){const r=e+n*x.strides[1],s=n*c.strideDepth-v;for(let e=0;e<h;++e){const n=s+e*m;if(n<0||n>=c.inDepth)continue;const i=e*E[0],a=t+n*I[1];for(let t=0;t<c.outHeight;++t){const e=r+t*x.strides[2],n=t*c.strideHeight-_;for(let t=0;t<p;++t){const r=n+t*g;if(r<0||r>=c.inHeight)continue;const s=i+t*E[1],o=a+r*I[2];for(let t=0;t<c.outWidth;++t){const n=e+t*c.outChannels,r=t*c.strideWidth-w;for(let t=0;t<f;++t){const e=r+t*y;if(e<0||e>=c.inWidth)continue;const i=o+e*c.inChannels;let a=s+t*E[2];for(let t=0;t<c.inChannels;++t){const e=k[i+t];for(let t=0;t<c.outChannels;++t)C[n+t]+=e*S[a+t];a+=c.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}},MK={kernelName:gE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,dy:a}=e,{strides:o,pad:l,filterShape:u}=s;Xq([i,a],"conv3dBackpropFilterV2");const c=r.computeStrides(i.shape),h=r.computeStrides(a.shape),p=d.computeConv3DInfo(i.shape,u,o,1,l),f=p.strideDepth,m=p.strideHeight,g=p.strideWidth,y=p.filterDepth,b=p.filterHeight,v=p.filterWidth,w=new JN(p.filterShape,"float32"),_=w.values,[x,k,S,C]=w.strides,I=n.data.get(a.dataId).values,[E,T,N,A]=h,R=n.data.get(i.dataId).values,[O,D,F,$]=c,M=p.padInfo.front,L=p.padInfo.left,P=p.padInfo.top;for(let r=0;r<y;++r){const t=Math.max(0,Math.ceil((M-r)/f)),e=Math.min(p.outDepth,(p.inDepth+M-r)/f),n=r*x;for(let s=0;s<b;++s){const i=Math.max(0,Math.ceil((P-s)/m)),a=Math.min(p.outHeight,(p.inHeight+P-s)/m),o=s*k+n;for(let n=0;n<v;++n){const l=Math.max(0,Math.ceil((L-n)/g)),u=Math.min(p.outWidth,(p.inWidth+L-n)/g),c=n*S+o;for(let o=0;o<p.inChannels;++o){const h=o*C+c;for(let c=0;c<p.outChannels;++c){let d=0;for(let h=0;h<p.batchSize;++h){const p=h*O,y=h*E;for(let h=t;h<e;++h){const t=(r+h*f-M)*D+p,e=h*T+y;for(let r=i;r<a;++r){const i=(s+r*m-P)*F+t,a=r*N+e;for(let t=l;t<u;++t)d+=R[(n+t*g-L)*$+i+o]*I[t*A+a+c]}}}_[h+c]=d}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},LK={kernelName:yE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{dy:i,filter:a}=e,{pad:o,strides:l,inputShape:u}=s;Xq([i],"conv3dBackpropInputV2");const c=r.computeStrides(i.shape),h=r.computeStrides(a.shape),p=d.computeConv3DInfo(u,a.shape,l,1,o),f=new JN(p.inShape,"float32"),m=f.values,[g,y,b,v]=f.strides,w=n.data.get(i.dataId).values,[_,x,k,S]=c,C=n.data.get(a.dataId).values,[I,E,T,N]=h,{batchSize:A,filterDepth:R,filterHeight:O,filterWidth:D,inChannels:F,inDepth:$,inHeight:M,inWidth:L,outChannels:P,outDepth:z,outHeight:B,outWidth:V,strideDepth:W,strideHeight:U,strideWidth:j}=p,H=R-1-p.padInfo.front,q=O-1-p.padInfo.top,G=D-1-p.padInfo.left;for(let r=0;r<A;++r)for(let t=0;t<F;++t)for(let e=0;e<$;++e){const n=e-H,s=Math.max(0,Math.ceil(n/W)),i=Math.min(z,(R+n)/W);for(let a=0;a<M;++a){const o=a-q,l=Math.max(0,Math.ceil(o/U)),u=Math.min(B,(O+o)/U);for(let c=0;c<L;++c){const h=c-G,d=Math.max(0,Math.ceil(h/j)),p=Math.min(V,(D+h)/j);let f=0;for(let e=s;e<i;++e){const s=e*W-n;for(let n=l;n<u;++n){const i=n*U-o;for(let a=d;a<p;++a){const o=_*r+x*e+k*n+S*a,l=I*(R-1-s)+E*(O-1-i)+T*(D-1-(a*j-h))+N*t;for(let t=0;t<P;++t)f+=w[o+t]*C[l+t]}}}m[g*r+y*e+b*a+v*c+t]=f}}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},PK=Qq(bE,t=>Math.cos(t)),zK={kernelName:bE,backendName:"cpu",kernelFunc:PK},BK=Qq(vE,t=>Math.cosh(t)),VK={kernelName:vE,backendName:"cpu",kernelFunc:BK},WK={kernelName:_E,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{image:i,boxes:a,boxInd:o}=e,{cropSize:l,method:u,extrapolationValue:c}=s,[h,d,p,f]=i.shape,m=a.shape[0],[g,y]=l,b=IR([m,g,y,f],"float32"),v=n.data.get(a.dataId).values,w=n.data.get(o.dataId).values,_=n.data.get(i.dataId).values,x=r.computeStrides(i.shape),k=r.computeStrides(b.shape);for(let r=0;r<m;r++){const t=4*r,e=v[t],n=v[t+1],s=v[t+2],i=v[t+3],a=w[r];if(a>=h)continue;const o=g>1?(s-e)*(d-1)/(g-1):0,l=y>1?(i-n)*(p-1)/(y-1):0;for(let h=0;h<g;h++){const t=g>1?e*(d-1)+h*o:.5*(e+s)*(d-1);if(t<0||t>d-1)for(let e=0;e<y;e++)for(let t=0;t<f;t++)b.values[t+e*k[2]+h*k[1]+r*k[0]]=c;else if("bilinear"===u){const e=Math.floor(t),s=Math.ceil(t),o=t-e;for(let t=0;t<y;t++){const u=y>1?n*(p-1)+t*l:.5*(n+i)*(p-1);if(u<0||u>p-1){for(let e=0;e<f;e++)b.values[e+t*k[2]+h*k[1]+r*k[0]]=c;continue}const d=Math.floor(u),m=Math.ceil(u),g=u-d;for(let n=0;n<f;n++){let i=n+d*x[2]+e*x[1]+a*x[0];const l=_[i];i=n+m*x[2]+e*x[1]+a*x[0];const u=_[i];i=n+d*x[2]+s*x[1]+a*x[0];const c=_[i];i=n+m*x[2]+s*x[1]+a*x[0];const p=_[i],f=l+(u-l)*g;i=n+t*k[2]+h*k[1]+r*k[0],b.values[i]=f+(c+(p-c)*g-f)*o}}}else for(let e=0;e<y;++e){const s=y>1?n*(p-1)+e*l:.5*(n+i)*(p-1);if(s<0||s>p-1){for(let t=0;t<f;t++)b.values[t+e*k[2]+h*k[1]+r*k[0]]=c;continue}const o=Math.round(s),u=Math.round(t);for(let t=0;t<f;t++)b.values[t+e*k[2]+h*k[1]+r*k[0]]=_[t+o*x[2]+u*x[1]+a*x[0]]}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},UK={kernelName:wE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,exclusive:o,reverse:l}=s;Xq(i,"cumsum");const u=d.getAxesPermutation([a],i.shape.length);let c=i;null!=u&&(c=VG({inputs:{x:i},backend:n,attrs:{perm:u}}));const h=d.getInnerMostAxes(1,i.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const p=hA(c.dtype,"int32"),f=r.makeZerosTypedArray(r.sizeFromShape(c.shape),p),m=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],y=l?(t,e)=>t+g-e-1:(t,e)=>t+e;for(let r=0;r<m.length;r+=g)for(let t=0;t<g;t++){const e=y(r,t);if(0===t)f[e]=o?0:m[e];else{const n=y(r,t-1);f[e]=o?m[n]+f[n]:m[e]+f[n]}}const b=n.makeTensorInfo(c.shape,p,f);if(null!=u){const t=VG({inputs:{x:b},backend:n,attrs:{perm:d.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),t}return b}},jK={kernelName:xE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:a,binaryOutput:o}=r;if(1===s.shape.length){const t=gK(n.data.get(s.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,a);return n.makeTensorInfo([a],i.dtype,t)}if(2===s.shape.length){const t=yK(n.bufferSync(s),n.bufferSync(i),a,o);return n.makeTensorInfo(t.shape,i.dtype,t.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+s.shape.length+".")}},HK={kernelName:kE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{blockSize:a,dataFormat:o}=s;r.assert("NHWC"===o,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o),r.assert(a>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+a);const l=i.shape[0],u=i.shape[1],c=i.shape[2],h=i.shape[3],d=u*a,p=c*a,f=h/(a*a),m=n.data.get(i.dataId).values,g=new Float32Array(l*d*p*f);let y=0;for(let r=0;r<l;++r)for(let t=0;t<d;++t){const e=Math.floor(t/a),n=t%a;for(let t=0;t<p;++t){const s=Math.floor(t/a),i=(n*a+t%a)*f;for(let t=0;t<f;++t)g[y++]=m[t+i+h*(s+c*(e+u*r))]}}return n.makeTensorInfo([l,d,p,f],i.dtype,g)}};function qK(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,filter:a}=e,{strides:o,pad:l,dilations:u,dimRoundingMode:c}=s;Xq([i,a],"depthwiseConv2DNative");const h=r.computeStrides(i.shape),p=r.computeStrides(a.shape);let f=u;null==f&&(f=[1,1]),r.assert(d.eitherStridesOrDilationsAreOne(o,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${f}'`);const m=d.computeConv2DInfo(i.shape,a.shape,o,f,l,c,!0),{filterHeight:g,filterWidth:y,dilationHeight:b,dilationWidth:v,padInfo:w}=m,_=w.left,x=w.top,k=m.outChannels/m.inChannels,S=new JN(m.outShape,i.dtype),C=n.data.get(i.dataId).values,I=n.data.get(a.dataId).values,E=S.values;for(let r=0;r<m.batchSize;++r){const t=r*h[0],e=r*S.strides[0];for(let n=0;n<m.outHeight;++n){const r=e+n*S.strides[1],s=n*m.strideHeight-_;for(let e=0;e<g;++e){const n=s+e*b;if(n<0||n>=m.inHeight)continue;const i=e*p[0],a=t+n*h[1];for(let t=0;t<m.outWidth;++t){const e=r+t*S.strides[2],n=t*m.strideWidth-x;for(let t=0;t<y;++t){const r=n+t*v;if(r<0||r>=m.inWidth)continue;const s=a+r*m.inChannels;let o=e,l=i+t*p[1];for(let t=0;t<m.inChannels;++t){const e=C[s+t];for(let t=0;t<k;++t)E[o+t]+=e*I[l+t];o+=k,l+=k}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const GK={kernelName:SE,backendName:"cpu",kernelFunc:qK},KK={kernelName:CE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r;Xq([s,i],"depthwiseConv2dNativeBackpropFilter");const h=d.computeConv2DInfo(s.shape,c,a,o,l,u,!0),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=h,y=new JN(h.filterShape,"float32"),b=h.padInfo.left,v=h.padInfo.top,w=h.outChannels/h.inChannels,_=n.data.get(s.dataId).values,x=new JN(s.shape,s.dtype,_),k=n.data.get(i.dataId).values,S=new JN(i.shape,i.dtype,k);for(let d=0;d<m;++d){const t=Math.max(0,Math.ceil((v-d)/p)),e=Math.min(h.outHeight,(h.inHeight+v-d)/p);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((b-n)/f)),s=Math.min(h.outWidth,(h.inWidth+b-n)/f);for(let i=0;i<h.outChannels;++i){const a=Math.trunc(i/w),o=i%w;let l=0;for(let u=0;u<h.batchSize;++u)for(let o=t;o<e;++o){const t=d+o*p-v;for(let e=r;e<s;++e)l+=x.get(u,t,n+e*f-b,a)*S.get(u,o,e,i)}y.set(l,d,n,a,o)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},XK={kernelName:IE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{dy:i,filter:a}=e,{strides:o,dilations:l,pad:u,dimRoundingMode:c,inputShape:h}=s;Xq([i,a],"depthwiseConv2DNativeBackpropInput");const p=r.computeStrides(i.shape),f=r.computeStrides(a.shape),m=d.computeConv2DInfo(h,a.shape,o,l,u,c,!0),g=new JN(m.inShape,"float32"),y=g.values,[b,v,w]=g.strides,_=n.data.get(i.dataId).values,[x,k,S]=p,C=n.data.get(a.dataId).values,[I,E,T]=f,{batchSize:N,filterHeight:A,filterWidth:R,inChannels:O,inHeight:D,inWidth:F,outChannels:$,outHeight:M,outWidth:L,strideHeight:P,strideWidth:z}=m,B=A-1-m.padInfo.top,V=R-1-m.padInfo.left,W=$/O;for(let r=0;r<N;++r)for(let t=0;t<O;++t)for(let e=0;e<D;++e){const n=e-B,s=Math.max(0,Math.ceil(n/P)),i=Math.min(M,(A+n)/P);for(let a=0;a<F;++a){const o=a-V,l=Math.max(0,Math.ceil(o/z)),u=Math.min(L,(R+o)/z);let c=0;for(let e=s;e<i;++e){const s=e*P-n;for(let n=l;n<u;++n){const i=x*r+k*e+S*n,a=I*(A-1-s)+E*(R-1-(n*z-o))+T*t;for(let e=0;e<W;++e)c+=_[i+(t*W+e)]*C[a+e]}}y[b*r+v*e+w*a+t]=c}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}},YK={kernelName:EE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:s}=e,i=r.sizeFromShape(s.shape),a=n.data.get(s.dataId).values,o=IR([i,i],s.dtype),l=o.values;for(let r=0;r<a.length;r++)l[r*i+r]=a[r];const u=[...s.shape,...s.shape];return n.makeTensorInfo(u,o.dtype,o.values)}},ZK={kernelName:TE,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:i}=t,{strides:a,pad:o,dilations:l}=n,u=e,c=u.data.get(s.dataId).values,h=s.shape.length,p=u.data.get(i.dataId).values,f=i.shape.length,{batchSize:m,inHeight:g,inWidth:y,inChannels:b,outHeight:v,outWidth:w,padInfo:_,strideHeight:x,strideWidth:k,filterHeight:S,filterWidth:C,dilationHeight:I,dilationWidth:E,outShape:T}=d.computeDilation2DInfo(s.shape,i.shape,a,o,"NHWC",l),N=r.sizeFromShape(T),A=T.length,R=r.getArrayFromDType(s.dtype,N);for(let d=0;d<m;++d)for(let t=0;t<v;++t){const e=t*x-_.top;for(let n=0;n<w;++n){const a=n*k-_.left;for(let o=0;o<b;++o){let l=Number.MIN_SAFE_INTEGER;for(let t=0;t<S;++t){const n=e+t*I;if(n>=0&&n<g)for(let e=0;e<C;++e){const u=a+e*E;if(u>=0&&u<y){const a=r.locToIndex([d,n,u,o],h,r.computeStrides(s.shape)),m=r.locToIndex([t,e,o],f,r.computeStrides(i.shape)),g=c[a]+p[m];g>l&&(l=g)}}}R[r.locToIndex([d,t,n,o],A,r.computeStrides(T))]=l}}}return{dataId:u.write(r.toTypedArray(R,s.dtype),T,s.dtype),shape:T,dtype:s.dtype}}},QK={kernelName:AE,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:i,dy:a}=t,{strides:o,pad:l,dilations:u}=n,c=e,h=r.toNestedArray(s.shape,c.data.get(s.dataId).values),p=r.toNestedArray(i.shape,c.data.get(i.dataId).values),{batchSize:f,inHeight:m,inWidth:g,inChannels:y,outHeight:b,outWidth:v,padInfo:w,strideHeight:_,strideWidth:x,filterHeight:k,filterWidth:S,dilationHeight:C,dilationWidth:I,outShape:E}=d.computeDilation2DInfo(s.shape,i.shape,o,l,"NHWC",u);r.assert(a.rank===E.length,()=>`Error in Dilation2DBackpropFilter, dy must have the same rank as output ${E.length}, but got `+a.rank);const T=r.toNestedArray(E,c.data.get(a.dataId).values),N=r.makeZerosNestedTypedArray(i.shape,i.dtype);for(let r=0;r<f;++r)for(let t=0;t<b;++t){const e=t*_-w.top;for(let n=0;n<v;++n){const s=n*x-w.left;for(let i=0;i<y;++i){let a=Number.MIN_SAFE_INTEGER,o=0,l=0;for(let t=0;t<k;++t){const n=e+t*C;if(n>=0&&n<m)for(let e=0;e<S;++e){const u=s+e*I;if(u>=0&&u<g){const s=h[r][n][u][i]+p[t][e][i];s>a&&(a=s,o=t,l=e)}}}N[o][l][i]+=T[r][t][n][i]}}}return{dataId:c.write(r.toTypedArray(N,s.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},JK={kernelName:NE,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:i,dy:a}=t,{strides:o,pad:l,dilations:u}=n,c=e,h=r.toNestedArray(s.shape,c.data.get(s.dataId).values),p=r.toNestedArray(i.shape,c.data.get(i.dataId).values),{batchSize:f,inHeight:m,inWidth:g,inChannels:y,outHeight:b,outWidth:v,padInfo:w,strideHeight:_,strideWidth:x,filterHeight:k,filterWidth:S,dilationHeight:C,dilationWidth:I,outShape:E}=d.computeDilation2DInfo(s.shape,i.shape,o,l,"NHWC",u);r.assert(a.rank===E.length,()=>`Error in Dilation2DBackpropInput, dy must have the same rank as output ${E.length}, but got `+a.rank);const T=r.toNestedArray(E,c.data.get(a.dataId).values),N=r.makeZerosNestedTypedArray(s.shape,s.dtype);for(let r=0;r<f;++r)for(let t=0;t<b;++t){const e=t*_-w.top;for(let n=0;n<v;++n){const s=n*x-w.left;for(let i=0;i<y;++i){let a=Number.MIN_SAFE_INTEGER,o=e<0?0:e,l=s<0?0:s;for(let t=0;t<k;++t){const n=e+t*C;if(n>=0&&n<m)for(let e=0;e<S;++e){const u=s+e*I;if(u>=0&&u<g){const s=h[r][n][u][i]+p[t][e][i];s>a&&(a=s,o=n,l=u)}}}N[r][o][l][i]+=T[r][t][n][i]}}}return{dataId:c.write(r.toTypedArray(N,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},tX={kernelName:DE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{dy:s,y:i}=e;Xq([s,i],"eluGrad");const a=new Float32Array(r.sizeFromShape(i.shape)),o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let r=0;r<o.length;++r){const t=o[r];a[r]=t>=1?l[r]:l[r]*(t+1)}return n.makeTensorInfo(i.shape,"float32",a)}},eX=aG((t,e)=>t===e?1:0),nX=xG($E,eX,null,"bool"),rX={kernelName:$E,backendName:"cpu",kernelFunc:nX},sX=d.ERF_P,iX=d.ERF_A1,aX=d.ERF_A2,oX=d.ERF_A3,lX=d.ERF_A4,uX=d.ERF_A5,cX=Qq(FE,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+sX*n);return e*(1-((((uX*r+lX)*r+oX)*r+aX)*r+iX)*r*Math.exp(-n*n))}),hX={kernelName:FE,backendName:"cpu",kernelFunc:cX},dX=vK(t=>Math.exp(t)),pX=Jq(ME,dX),fX={kernelName:ME,backendName:"cpu",kernelFunc:pX};function mX(t){const{inputs:e,backend:n,attrs:s}=t,{input:i}=e,{dim:a}=s,o=i.shape.length,l=i.shape.slice();let u=a;return a<0&&(r.assert(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+a+1),l.splice(u,0,1),TG({inputs:{x:i},backend:n,attrs:{shape:l}})}const gX={kernelName:LE,backendName:"cpu",kernelFunc:mX},yX=vK(t=>Math.expm1(t)),bX=Jq(PE,yX),vX={kernelName:PE,backendName:"cpu",kernelFunc:bX},wX=aG((t,e)=>t*e),_X=kG((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),xX=xG(CT,wX,_X),kX={kernelName:CT,backendName:"cpu",kernelFunc:xX},SX=aG((t,e)=>t/e),CX=xG(RE,SX),IX={kernelName:RE,backendName:"cpu",kernelFunc:CX},EX=aG((t,e)=>t-e),TX=kG((t,e,n,r)=>({real:t-n,imag:e-r})),NX=xG(pN,EX,TX),AX={kernelName:pN,backendName:"cpu",kernelFunc:NX};function RX(t,e,n){const s=t.shape,i=s[0],a=s[1],o=n.data.get(t.dataId),l=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[i,a],h=r.sizeFromShape(c),p=r.getTypedArrayFromDType("float32",h),f=r.getTypedArrayFromDType("float32",h);for(let r=0;r<i;r++){const t=pK({inputs:{x:l},backend:n,attrs:{begin:[r,0],size:[1,a]}}),s=pK({inputs:{x:u},backend:n,attrs:{begin:[r,0],size:[1,a]}}),i=mG({inputs:{real:t,imag:s},backend:n}),{real:o,imag:c}=OX(i,e,n),h=d.mergeRealAndImagArrays(o,c);for(let e=0;e<a;e++){const t=d.getComplexWithIndex(h,e);p[r*a+e]=t.real,f[r*a+e]=t.imag}n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i)}const m=n.makeTensorInfo(c,"float32",p),g=n.makeTensorInfo(c,"float32",f),y=mG({inputs:{real:m,imag:g},backend:n});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}function OX(t,e,n){const s=r.sizeFromShape(t.shape),i=n.data.get(t.dataId),a=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(0==((l=s)&l-1)){const i=DX(a,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(l,"float32",i.real),e=n.makeTensorInfo(l,"float32",i.imag),a=n.makeTensorInfo([],"float32",r.createScalarValue(s,"float32")),o=nG({inputs:{x:a},backend:n}),u=IX.kernelFunc({inputs:{a:t,b:a},backend:n}),c=IX.kernelFunc({inputs:{a:e,b:o},backend:n}),h=n.data.get(u.dataId).values,d=n.data.get(c.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),{real:h,imag:d}}return i}{const t=function(t,e,n){const r=new Float32Array(2*e);for(let s=0;s<e;s++){let i=0,a=0;for(let r=0;r<e;r++){const o=d.exponent(s*r,e,n),l=d.getComplexWithIndex(t,r);i+=l.real*o.real-l.imag*o.imag,a+=l.real*o.imag+l.imag*o.real}n&&(i/=e,a/=e),d.assignToTypedArray(r,i,a,s)}return r}(d.mergeRealAndImagArrays(a,o),s,e);return d.splitRealAndImagArrays(t)}var l}function DX(t,e,n,r,s){if(1===n)return{real:t,imag:e};const i=d.mergeRealAndImagArrays(t,e),a=n/2,o=d.complexWithEvenIndex(i),l=o.real,u=o.imag,c=[l.length],h=s.makeTensorInfo(c,"float32",l),p=s.makeTensorInfo(c,"float32",u),f=mG({inputs:{real:h,imag:p},backend:s}),m=d.complexWithOddIndex(i),g=m.real,y=m.imag,b=[g.length],v=s.makeTensorInfo(b,"float32",g),w=s.makeTensorInfo(b,"float32",y),_=mG({inputs:{real:v,imag:w},backend:s}),x=DX(l,u,a,r,s),k=x.real,S=x.imag,C=[k.length],I=s.makeTensorInfo(C,"float32",k),E=s.makeTensorInfo(C,"float32",S),T=mG({inputs:{real:I,imag:E},backend:s}),N=DX(g,y,a,r,s),A=N.real,R=N.imag,O=[A.length],D=s.makeTensorInfo(O,"float32",A),F=s.makeTensorInfo(O,"float32",R),$=mG({inputs:{real:D,imag:F},backend:s}),M=d.exponents(n,r),L=[M.real.length],P=s.makeTensorInfo(L,"float32",M.real),z=s.makeTensorInfo(L,"float32",M.imag),B=mG({inputs:{real:P,imag:z},backend:s}),V=xX({inputs:{a:B,b:$},backend:s}),W=IG({inputs:{a:T,b:V},backend:s}),U=NX({inputs:{a:T,b:V},backend:s}),j=bG({inputs:{input:W},backend:s}),H=bG({inputs:{input:U},backend:s}),q=EK({inputs:{input:W},backend:s}),G=EK({inputs:{input:U},backend:s}),K=NK({inputs:[j,H],backend:s,attrs:{axis:0}}),X=NK({inputs:[q,G],backend:s,attrs:{axis:0}}),Y=s.data.get(K.dataId).values,Z=s.data.get(X.dataId).values;return s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(p),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(_),s.disposeIntermediateTensorInfo(I),s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo(T),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(F),s.disposeIntermediateTensorInfo($),s.disposeIntermediateTensorInfo(P),s.disposeIntermediateTensorInfo(z),s.disposeIntermediateTensorInfo(B),s.disposeIntermediateTensorInfo(V),s.disposeIntermediateTensorInfo(W),s.disposeIntermediateTensorInfo(U),s.disposeIntermediateTensorInfo(j),s.disposeIntermediateTensorInfo(q),s.disposeIntermediateTensorInfo(H),s.disposeIntermediateTensorInfo(G),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(X),{real:Y,imag:Z}}const FX={kernelName:zE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:s}=e,i=r.sizeFromShape(s.shape),a=s.shape[s.shape.length-1],o=TG({inputs:{x:s},backend:n,attrs:{shape:[i/a,a]}}),l=RX(o,!1,n),u=TG({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}};function $X(t){const{backend:e,attrs:n}=t,{shape:s,value:i,dtype:a}=n,o=a||r.inferDtype(i),l=r.getArrayFromDType(o,r.sizeFromShape(s));return function(t,e,n){t.fill(e)}(l,i),e.makeTensorInfo(s,o,l)}const MX={kernelName:BE,backendName:"cpu",kernelFunc:$X},LX={kernelName:VE,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,i=r.getTypedArrayFromDType(n.dtype,r.sizeFromShape(n.shape)),[a,o,l,u]=n.shape,c=s.data.get(n.dataId).values;for(let r=0;r<a;r++){const t=r*l*o*u;for(let e=0;e<o;e++){const n=e*(l*u);for(let r=0;r<l;r++){const s=r*u;for(let o=0;o<u;o++){const h=Math.round(l-[a,e,r,o][2]),d=t+n+s+o;let p=c[d];h>=0&&h<l&&(p=c[t+n+h*u+o]),i[d]=p}}}}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},PX=vK(t=>Math.floor(t)),zX=Jq(WE,PX),BX={kernelName:WE,backendName:"cpu",kernelFunc:zX},VX=aG((t,e)=>Math.floor(t/e)),WX=xG(UE,VX,null,"int32"),UX={kernelName:UE,backendName:"cpu",kernelFunc:WX},jX={kernelName:NN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r;let m=RK({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(a){const t=m;m=IG({inputs:{a:m,b:a},backend:n}),n.disposeIntermediateTensorInfo(t)}if(p){const t=m;m=fG(n,m,p,o,f),n.disposeIntermediateTensorInfo(t)}return m}},HX={kernelName:AN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r;let m=qK({inputs:{x:s,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:h,dimRoundingMode:d}});if(a){const t=m;m=IG({inputs:{a:m,b:a},backend:n}),n.disposeIntermediateTensorInfo(t)}if(p){const t=m;m=fG(n,m,p,o,f),n.disposeIntermediateTensorInfo(t)}return m}},qX={kernelName:qE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:s,indices:i}=e,a=r.sizeFromShape(s.shape),o=i.shape,l=o[o.length-1],[u,c,h,p]=d.prepareAndValidate(s,i);if(0===c)return n.makeTensorInfo(u,s.dtype,[]);const f=IR([c,h],s.dtype),m=n.data.get(i.dataId).values,g=n.data.get(s.dataId).values;for(let r=0;r<c;r++){const t=[];let e=0;for(let n=0;n<l;n++){const s=m[r*l+n];e+=s*p[n],t.push(s)}if(e<0||e>=a/h)throw new Error(`Invalid indices: ${t} does not index into ${s.shape}`);for(let n=0;n<h;n++)f.values[r*h+n]=g[e*h+n]}return n.makeTensorInfo(u,f.dtype,f.values)}};function GX(t,e,n){const r=IR(n,t.dtype);for(let s=0;s<r.size;++s){const n=r.indexToLoc(s).slice(),i=e.locToIndex([n[0],n[2]]);n[2]=e.values[i];const a=t.locToIndex(n);r.values[s]=t.values[a]}return r}const KX={kernelName:HE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,indices:a}=e,{axis:o,batchDims:l}=s;Xq([i,a],"gatherV2");let u=l;null==l&&(u=0);const c=r.sizeFromShape(a.shape),h=r.parseAxisParam(o,i.shape)[0],p=d.segment_util.collectGatherOpShapeInfo(i,a,h,u),f=TG({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),m=TG({inputs:{x:a},backend:n,attrs:{shape:[p.batchSize,c/p.batchSize]}}),g=[p.batchSize,p.outerSize,c/p.batchSize,p.sliceSize],y=n.bufferSync(m),b=GX(n.bufferSync(f),y,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(p.outputShape,b.dtype,b.values)}},XX=aG((t,e)=>t>e?1:0),YX=xG(GE,XX,null,"bool"),ZX={kernelName:GE,backendName:"cpu",kernelFunc:YX},QX=aG((t,e)=>t>=e?1:0),JX=xG(KE,QX,null,"bool"),tY={kernelName:KE,backendName:"cpu",kernelFunc:JX},eY={kernelName:YE,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:s}=e,i=r.sizeFromShape(s.shape),a=s.shape[s.shape.length-1],o=TG({inputs:{x:s},backend:n,attrs:{shape:[i/a,a]}}),l=RX(o,!0,n),u=TG({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}},nY=Qq(QE,t=>Number.isFinite(t)?1:0,"bool"),rY={kernelName:QE,backendName:"cpu",kernelFunc:nY},sY=Qq(JE,t=>Math.abs(t)===1/0?1:0,"bool"),iY={kernelName:JE,backendName:"cpu",kernelFunc:sY},aY=Qq(tT,t=>Number.isNaN(t)?1:0,"bool"),oY={kernelName:tT,backendName:"cpu",kernelFunc:aY},lY=aG((t,e)=>t<e?1:0),uY=xG(nT,lY,null,"bool"),cY={kernelName:nT,backendName:"cpu",kernelFunc:uY},hY=aG((t,e)=>t<=e?1:0),dY=xG(rT,hY,null,"bool"),pY={kernelName:rT,backendName:"cpu",kernelFunc:dY};function fY(t,e,n){const s=(e-t)/(n-1),i=r.makeZerosTypedArray(n,"float32");i[0]=t;for(let r=1;r<i.length;r++)i[r]=i[r-1]+s;return i}const mY={kernelName:sT,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,a=fY(r,s,i);return e.makeTensorInfo([a.length],"float32",a)}},gY=vK(t=>Math.log(t)),yY=Jq(iT,gY),bY={kernelName:iT,backendName:"cpu",kernelFunc:yY},vY=Qq(aT,t=>Math.log1p(t)),wY={kernelName:aT,backendName:"cpu",kernelFunc:vY},_Y=aG((t,e)=>t&&e),xY=xG(oT,_Y,null,"bool"),kY={kernelName:oT,backendName:"cpu",kernelFunc:xY},SY=Qq(lT,t=>t?0:1,"bool"),CY={kernelName:lT,backendName:"cpu",kernelFunc:SY},IY=aG((t,e)=>t||e),EY=xG(uT,IY,null,"bool"),TY={kernelName:uT,backendName:"cpu",kernelFunc:EY},NY={kernelName:cT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{depthRadius:a,bias:o,alpha:l,beta:u}=s;Xq(i,"LRN");const c=i.shape[3],h=c-1,d=n.data.get(i.dataId).values,p=r.sizeFromShape(i.shape),f=new Float32Array(p);function m(t){const e=t%c;let n=t-e+Math.max(0,e-a);const r=t-e+Math.min(e+a,h);let s=0;for(;n<=r;n++){const t=d[n];s+=t*t}return s}for(let r=0;r<p;r++){const t=m(r),e=d[r]*Math.pow(o+l*t,-u);f[r]=e}return n.makeTensorInfo(i.shape,i.dtype,f)}},AY={kernelName:hT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,y:a,dy:o}=e,{depthRadius:l,bias:u,alpha:c,beta:h}=s;Xq(o,"LRNGrad");const d=r.sizeFromShape(o.shape),p=o.shape[3],f=n.data.get(o.dataId).values,m=n.data.get(i.dataId).values,g=n.data.get(a.dataId).values,y=new Float32Array(d),b=d;for(let r=0;r<b;r++){const t=r%p,e=r-t+Math.max(0,t-l),n=r-t+Math.min(p,t+l+1);let s=0;for(let r=e;r<n;r++)s+=Math.pow(m[r],2);s=c*s+u;for(let i=e;i<n;i++){let t=-2*c*h*m[i]*g[r]/s;r===i&&(t+=Math.pow(s,-h)),t*=f[r],y[i]+=t}}return n.makeTensorInfo(o.shape,i.dtype,y)}};function RY(t,e,n,s){const i=r.getTypedArrayFromDType(s,r.sizeFromShape(n));for(let r=0;r<i.length;++r){const n=r*e;let s=t[n];for(let r=0;r<e;++r){const e=t[n+r];e>s&&(s=e)}i[r]=s}return i}function OY(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{reductionIndices:a,keepDims:o}=s,l=n;let u=i.shape;const c=u.length,h=r.parseAxisParam(a,u);let p=h;const f=d.getAxesPermutation(p,c);let m=l.data.get(i.dataId).values;if(null!=f){const t=new Array(c);for(let e=0;e<t.length;e++)t[e]=u[f[e]];m=BG(m,u,i.dtype,f,t),p=d.getInnerMostAxes(p.length,c),u=t}Xq(i,"max"),d.assertAxesAreInnerMostDims("max",p,c);const[g,y]=d.computeOutAndReduceShapes(u,p),b=RY(m,r.sizeFromShape(y),g,i.dtype),v=l.write(b,g,i.dtype);let w=g;return o&&(w=d.expandShapeToKeepDim(g,h)),{dataId:v,shape:w,dtype:i.dtype}}const DY={kernelName:dT,backendName:"cpu",kernelFunc:OY},FY=aG((t,e)=>Math.max(t,e)),$Y=xG(pT,FY),MY={kernelName:pT,backendName:"cpu",kernelFunc:$Y},LY={kernelName:fT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e;Xq(i,"maxPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=s;r.assert(d.eitherStridesOrDilationsAreOne(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.computePool2DInfo(i.shape,a,o,1,l,u);let h;if(1===c.filterWidth&&1===c.filterHeight&&r.arraysEqual(c.inShape,c.outShape))h=nG({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=r.computeStrides(i.shape),s=sK(t,0,i.dtype,e,c,"max");h=n.makeTensorInfo(c.outShape,i.dtype,s.values)}return h}},PY={kernelName:gT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:u,dataFormat:c,dilations:h}=s;Xq(i,"maxPool3d");let p=h;null==p&&(p=[1,1,1]);const f=d.computePool3DInfo(i.shape,a,o,p,l,u,c),m=aK(n.data.get(i.dataId).values,0,i.dtype,r.computeStrides(i.shape),f,"max");return n.makeTensorInfo(m.shape,"float32",m.values)}},zY={kernelName:yT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:a,strides:o,pad:l,dilations:u,dimRoundingMode:c}=r;Xq([s,i],"maxPool3DGrad");const h=d.computePool3DInfo(i.shape,a,o,u,l,c),p=function(t,e){const n=IR(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const b=y*r-d;let v=b;for(;v<0;)v+=a;const w=Math.min(e.inDepth,u+b);for(let r=0;r<e.outHeight;++r){const u=r*s-p;let d=u;for(;d<0;)d+=o;const _=Math.min(e.inHeight,c+u);for(let s=0;s<e.outWidth;++s){const p=s*i-f;let x=p;for(;x<0;)x+=l;const k=Math.min(e.inWidth,h+p);let S=Number.NEGATIVE_INFINITY,C=-1;for(let e=v;e<w;e+=a){const n=e-b;for(let r=d;r<_;r+=o){const s=r-u;for(let i=x;i<k;i+=l){const a=i-p,o=t.get(m,e,r,i,g);o>=S&&(S=o,C=n*c*h+s*c+a)}}}n.set(C,m,y,r,s,g)}}}return n}(n.bufferSync(i),h),f=h.strideDepth,m=h.strideHeight,g=h.strideWidth,y=h.dilationDepth,b=h.dilationHeight,v=h.dilationWidth,w=h.effectiveFilterDepth,_=h.effectiveFilterHeight,x=h.effectiveFilterWidth,k=w-1-h.padInfo.front,S=x-1-h.padInfo.left,C=_-1-h.padInfo.top,I=IR(i.shape,"float32"),E=n.bufferSync(s);for(let d=0;d<h.batchSize;++d)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let r=0;r<h.inWidth;++r){const s=e-k,i=n-C,a=r-S;let o=0;for(let e=0;e<w;e+=y){const n=(s+e)/f;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let r=0;r<_;r+=b){const s=(i+r)/m;if(!(s<0||s>=h.outHeight||Math.floor(s)!==s))for(let i=0;i<x;i+=v){const l=(a+i)/g;if(l<0||l>=h.outWidth||Math.floor(l)!==l)continue;const u=w*_*x-1-p.get(d,n,s,l,t)===e*_*x+r*x+i?1:0;0!==u&&(o+=E.get(d,n,s,l,t)*u)}}}I.set(o,d,e,n,r,t)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}},BY={kernelName:mT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:a}=e,o=i;Xq([i,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,p=d.computePool2DInfo(o.shape,l,u,1,c,h),f=n.data.get(o.dataId).values,m=IR(p.outShape,o.dtype,iK(f,o.shape,o.dtype,p).values),g=p.strideHeight,y=p.strideWidth,b=p.dilationHeight,v=p.dilationWidth,w=p.effectiveFilterHeight,_=p.effectiveFilterWidth,x=_-1-p.padInfo.left,k=w-1-p.padInfo.top,S=IR(o.shape,"float32"),C=n.data.get(s.dataId).values,I=IR(s.shape,"float32",C);for(let d=0;d<p.batchSize;++d)for(let t=0;t<p.inChannels;++t)for(let e=0;e<p.inHeight;++e)for(let n=0;n<p.inWidth;++n){const r=e-k,s=n-x;let i=0;for(let e=0;e<w;e+=b){const n=(r+e)/g;if(!(n<0||n>=p.outHeight||Math.floor(n)!==n))for(let r=0;r<_;r+=v){const a=(s+r)/y;if(a<0||a>=p.outWidth||Math.floor(a)!==a)continue;const o=w*_-1-m.get(d,n,a,t)===e*_+r?1:0;0!==o&&(i+=I.get(d,n,a,t)*o)}}S.set(i,d,e,n,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}},VY={kernelName:bT,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:i,strides:a,pad:o,includeBatchInIndex:l}=e,u=n;Xq(s,"MaxPoolWithArgmax");const c=u.data.get(s.dataId).values,h=d.computePool2DInfo(s.shape,i,a,[1,1],o),[p,f]=function(t,e,n,s,i){const a=sK(t,0,n,r.computeStrides(e),i,"max"),o=iK(t,e,n,i,!0,s);return[a.values,o.values]}(c,s.shape,s.dtype,l,h),m=u.write(p,h.outShape,s.dtype),g=u.write(f,h.outShape,s.dtype);return[{dataId:m,shape:h.outShape,dtype:s.dtype},{dataId:g,shape:h.outShape,dtype:"int32"}]}};function WY(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s;let l;Xq(i,"sum"),l="bool"===i.dtype?wG({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):nG({inputs:{x:i},backend:n});const u=l.shape.length,c=r.parseAxisParam(a,l.shape),h=d.getAxesPermutation(c,u);let p=c,f=l;null!=h&&(f=VG({inputs:{x:l},backend:n,attrs:{perm:h}}),p=d.getInnerMostAxes(p.length,u)),d.assertAxesAreInnerMostDims("sum",p,f.shape.length);const[m,g]=d.computeOutAndReduceShapes(f.shape,p);let y=yG(n,m,d.upcastType(f.dtype,"int32"));const b=r.sizeFromShape(g),v=n.data.get(y.dataId).values,w=n.data.get(f.dataId).values;for(let r=0;r<v.length;++r){const t=r*b;let e=0;for(let n=0;n<b;++n)e+=w[t+n];v[r]=e}if(o){const t=y;y=TG({inputs:{x:y},backend:n,attrs:{shape:d.expandShapeToKeepDim(y.shape,c)}}),n.disposeIntermediateTensorInfo(t)}return n.disposeIntermediateTensorInfo(l),null!=h&&n.disposeIntermediateTensorInfo(f),y}const UY={kernelName:oN,backendName:"cpu",kernelFunc:WY},jY={kernelName:vT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s,l=r.parseAxisParam(a,i.shape),u=d.computeOutAndReduceShapes(i.shape,l),c=r.sizeFromShape(u[1]),h=[],p=n.makeTensorInfo([],"float32",new Float32Array([c]));h.push(p);const f=wG({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});h.push(f);const m=CX({inputs:{a:f,b:p},backend:n});h.push(m);const g=WY({inputs:{x:m},backend:n,attrs:{axis:a,keepDims:o}});return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),g}},HY={kernelName:wT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s;Xq(i,"min");const l=r.parseAxisParam(a,i.shape);let u=l;const c=d.getAxesPermutation(u,i.shape.length);let h=i;null!=c&&(h=VG({inputs:{x:i},backend:n,attrs:{perm:c}}),u=d.getInnerMostAxes(u.length,i.shape.length)),d.assertAxesAreInnerMostDims("min",u,h.shape.length);const[p,f]=d.computeOutAndReduceShapes(h.shape,u),m=r.sizeFromShape(f),g=r.makeZerosTypedArray(r.sizeFromShape(p),h.dtype),y=n.data.get(h.dataId).values;for(let r=0;r<g.length;++r){const t=r*m;let e=y[t];for(let n=0;n<m;++n){const r=y[t+n];r<e&&(e=r)}g[r]=e}null!=c&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(p,h.dtype,g);if(o){const t=TG({inputs:{x:b},backend:n,attrs:{shape:d.expandShapeToKeepDim(p,l)}});return n.disposeIntermediateTensorInfo(b),t}return b}},qY=aG((t,e)=>Math.min(t,e)),GY=xG(_T,qY),KY={kernelName:_T,backendName:"cpu",kernelFunc:GY},XY={kernelName:xT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{paddings:a,mode:o}=s;Xq(i,"mirrorPad");const l=a.map((t,e)=>t[0]+i.shape[e]+t[1]),u=a.map(t=>t[0]),c=a.map((t,e)=>t[0]+i.shape[e]),h="reflect"===o?0:1,d=n.data.get(i.dataId).values,p=i.shape.length,f=r.computeStrides(i.shape),m=r.sizeFromShape(l),g=l.length,y=r.computeStrides(l),b=r.getTypedArrayFromDType(i.dtype,m);for(let v=0;v<m;v++){let t=r.indexToLoc(v,g,y);for(let n=0;n<g;n++)t[n]<u[n]?t[n]=2*u[n]-t[n]-h:t[n]>=c[n]&&(t[n]=2*(c[n]-1)-t[n]+h);t=t.map((t,e)=>t-u[e]);const e=r.locToIndex(t,p,f);b[v]=d[e]}return{dataId:n.write(b,l,i.dtype),shape:l,dtype:i.dtype}}},YY=aG((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),ZY=xG(kT,YY),QY={kernelName:kT,backendName:"cpu",kernelFunc:ZY};function JY(t){const{inputs:e,backend:n,attrs:s}=t,{logits:i}=e,{dim:a}=s,o=i.shape.length;let l=a;if(-1===l&&(l=o-1),l!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${l}`);const u=r.parseAxisParam([l],i.shape),c=OY({inputs:{x:i},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),h=d.expandShapeToKeepDim(c.shape,u),p=TG({inputs:{x:c},backend:n,attrs:{shape:h}}),f=NX({inputs:{a:i,b:p},backend:n}),m=pX({inputs:{x:f},backend:n}),g=WY({inputs:{x:m},backend:n,attrs:{axis:u,keepDims:!1}}),y=TG({inputs:{x:g},backend:n,attrs:{shape:h}}),b=CX({inputs:{a:m,b:y},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}const tZ={kernelName:cN,backendName:"cpu",kernelFunc:JY},eZ={kernelName:ST,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{logits:i}=e,{numSamples:a,seed:o,normalized:l}=s;Xq(i,"multinomial");const u=l?i:JY({inputs:{logits:i},backend:n,attrs:{dim:-1}}),c=u.shape[0],h=u.shape[1],d=n.data.get(u.dataId).values,p=[c,a],f=r.makeZerosTypedArray(r.sizeFromShape(p),"int32");for(let r=0;r<c;++r){const t=r*h,e=new Float32Array(h-1);e[0]=d[t];for(let r=1;r<e.length;++r)e[r]=e[r-1]+d[t+r];const n=nF.alea(o.toString()),s=r*a;for(let r=0;r<a;++r){const t=n();f[s+r]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){f[s+r]=n;break}}}return l||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(p,"int32",f)}};function nZ(t,e,n){const s=r.createScalarValue(-1,n);return wX([],e,s,t,n)}const rZ={kernelName:IT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;Xq(r,"neg");const s=n.data.get(r.dataId).values,[i,a]=nZ(s,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}},sZ=p.nonMaxSuppressionV3Impl,iZ={kernelName:TT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r;Xq(s,"NonMaxSuppression");const u=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:h}=sZ(u,c,a,o,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},aZ=p.nonMaxSuppressionV4Impl,oZ={kernelName:NT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r;Xq(s,"NonMaxSuppressionPadded");const c=n.data.get(s.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:p}=aZ(c,h,a,o,l,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},lZ=p.nonMaxSuppressionV5Impl,uZ={kernelName:AT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r;Xq(s,"NonMaxSuppressionWithScore");const c=n.data.get(s.dataId).values,h=n.data.get(i.dataId).values,d=a,p=o,f=l,m=u,{selectedIndices:g,selectedScores:y}=lZ(c,h,d,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},cZ=aG((t,e)=>t!==e?1:0),hZ=xG(ET,cZ,null,"bool"),dZ={kernelName:ET,backendName:"cpu",kernelFunc:hZ},pZ={kernelName:OT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{indices:i}=e,{depth:a,onValue:o,offValue:l}=s;Xq(i,"oneHot");const u=r.sizeFromShape(i.shape),c=new Float32Array(u*a);c.fill(l);const h=n.data.get(i.dataId).values;for(let r=0;r<u;++r)h[r]>=0&&h[r]<a&&(c[r*a+h[r]]=o);return n.makeTensorInfo([...i.shape,a],"int32",c)}};function fZ(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=bG({inputs:{input:r},backend:n}),e=fZ({inputs:{x:t},backend:n}),s=EK({inputs:{input:r},backend:n}),i=fZ({inputs:{x:s},backend:n}),a=mG({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),a}return $X({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const mZ={kernelName:SN,backendName:"cpu",kernelFunc:fZ},gZ={kernelName:RT,backendName:"cpu",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:s}=n;if("string"===s.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===s.dtype){const e=bG({inputs:{input:s},backend:r}),n=t({inputs:{x:e},backend:r}),i=EK({inputs:{input:s},backend:r}),a=fZ({inputs:{x:i},backend:r}),o=mG({inputs:{real:n,imag:a},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(a),o}return $X({backend:r,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}};function yZ(t){const{inputs:e,backend:n,attrs:s}=t,{axis:i}=s;if(1===e.length)return mX({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const a=e[0].shape,o=e[0].dtype;e.forEach(t=>{r.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),r.assert(o===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],u=NK({inputs:e.map(t=>{const e=mX({inputs:{input:t},backend:n,attrs:{dim:i}});return l.push(e),e}),backend:n,attrs:{axis:i}});return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}const bZ={kernelName:DT,backendName:"cpu",kernelFunc:yZ},vZ={kernelName:FT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{paddings:a,constantValue:o}=s;Xq(i,"pad");const l=a.map((t,e)=>t[0]+i.shape[e]+t[1]),u=a.map(t=>t[0]),c=n.data.get(i.dataId).values,h=r.sizeFromShape(i.shape),d=i.shape.length,p=r.computeStrides(i.shape),f=r.sizeFromShape(l),m=l.length,g=r.computeStrides(l),y=r.getTypedArrayFromDType(i.dtype,f);0!==o&&y.fill(o);for(let b=0;b<h;b++){const t=r.indexToLoc(b,d,p).map((t,e)=>t+u[e]);y[r.locToIndex(t,m,g)]=c[b]}return{dataId:n.write(y,l,i.dtype),shape:l,dtype:i.dtype}}},wZ=aG((t,e)=>Math.pow(t,e)),_Z=xG($T,wZ),xZ={kernelName:$T,backendName:"cpu",kernelFunc:_Z};function kZ(t,e,n,s){const[i,a]=d.computeOutAndReduceShapes(t,s),o=hA(e,"int32"),l=r.makeZerosTypedArray(r.sizeFromShape(i),o),u=r.sizeFromShape(a);for(let r=0;r<l.length;++r){const t=r*u;let e=1;for(let r=0;r<u;++r)e*=n[t+r];l[r]=e}return{outVals:l,outShape:i,outDtype:o}}const SZ={kernelName:LT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s;Xq(i,"prod");const l=i.shape.length,u=r.parseAxisParam(a,i.shape),c=d.getAxesPermutation(u,l);let h=u,p=i;const f=[];null!=c&&(p=VG({inputs:{x:i},backend:n,attrs:{perm:c}}),f.push(p),h=d.getInnerMostAxes(h.length,l));const m=n.data.get(p.dataId).values,{outVals:g,outShape:y,outDtype:b}=kZ(p.shape,p.dtype,m,h);let v=y;return o&&(v=d.expandShapeToKeepDim(y,u)),f.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(v,b,g)}};function CZ(t,e,n,s){if(t===e||t<e&&n<0||e<t&&n>1)return r.makeZerosTypedArray(0,s);const i=Math.abs(Math.ceil((e-t)/n)),a=r.makeZerosTypedArray(i,s);e<t&&1===n&&(n=-1),a[0]=t;for(let r=1;r<a.length;r++)a[r]=a[r-1]+n;return a}const IZ={kernelName:PT,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:i,step:a}=n,o=CZ(r,s,a,i);return e.makeTensorInfo([o.length],i,o)}},EZ=Qq(BT,t=>1/t),TZ={kernelName:BT,backendName:"cpu",kernelFunc:EZ},NZ={kernelName:HT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s;Xq(i,"resizeBilinear");const u=r.computeStrides(i.shape),[c,h]=l,[d,p,f,m]=i.shape,g=n.data.get(i.dataId).values,y=new Float32Array(r.sizeFromShape([d,c,h,m])),b=[a&&c>1?p-1:p,a&&h>1?f-1:f],v=[a&&c>1?c-1:c,a&&h>1?h-1:h];let w=0;const _=b[0]/v[0],x=b[1]/v[1];for(let r=0;r<d;r++)for(let t=0;t<c;t++){let e;e=o?_*(t+.5)-.5:_*t;const n=Math.max(0,Math.floor(e)),s=e-n,i=Math.min(p-1,Math.ceil(e)),a=r*u[0]+n*u[1],l=r*u[0]+i*u[1];for(let t=0;t<h;t++){let e;e=o?x*(t+.5)-.5:x*t;const n=Math.max(0,Math.floor(e)),r=e-n,i=Math.min(f-1,Math.ceil(e)),c=a+n*u[2],h=l+n*u[2],d=a+i*u[2],p=l+i*u[2];for(let t=0;t<m;t++){const e=g[c+t],n=g[h+t],i=e+(g[d+t]-e)*r;y[w++]=i+(n+(g[p+t]-n)*r-i)*s}}}return n.makeTensorInfo([d,c,h,m],"float32",y)}},AZ={kernelName:qT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{images:i,dy:a}=e,{alignCorners:o}=s;Xq([a,i],"resizeBilinearGrad");const l=r.computeStrides(i.shape),[u,c,h,d]=i.shape,[,p,f]=a.shape,m=new Float32Array(u*c*h*d),g=[o&&p>1?c-1:c,o&&f>1?h-1:h],y=[o&&p>1?p-1:p,o&&f>1?f-1:f],b=g[0]/y[0],v=g[1]/y[1],w=n.data.get(a.dataId).values;let _=0;for(let r=0;r<u;r++){const t=r*l[0];for(let e=0;e<p;e++){const n=e*b,r=Math.floor(n),s=Math.min(Math.ceil(n),c-1),i=t+r*l[1],a=t+s*l[1],o=n-r,u=1-o;for(let t=0;t<f;t++){const e=t*v,n=Math.floor(e),r=Math.min(Math.ceil(e),h-1),s=e-n,c=1-s,p=i+n*l[2],f=i+r*l[2],g=a+n*l[2],y=a+r*l[2],b=u*c,x=u*s,k=o*c,S=o*s;for(let t=0;t<d;t++){const e=w[_++];m[p+t]+=e*b,m[f+t]+=e*x,m[g+t]+=e*k,m[y+t]+=e*S}}}}return n.makeTensorInfo([u,h,c,d],"float32",m)}},RZ={kernelName:UT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s;Xq(i,"resizeNearestNeighbor");const u=r.computeStrides(i.shape),[c,h]=l,[d,p,f,m]=i.shape,g=n.data.get(i.dataId).values,y=new Float32Array(d*c*h*m),b=[a&&c>1?p-1:p,a&&h>1?f-1:f],v=[a&&c>1?c-1:c,a&&h>1?h-1:h],w=b[0]/v[0],_=b[1]/v[1];let x=0;for(let r=0;r<d;r++){const t=r*u[0];for(let e=0;e<c;e++){const n=o?w*(e+.5):w*e;let r=Math.min(p-1,a?Math.round(n):Math.floor(n));o&&(r=Math.max(0,r));const s=t+r*u[1];for(let t=0;t<h;t++){const e=o?_*(t+.5):_*t;let n=Math.min(f-1,a?Math.round(e):Math.floor(e));o&&(n=Math.max(0,n));const r=s+n*u[2];for(let t=0;t<m;t++)y[x++]=g[r+t]}}}return n.makeTensorInfo([d,c,h,m],i.dtype,y)}},OZ={kernelName:jT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{images:i,dy:a}=e,{alignCorners:o}=s;Xq([a,i],"resizeNearestNeighborGrad");const l=r.computeStrides(i.shape),u=r.computeStrides(a.shape),[c,h,d,p]=i.shape,[,f,m]=a.shape,g=new Float32Array(c*h*d*p),y=n.data.get(a.dataId).values,b=[o&&f>1?h-1:h,o&&m>1?d-1:d],v=[o&&f>1?f-1:f,o&&m>1?m-1:m],w=b[0]/v[0],_=b[1]/v[1],x=1/w,k=1/_,S=2*Math.ceil(x)+2,C=2*Math.ceil(k)+2;for(let r=0;r<c;r++){const t=r*l[0];for(let e=0;e<h;e++){const n=t+e*l[1],r=Math.floor(e*x),s=Math.floor(r-S/2);for(let i=0;i<d;i++){const r=n+i*l[2],a=Math.floor(i*k),c=Math.floor(a-C/2);for(let n=0;n<p;n++){let a=0;for(let r=0;r<S;r++){const l=r+s;if(l<0||l>=f)continue;const p=t+l*u[1],g=l*w;if(e===Math.min(h-1,o?Math.round(g):Math.floor(g)))for(let t=0;t<C;t++){const e=t+c;if(e<0||e>=m)continue;const r=p+e*u[2],s=e*_;i===Math.min(d-1,o?Math.round(s):Math.floor(s))&&(a+=y[r+n])}}g[r+n]=a}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}},DZ={kernelName:KT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{dims:a}=s;Xq(i,"reverse");const o=i.shape.length,l=r.parseAxisParam(a,i.shape);if(0===o)return nG({inputs:{x:i},backend:n});const u=new JN(i.shape,i.dtype),c=n.bufferSync(i);for(let r=0;r<u.size;r++){const t=u.indexToLoc(r),e=t.slice();l.forEach(t=>e[t]=i.shape[t]-1-e[t]),u.set(c.get(...e),...t)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}},FZ={kernelName:EN,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:i,fillValue:a,center:o}=e,l=n,u=r.getTypedArrayFromDType(s.dtype,r.sizeFromShape(s.shape)),[c,h,p,f]=s.shape,[m,g]=d.getImageCenter(o,h,p),y=Math.sin(i),b=Math.cos(i),v=l.data.get(s.dataId).values;for(let r=0;r<c;r++){const t=r*p*h*f;for(let e=0;e<h;e++){const n=e*(p*f);for(let r=0;r<p;r++){const s=r*f;for(let i=0;i<f;i++){const o=[c,e,r,i],l=o[2],d=o[1];let w=(l-m)*b-(d-g)*y,_=(l-m)*y+(d-g)*b;w=Math.round(w+m),_=Math.round(_+g);let x=a;"number"!=typeof a&&(x=3===i?255:a[i]),w>=0&&w<p&&_>=0&&_<h&&(x=v[t+_*(p*f)+w*f+i]),u[t+n+s+i]=x}}}}return{dataId:l.write(u,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},$Z=Qq(XT,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2==0?e:e+1}),MZ={kernelName:XT,backendName:"cpu",kernelFunc:$Z},LZ=vK(t=>1/Math.sqrt(t)),PZ=Jq(YT,LZ),zZ={kernelName:YT,backendName:"cpu",kernelFunc:PZ};function BZ(t,e,n,r,s,i,a,o,l,u){const c=[r/s,s],h=t.values,d=e.values;if(0===r)return IR(n,e.dtype);const p=IR(c,e.dtype);p.values.fill(l);for(let f=0;f<i;f++){const t=[];let i=0;for(let e=0;e<a;e++){const n=h[f*a+e];t.push(n),i+=n*o[e]}if(i<0||i>=r/s)throw new Error(`Invalid indices: ${t} does not index into ${n}`);for(let n=0;n<s;n++)u?p.values[i*s+n]+=d[f*s+n]:p.values[i*s+n]=0===e.rank?d[0]:d[f*s+n]}return p}const VZ={kernelName:ZT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=d.calculateShapes(i,s,a),p=BZ(n.bufferSync(s),n.bufferSync(i),a,h,u,l,o,c,0,!0);return n.makeTensorInfo(a,p.dtype,p.values)}},WZ={kernelName:QT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:s,t:i,e:a}=e;Xq([s,i,a],"select");const o=s.shape.length,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,h=hA(i.dtype,a.dtype),d=r.makeZerosTypedArray(r.sizeFromShape(i.shape),h);let p=0;const f=0===o||o>1||1===i.shape.length?1:r.sizeFromShape(i.shape.slice(1));for(let r=0;r<l.length;r++)for(let t=0;t<f;t++)d[p++]=1===l[r]?u[r]:c[r];return n.makeTensorInfo(i.shape,h,d)}},UZ=d.SELU_SCALEALPHA,jZ=d.SELU_SCALE,HZ=Qq(JT,t=>t>=0?jZ*t:UZ*(Math.exp(t)-1)),qZ={kernelName:JT,backendName:"cpu",kernelFunc:HZ},GZ=Qq(sN,t=>1/(1+Math.exp(-t))),KZ={kernelName:sN,backendName:"cpu",kernelFunc:GZ},XZ=Qq(rN,t=>t<0?-1:t>0?1:0),YZ={kernelName:rN,backendName:"cpu",kernelFunc:XZ},ZZ=Qq(eN,t=>Math.sin(t)),QZ={kernelName:eN,backendName:"cpu",kernelFunc:ZZ},JZ=Qq(nN,t=>Math.sinh(t)),tQ={kernelName:nN,backendName:"cpu",kernelFunc:JZ},eQ=Math.log(1.1920928955078125e-7)+2,nQ=Qq(iN,t=>{const e=t>-eQ,n=t<eQ,r=Math.exp(t);let s;return s=n?r:e?t:Math.log(1+r),s}),rQ={kernelName:iN,backendName:"cpu",kernelFunc:nQ},sQ={kernelName:lN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{blockShape:a,paddings:o}=s;Xq([i],"spaceToBatchND");const l=r.sizeFromShape(a),u=[[0,0]];u.push(...o);for(let r=1+a.length;r<i.shape.length;++r)u.push([0,0]);const c=vZ.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),h=d.getReshaped(c.shape,a,l,!1),p=d.getPermuted(h.length,a.length,!1),f=d.getReshapedPermuted(c.shape,a,l,!1),m=TG({inputs:{x:c},backend:n,attrs:{shape:h}}),g=VG({inputs:{x:m},backend:n,attrs:{perm:p}}),y=TG({inputs:{x:g},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}},iQ={kernelName:fN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:h,outputSize:p}=d.calculateShapes(i,s,o),f=BZ(n.bufferSync(s),n.bufferSync(i),o,p,c,u,l,h,n.data.get(a.dataId).values[0],!1);return n.makeTensorInfo(o,f.dtype,f.values)}},aQ={kernelName:uN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{numOrSizeSplits:a,axis:o}=s,l=r.parseAxisParam(o,i.shape)[0],u=d.prepareSplitSize(i,a,l),c=new Array(i.shape.length).fill(0),h=i.shape.slice();return u.map(t=>{const e=[...h];e[l]=t;const r=pK({inputs:{x:i},backend:n,attrs:{begin:c,size:e}});return c[l]+=t,r})}},oQ=Qq(aN,t=>Math.sqrt(t)),lQ={kernelName:aN,backendName:"cpu",kernelFunc:oQ},uQ={kernelName:dN,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;Xq(n,"square");const s=r.data.get(n.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const t=s[a];i[a]=t*t}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},cQ=aG((t,e)=>{const n=t-e;return n*n}),hQ=xG(hN,cQ),dQ={kernelName:hN,backendName:"cpu",kernelFunc:hQ},pQ=Qq(CN,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),fQ={kernelName:CN,backendName:"cpu",kernelFunc:pQ};function mQ(t,e,n,r){const s=IR(t,e.dtype);for(let i=0;i<s.size;i++){const t=s.indexToLoc(i),a=new Array(t.length);for(let e=0;e<a.length;e++)a[e]=t[e]*n[e]+r[e];s.set(e.get(...a),...t)}return s}const gQ={kernelName:mN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:a,strides:o,beginMask:u,endMask:c,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:p}=r;Xq(s,"stridedSlice");const{nonStrided:f,$begin:m,$strides:g,size:y,newShape:b,outShape:v}=l.sliceInfo(s.shape,i,a,o,u,c,h,d,p),w=TG({inputs:{x:s},backend:n,attrs:{shape:b}});let _;if(f){const t=pK({inputs:{x:w},backend:n,attrs:{begin:m,size:y}});_=TG({inputs:{x:t},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(t)}else if(v.some(t=>0===t))_=n.makeTensorInfo(v,s.dtype,[]);else{const t=mQ(v,n.bufferSync(w),g,m);_=n.makeTensorInfo(t.shape,t.dtype,t.values)}const x=TG({inputs:{x:_},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(_),x}},yQ=Qq(gN,t=>Math.tan(t)),bQ={kernelName:gN,backendName:"cpu",kernelFunc:yQ},vQ=Qq(yN,t=>Math.tanh(t));function wQ(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=IR(n,t.dtype);for(let s=0;s<r.values.length;++s){const e=r.indexToLoc(s),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const i=t.locToIndex(n);r.values[s]=t.values[i]}return r}function _Q(t,e,n,s,i){const a=e[e.length-1],[o,l]=[t.length/a,a],u=r.getTypedArrayFromDType(n,o*s),c=r.getTypedArrayFromDType("int32",o*s);for(let r=0;r<o;r++){const e=r*l,n=t.subarray(e,e+l),i=[];for(let t=0;t<n.length;t++)i.push({value:n[t],index:t});i.sort((t,e)=>e.value-t.value);const a=r*s,o=u.subarray(a,a+s),h=c.subarray(a,a+s);for(let t=0;t<s;t++)o[t]=i[t].value,h[t]=i[t].index}const h=e.slice();return h[h.length-1]=s,[IR(h,n,u),IR(h,"int32",c)]}function xQ(t,e,n,s){const i=r.parseAxisParam(e,n)[0],a=[1,n[0],1];for(let r=0;r<i;r++)a[0]*=n[r];a[1]=n[i];for(let r=i+1;r<n.length;r++)a[2]*=n[r];const o={},l=new Int32Array(n[i]),u=new JN(a,s,t),c=[],h=1===a[0]&&1===a[2];for(let r=0;r<n[i];r++){let e;if(h)e=t[r].toString();else{const t=[];for(let e=0;e<a[0];e++)for(let n=0;n<a[2];n++)t.push(u.get(e,r,n));e=t.join(",")}if(void 0!==o[e])l[r]=o[e];else{const t=Object.keys(o).length;o[e]=t,l[r]=t,c.push(r)}}const d=a.slice();d[1]=Object.keys(o).length;const p=new JN(d,s);c.forEach((t,e)=>{for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)p.set(u.get(n,t,r),n,e,r)});const f=n.slice();return f[i]=d[1],{outputValues:p.values,outputShape:f,indices:l}}const kQ=[OG,FG,MG,PG,EG,zG,UG,jG,HG,qG,KG,YG,QG,eK,rK,oK,lK,uK,cK,RG,hK,mK,bK,_G,xK,SK,gG,CK,AK,DK,FK,OK,MK,LK,$K,zK,VK,WK,UK,jK,HK,GK,KK,XK,YK,ZK,JK,QK,IX,eG,tX,rX,hX,fX,gX,vX,FX,MX,LX,BX,UX,jX,HX,qX,KX,ZX,tY,rG,eY,TK,rY,iY,oY,iG,cY,pY,mY,bY,wY,kY,CY,TY,NY,AY,MY,LY,PY,zY,BY,VY,DY,jY,HY,KY,XY,QY,eZ,kX,rZ,iZ,oZ,uZ,dZ,pZ,gZ,bZ,vZ,xZ,uG,SZ,IZ,vG,TZ,hG,pG,NG,NZ,AZ,RZ,OZ,DZ,FZ,MZ,zZ,VZ,WZ,qZ,KZ,YZ,QZ,tQ,fK,tZ,rQ,sQ,iQ,aQ,lQ,uQ,dQ,fQ,gQ,AX,UY,bQ,{kernelName:yN,backendName:"cpu",kernelFunc:vQ},{kernelName:bN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;Xq(s,"tile");const a=wQ(n.bufferSync(s),i);return n.makeTensorInfo(a.shape,a.dtype,a.values)}},{kernelName:vN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i}=r;Xq(s,"topk");const a=n.data.get(s.dataId).values,[o,l]=_Q(a,s.shape,s.dtype,i);return[n.makeTensorInfo(o.shape,o.dtype,o.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}},WG,{kernelName:_N,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;Xq(i,"unique");const a=r.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:u}=xQ(a,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}},{kernelName:xN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const a=s.shape.length,o=s.shape[i],l=new Array(a-1);let u=0;for(let p=0;p<a;p++)p!==i&&(l[u++]=s.shape[p]);const c=new Array(a).fill(0),h=s.shape.slice();h[i]=1;const d=new Array(o);for(let p=0;p<d.length;p++){c[i]=p;const t=pK({inputs:{x:s},backend:n,attrs:{begin:c,size:h}});d[p]=TG({inputs:{x:t},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(t)}return d}},{kernelName:kN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,segmentIds:a}=e,{numSegments:o}=s;Xq(i,"unsortedSegmentSum");const l=[],u=[],c=i.shape.length-a.shape.length;let h=a;for(let r=0;r<c;++r){const t=mX({inputs:{input:h},backend:n,attrs:{dim:r+1}});h=t,u.push(t)}for(let p=0;p<o;++p){const t=r.createScalarValue(p,"int32"),e=n.makeTensorInfo([],"int32",t),s=nX({inputs:{a:e,b:h},backend:n}),a=wG({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),o=xX({inputs:{a:a,b:i},backend:n}),c=WY({inputs:{x:o},backend:n,attrs:{axis:0,keepDims:!1}});l.push(c),u.push(e),u.push(s),u.push(a),u.push(o),u.push(c)}const d=yZ({inputs:l,backend:n,attrs:{axis:0}});return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),d}},mZ];for(const Set of kQ)MN(Set);const SQ={},CQ={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function IQ(t){if(!(t in SQ)){const e=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete SQ[t]},!1),1===t?e.getContext("webgl",CQ)||e.getContext("experimental-webgl",CQ):e.getContext("webgl2",CQ)}(t);if(null===e)return console.log("Could not get context for WebGL version",t),null;SQ[t]=e}const e=SQ[t];return e.isContextLost()?(delete SQ[t],IQ(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),SQ[t])}var EQ,TQ,NQ;function AQ(t,e){return[e,t]}function RQ(t){const e=r.sizeFromShape(t),n=Math.ceil(e/4);return r.sizeToSquarishShape(n)}function OQ(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function DQ(t,e){const n=t;let r,s,i,a,o,l,u,c,h,d;return 2===FI().getNumber("WEBGL_VERSION")?(r=n.R32F,s=n.R16F,i=n.RGBA16F,a=n.RGBA32F,o=n.RED,u=4,c=1,h=n.HALF_FLOAT,d=n.FLOAT):(r=t.RGBA,s=t.RGBA,i=t.RGBA,a=n.RGBA,o=t.RGBA,u=4,c=4,h=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT),l=t.RGBA,{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:h,textureTypeFloat:d}}function FQ(t,e){const n=e();return FI().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}(t,e))}(t),n}function $Q(t){return!!(FI().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function MQ(t,e){return UQ(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(EQ||(EQ={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(TQ||(TQ={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(NQ||(NQ={}));const LQ=/ERROR: [0-9]+:([0-9]+):/g;function PQ(t,e){if(FQ(t,()=>t.validateProgram(e)),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function zQ(t,e,n,r,s,i,a){const o=t.getAttribLocation(e,n);return-1!==o&&(FQ(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),FQ(t,()=>t.vertexAttribPointer(o,s,t.FLOAT,!1,i,a)),FQ(t,()=>t.enableVertexAttribArray(o)),!0)}function BQ(t,e,n){FQ(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),FQ(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function VQ(t,e){FQ(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),FQ(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function WQ(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}(t,e))}function UQ(t,e,n){const r=FQ(t,()=>e());if(null==r)throw new Error(n);return r}function jQ(t,e=2){return r.sizeFromShape(t.slice(0,t.length-e))}function HQ(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function qQ(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[jQ(t),...HQ(t)]),e}function GQ(t){return t%2==0}function KQ(t,e){if(t=t.slice(-2),e=e.slice(-2),r.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(GQ(n)&&GQ(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&GQ(t[0])&&GQ(e[0])}let XQ,YQ;function ZQ(t,e){return null!=t.getExtension(e)}function QQ(t){try{if(null!=IQ(t))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function JQ(t){const e=DQ(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),s}function tJ(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&r.assert("complex64"!==t.dtype,()=>e+" does not support complex64 tensors in the WebGL backend.")})}const eJ=FI();function nJ(){let t,e,n,r,s,i,a,o,l,u;return 2===FI().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",s="texture",i="outputColor",a="out vec4 outputColor;",o="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",a="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}function rJ(t,e,n="index"){const s=r.computeStrides(e);return s.map((e,r)=>`int ${t[r]} = ${n} / ${e}; ${r===s.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${e}`:`index -= ${t[r]} * ${e}`};`).join("")}function sJ(t){const e=r.computeStrides(t).map(t=>t.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;\n  }\n`}eJ.registerFlag("HAS_WEBGL",()=>eJ.getNumber("WEBGL_VERSION")>0),eJ.registerFlag("WEBGL_VERSION",()=>QQ(2)?2:QQ(1)?1:0),eJ.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),eJ.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===eJ.get("WEBGL_VERSION")),eJ.registerFlag("WEBGL_CPU_FORWARD",()=>!0),eJ.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),eJ.registerFlag("WEBGL_PACK",()=>eJ.getBool("HAS_WEBGL")),eJ.registerFlag("WEBGL_PACK_NORMALIZATION",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_PACK_CLIP",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1),eJ.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_PACK_REDUCE",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_LAZILY_UNPACK",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_CONV_IM2COL",()=>eJ.getBool("WEBGL_PACK")),eJ.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(t){if(null==XQ){const e=IQ(t);XQ=e.getParameter(e.MAX_TEXTURE_SIZE)}return XQ}(eJ.getNumber("WEBGL_VERSION"))),eJ.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(t){if(null==YQ){const e=IQ(t);YQ=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,YQ)}(eJ.getNumber("WEBGL_VERSION"))),eJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=eJ.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=IQ(t);return e=ZQ(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:ZQ(n,"EXT_disjoint_timer_query")?1:0,e}(t)}),eJ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>eJ.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!i.isMobile()),eJ.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(t){if(0===t)return!1;const e=IQ(t);if(1===t){if(!ZQ(e,"OES_texture_float"))return!1}else if(!ZQ(e,"EXT_color_buffer_float"))return!1;return JQ(e)}(eJ.getNumber("WEBGL_VERSION"))),eJ.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!eJ.getBool("WEBGL_FORCE_F16_TEXTURES")&&eJ.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),eJ.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>function(t){if(0===t)return!1;const e=IQ(t);if(1!==t){if(ZQ(e,"EXT_color_buffer_float"))return JQ(e);const t="EXT_color_buffer_half_float";if(ZQ(e,t)){const n=e.getExtension(t);return function(t,e){const n=DQ(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(s),i}(e,n)}return!1}return!!ZQ(e,"OES_texture_float")&&!!ZQ(e,"WEBGL_color_buffer_float")&&JQ(e)}(eJ.getNumber("WEBGL_VERSION"))),eJ.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(t=eJ.getNumber("WEBGL_VERSION"))&&null!=IQ(t).fenceSync;var t}),eJ.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>eJ.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),eJ.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&-1!==t)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});const iJ="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";class aJ{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=EQ.DENSE;const e=RQ(t),n=nJ();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${rJ(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${n.output} = result;\n      }\n    `}}class oJ{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=EQ.DENSE;const e=RQ(t),n=nJ();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${rJ(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${n.output} = result;\n      }\n    `}}class lJ{constructor(t){this.variableNames=["A"],this.outTexUsage=TQ.DOWNLOAD;const e=nJ();this.outputShape=t,this.userCode=`\n      ${iJ}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}class uJ{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=TQ.DOWNLOAD;const e=nJ();this.outputShape=t,this.userCode=`\n      ${iJ}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}class cJ{constructor(t,e,n=!1){this.variableNames=["A"];const r=nJ(),[s,i]=e;this.outputShape=t;let a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`\n      ${sJ(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ${i};\n        int c = imod(flatIndex, ${i});\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(${i}.0, ${s}.0);\n        vec4 values = ${r.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${r.output} = vec4(${a}, 0., 0., 0.);\n      }\n    `}}class hJ{constructor(t,e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const r=nJ(),[s,i]=e;this.outputShape=t;let a="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let l=0;l<=1;l++)for(let e=0;e<=1;e++){const n=2*l+e;a+=`\n          localCoords = coords;\n          if(localCoords[2] + ${e} < ${t[2]}) {\n            localCoords[2] += ${e};\n            if(localCoords[1] + ${l} < ${t[1]}) {\n              localCoords[1] += ${l};\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ${i};\n              c = imod(flatIndex, ${i});\n              uv = (vec2(c, r) + halfCR) / vec2(${i}.0, ${s}.0);\n              values = ${r.texture2D}(A, uv);\n\n              if(offset == 0) {\n                result[${n}] = values[0];\n              } else if(offset == 1) {\n                result[${n}] = values[1];\n              } else if(offset == 2) {\n                result[${n}] = values[2];\n              } else {\n                result[${n}] = values[3];\n              }\n            }\n          }\n        `}this.userCode=`\n      ${sJ(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ${a}\n\n        ${r.output} = ${o};\n      }\n    `}}function dJ(t,e,n,r,s,i){!function(t,e){const n=FI().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0)throw new Error(`Requested texture size [${t}x${e}] is invalid.`);if(t>n||e>n)throw new Error(`Requested texture size [${t}x${e}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}(e,n);const a=function(t){return UQ(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}(t),o=t.TEXTURE_2D;return FQ(t,()=>t.bindTexture(o,a)),FQ(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),FQ(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),FQ(t,()=>t.texParameteri(o,t.TEXTURE_MIN_FILTER,t.NEAREST)),FQ(t,()=>t.texParameteri(o,t.TEXTURE_MAG_FILTER,t.NEAREST)),FQ(t,()=>t.texImage2D(o,0,r,e,n,0,s,i,null)),FQ(t,()=>t.bindTexture(t.TEXTURE_2D,null)),a}function pJ(t){return t.internalFormatFloat}function fJ(t){return t.internalFormatHalfFloat}function mJ(t){return t.downloadTextureFormat}function gJ(t){return t.internalFormatPackedFloat}function yJ(t){return t.internalFormatPackedHalfFloat}class bJ{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=FI().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(t,e){SQ[t]=e}(e,t)):this.gl=IQ(e);let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(1===FI().getNumber("WEBGL_VERSION")){const t="OES_texture_half_float";if(this.textureFloatExtension=MQ(this.gl,"OES_texture_float"),ZQ(this.gl,t))this.textureHalfFloatExtension=MQ(this.gl,t);else if(FI().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),ZQ(this.gl,r))this.colorBufferHalfFloatExtension=MQ(this.gl,r);else if(FI().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",ZQ(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!ZQ(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=function(t){return function(t,e){const n=UQ(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return FQ(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),FQ(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl),this.indexBuffer=function(t){return function(t,e){const n=UQ(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return FQ(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),FQ(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}(t,new Uint16Array([0,1,2,2,1,3]))}(this.gl),this.framebuffer=function(t){return UQ(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=DQ(this.gl,this.textureHalfFloatExtension)}get debug(){return FI().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;FQ(t,()=>t.finish()),FQ(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),FQ(t,()=>t.deleteFramebuffer(this.framebuffer)),FQ(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),FQ(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),FQ(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[s,i]=AQ(e,n);return dJ(t,s,i,pJ(r),r.textureFormatFloat,t.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[s,i]=AQ(e,n);return dJ(t,s,i,fJ(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[s,i]=AQ(e,n);return dJ(t,s,i,mJ(r),t.RGBA,t.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n){FQ(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?FQ(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):FQ(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),FQ(t,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),function(t,e,n,r,s,i){let a,o,l;FQ(t,()=>t.bindTexture(t.TEXTURE_2D,e)),s instanceof Uint8Array?(a=new Uint8Array(n*r*4),o=t.UNSIGNED_BYTE,l=t.RGBA):(a=new Float32Array(n*r*4),o=t.FLOAT,l=i.internalFormatPackedFloat),a.set(s),FQ(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,o,a)),FQ(t,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[s,i]=OQ(e,n);return dJ(t,s,i,yJ(r),t.RGBA,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[s,i]=OQ(e,n);return dJ(t,s,i,gJ(r),t.RGBA,t.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(VQ(this.gl,this.framebuffer),this.outputTexture=null),FQ(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n,r){const[s,i]=AQ(e,n),a=new Uint8Array(e*n*4);return FQ(t,()=>t.readPixels(0,0,s,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}(this.gl,e,n,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,n,r,s,i){return function(t,e,n,r,s,i,a,o){const l=t,u=new Float32Array(function(t,e){const[n,r]=OQ(t,e);return n*r*4}(i,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}(this.gl,t,0,0,0,s,i)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=function(t,e,n,r){const s=t.createBuffer();FQ(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const i=16*e*n;return FQ(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,i,t.STREAM_READ)),FQ(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),FQ(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}(this.gl,e,n);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(FI().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,s=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(s,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=s}else FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n){const r=new Float32Array(e*n*4);return FQ(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}(this.gl,e,n))}createProgram(t){this.throwIfDisposed();const e=this.gl,n=function(t,e){const n=UQ(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(FQ(t,()=>t.shaderSource(n,e)),FQ(t,()=>t.compileShader(n)),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw function(t,e){const n=LQ.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);const s=+n[1],i=t.split("\n"),a=i.length.toString().length+2,o=i.map((t,e)=>r.rightPad((e+1).toString(),a)+t);let l=0;for(let r=0;r<o.length;r++)l=Math.max(o[r].length,l);const u=o.slice(0,s-1),c=o.slice(s-1,s),h=o.slice(s);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+r.rightPad(c[0],l),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e,t),s=function(t){const e=nJ();return function(t,e){const n=UQ(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(FQ(t,()=>t.shaderSource(n,e)),FQ(t,()=>t.compileShader(n)),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(t,`${e.version}\n    precision highp float;\n    ${e.attribute} vec3 clipSpacePos;\n    ${e.attribute} vec2 uv;\n    ${e.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}(e),i=function(t){return UQ(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}(e);return FQ(e,()=>e.attachShader(i,s)),FQ(e,()=>e.attachShader(i,n)),function(t,e){if(FQ(t,()=>t.linkProgram(e)),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}(e,i),this.debug&&PQ(e,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=function(t,e,n){return FQ(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),zQ(t,e,"clipSpacePos",n,3,20,0)&&zQ(t,e,"uv",n,2,20,12)}(e,this.program,this.vertexBuffer)),i}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&FQ(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&PQ(this.gl,this.program),FQ(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,n=!0){return this.throwIfDisposed(),n?function(t,e,n){return UQ(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}(this.gl,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),FQ(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),function(t,e,n,r){FQ(t,()=>function(t,e,n){(function(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${n}].`)})(t,n),FQ(t,()=>t.activeTexture(t.TEXTURE0+n)),FQ(t,()=>t.bindTexture(t.TEXTURE_2D,e))}(t,e,r)),FQ(t,()=>t.uniform1i(n,r))}(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,s]=OQ(e,n);this.setOutputMatrixTextureDriver(t,r,s)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&PQ(this.gl,this.program),WQ(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),FQ(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),FQ(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=MQ(this.gl,2===FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await r.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map(t=>t.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||r.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),BQ(this.gl,t,this.framebuffer),this.debug&&WQ(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(BQ(this.gl,this.outputTexture,this.framebuffer),this.debug&&WQ(this.gl)):VQ(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;BQ(r,t,this.framebuffer),this.debug&&WQ(r),this.outputTexture=t,FQ(r,()=>r.viewport(0,0,e,n)),FQ(r,()=>r.scissor(0,0,e,n))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),FQ(this.gl,()=>this.gl.scissor(t,e,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{getBroadcastDims:vJ}=d;function wJ(t,e,n,s){const i=[];t.forEach(t=>{const e=r.sizeFromShape(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push(`uniform float ${t.name}${e>1?`[${e}]`:""};`):(i.push(`uniform sampler2D ${t.name};`),i.push(`uniform int offset${t.name};`))});const a=i.join("\n"),o=t.map(t=>function(t,e,n=!1){let s="";return s+=n?xJ(t):_J(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(s+=n?function(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),i="get"+s+"AtOutCoords",a=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,l=vJ(t.shapeInfo.logicalShape,e.logicalShape),u=NJ(o),c=o-a;let h;const d=["x","y","z","w","u","v"];h=0===a?"":o<2&&l.length>=1?"coords = 0;":l.map(t=>`coords.${d[t+c]} = 0;`).join("\n");let p="";p=o<2&&a>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+d[e+c]).join(", ");let f="return outputValue;";const m=1===r.sizeFromShape(t.shapeInfo.logicalShape),g=1===r.sizeFromShape(e.logicalShape);if(1!==a||m||g){if(m&&!g)f=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){const t=a-2,e=a-1;l.indexOf(t)>-1&&l.indexOf(e)>-1?f="return vec4(outputValue.x);":l.indexOf(t)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(e)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${u} coords = getOutputCoords();\n      ${h}\n      vec4 outputValue = get${s}(${p});\n      ${f}\n    }\n  `}(t,e):function(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),i="get"+s+"AtOutCoords",a=t.shapeInfo.logicalShape.length,o=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===o&&null==t.shapeInfo.flatOffset&&r.arraysEqual(t.shapeInfo.texShape,e.texShape))return`\n      float ${i}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const l=NJ(o),u=vJ(t.shapeInfo.logicalShape,e.logicalShape),c=o-a;let h;const d=["x","y","z","w","u","v"];h=0===a?"":o<2&&u.length>=1?"coords = 0;":u.map(t=>`coords.${d[t+c]} = 0;`).join("\n");let p="";return p=o<2&&a>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+d[e+c]).join(", "),`\n    float ${i}() {\n      ${l} coords = getOutputCoords();\n      ${h}\n      return get${s}(${p});\n    }\n  `}(t,e)),s}(t,e,s)).join("\n"),l=e.texShape,u=nJ(),c=function(t){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${t.texture2D}(textureSampler, uv).r;\n    }\n  `}(u);let h,d,p=function(t){return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFs} vec2 resultUV;\n    ${t.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${t.defineSpecialNaN}\n    ${t.defineSpecialInf}\n    ${t.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${kJ}\n    ${SJ}\n    ${CJ}\n  `}(u);return e.isPacked?(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${n[1]}.0);\n      }\n    `:1===n[1]?`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${n[0]}.0);\n      }\n    `:`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);\n    }\n  `}(0,e);case 2:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(r.arraysEqual(t,e))return`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));\n      }\n    `;const s=Math.ceil(t[1]/2);return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n      int r = 2 * (index / ${s});\n      int c = imod(index, ${s}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),s=r*Math.ceil(t[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${r});\n      int c = imod(index, ${r}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(t,e);default:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),s=r*Math.ceil(t[t.length-2]/2);let i=s,a="",o="b, r, c";for(let l=2;l<t.length-1;l++)i*=t[t.length-l-1],a=`\n      int b${l} = index / ${i};\n      index -= b${l} * ${i};\n    `+a,o=`b${l}, `+o;return`\n    ivec${t.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      ${a}\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${r});\n      int c = imod(index, ${r}) * 2;\n\n      return ivec${t.length}(${o});\n    }\n  `}(t,e)}}(e.logicalShape,l),d=function(t){return`\n    void setOutput(vec4 val) {\n      ${t.output} = val;\n    }\n  `}(u)):(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(n=e)[0]?`\n      int getOutputCoords() {\n        return int(resultUV.x * ${n[1]}.0);\n      }\n    `:1===n[1]?`\n      int getOutputCoords() {\n        return int(resultUV.y * ${n[0]}.0);\n      }\n    `:`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return resTexRC.x * ${n[1]} + resTexRC.y;\n    }\n  `;case 2:return function(t,e){return r.arraysEqual(t,e)?`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));\n      }\n    `:1===t[1]?`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===t[0]?`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      int r = index / ${t[1]};\n      int c = index - r * ${t[1]};\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=rJ(["r","c","d"],t);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec3(r, c, d);\n    }\n  `}(t,e);case 4:return function(t,e){const n=rJ(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec4(r, c, d, d2);\n    }\n  `}(t,e);case 5:return function(t,e){const n=rJ(["r","c","d","d2","d3"],t);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},\n                             ${e[1]}));\n\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(t,e);case 6:return function(t,e){const n=rJ(["r","c","d","d2","d3","d4"],t);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n}(e.logicalShape,l),d=function(t){return`\n    void setOutput(float val) {\n      ${t.output} = vec4(val, 0, 0, 0);\n    }\n  `}(u)),s&&(p+=IJ),[p,c,d,a,h,o,n].join("\n")}function _J(t){const e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`float ${n}() {return ${e};}`;const[r,s]=t.shapeInfo.texShape;if(1===r&&1===s)return`\n      float ${n}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const[i,a]=t.shapeInfo.texShape;return`\n    float ${n}() {\n      vec2 uv = uvFromFlat(${i}, ${a}, ${EJ(e)});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`\n      float ${n}(int index) {\n        ${TJ(t)}\n      }\n    `;const r=t.shapeInfo.texShape,s=r[0],i=r[1];if(1===i&&1===s)return`\n      float ${n}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const a=EJ(e);return 1===i?`\n      float ${n}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `:1===s?`\n      float ${n}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n    float ${n}(int index) {\n      vec2 uv = uvFromFlat(${s}, ${i}, index + ${a});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape;if(null!=i&&r.arraysEqual(e,i))return`\n    float ${s}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${i[1]}.0, ${i[0]}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `;const{newShape:a,keptDims:o}=r.squeezeShape(e);if(a.length<e.length){const e=["row","col"];return`\n      ${_J(AJ(t,a))}\n      float ${s}(int row, int col) {\n        return ${s}(${RJ(e,o)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${s}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));\n        ${TJ(t)}\n      }\n    `;const l=i[0],u=i[1],c=EJ(n);return 1===u?`\n    float ${s}(int row, int col) {\n      float index = dot(vec3(row, col, ${c}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `:1===l?`\n    float ${s}(int row, int col) {\n      float index = dot(vec3(row, col, ${c}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n  float ${s}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${e[1]} + col + ${c};\n    vec2 uv = uvFromFlat(${l}, ${u}, index);\n    return sampleTexture(${n}, uv);\n  }\n`}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[1]*e[2],a=e[2],{newShape:o,keptDims:l}=r.squeezeShape(e);if(o.length<e.length){const e=["row","col","depth"];return`\n        ${_J(AJ(t,o))}\n        float ${s}(int row, int col, int depth) {\n          return ${s}(${RJ(e,l)});\n        }\n      `}if(t.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${i}, ${a}, 1)));\n        ${TJ(t)}\n      }\n    `;const u=t.shapeInfo.texShape,c=u[0],h=u[1],d=t.shapeInfo.flatOffset;return h===i&&null==d?`\n        float ${s}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${a}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${h}.0, ${c}.0);\n          return sampleTexture(${n}, uv);\n        }\n      `:h===a&&null==d?`\n    float ${s}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${c}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n      float ${s}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${i} + col * ${a} + depth + ${EJ(n)};\n        vec2 uv = uvFromFlat(${c}, ${h}, index);\n        return sampleTexture(${n}, uv);\n      }\n  `}(t);case 4:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[3],a=e[2]*i,o=e[1]*a,{newShape:l,keptDims:u}=r.squeezeShape(e);if(l.length<e.length){const e=["row","col","depth","depth2"];return`\n      ${_J(AJ(t,l))}\n      float ${s}(int row, int col, int depth, int depth2) {\n        return ${s}(${RJ(e,u)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${o}, ${a}, ${i}, 1)));\n        ${TJ(t)}\n      }\n    `;const c=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1];return p===o&&null==c?`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${a}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:p===i&&null==c?`\n      float ${s}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${e[1]*e[2]}, ${e[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${s}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${o} + col * ${a} +\n          depth * ${i} + depth2;\n      vec2 uv = uvFromFlat(${d}, ${p}, index + ${EJ(n)});\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[4],a=e[3]*i,o=e[2]*a,l=e[1]*o,{newShape:u,keptDims:c}=r.squeezeShape(e);if(u.length<e.length){const e=["row","col","depth","depth2","depth3"];return`\n      ${_J(AJ(t,u))}\n      float ${s}(int row, int col, int depth, int depth2, int depth3) {\n        return ${s}(${RJ(e,c)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${l}, ${o}, ${a}, ${i})) +\n          depth3;\n        ${TJ(t)}\n      }\n    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];return f===l&&null==h?`\n      float ${s}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${o}, ${a}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:f===i&&null==h?`\n      float ${s}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]},\n               ${e[2]*e[3]}, ${e[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${s}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${l} + col * ${o} + depth * ${a} +\n          depth2 * ${i} + depth3 + ${EJ(n)};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:a}=r.squeezeShape(e);if(i.length<e.length){const e=["row","col","depth","depth2","depth3","depth4"];return`\n      ${_J(AJ(t,i))}\n      float ${s}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${s}(${RJ(e,a)});\n      }\n    `}const o=e[5],l=e[4]*o,u=e[3]*l,c=e[2]*u,h=e[1]*c;if(t.shapeInfo.isUniform)return`\n      float ${s}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${h}, ${c}, ${u}, ${l})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${o}, 1)));\n        ${TJ(t)}\n      }\n    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],m=p[1];return m===h&&null==d?`\n      float ${s}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${c}, ${u}, ${l}, ${o})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${m}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:m===o&&null==d?`\n      float ${s}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]*e[4]},\n               ${e[2]*e[3]*e[4]},\n               ${e[3]*e[4]},\n               ${e[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${m}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${s}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${h} + col * ${c} + depth * ${u} +\n          depth2 * ${l} + depth3 * ${o} + depth4 + ${EJ(n)};\n      vec2 uv = uvFromFlat(${f}, ${m}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function xJ(t){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name;return`\n    vec4 ${"get"+e.charAt(0).toUpperCase()+e.slice(1)}() {\n      return ${nJ().texture2D}(${e}, halfCR);\n    }\n  `}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,s=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=nJ();return`\n    vec4 ${n}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${s[0]}, ${s[1]}, index);\n      return ${i.texture2D}(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,a=i[0],o=i[1],l=nJ();if(null!=i&&r.arraysEqual(e,i))return`\n      vec4 ${s}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);\n\n        return ${l.texture2D}(${n}, uv);\n      }\n    `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`\n    vec4 ${s}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(e[1]/2)}, ${u[0]}, ${u[1]}, row, col);\n      return ${l.texture2D}(${n}, uv);\n    }\n  `}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(1===e[0]){const n=[1,2],s=["b","row","col"];return`\n        ${xJ(AJ(t,e.slice(1)))}\n        vec4 ${r}(int b, int row, int col) {\n          return ${r}(${RJ(s,n)});\n        }\n      `}const a=i[0],o=i[1],l=Math.ceil(e[2]/2);return`\n    vec4 ${r}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${a}, ${o}, ${l*Math.ceil(e[1]/2)}, ${l}, b, row, col);\n      return ${nJ().texture2D}(${n}, uv);\n    }\n  `}(t);default:return function(t){const e=t.shapeInfo.logicalShape,n=e.length,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],o=a[0],l=a[1],u=Math.ceil(e[n-1]/2);let c=u*Math.ceil(e[n-2]/2),h="int b, int row, int col",d=`b * ${c} + (row / 2) * ${u} + (col / 2)`;for(let p=2;p<n-1;p++)h=`int b${p}, `+h,c*=e[n-p-1],d=`b${p} * ${c} + `+d;return`\n    vec4 ${s}(${h}) {\n      int index = ${d};\n      int texR = index / ${l};\n      int texC = index - texR * ${l};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${o});\n      return ${nJ().texture2D}(${r}, uv);\n    }\n  `}(t)}}const kJ="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",SJ="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",CJ="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",IJ="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function EJ(t){return"offset"+t}function TJ(t){const e=t.name,n=r.sizeFromShape(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${e}[i];\n      }\n    }\n  `}function NJ(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function AJ(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function RJ(t,e){return e.map(e=>t[e]).join(", ")}function OJ(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((t,n)=>{const s=t.logicalShape,i=e[n],a=i.shape;if(!r.arraysEqual(s,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${a} must match`);if(t.isUniform&&i.isUniform)return;const o=t.texShape,l=i.isUniform?null:i.texData.texShape;if(!r.arraysEqual(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}const{addImpl:DJ,bincountImpl:FJ,bincountReduceImpl:$J,ceilImpl:MJ,concatImpl:LJ,expImpl:PJ,expm1Impl:zJ,floorImpl:BJ,gatherV2Impl:VJ,greaterImpl:WJ,lessImpl:UJ,linSpaceImpl:jJ,logImpl:HJ,maxImpl:qJ,maximumImpl:GJ,minimumImpl:KJ,multiplyImpl:XJ,negImpl:YJ,prodImpl:ZJ,rangeImpl:QJ,rsqrtImpl:JJ,simpleAbsImpl:t0,sliceImpl:e0,stridedSliceImpl:n0,subImpl:r0,tileImpl:s0,topKImpl:i0,transposeImpl:a0,uniqueImpl:o0}=R;function l0(t,e){return["x","y","z","w","u","v"].slice(0,e).map(e=>`${t}.${e}`)}function u0(t,e){return 1===e?[t]:l0(t,e)}class c0{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const n=u0("rc",e),r=NJ(e),s=function(t,e,n){if(1===t)return"rc > "+e[0];let r="";for(let s=t-2;s<t;s++)r+=`${n[s]} >= ${e[s]}`,s<t-1&&(r+="||");return r}(e,t,n),i=function(t,e,n,r){if(1===t)return"";const s=r.slice(-2);return`\n    int r = ${s[0]};\n    int c = ${s[1]};\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ${e};\n    bool rEdge = rp1 >= ${n};\n  `}(e,t[t.length-1],t[t.length-2],n),a=function(t,e){const n=t.length,r=function(t,e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${0===r?"r":"rp1"}, ${0===s?"c":"cp1"}`;for(let n=2;n<t;n++)i=e[e.length-1-n]+","+i;n.push(i)}return n}(n,e);return 1===n?`getA(rc),\n            rc + 1 >= ${t[0]} ? 0. : getA(rc + 1),\n            0, 0`:`getA(${r[0]}),\n          cEdge ? 0. : getA(${r[1]}),\n          rEdge ? 0. : getA(${r[2]}),\n          rEdge || cEdge ? 0. : getA(${r[3]})`}(t,n);this.userCode=`\n        void main() {\n          ${r} rc = getOutputCoords();\n\n          if(${s}) {\n            setOutput(vec4(0));\n          } else {\n            ${i}\n\n            setOutput(vec4(${a}));\n          }\n        }\n      `}}}class h0{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let n="";for(let s=0;s<4;s++){let t="thisRC = rc;";s%2==1&&(t+="thisRC.z += 1;"),s>1&&(t+="thisRC.y += 1;"),n+=`\n        ${t}\n        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${s}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${s>0?"}":""}\n      `}var r;this.userCode=`\n      ${r=e,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${rJ(["r","c","d"],r)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${sJ(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${t[1]};\n        int cols = ${t[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class d0{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const r=f0(e,n),s=m0(t,r,n);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const i=p0(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const t=this.freeTextures[s].shift();return this.usedTextures[s].push(t),t}let a;return r===NQ.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===NQ.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===NQ.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===NQ.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===NQ.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const s=f0(n,r),i=m0(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=p0(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=FI().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=a):(this.freeTextures[i].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[i],u=l.indexOf(t);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l.splice(u,1),this.log()}log(){if(!this.logEnabled)return;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${this.numFreeTextures+this.numUsedTextures})`);const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: "+this._numBytesAllocated),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});for(const t in this.usedTextures)this.usedTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function p0(t,e,n,r,s){const i=function(t,e){switch(t){case NQ.PACKED_2X2_FLOAT32:return gJ(e);case NQ.PACKED_2X2_FLOAT16:return yJ(e);case NQ.UNPACKED_FLOAT32:return pJ(e);case NQ.UNPACKED_FLOAT16:return fJ(e);case NQ.PACKED_4X1_UNSIGNED_BYTE:return mJ(e);default:throw new Error("Unknown physical texture type "+t)}}(e,r);let a;if(s){const[e,n]=OQ(t[0],t[1]);a=e*n}else{const[e,n]=AQ(t[0],t[1]);a=e*n}return a*function(t,e){if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===t.RGBA16F)return 8;throw new Error("Unknown internal format "+e)}(n,i)}function f0(t,e){if(t===TQ.UPLOAD)return NQ.PACKED_2X2_FLOAT32;if(t===TQ.RENDER||null==t)return function(t){return FI().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?NQ.PACKED_2X2_FLOAT32:NQ.UNPACKED_FLOAT32:t?NQ.PACKED_2X2_FLOAT16:NQ.UNPACKED_FLOAT16}(e);if(t===TQ.DOWNLOAD||t===TQ.PIXELS)return NQ.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function m0(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}class g0{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const y0="return abs(x);",b0="return x;";class v0{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class w0{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const e=t.length,n=u0("rc",e),r=NJ(e),s=function(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),i=n.slice(-2),a=e<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${s});\n\n        setOutput(getChannel(packedInput, ${a}));\n      }\n    `}}const _0=p.whereImpl,x0={};class k0 extends zC{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.warnedAboutCPUBackend=!1,this.pendingDeletes=0,this.disposed=!1,!FI().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){const t=IQ(FI().getNumber("WEBGL_VERSION"));this.binaryCache=((e=FI().getNumber("WEBGL_VERSION"))in x0||(x0[e]={}),x0[e]),this.gpgpu=new bJ(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var e;this.textureManager=new d0(this.gpgpu),this.numMBBeforeWarning=null==FI().global.screen?1024:FI().global.screen.height*FI().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new PC(this,mO())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,n){if((FI().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||FI().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:TQ.UPLOAD,refCount:1,complexParentRefCount:0}),r}incRef(t){this.texData.get(t).refCount++}decRef(t){this.texData.has(t)&&this.texData.get(t).refCount--}decComplexRef(t){if(this.texData.has(t)){const e=this.texData.get(t);e.complexParentRefCount>0&&e.refCount--}}move(t,e,n,r){if(FI().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:TQ.UPLOAD,refCount:1,complexParentRefCount:0})}disposeIntermediateTensorInfo(t){const e=t.dataId;if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--,t.refCount<1&&this.disposeData(e)}}readSync(t){const e=this.texData.get(t),{values:n,dtype:s,complexTensorInfos:i,slice:a,shape:o,isPacked:l}=e;if(null!=a){let e;e=l?new v0(o,b0):new g0(o,b0);const n=this.runWebGLProgram(e,[{dataId:t,shape:o,dtype:s}],s),r=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===s)return n;const u=null!=this.activeTimers;let c,h;if(u&&(c=r.now()),"complex64"===s){const t=this.readSync(i.real.dataId),e=this.readSync(i.imag.dataId);h=d.mergeRealAndImagArrays(t,e)}else h=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=r.now()-c),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise(t=>e.push(t))}const e=this.texData.get(t),{values:n,shape:s,slice:i,dtype:a,complexTensorInfos:o,isPacked:l}=e;if(null!=i){let e;e=l?new v0(s,b0):new g0(s,b0);const n=this.runWebGLProgram(e,[{dataId:t,shape:s,dtype:a}],a),r=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if(!FI().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===FI().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u,c,h=null;if("complex64"!==a&&FI().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);const e=this.texData.get(u.dataId);h=this.gpgpu.createBufferFromTexture(e.texture,...RQ(s))}if(this.pendingRead.set(t,[]),"complex64"!==a&&await this.gpgpu.createAndWaitForFence(),"complex64"===a){const t=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]);c=d.mergeRealAndImagArrays(t[0],t[1])}else if(null==h)c=this.getValuesFromTexture(t);else{const t=r.sizeFromShape(s);c=this.gpgpu.downloadFloat32MatrixFromBuffer(h,t)}null!=u&&this.disposeIntermediateTensorInfo(u);const p=this.convertAndCacheOnCPU(t,c),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach(t=>t(p)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),p}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map(t=>r.decodeString(t))}catch(xrt){throw new Error("Failed to decode encoded string bytes into utf-8")}return IR(t.shape,t.dtype,n)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!$Q(n)){if(FI().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:s}=this.texData.get(t),i=r.sizeFromShape(e);if(FI().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),s=this.gpgpu.downloadMatrixFromPackedTexture(r.texture,...RQ(e)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),s}const a=FI().getBool("WEBGL_PACK")&&!0===s,o=a?qQ(e):e,l=a?new uJ(o):new lJ(o),u=this.runWebGLProgram(l,[{shape:o,dtype:n,dataId:t}],"float32"),c=this.texData.get(u.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),h}async time(t){const e=this.activeTimers,n=[];let s=!1;null==this.programTimersStack?(this.programTimersStack=n,s=!0):this.activeTimers.push(n),this.activeTimers=n,t();const i=r.flatten(this.activeTimers.map(t=>t.query)).filter(t=>null!=t),a=r.flatten(this.activeTimers.map(t=>t.name)).filter(t=>null!=t);this.activeTimers=e,s&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(i);o.kernelMs=r.sum(t),o.getExtraProfileInfo=()=>t.map((t,e)=>({name:a[e],ms:t})).map(t=>`${t.name}: ${t.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:r.now(),endMs:null}}endTimer(t){return FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=r.now(),t)}async getQueryTime(t){return FI().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(t):t.endMs-t.startMs}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(!this.texData.has(t))return;if(this.texData.get(t).complexParentRefCount>0)return void this.texData.get(t).refCount--;this.releaseGPUData(t);const{complexTensorInfos:e}=this.texData.get(t);null!=e&&(this.texData.get(e.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.real),this.texData.get(e.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.imag)),this.texData.delete(t)}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:s,isPacked:i,slice:a}=this.texData.get(t),o=a&&a.origDataId||t,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,s,i)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return FI().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=mO().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,e=128){const n=this.getCPUBackend();return FI().getBool("IS_TEST")||this.warnedAboutCPUBackend||null!=n||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=n&&t.every(t=>null==this.texData.get(t.dataId).texture&&r.sizeFromShape(t.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){d.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return _0(t.shape,e)}packedUnaryOp(t,e,n){const r=new v0(t.shape,e);return this.compileAndRun(r,[t],n)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=t0(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(FI().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,y0,t.dtype);const e=new g0(t.shape,y0);return this.compileAndRun(e,[t])}makeTensorInfo(t,e,n){let s;if("string"===e&&null!=n&&n.length>0&&r.isString(n[0])){const i=n.map(t=>r.encodeString(t));s=this.write(i,t,e)}else s=this.write(n,t,e);return this.texData.get(s).usage=null,{dataId:s,shape:t,dtype:e}}makeOutput(t,e,n){const{dataId:r}=this.makeTensorInfo(t,e,n);return mO().makeTensorFromDataId(r,t,e,this)}unpackTensor(t){const e=new w0(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new c0(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[jQ(t.shape),...HQ(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},s=[jQ(e),...HQ(e)],i=new h0(s,n),a=this.runWebGLProgram(i,[r],t.dtype,null,!0);return{dataId:a.dataId,shape:e,dtype:a.dtype}}decode(t){const e=this.texData.get(t),{isPacked:n,shape:r,dtype:s}=e,i=qQ(r);let a;return a=n?new oJ(i):new aJ(i),{dtype:s,shape:r,dataId:this.runWebGLProgram(a,[{shape:i,dtype:s,dataId:t}],s,null,!0).dataId}}runWebGLProgram(t,e,n,s,i=!1){const a=this.makeTensorInfo(t.outputShape,n),o=this.texData.get(a.dataId);if(t.packedOutput&&(o.isPacked=!0),t.outPackingScheme===EQ.DENSE){const e=RQ(t.outputShape);o.texShape=e.map(t=>2*t)}if(null!=t.outTexUsage&&(o.usage=t.outTexUsage),0===r.sizeFromShape(a.shape))return o.values=r.getTypedArrayFromDType(a.dtype,0),a;const l=[],u=e.map(e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&r.sizeFromShape(e.shape)<=FI().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),l.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!KQ(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),l.push(e),n=this.texData.get(e.dataId),t.shape=r}return this.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}});this.uploadToGPU(a.dataId);const c={shape:a.shape,texData:o,isUniform:!1},h=function(t,e,n){let r="";e.concat(n).forEach(t=>{r+=`${t.shape}_${t.isUniform?"uniform":t.texData.texShape}_${null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0}`});let s=t.constructor.name;return s+="_"+r+"_"+t.userCode,s}(t,u,c),d=this.getAndSaveBinary(h,()=>function(t,e,n,r){const s=e.userCode,i=n.map((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}}),a=i.map(t=>t.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},l=wJ(i,o,s,e.packedInputs),u=t.createProgram(l);let c=null;const h=t.getUniformLocation(u,"NAN",!1);1===FI().getNumber("WEBGL_VERSION")&&(c=t.getUniformLocation(u,"INFINITY",!1));const d={};for(let p=0;p<e.variableNames.length;p++){const n=e.variableNames[p],r=!1;d[n]=t.getUniformLocation(u,n,r),d["offset"+n]=t.getUniformLocation(u,"offset"+n,r)}return{program:e,source:l,webGLProgram:u,uniformLocations:d,inShapeInfos:a,outShapeInfo:o,infLoc:c,nanLoc:h}}(this.gpgpu,t,u,c)),p=null!=this.activeTimers;let f;if(p&&(f=this.startTimer()),function(t,e,n,s,i){OJ(e.inShapeInfos,n),OJ([e.outShapeInfo],[s]);const a=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(a,o[0],o[1]):t.setOutputMatrixTexture(a,o[0],o[1]),t.setProgram(e.webGLProgram),1===FI().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((n,s)=>{const i=e.program.variableNames[s],a=e.uniformLocations[i],o=e.uniformLocations["offset"+i];if(null!=a)if(n.isUniform)if(r.sizeFromShape(n.shape)<2)t.gl.uniform1f(a,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(a,e)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,a,s)}),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,d,u,c,s),l.forEach(t=>this.disposeIntermediateTensorInfo(t)),p&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)})),!FI().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===i){const t=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),t}return a}compileAndRun(t,e,n,r,s=!1){const i=this.runWebGLProgram(t,e,n=n||e[0].dtype,r,s);return mO().makeTensorFromDataId(i.dataId,i.shape,i.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(FI().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=yO(()=>{if(!FI().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=FI().getBool("DEBUG");FI().set("DEBUG",!1);const e=this.abs(xO(1e-8)).dataSync()[0];if(FI().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:s,values:i,texture:a,usage:o,isPacked:l}=e;if(null!=a)return;const u=null!=this.activeTimers;let c;u&&(c=r.now());let h=e.texShape;if(null==h&&(h=function(t,e=!1){let n=FI().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map((e,n)=>n>=t.length-2?r.nearestLargerEven(t[n]):t[n])).length&&(t=[2,t[0]])),2!==t.length){const e=r.squeezeShape(t);t=e.newShape}let s=r.sizeFromShape(t);if(t.length<=1&&s<=n)return[1,s];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){const e=jQ(t);let n=2,i=2;return t.length&&([n,i]=HQ(t)),s=e*(n/2)*(i/2),r.sizeToSquarishShape(s).map(t=>2*t)}return r.sizeToSquarishShape(s)}(n,l),e.texShape=h),null!=i){const t=qQ(n);let a,o=h[1],d=h[0];const p=i instanceof Uint8Array;l?([o,d]=OQ(h[0],h[1]),a=new hJ(t,[d,o],p)):a=new cJ(t,[d,o],p);const f=this.makeTensorInfo([d,o],s);this.texData.get(f.dataId).usage=p?TQ.PIXELS:TQ.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),o,d,i);const m=this.runWebGLProgram(a,[f],s,null,!0),g=this.texData.get(m.dataId);e.texture=g.texture,e.texShape=g.texShape,e.isPacked=g.isPacked,e.usage=g.usage,this.disposeIntermediateTensorInfo(f),this.texData.delete(m.dataId),e.values=null,u&&(this.uploadWaitMs+=r.now()-c)}else{const t=this.acquireTexture(h,o,s,l);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${t} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*r.bytesPerElement(e)}}i.isBrowser()&&wO("webgl",()=>new k0,2);class S0{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=d.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}class C0{constructor(t,e,n,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=d.assertAndGetBroadcastShape(e,n);const i=this.outputShape.length;let a="";if(s)if(0===i||1===r.sizeFromShape(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(a=`\n          ${NJ(i)} coords = getOutputCoords();\n        `,1===i)a+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const t=u0("coords",i);a+=`\n            bool nextRowOutOfBounds =\n              (${t[i-2]} + 1) >= ${this.outputShape[i-2]};\n            bool nextColOutOfBounds =\n              (${t[i-1]} + 1) >= ${this.outputShape[i-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${a}\n\n        setOutput(result);\n      }\n    `}}function I0(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const E0={kernelName:XE,backendName:"webgl",kernelFunc:I0};function T0(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),a=n.texData.get(i.dataId),o=I0({inputs:{x:r},backend:n});n.texData.get(o.dataId).complexParentRefCount++;const l=I0({inputs:{x:s},backend:n});return n.texData.get(l.dataId).complexParentRefCount++,a.complexTensorInfos={real:o,imag:l},i}const N0={kernelName:uE,backendName:"webgl",kernelFunc:T0},A0="return (a < 0.) ? b * a : a;",R0="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",O0={kernelName:eT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{alpha:a}=s,o=n.makeTensorInfo([],"float32",r.createScalarValue(a,"float32")),l=FI().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new C0(R0,i.shape,o.shape):new S0(A0,i.shape,o.shape),u=n.runWebGLProgram(l,[i,o],i.dtype);return n.disposeIntermediateTensorInfo(o),u}},D0="return (a < 0.) ? b * a : a;",F0="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",$0={kernelName:MT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=FI().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new C0(F0,r.shape,s.shape):new S0(D0,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)}};function M0({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:i})=>{const{x:a}=s,o=i,l=r||a.dtype;if(o.shouldExecuteOnCPU([a])&&null!=n){const t=o.texData.get(a.dataId),e=n(t.values,l);return o.makeTensorInfo(a.shape,l,e)}let u;return u=FI().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=e?new v0(a.shape,e):new g0(a.shape,t),o.runWebGLProgram(u,[a],l)}}function L0({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:a,backend:o})=>{const{a:l,b:u}=a,c=o;if(r&&"complex64"===l.dtype){const e=c.texData.get(l.dataId),n=c.texData.get(u.dataId),[r,s]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{const[n,r]=e,s={dataId:n.dataId,dtype:n.dtype,shape:l.shape},i={dataId:r.dataId,dtype:r.dtype,shape:u.shape},a=new S0(t,l.shape,u.shape);return c.runWebGLProgram(a,[s,i],hA(n.dtype,r.dtype))}),i=T0({inputs:{real:r,imag:s},backend:c});return c.disposeIntermediateTensorInfo(r),c.disposeIntermediateTensorInfo(s),i}const h=i||hA(l.dtype,u.dtype);if(c.shouldExecuteOnCPU([l,u])&&null!=s){const t=c.texData.get(l.dataId),e=c.texData.get(u.dataId),[n,r]=s(l.shape,u.shape,t.values,e.values,h),i=c.makeTensorInfo(r,h);return c.texData.get(i.dataId).values=n,i}let d;return d=FI().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=e?new C0(e,l.shape,u.shape,n):new S0(t,l.shape,u.shape),c.runWebGLProgram(d,[l,u],h)}}function P0(t,e=!1){if("linear"===t)return"return x;";if("relu"===t)return e?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===t)return e?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===t)return e?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n";if("prelu"===t)return e?F0:D0;if("leakyrelu"===t)return e?R0:A0;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}class z0{constructor(t,e,n,r=!1,s=!1,i=!1,a=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;const u=Math.ceil((r?t[1]:t[2])/2),c=r?"i * 2, rc.y":"rc.y, i * 2",h=s?"rc.z, i * 2":"i * 2, rc.z",d=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let f="",m="";a&&(f=o?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${a}\n        }`:l?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${a}\n        }`:`vec4 activation(vec4 x) {\n          ${a}\n        }`,m="result = activation(result);");const g=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let y="rc.x",b="rc.x";t[0]<e[0]?y=`int(min(float(rc.x), ${t[0]-1}.))`:e[0]<t[0]&&(b=`int(min(float(rc.x), ${e[0]-1}.))`),this.userCode=`\n      ${f}\n\n      const float sharedDimension = ${u}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${u}; i++) {\n          int batchA = ${y};\n          int batchB = ${b};\n          vec4 a = getMatrixA(batchA, ${c});\n          vec4 b = getMatrixB(batchB, ${h});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${d[0]} * ${p[0]});\n          result += (${d[1]} * ${p[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${g}\n\n        ${m}\n\n        setOutput(result);\n      }\n    `}}class B0{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=d.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const V0="return a * b;";function W0(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=d.upcastType(r.dtype,s.dtype);if("complex64"===r.dtype){const t=n.texData.get(r.dataId),e=n.texData.get(s.dataId),i=new B0("return areal * breal - aimag * bimag;",r.shape,s.shape),a=new B0("return areal * bimag + aimag * breal;",r.shape,s.shape),o=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:r.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:s.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:s.shape}],l=n.runWebGLProgram(i,o,"float32"),u=n.runWebGLProgram(a,o,"float32"),c=T0({inputs:{real:l,imag:u},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),c}if(n.shouldExecuteOnCPU([r,s])){const t=n.texData.get(r.dataId),e=n.texData.get(s.dataId),[a,o]=XJ(r.shape,s.shape,t.values,e.values,i),l=n.makeTensorInfo(o,i);return n.texData.get(l.dataId).values=a,l}let a;return a=FI().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new C0(V0,r.shape,s.shape):new S0(V0,r.shape,s.shape),n.runWebGLProgram(a,[r,s],i)}const U0={kernelName:CT,backendName:"webgl",kernelFunc:W0};function j0(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{shape:a}=s,o=n,l=r.sizeFromShape(i.shape),u=r.inferFromImplicitShape(a,l),c=r.sizeFromShape(u);r.assert(l===c,()=>`The new shape (${u}) has ${c} elements and the old shape (${i.shape}) has ${l} elements. The new shape and old shape must have the same number of elements.`);const h=o.texData.get(i.dataId);return!h.isPacked||KQ(i.shape,u)||null!==h.texture&&KQ(h.shape,u)?(o.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype}):function(t,e,n){const r=[jQ(t.shape),...HQ(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},i=[jQ(e),...HQ(e)],a=new h0(i,r),o=n.runWebGLProgram(a,[s],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}(i,u,o)}const H0={kernelName:WT,backendName:"webgl",kernelFunc:j0};class q0{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:s,inSize:i,outSize:a}=t;this.outputShape=[s,a];const o=4*Math.floor(n/4),l=n%4;let u="sumValue += dot(values, ones);";if(null!=e){const t=1/e;u=`sumValue += dot(values * ${r.isInt(t)?t.toPrecision(2):t}, ones);`}let c="";i%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${o}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${o};\n        if (${1===l}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${u}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${u}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}class G0{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:s,outSize:i}=t;this.outputShape=[r,i];let a="0.0",o="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",o="min"):"max"===e&&(a="-1.0 / 1e-20",o="max");let l=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?l="sumValue":"prod"===e?l="prodValue":"all"===e?l="allValue":"any"===e&&(l="anyValue");const u=4*Math.floor(n/4),c=n%4;let h=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${o}(values, minMaxValue);\n      }\n    `,d="vec4";"all"===e?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";s%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${a};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${a});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${2===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${3===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${h}\n        }\n        setOutput(${l});\n      }\n    `}}function K0(t,e,n,r){const s=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],r=d.computeOptimalWindowSize(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}(t.shape);let i=t;for(let a=0;a<s.length;a++){const{inSize:o,windowSize:l,outSize:u}=s[a];let c,h;c="mean"===n?0===a?new q0({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u},o):new q0({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u}):new G0({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u},n),h=i,i=r.runWebGLProgram(c,[i],e),h.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(h)}return i}class X0{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let i=0;i<n.length;i++)n[i]=t[e[i]];this.outputShape=n,this.rank=n.length;const r=NJ(this.rank),s=function(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}(e);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${s}));\n    }\n    `}}class Y0{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let u=0;u<n.length;u++)n[u]=t[e[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=NJ(this.rank),s=l0("rc",this.rank),i=new Array(this.rank);for(let u=0;u<e.length;u++)i[e[u]]=s[u];const a=`vec2(${i.slice(-2).join()})`,o=`++${s[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${l};\n      if(${o}) {\n        result[1] = ${l};\n      }\n      --${s[this.rank-1]};\n      if(++${s[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${l};\n        if(${o}) {\n          result[3] = ${l};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function Z0(t,e,n){const r=FI().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Y0(t.shape,e):new X0(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}function Q0(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s;return function(t,e,n,s){const i=t.shape.length,a=r.parseAxisParam(e,t.shape);let o=a;const l=d.getAxesPermutation(o,i),u=null!=l;let c=t;u&&(c=Z0(t,l,s),o=d.getInnerMostAxes(o.length,i)),d.assertAxesAreInnerMostDims("sum",o,i);const[h,p]=d.computeOutAndReduceShapes(c.shape,o);let f=h;n&&(f=d.expandShapeToKeepDim(h,a));const m=r.sizeFromShape(p),g=j0({inputs:{x:c},attrs:{shape:[r.sizeFromShape(t.shape)/m,m]},backend:s}),y=K0(g,dA(t.dtype),"sum",s),b=j0({inputs:{x:y},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(g),s.disposeIntermediateTensorInfo(y),u&&s.disposeIntermediateTensorInfo(c),b}(i,a,o,n)}const J0={kernelName:oN,backendName:"webgl",kernelFunc:Q0};function t1(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,a=n,o=new Array(s.shape.length);for(let u=0;u<o.length;u++)o[u]=s.shape[i[u]];let l;if(a.shouldExecuteOnCPU([s])){const t=a.texData.get(s.dataId),e=a0(t.values,s.shape,s.dtype,i,o);l=a.makeTensorInfo(o,s.dtype),a.texData.get(l.dataId).values=e}else l=Z0(s,i,a);return l}const e1={kernelName:wN,backendName:"webgl",kernelFunc:t1};function n1({a:t,b:e,transposeA:n,transposeB:s,backend:i,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:u=null}){const c=t.shape.length,h=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],p=s?e.shape[h-1]:e.shape[h-2],f=n?t.shape[c-1]:t.shape[c-2],m=s?e.shape[h-2]:e.shape[h-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),b=r.sizeFromShape(g),v=r.sizeFromShape(y);r.assert(c>=2&&h>=2&&(b===v||1===b||1===v),()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${g}) and (${y}).`);const w=(b>v?t.shape.slice(0,-2):e.shape.slice(0,-2)).concat([f,m]);r.assert(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const _=n?[b,d,f]:[b,f,d],x=s?[v,m,p]:[v,p,m],k=j0({inputs:{x:t},backend:i,attrs:{shape:_}}),S=j0({inputs:{x:e},backend:i,attrs:{shape:x}}),C=[k,S],I=Math.max(b,v),E=n?k.shape[1]:k.shape[2],T=null!=a,N=null!=o,A="leakyrelu"===u,R=null!=u?P0(u,!0):null;let O;if((1===f||1===m)&&E>1e3&&!1===(T||N||A||null!=R)){let t=k,e=S;n&&(t=t1({inputs:{x:k},backend:i,attrs:{perm:[0,2,1]}}),C.push(t)),s&&(e=t1({inputs:{x:S},backend:i,attrs:{perm:[0,2,1]}}),C.push(e));const r=1===m;let a=t;1!==m&&(a=j0({inputs:{x:t},backend:i,attrs:{shape:[I,E,1]}}),C.push(a));const o=1===m?2:1;let l=e;r&&(l=j0({inputs:{x:e},backend:i,attrs:{shape:[I,1,E]}}),C.push(l));const u=W0({inputs:{a:a,b:l},backend:i});O=Q0({inputs:{x:u},backend:i,attrs:{axis:o,keepDims:!0}}),C.push(u)}else{const u=hA(t.dtype,e.dtype),c=new z0(_,x,[I,f,m],n,s,T,R,N,A),h=[k,S];if(null!=a&&h.push(a),N&&h.push(o),A){const t=i.makeTensorInfo([],"float32",r.createScalarValue(l,"float32"));h.push(t),C.push(t)}O=i.runWebGLProgram(c,h,u)}const D=j0({inputs:{x:O},backend:i,attrs:{shape:w}});C.push(O);for(const r of C)i.disposeIntermediateTensorInfo(r);return D}const r1={kernelName:TN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:h}=r;return n1({a:s,b:i,transposeA:l,transposeB:u,backend:n,bias:a,preluActivationWeights:o,leakyreluAlpha:h,activation:c})}},s1="return abs(x);",i1={kernelName:zI,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const t=n.texData.get(r.dataId),e=t0(t.values);return n.makeTensorInfo(r.shape,r.dtype,e)}let s;return s=FI().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new v0(r.shape,s1):new g0(r.shape,s1),n.runWebGLProgram(s,[r],r.dtype)}},a1=M0({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),o1={kernelName:BI,backendName:"webgl",kernelFunc:a1},l1=M0({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),u1={kernelName:VI,backendName:"webgl",kernelFunc:l1},c1="return a + b;",h1=L0({opSnippet:c1,packedOpSnippet:c1,supportsComplex:!0,cpuKernelImpl:DJ}),d1={kernelName:WI,backendName:"webgl",kernelFunc:h1};class p1{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`float v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}class f1{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`vec4 v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}const m1={kernelName:UI,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,s=n;if(1===s.length)return I0({inputs:{x:s[0]},backend:r});if(s.length>FI().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(s.length/2),n=t({inputs:s.slice(0,e),backend:r}),i=t({inputs:s.slice(e),backend:r});return t({inputs:[n,i],backend:r})}const i=s.map(t=>t.dtype).reduce((t,e)=>hA(t,e)),a=s.map(t=>t.shape),o=FI().getBool("WEBGL_PACK")?new f1(s[0].shape,a):new p1(s[0].shape,a);return r.runWebGLProgram(o,s,i)}},g1={kernelName:jI,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s,l=i.shape.length,u=r.parseAxisParam(a,i.shape);let c=u;const h=d.getAxesPermutation(c,l);let p=i;null!=h&&(p=t1({inputs:{x:i},backend:n,attrs:{perm:h}}),c=d.getInnerMostAxes(c.length,l)),d.assertAxesAreInnerMostDims("all",c,l);const[f,m]=d.computeOutAndReduceShapes(p.shape,c),g=j0({inputs:{x:p},backend:n,attrs:{shape:[-1,r.sizeFromShape(m)]}}),y=K0(g,g.dtype,"all",n);let b;return b=j0(o?{inputs:{x:y},backend:n,attrs:{shape:d.expandShapeToKeepDim(f,u)}}:{inputs:{x:y},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),null!=h&&n.disposeIntermediateTensorInfo(p),b}},y1={kernelName:HI,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s,l=i.shape.length,u=r.parseAxisParam(a,i.shape);let c=u;const h=d.getAxesPermutation(c,l);let p=i;null!=h&&(p=t1({inputs:{x:i},backend:n,attrs:{perm:h}}),c=d.getInnerMostAxes(c.length,l)),d.assertAxesAreInnerMostDims("any",c,l);const[f,m]=d.computeOutAndReduceShapes(p.shape,c),g=j0({inputs:{x:p},backend:n,attrs:{shape:[-1,r.sizeFromShape(m)]}}),y=K0(g,g.dtype,"any",n);let b;return b=j0(o?{inputs:{x:y},backend:n,attrs:{shape:d.expandShapeToKeepDim(f,u)}}:{inputs:{x:y},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),null!=h&&n.disposeIntermediateTensorInfo(p),b}};class b1{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:s,outSize:i}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[s,i],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${"max"===e?">":"<"} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class v1{constructor(t,e,n,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,r.assert(t.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);const i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,o=a.length,l=NJ(o),u=u0("coords",o);let c,h;if(1===i){h=o+1;const t=NJ(h);c=`\n        ${t} sourceLocR = ${t}(${u.join()}, 0);\n        ++${u[o-1]};\n        ${t} sourceLocG = ${t}(${u.join()}, 0);\n        ++${u[o-2]};\n        ${t} sourceLocA = ${t}(${u.join()}, 0);\n        --${u[o-1]};\n        ${t} sourceLocB = ${t}(${u.join()}, 0);\n        --${u[o-2]};`}else h=o,c=`\n        ${l} sourceLocR = coords;\n        ++${u[o-1]};\n        ${l} sourceLocG = coords;\n        ++${u[o-2]};\n        ${l} sourceLocA = coords;\n        --${u[o-1]};\n        ${l} sourceLocB = coords;\n        --${u[o-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],f=d.map(t=>"int "+t),m=u0("sourceLocR",h-1).concat("inIdx.r"),g=u0("sourceLocG",h-1).concat("inIdx.g"),y=u0("sourceLocB",h-1).concat("inIdx.b"),b=u0("sourceLocA",h-1).concat("inIdx.a"),v="max"===n?"greaterThan":"lessThan",w=s?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${b.join()})));`,_=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${g.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,x=s?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${d.join()}),\n                                          vec2(${d.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${d.join()}),\n                               vec2(${d.slice(-2).join()}));\n      }\n      ${x}\n      void main() {\n        ${l} coords = getOutputCoords();\n        bool hasNextCol = ${u[o-1]} < ${a[o-1]-1};\n        bool hasNextRow = ${u[o-2]} < ${a[o-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${_};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${w}\n          vec4 candidate = ${_};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function w1(t,e,n,r=null){let s=e.shape[0],i=e.shape[1];null!=r&&(s=r.shape[0],i=r.shape[1]);const a=d.computeOptimalWindowSize(i),o={windowSize:a,inSize:i,batchSize:s,outSize:Math.ceil(i/a)},l=new b1(o,n,null==r),u=[e];null!=r&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(1===c.shape[1])return c;const h=w1(t,e,n,c);return t.disposeIntermediateTensorInfo(c),h}function _1(t,e,n,r=null){const s=null!=r?r.shape:e.shape,i=d.computeOptimalWindowSize(s[s.length-1]),a=new v1(s,i,n,null==r),o=t.runWebGLProgram(a,null==r?[e]:[e,r],"int32");if(o.shape.length===e.shape.length){const r=_1(t,e,n,o);return t.disposeIntermediateTensorInfo(o),r}return o}function x1(t,e,n,s){const i=[n];if(d.assertAxesAreInnerMostDims("arg"+s.charAt(0).toUpperCase()+s.slice(1),i,e.shape.length),!FI().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],[a,o]=d.computeOutAndReduceShapes(e.shape,i),l=r.sizeFromShape(o),u=j0({inputs:{x:e},backend:t,attrs:{shape:[-1,l]}});n.push(u);const c=w1(t,u,s);n.push(c);const h=j0({inputs:{x:c},backend:t,attrs:{shape:a}});return n.forEach(e=>t.disposeIntermediateTensorInfo(e)),h}return _1(t,e,s)}const k1={kernelName:qI,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a}=s;let o=r.parseAxisParam(a,i.shape);const l=d.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=l&&(u=t1({inputs:{x:i},backend:n,attrs:{perm:l}}),c.push(u),o=d.getInnerMostAxes(o.length,u.shape.length)),d.assertAxesAreInnerMostDims("argMax",[o[0]],u.shape.length);const h=x1(n,u,o[0],"max");return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),h}},S1={kernelName:GI,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a}=s;let o=r.parseAxisParam(a,i.shape);const l=d.getAxesPermutation(o,i.shape.length);let u=i;const c=[];null!=l&&(u=t1({inputs:{x:i},backend:n,attrs:{perm:l}}),c.push(u),o=d.getInnerMostAxes(o.length,u.shape.length)),d.assertAxesAreInnerMostDims("argMin",[o[0]],u.shape.length);const h=x1(n,u,o[0],"min");return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),h}},C1=M0({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),I1={kernelName:KI,backendName:"webgl",kernelFunc:C1},E1=M0({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),T1={kernelName:XI,backendName:"webgl",kernelFunc:E1},N1=M0({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),A1={kernelName:YI,backendName:"webgl",kernelFunc:N1},R1=L0({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),O1={kernelName:QI,backendName:"webgl",kernelFunc:R1},D1=M0({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),F1={kernelName:ZI,backendName:"webgl",kernelFunc:D1};class $1{constructor(t,e,n,r=!1,s=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,a=t.strideHeight,o=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e;let m="0.0";if(f||(m="-1.0 / 1e-20"),n)return void(this.userCode=`\n        const ivec2 strides = ivec2(${a}, ${o});\n        const ivec2 pads = ivec2(${d}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?s?`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`:`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`:`wR * ${h} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let g=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(g="avgValue / count");const y=4*Math.floor(i/4),b=i%4,v=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${a}, ${o});\n      const ivec2 pads = ivec2(${d}, ${p});\n      const float initializationValue = ${m};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${m});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${l}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${y}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${v}\n          }\n\n          int xC = xCCorner + ${y};\n          if (${1===b}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${v}\n          } else if (${2===b}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${v}\n          } else if (${3===b}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${v}\n          }\n        }\n        setOutput(${g});\n      }\n    `}}class M1{constructor(t,e,n,r=!1,s=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,a=t.strideDepth,o=t.strideHeight,l=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const b="avg"===e;let v="0.0";if(b||(v="-1.0 / 1e-20"),n)return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${a}, ${o}, ${l});\n        const ivec3 pads = ivec3(${m}, ${g}, ${y});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${d};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${h}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let w=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(w="avgValue / count");const _=4*Math.floor(i/4),x=i%4,k=`\n      if (${b}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${a}, ${o}, ${l});\n      const ivec3 pads = ivec3(${m}, ${g}, ${y});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${_}; wC += 4) {\n              int xC = xCCorner + wC * ${h};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${h}, ch)\n              );\n\n              ${k}\n            }\n\n            int xC = xCCorner + ${_};\n            if (${1===x}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${k}\n            } else if (${2===x}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${k}\n            } else if (${3===x}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                initializationValue\n              );\n\n              ${k}\n            }\n          }\n          setOutput(${w});\n        }\n      }\n    `}}const L1={kernelName:JI,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e;tJ(i,"avgPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=s;r.assert(d.eitherStridesOrDilationsAreOne(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.computePool2DInfo(i.shape,a,o,1,l,u);if(1===c.filterWidth&&1===c.filterHeight&&r.arraysEqual(c.inShape,c.outShape))return I0({inputs:{x:i},backend:n});const h=new $1(c,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}},P1={kernelName:eE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=d.computePool3DInfo(s.shape,i,a,[1,1,1],o,l,u),h=new M1(c,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}};class z1{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e};\n            wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${n};\n            wC+= ${t.dilationWidth}) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class B1{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterDepth*t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${e};\n            wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${n};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${r};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const V1={kernelName:nE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,a=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,h=d.computePool3DInfo(a.shape,o,l,[1,1,1],u,c),p=new B1(h);return n.runWebGLProgram(p,[s],a.dtype)}},W1={kernelName:tE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,a=i;tJ([s,i],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=d.computePool2DInfo(a.shape,o,l,1,u),h=new z1(c);return n.runWebGLProgram(h,[s],a.dtype)}},U1={kernelName:rE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:a,transposeB:o}=r;return n1({a:s,b:i,transposeA:a,transposeB:o,backend:n})}};class j1{constructor(t,e,n,r,s,i){this.outputShape=[],this.variableNames=["x","mean","variance"],d.assertAndGetBroadcastShape(t,e),d.assertAndGetBroadcastShape(t,n);let a="0.0";null!=r&&(d.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let o="1.0";null!=s&&(d.assertAndGetBroadcastShape(t,s),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${a};\n        float scale = ${o};\n        float inv = scale * inversesqrt(variance + float(${i}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class H1{constructor(t,e,n,r,s,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],d.assertAndGetBroadcastShape(t,e),d.assertAndGetBroadcastShape(t,n);let a="vec4(0.0)";null!=r&&(d.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=s&&(d.assertAndGetBroadcastShape(t,s),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${a};\n        vec4 scale = ${o};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${i}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const q1={kernelName:jE,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:i,variance:a,offset:o,scale:l}=t;r.assert(i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),r.assert(null==o||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),r.assert(null==l||i.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=n;null==u&&(u=.001);const c=[s,i,a];let h=null;null!=o&&(h=o.shape,c.push(o));let d=null;null!=l&&(d=l.shape,c.push(l));const p=FI().getBool("WEBGL_PACK_NORMALIZATION")?new H1(s.shape,i.shape,a.shape,h,d,u):new j1(s.shape,i.shape,a.shape,h,d,u);return e.runWebGLProgram(p,c,c[0].dtype)}};class G1{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=NJ(this.rank),n=`uniform int start[${this.rank}];`,r=function(t){if(1===t)return"sourceLoc";if(t<=6)return K1.slice(0,t).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}(this.rank);let s;s=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((t,e)=>`sourceLoc.${K1[e]} = start[${e}] + coords.${K1[e]};`).join("\n")}\n      `,this.userCode=`\n      ${n}\n      void main() {\n        ${s}\n        setOutput(getSource(${r}));\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}const K1=["x","y","z","w","u","v"];class X1{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const e=NJ(this.rank),n=u0("coords",this.rank),r=u0("sourceLoc",this.rank),s=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${s})`,a=`\n      result.x = ${i};\n      if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${i};\n        --${r[this.rank-1]};\n      }\n    `,o=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${i};\n        if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${i};\n        }\n      }\n    `,l=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((t,e)=>`start[${e}]`).join()});`:t.map((t,e)=>`${r[e]} = ${n[e]} + start[${e}];`).join("\n");this.userCode=`\n      uniform int start[${this.rank}];\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${l}\n        vec4 result = vec4(0.);\n        ${a}\n        ${o}\n        setOutput(result);\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}function Y1(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{begin:a,size:o}=s,[u,c]=l.parseSliceParams(i,a,o);if(l.assertParamsValid(i,u,c),0===r.sizeFromShape(c))return n.makeTensorInfo(c,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const t=n.texData.get(i.dataId),e=e0(t.values,u,c,i.shape,i.dtype);return n.makeTensorInfo(c,i.dtype,e)}const{isPacked:h}=n.texData.get(i.dataId),d=l.isSliceContinous(i.shape,u,c);if(h||!d){const t=FI().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new X1(c):new G1(c),e=t.getCustomSetupFunc(u);return n.runWebGLProgram(t,[i],i.dtype,e)}return n.uploadToGPU(i.dataId),function(t,e,n,s){const i=s.texData.get(t.dataId),a=s.makeTensorInfo(n,t.dtype),o=s.texData.get(a.dataId);Object.assign(o,i),o.complexParentRefCount=0,o.refCount=1,o.shape=n,o.dtype=t.dtype;let u=l.computeFlatOffset(e,r.computeStrides(t.shape));i.slice&&(u+=i.slice.flatOffset),o.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||t.dataId};const c=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,c+1),a}(i,u,c,n)}const Z1={kernelName:tN,backendName:"webgl",kernelFunc:Y1},Q1={kernelName:sE,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{blockShape:a,crops:o}=s;r.assert(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((t,e)=>t*e),u=d.getReshaped(i.shape,a,l),c=d.getPermuted(u.length,a.length),h=d.getReshapedPermuted(i.shape,a,l),p=d.getSliceBeginCoords(o,a.length),f=d.getSliceSize(h,o,a.length),m=[],g=j0({inputs:{x:i},backend:n,attrs:{shape:u}}),y=t1({inputs:{x:g},backend:n,attrs:{perm:c}}),b=j0({inputs:{x:y},backend:n,attrs:{shape:h}}),v=Y1({inputs:{x:b},backend:n,attrs:{begin:p,size:f}});return m.push(g),m.push(y),m.push(b),m.forEach(t=>n.disposeIntermediateTensorInfo(t)),v}},J1={kernelName:iE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:a}=r,o=n.readSync(s.dataId),l=n.readSync(i.dataId),u=FJ(o,l,i.dtype,i.shape,a);return n.makeTensorInfo([a],i.dtype,u)}},t2=L0({opSnippet:"return float(a != b);",dtype:"bool"}),e2={kernelName:ET,backendName:"webgl",kernelFunc:t2};function n2(t){const{inputs:e,backend:n}=t,{input:r}=e;return I0({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const r2={kernelName:zT,backendName:"webgl",kernelFunc:n2},s2={kernelName:aE,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:s,attrs:i}=e,{x:a}=n,{dtype:o}=i;if("complex64"===o){if("complex64"===a.dtype)return I0({inputs:{x:a},backend:s});const e=YD(a.shape),n=t({inputs:{x:a},backend:s,attrs:{dtype:"float32"}}),r=T0({inputs:{real:n,imag:e},backend:s});return e.dispose(),s.disposeIntermediateTensorInfo(n),r}if("complex64"===a.dtype){const e=n2({inputs:{input:a},backend:s}),n=t({inputs:{x:e},backend:s,attrs:{dtype:o}});return s.disposeIntermediateTensorInfo(e),n}if(!r.hasEncodingLoss(a.dtype,o)){const t=I0({inputs:{x:a},backend:s});return{dataId:t.dataId,shape:t.shape,dtype:o}}if("int32"===o)return function(t,e){const n=new g0(t.shape,"return float(int(x));"),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(a,s);if("bool"===o){const t=s.makeTensorInfo([],"bool",r.getTypedArrayFromDType("bool",1)),e=t2({inputs:{a:a,b:t},backend:s});return s.disposeIntermediateTensorInfo(t),e}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${o}`)}},i2="return ceil(x);",a2=M0({opSnippet:i2,packedOpSnippet:i2,cpuKernelImpl:MJ}),o2={kernelName:oE,backendName:"webgl",kernelFunc:a2};class l2{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}getCustomSetupFunc(t,e){return(n,r)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class u2{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}getCustomSetupFunc(t,e){return(n,r)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(r,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(r,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}const c2={kernelName:lE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:a}=r;let o;o=FI().getBool("WEBGL_PACK_CLIP")?new u2(s.shape):new l2(s.shape);const l=o.getCustomSetupFunc(i,a);return n.runWebGLProgram(o,[s],s.dtype,l)}};class h2{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function d2(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}const p2={kernelName:cE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),i=new h2(r.shape),a=[d2(r,s.complexTensorInfos.real),d2(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(i,a,a[0].dtype)}};class f2{constructor(t){this.outputShape=[],this.outputShape=d.computeOutShape(t,1),this.variableNames=t.map((t,e)=>"T"+e);const e=new Array(t.length-1);e[0]=t[0][1];for(let r=1;r<e.length;r++)e[r]=e[r-1]+t[r][1];const n=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let r=1;r<e.length;r++)n.push(`else if (yC < ${e[r]}) setOutput(getT${r}(yR, yC-${e[r-1]}));`);n.push(`else setOutput(getT${e.length}(yR, yC-${e[e.length-1]}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}class m2{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=d.computeOutShape(t,e);const n=this.outputShape,r=n.length,s=NJ(r),i=u0("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((t,e)=>"T"+e);const o=new Array(t.length-1);o[0]=t[0][e];for(let d=1;d<o.length;d++)o[d]=o[d-1]+t[d][e];const l=a[e],u=a.slice(-2),c=a.join();let h=`if (${l} < ${o[0]}) {\n        return getChannel(\n            getT0(${c}), vec2(${u.join()}));\n        }`;for(let d=1;d<o.length;d++){const t=o[d-1];h+=`\n        if (${l} < ${o[d]}  && ${l} >= ${o[d-1]}) {\n          return getChannel(\n            getT${d}(${g2(a,l,t)}),\n            vec2(${g2(u,l,t)}));\n        }`}const p=o[o.length-1];h+=`\n        return getChannel(\n          getT${o.length}(${g2(a,l,p)}),\n          vec2(${g2(u,l,p)}));`,this.userCode=`\n      float getValue(${a.map(t=>"int "+t)}) {\n        ${h}\n      }\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${i}), 0., 0., 0.);\n\n        ${i[r-1]} = ${i[r-1]} + 1;\n        if (${i[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${i});\n        }\n\n        ${i[r-2]} = ${i[r-2]} + 1;\n        if (${i[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${i});\n        }\n\n        ${i[r-1]} = ${i[r-1]} - 1;\n        if (${i[r-2]} < ${n[r-2]} &&\n            ${i[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${i});\n        }\n        setOutput(result);\n      }\n    `}}function g2(t,e,n){const r=t.indexOf(e);return t.map((t,e)=>e===r?`${t} - ${n}`:t).join()}function y2(t){const{inputs:e,backend:n}=t,{input:r}=e;return I0({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const b2={kernelName:ZE,backendName:"webgl",kernelFunc:y2};function v2(t,e,n){const r=t[0].dtype;if("complex64"===r){const r=t.map(t=>n2({inputs:{input:t},backend:n})),s=t.map(t=>y2({inputs:{input:t},backend:n})),i=v2(r,e,n),a=v2(s,e,n),o=T0({inputs:{real:i,imag:a},backend:n});return r.forEach(t=>n.disposeIntermediateTensorInfo(t)),s.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}if("string"===r){const{tensors2D:s,outShape:i}=w2(t,e,n),a=s.map(t=>({vals:n.readSync(t.dataId),shape:t.shape})),o=LJ(a,i,r,1===s[0].shape[0]),l=d.computeOutShape(t.map(t=>t.shape),e),u=n.makeTensorInfo(l,r,o);return s.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}if(t.length>FI().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const r=Math.floor(t.length/2),s=v2(t.slice(0,r),e,n),i=v2(t.slice(r),e,n),a=v2([s,i],e,n);return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),a}if(FI().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const s=new m2(t.map(t=>t.shape),e);return n.runWebGLProgram(s,t,r)}const{tensors2D:s,outShape:i}=w2(t,e,n),a=new f2(s.map(t=>t.shape)),o=n.runWebGLProgram(a,s,r);s.forEach(t=>n.disposeIntermediateTensorInfo(t));const l=j0({inputs:{x:o},attrs:{shape:i},backend:n});return n.disposeIntermediateTensorInfo(o),l}function w2(t,e,n){const s=d.computeOutShape(t.map(t=>t.shape),e);return{tensors2D:t.map(t=>j0({inputs:{x:t},attrs:{shape:[-1,r.sizeFromShape(t.shape.slice(e))]},backend:n})),outShape:s}}function _2(t){const{inputs:e,backend:n,attrs:s}=t,{axis:i}=s,a=r.parseAxisParam(i,e[0].shape)[0],o=d.computeOutShape(e.map(t=>t.shape),a);if(0===r.sizeFromShape(o))return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(t=>r.sizeFromShape(t.shape)>0);if(1===l.length)return I0({inputs:{x:l[0]},backend:n});const u=l.map(t=>t.shape);return d.assertParamsConsistent(u,a),v2(l,a,n)}const x2={kernelName:hE,backendName:"webgl",kernelFunc:_2};class k2{constructor(t,e=!1,n=null,r=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.padInfo.top,a=t.padInfo.left,o=t.strideHeight,l=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,y=m?2:3,b=m?3:1;let v="",w="";n&&(v=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,w="result = activation(result);");const _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${o}, ${l});\n      const ivec2 pads = ivec2(${i}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${b}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${g}], coords[${y}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${h}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${d}; wC++) {\n            int xC = xCCorner + wC * ${c};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${_}\n        ${w}\n        setOutput(result);\n      }\n    `}}class S2{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,s=t.strideDepth,i=t.strideHeight,a=t.strideWidth,o=t.dilationDepth,l=t.dilationHeight,u=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${s}, ${i}, ${a});\n      const ivec3 pads = ivec3(${e}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${o};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h}; wR++) {\n            int xR = xRCorner + wR * ${l};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class C2{constructor(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:r,inChannels:s,strideWidth:i,strideHeight:a,padInfo:o,outWidth:l,dilationWidth:u,dilationHeight:c,dataFormat:h}=n,{left:d,top:p}=o,f=s*r,m=nJ(),g="channelsLast"===h,y=g?0:1,b=g?1:2;let v="";for(let w=0;w<=1;w++)for(let n=0;n<=1;n++)v+=`\n          blockIndex = rc.y + ${n};\n          pos = rc.x + ${w};\n\n          if(blockIndex < ${t[1]} && pos < ${t[0]}) {\n            offsetY = int(blockIndex / (${l})) * ${a} - ${p};\n            d0 = offsetY + ${c} * (pos / ${f});\n\n            if(d0 < ${e[y]} && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ${l}.) * ${i}. - ${d}.);\n              d1 = offsetX + ${u} * (int(mod(float(pos), ${f}.) / ${s}.));\n\n              if(d1 < ${e[b]} && d1 >= 0) {\n\n                ch = int(mod(float(pos), ${s}.));\n\n                if (${g}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*w+n}] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*w+n}] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${v}\n\n        ${m.output} = result;\n      }\n    `}}function I2({x:t,filter:e,convInfo:n,backend:s,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const u=t.shape,c=s.texData.get(t.dataId),h="channelsLast"===n.dataFormat;let d;const p=[],f=u[2]%2!=0&&!!c.isPacked;if((1!=u[0]*u[1]*u[2]&&1!==n.outChannels||!(n.inChannels>1e3))&&FI().getBool("WEBGL_LAZILY_UNPACK")&&FI().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&f){const f={dataId:t.dataId,shape:[1,h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),n.inChannels],dtype:t.dtype},m=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,r.assert(KQ(c.shape,f.shape),()=>`packed reshape ${c.shape} to ${f.shape} isn't free`);const g=j0({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});p.push(g);const y=n1({a:f,b:g,backend:s,transposeA:!1,transposeB:!1,bias:i,activation:l,preluActivationWeights:a,leakyreluAlpha:o}),b=s.texData.get(y.dataId);r.assert(b.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=m,b.shape=n.outShape,d=I0({inputs:{x:y},backend:s}),d.shape=n.outShape,p.push(y)}else{const r=j0({inputs:{x:t},backend:s,attrs:{shape:[1,h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],n.inChannels]}}),c=j0({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),f=n1({a:r,b:c,transposeA:!1,transposeB:!1,backend:s,bias:i,activation:l,preluActivationWeights:a,leakyreluAlpha:o});d=j0({inputs:{x:f},backend:s,attrs:{shape:n.outShape}}),p.push(r),p.push(c),p.push(f)}for(const r of p)s.disposeIntermediateTensorInfo(r);return d}function E2({x:t,filter:e,convInfo:n,backend:s,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const{filterWidth:u,filterHeight:c,inChannels:h,outWidth:d,outHeight:p,dataFormat:f}=n,m="channelsLast"===f,g=u*c*h,y=p*d,b=[g,y],v=[],w=j0({inputs:{x:t},backend:s,attrs:{shape:t.shape.slice(1)}}),_=j0({inputs:{x:e},backend:s,attrs:{shape:[1,g,r.sizeFromShape(e.shape)/g]}});v.push(w),v.push(_);const x=new C2(b,w.shape,n),k=s.runWebGLProgram(x,[w],"float32"),S=j0({inputs:{x:k},backend:s,attrs:{shape:[1,b[0],b[1]]}});v.push(k),v.push(S);const C=null!=i,I=null!=a,E="leakyrelu"===l,T=l?P0(l,!0):null,N=new z0(S.shape,_.shape,[1,y,n.outChannels],!0,!1,C,T,I,E),A=[S,_];if(i&&A.push(i),I&&A.push(a),E){const t=s.makeTensorInfo([],"float32",r.createScalarValue(o,"float32"));A.push(t),v.push(t)}const R=s.runWebGLProgram(N,A,"float32"),O=j0({inputs:{x:R},backend:s,attrs:{shape:m?[1,p,d,n.outChannels]:[1,n.outChannels,p,d]}});v.push(R);for(const r of v)s.disposeIntermediateTensorInfo(r);return O}const T2={kernelName:dE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:a,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r,h=d.convertConv2DDataFormat(l),p=d.computeConv2DInfo(s.shape,i.shape,a,u,o,c,!1,h);let f;if(1!==p.filterHeight||1!==p.filterWidth||1!==p.dilationHeight||1!==p.dilationWidth||1!==p.strideHeight||1!==p.strideWidth||"SAME"!==p.padInfo.type&&"VALID"!==p.padInfo.type)if(FI().getBool("WEBGL_CONV_IM2COL")&&1===s.shape[0])f=E2({x:s,filter:i,convInfo:p,backend:n});else{const t=new k2(p);f=n.runWebGLProgram(t,[s,i],"float32")}else f=I2({x:s,filter:i,convInfo:p,backend:n});const m=j0({inputs:{x:f},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(f),m}};class N2{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              if (${"channelsLast"===t.dataFormat}) {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class A2{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r="channelsLast"===t.dataFormat;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${r?3:1}];\n\n        ivec2 dyCorner = ivec2(coords[${r?1:2}], coords[${r?2:3}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${r}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class R2{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${t.strideDepth} - ${t.padInfo.front};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class O2{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${t.strideDepth}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const D2={kernelName:pE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,h=d.convertConv2DDataFormat(l),p=d.computeConv2DInfo(s.shape,c,a,1,o,u,!1,h),f=new N2(p);return n.runWebGLProgram(f,[s,i],"float32")}},F2={kernelName:fE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:a,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r,h=d.convertConv2DDataFormat(u),p=d.computeConv2DInfo(a,i.shape,o,1,l,c,!1,h),f=new A2(p);return n.runWebGLProgram(f,[s,i],"float32")}},$2={kernelName:mE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:a,pad:o,dilations:l}=r,u=d.computeConv3DInfo(s.shape,i.shape,a,l,o),c=new S2(u);return n.runWebGLProgram(c,[s,i],"float32")}},M2={kernelName:gE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:a,pad:o,filterShape:l}=r,u=d.computeConv3DInfo(s.shape,l,a,1,o),c=new R2(u);return n.runWebGLProgram(c,[s,i],"float32")}},L2={kernelName:yE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:a,strides:o,inputShape:l}=r,u=d.computeConv3DInfo(l,i.shape,o,1,a),c=new O2(u);return n.runWebGLProgram(c,[s,i],"float32")}},P2=M0({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),z2={kernelName:bE,backendName:"webgl",kernelFunc:P2},B2=M0({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),V2={kernelName:vE,backendName:"webgl",kernelFunc:B2};class W2{constructor(t,e,n,r,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,o,l]=t,[u]=e,[c,h]=n;this.outputShape=[u,c,h,l];const d="bilinear"===r?1:0,[p,f]=[a-1+".0",o-1+".0"],[m,g,y]=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0","0.5 * (y1+y2) * "+p],[b,v,w]=h>1?[""+(o-1)/(h-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0","0.5 * (x1+x2) * "+f];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${b});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${i}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${v};\n\n        float in_y = ${y};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${s}));\n          return;\n        }\n        float in_x = ${w};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${s}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${d} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const U2={kernelName:_E,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:u}=r,c=new W2(s.shape,i.shape,o,l,u);return n.runWebGLProgram(c,[s,i,a],"float32")}};class j2{constructor(t,e,n){this.variableNames=["x"],this.outputShape=t;const r=t.length,s=e?"0.0":`getX(${H2(r,"coords")})`,i=t[t.length-1];let a="",o="";e?(a=n?"end != "+(i-1):"end != 0",o=n?"end + 1":"end - 1"):(a=n?"end + pow2 < "+i:"end >= pow2",o=n?"end + pow2":"end - pow2"),this.userCode=`\n      uniform float index;\n      void main() {\n        ${NJ(r)} coords = getOutputCoords();\n        int end = ${q2(r,"coords")};\n        float val = ${s};\n        int pow2 = int(pow(2.0, index));\n        if (${a}) {\n          int idx = ${o};\n          ${q2(r,"coords")} = idx;\n          val += getX(${H2(r,"coords")});\n        }\n        setOutput(val);\n      }\n    `}getCustomSetupFunc(t){return(e,n)=>{null==this.index&&(this.index=e.getUniformLocation(n,"index")),e.gl.uniform1f(this.index,t)}}}function H2(t,e){if(1===t)return""+e;if(2===t)return`${e}.x, ${e}.y`;if(3===t)return`${e}.x, ${e}.y, ${e}.z`;if(4===t)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative sum for rank ${t} is not yet supported`)}function q2(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error(`Cumulative sum for rank ${t} is not yet supported`)}const G2={kernelName:wE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r,l=s.shape.length,u=d.getAxesPermutation([i],l);let c=s;null!=u&&(c=t1({inputs:{x:s},backend:n,attrs:{perm:u}}));const h=d.getInnerMostAxes(1,l)[0];if(h!==l-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${s.shape.length-1} but got axis=`+i);const p=s.shape[h];let f=I0({inputs:{x:c},backend:n});for(let d=0;d<=Math.ceil(Math.log2(p))-1;d++){const t=new j2(c.shape,!1,o),e=t.getCustomSetupFunc(d),r=f;f=n.runWebGLProgram(t,[f],f.dtype,e),n.disposeIntermediateTensorInfo(r)}if(a){const t=new j2(c.shape,a,o),e=f;f=n.runWebGLProgram(t,[f],f.dtype),n.disposeIntermediateTensorInfo(e)}if(null!=u){const t=t1({inputs:{x:f},backend:n,attrs:{perm:d.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(c),t}return f}},K2={kernelName:xE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:a,binaryOutput:o}=r;if(1===s.shape.length){const t=n.readSync(s.dataId),e=n.readSync(i.dataId),r=FJ(t,e,i.dtype,i.shape,a);return n.makeTensorInfo([a],i.dtype,r)}if(2===s.shape.length){const t=n.bufferSync(s),e=n.bufferSync(i),r=$J(t,e,a,o);return n.makeTensorInfo(r.shape,i.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+s.shape.length+".")}};class X2{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const Y2={kernelName:kE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{blockSize:a,dataFormat:o}=s;r.assert(a>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+a);const l=i.shape[0],u=("NHWC"===o?i.shape[1]:i.shape[2])*a,c=("NHWC"===o?i.shape[2]:i.shape[3])*a,h=("NHWC"===o?i.shape[3]:i.shape[1])/(a*a),d=new X2("NHWC"===o?[l,u,c,h]:[l,h,u,c],a,o);return n.runWebGLProgram(d,[i],i.dtype)}};class Z2{constructor(t,e=!1,n=null,r=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.inHeight,a=t.inWidth,o=t.padInfo.top,l=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,m=t.outChannels/t.inChannels;let g="",y="";n&&(g=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,y="result = activation(result);");const b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${g}\n\n      const ivec2 strides = ivec2(${u}, ${c});\n      const ivec2 pads = ivec2(${o}, ${l});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${m};\n        int q = d2 - d1 * ${m};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${p}; wR++) {\n          int xR = xRCorner + wR * ${h};\n\n          if (xR < 0 || xR >= ${i}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${f}; wC++) {\n            int xC = xCCorner + wC * ${d};\n\n            if (xC < 0 || xC >= ${a}) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${b}\n        ${y}\n        setOutput(result);\n      }\n    `}}class Q2{constructor(t,e=!1,n=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const a=t.inHeight,o=t.inWidth,l=t.padInfo.top,u=t.padInfo.left,c=t.strideHeight,h=t.strideWidth,d=t.dilationHeight,p=t.dilationWidth,f=t.filterHeight,m=t.filterWidth,g=m;let y="int xR; int xC; int xCOffset;";for(let r=0;r<f;r++)for(let t=0;t<m;t++)y+=`\n          vec4 xTexelR${r}C${2*t} = vec4(0.);\n          vec4 wR${r}C${t} = vec4(0.);\n          vec4 xR${r}C${t} = vec4(0.);`;for(let _=0;_<f;_++)for(let t=0;t<g;t++){const e=2*t;if(y+=`\n          xR = xRCorner + ${_*d};\n          xC = xCCorner + ${e*p};\n        `,1===h){if(e<m&&(y+=u%2==1?`\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ${a} && xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${_}C${e} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${o}) {\n                    xTexelR${_}C${e}.zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR${_}C${e} = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ${a} && xCOffset >= 0 && xCOffset < ${o}) {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${o}) {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR${_}C${e} = vec4(previous.zw, xTexelR${_}C${e}.xy);\n                } else {\n                  xR${_}C${e} = vec4(0, 0, xTexelR${_}C${e}.xy);\n                }\n              `:`\n                if(xR >= 0 && xR < ${a} && xC >= 0 && xC < ${o}) {\n                  xTexelR${_}C${e} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${_}C${e} = vec4(0.);\n                }\n\n                xR${_}C${e} = xTexelR${_}C${e};\n              `,e+1<m)){const t=u%2==0?r.nearestLargerEven(p):p;p%2==0&&u%2==1||p%2!=0&&u%2!=1?(y+=`\n                  xCOffset = xC + ${u%2} + ${t};\n\n                  if(xR >= 0 && xR < ${a} &&\n                    xCOffset >= 0 && xCOffset < ${o}) {\n                    xTexelR${_}C${e+2} = getX(batch, xR, xCOffset, d1);\n                  }\n                `,p>1&&(y+=`\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ${a} &&\n                      xCOffset >= 0 && xCOffset < ${o}) {\n                      xTexelR${_}C${e} = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR${_}C${e} = vec4(0.);\n                    }\n                  `),y+=`\n                  xR${_}C${e+1} = vec4(\n                    xTexelR${_}C${e}.zw, xTexelR${_}C${e+2}.xy);\n                `):y+=`\n                  xCOffset = xC + ${t};\n\n                  if(xR >= 0 && xR < ${a} &&\n                    xCOffset >= 0 && xCOffset < ${o}) {\n                    xTexelR${_}C${e+2} = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR${_}C${e+1} = xTexelR${_}C${e+2};\n                `}}else e<m&&(y+=`\n              if(xR >= 0 && xR < ${a}) {\n            `,u%2==1?(y+=`\n                xCOffset = xC + 1 - ${h};\n                if(xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${_}C${e} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${_}C${e} = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ${o}) {\n                  xTexelR${_}C${e+2} = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR${_}C${e+2} = vec4(0.);\n                }\n\n                xR${_}C${e} = vec4(\n                  xTexelR${_}C${e}.zw, xTexelR${_}C${e+2}.zw);\n              `,e+1<m&&(y+=`\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ${h};\n                  if(xCOffset >= 0 && xCOffset < ${o}) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR${_}C${e+1} = vec4(xTexelR${_}C${e+2}.xy, final.xy);\n                `)):(y+=`\n                if(xC >= 0 && xC < ${o}) {\n                  xTexelR${_}C${e} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${_}C${e} = vec4(0.);\n                }\n\n                xCOffset = xC + ${h};\n                if(xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${_}C${e+2} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${_}C${e+2} = vec4(0.);\n                }\n\n                xR${_}C${e} = vec4(\n                  xTexelR${_}C${e}.xy, xTexelR${_}C${e+2}.xy);\n              `,e+1<m&&(y+=`\n                  xR${_}C${e+1} = vec4(\n                    xTexelR${_}C${e}.zw, xTexelR${_}C${e+2}.zw);\n                `)),y+="}");e<m&&(y+=`\n            vec4 wTexelR${_}C${e} = getW(${_}, ${e}, d1, q);\n            wR${_}C${e} = vec4(wTexelR${_}C${e}.xz, wTexelR${_}C${e}.xz);\n          `,e+1<m&&(y+=`\n              vec4 wTexelR${_}C${e+1} = getW(${_}, ${e+1}, d1, q);\n              wR${_}C${e+1} =\n                vec4(wTexelR${_}C${e+1}.xz, wTexelR${_}C${e+1}.xz);`))}for(let r=0;r<f;r++)for(let t=0;t<m;t++)y+=`dotProd += xR${r}C${t} * wR${r}C${t};`;let b="",v="";n&&(b=s?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,v="result = activation(result);");const w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${b}\n\n      const ivec2 strides = ivec2(${c}, ${h});\n      const ivec2 pads = ivec2(${l}, ${u});\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ${y}\n\n        vec4 result = dotProd;\n        ${w}\n        ${v}\n        setOutput(result);\n      }\n    `}}const J2={kernelName:SE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,filter:a}=e,{strides:o,pad:l,dilations:u,dimRoundingMode:c}=s;let h=u;null==h&&(h=[1,1]),r.assert(d.eitherStridesOrDilationsAreOne(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const p=d.computeConv2DInfo(i.shape,a.shape,o,h,l,c,!0);let f;return f=FI().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels==1?new Q2(p):new Z2(p),n.runWebGLProgram(f,[i,a],"float32")}};class t3{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${t.outChannels/t.inChannels} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class e3{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${r}; dm++) {\n              int d2 = d1 * ${r} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const n3={kernelName:CE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r,h=d.computeConv2DInfo(s.shape,c,a,o,l,u,!0),p=new t3(h);return n.runWebGLProgram(p,[s,i],"float32")}},r3={kernelName:IE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r,h=d.computeConv2DInfo(c,i.shape,a,o,l,u,!0),p=new e3(h);return n.runWebGLProgram(p,[s,i],"float32")}};class s3{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const i3={kernelName:EE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:s}=e,i=[...s.shape,...s.shape],a=r.sizeFromShape(s.shape),o=j0({inputs:{x:s},backend:n,attrs:{shape:[a]}}),l=new s3(a),u=n.runWebGLProgram(l,[o],o.dtype),c=j0({inputs:{x:u},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}};class a3{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:s,strideWidth:i,filterHeight:a,filterWidth:o,dilationHeight:l,dilationWidth:u}=t,{top:c,left:h}=r;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${i});\n      const ivec2 pads = ivec2(${c}, ${h});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${a}; h++) {\n          int hIn = hBeg + h * ${l};\n\n          if (hIn >= 0 && hIn < ${e}) {\n            for (int w = 0; w < ${o}; w++) {\n              int wIn = wBeg + w * ${u};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const o3={kernelName:TE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:a,pad:o,dilations:l}=r,u=d.computeDilation2DInfo(s.shape,i.shape,a,o,"NHWC",l);let c;const h=new a3(u);c=n.runWebGLProgram(h,[s,i],"float32");const p=j0({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),p}},l3=M0({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),u3={kernelName:OE,backendName:"webgl",kernelFunc:l3},c3={kernelName:DE,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=FI().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new C0("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,s.shape):new S0("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)}},h3=L0({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),d3={kernelName:$E,backendName:"webgl",kernelFunc:h3},p3=M0({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${d.ERF_P};\n  float a1 = ${d.ERF_A1};\n  float a2 = ${d.ERF_A2};\n  float a3 = ${d.ERF_A3};\n  float a4 = ${d.ERF_A4};\n  float a5 = ${d.ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),f3={kernelName:FE,backendName:"webgl",kernelFunc:p3},m3="return exp(x);",g3=M0({opSnippet:m3,packedOpSnippet:m3,cpuKernelImpl:PJ}),y3={kernelName:ME,backendName:"webgl",kernelFunc:g3};function b3(t){const{inputs:e,attrs:n,backend:s}=t,{dim:i}=n,{input:a}=e,o=a.shape.length,l=a.shape.slice();let u=i;return i<0&&(r.assert(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+i+1),l.splice(u,0,1),j0({inputs:{x:a},backend:s,attrs:{shape:l}})}const v3={kernelName:LE,backendName:"webgl",kernelFunc:b3},w3="return exp(x) - 1.0;",_3=M0({opSnippet:w3,packedOpSnippet:w3,cpuKernelImpl:zJ}),x3={kernelName:PE,backendName:"webgl",kernelFunc:_3};class k3{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const s=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";let a;if("real"===t)a="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);a="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${s};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${a}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${i};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function S3(t,e,n){const s=n.texData.get(t.dataId),i=r.sizeFromShape(t.shape),a=t.shape[t.shape.length-1],o=j0({inputs:{x:t},backend:n,attrs:{shape:[i/a,a]}}),l=o.shape,u=new k3("real",l,e),c=new k3("imag",l,e),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(u,h,"float32"),p=n.runWebGLProgram(c,h,"float32"),f=T0({inputs:{real:d,imag:p},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p);const m=j0({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),m}const C3={kernelName:zE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return S3(r,!1,n)}};class I3{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}getCustomSetupFunc(t){return(e,n)=>{null==this.valueLoc&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}}function E3(t){const{backend:e,attrs:n}=t,{shape:s,value:i}=n;let{dtype:a}=n;if(a=a||r.inferDtype(i),"string"===a){const t=r.getArrayFromDType(a,r.sizeFromShape(s));return t.fill(i),e.makeTensorInfo(s,a,t)}{const t=new I3(s,i),n=t.getCustomSetupFunc(i);return e.runWebGLProgram(t,[],a,n)}}const T3={kernelName:BE,backendName:"webgl",kernelFunc:E3};class N3{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${e} - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${e}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const A3={kernelName:VE,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new N3(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}},R3="return floor(x);",O3=M0({opSnippet:R3,packedOpSnippet:R3,cpuKernelImpl:BJ}),D3={kernelName:WE,backendName:"webgl",kernelFunc:O3},F3=L0({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),$3={kernelName:UE,backendName:"webgl",kernelFunc:F3};class M3{constructor(t){this.variableNames=["A"];const e=nJ(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class L3{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=nJ(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}const P3={kernelName:IN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r,a="undefined"!=typeof HTMLVideoElement&&s instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&s instanceof HTMLImageElement,l="undefined"!=typeof ImageBitmap&&s instanceof ImageBitmap,[u,c]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height],h=[c,u],d=[c,u,i];(o||a||l)&&(null==z3&&(z3=document.createElement("canvas").getContext("2d")),z3.canvas.width=u,z3.canvas.height=c,z3.drawImage(s,0,0,u,c),s=z3.canvas);const p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=TQ.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),s);const f=FI().getBool("WEBGL_PACK")?new L3(d):new M3(d),m=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),m}};let z3;const B3={kernelName:NN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,filter:a,bias:o,preluActivationWeights:l}=e,{strides:u,pad:c,dataFormat:h,dilations:p,dimRoundingMode:f,activation:m,leakyreluAlpha:g}=s,y=d.convertConv2DDataFormat(h),b=d.computeConv2DInfo(i.shape,a.shape,u,p,c,f,!1,y);let v;const w=[];if(1!==b.filterHeight||1!==b.filterWidth||1!==b.dilationHeight||1!==b.dilationWidth||1!==b.strideHeight||1!==b.strideWidth||"SAME"!==b.padInfo.type&&"VALID"!==b.padInfo.type)if(FI().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])v=E2({x:i,filter:a,convInfo:b,backend:n,bias:o,activation:m,preluActivationWeights:l,leakyreluAlpha:g});else{const t=null!=o,e=null!=l,s="leakyrelu"===m,u=m?P0(m,!1):null,c=new k2(b,t,u,e,s),h=[i,a];if(o&&h.push(o),l&&h.push(l),s){const t=n.makeTensorInfo([],"float32",r.createScalarValue(g,"float32"));h.push(t),w.push(t)}v=n.runWebGLProgram(c,h,"float32")}else v=I2({x:i,filter:a,convInfo:b,backend:n,bias:o,activation:m,preluActivationWeights:l,leakyreluAlpha:g});const _=j0({inputs:{x:v},backend:n,attrs:{shape:b.outShape}});return w.push(v),w.forEach(t=>n.disposeIntermediateTensorInfo(t)),_}},V3={kernelName:AN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,filter:a,bias:o,preluActivationWeights:l}=e,{strides:u,pad:c,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=s,g=[];let y=h;null==y&&(y=[1,1]),r.assert(d.eitherStridesOrDilationsAreOne(u,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${y}'`);const b=d.computeConv2DInfo(i.shape,a.shape,u,y,c,p,!0),v=FI().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels==1,w=f?P0(f,v):null,_=[i,a],x=null!=o,k=null!=l,S="leakyrelu"===f;if(x&&_.push(o),k&&_.push(l),S){const t=n.makeTensorInfo([],"float32",r.createScalarValue(m,"float32"));_.push(t),g.push(t)}let C;C=v?new Q2(b,x,w,k,S):new Z2(b,x,w,k,S);const I=n.runWebGLProgram(C,_,"float32");return g.forEach(t=>n.disposeIntermediateTensorInfo(t)),I}};class W3{constructor(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;const r=NJ(e.length),s=NJ(n.length);this.userCode=`\n        ${r} strides = ${r}(${this.strides});\n         void main() {\n          ${s} coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ${this.sliceDim}; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ${this.sliceDim>1?"strides[j]":"strides"};\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      `}}const U3={kernelName:qE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:s,indices:i}=e,a=i.shape,o=a[a.length-1],[l,u,c,h]=d.prepareAndValidate(s,i),p=j0({inputs:{x:i},backend:n,attrs:{shape:[u,o]}}),f=j0({inputs:{x:s},backend:n,attrs:{shape:[r.sizeFromShape(s.shape)/c,c]}}),m=new W3(o,h,[u,c]),g=n.runWebGLProgram(m,[f,p],f.dtype),y=j0({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}};class j3{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=NJ(this.rank),r=function(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)r.push(2===s?"int(getIndices(resRC.x, resRC.z))":""+n[s]);return r.join()}(t);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        setOutput(getA(${r}));\n      }\n    `}}const H3={kernelName:HE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,indices:a}=e,{axis:o,batchDims:l}=s,u=r.parseAxisParam(o,i.shape)[0],c=d.segment_util.collectGatherOpShapeInfo(i,a,u,l),h=r.sizeFromShape(a.shape),p=[],f=j0({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),m=j0({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,h/c.batchSize]}});p.push(f),p.push(m);const g=[c.batchSize,c.outerSize,h/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([i,a])||"string"===i.dtype){const t=n.bufferSync(m),e=n.bufferSync(f),r=VJ(e,t,g);return p.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(c.outputShape,r.dtype,r.values)}const y=new j3(f.shape,g),b=n.runWebGLProgram(y,[f,m],f.dtype);p.push(b);const v=j0({inputs:{x:b},backend:n,attrs:{shape:c.outputShape}});return p.forEach(t=>n.disposeIntermediateTensorInfo(t)),v}},q3=L0({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:WJ,dtype:"bool"}),G3={kernelName:GE,backendName:"webgl",kernelFunc:q3},K3=L0({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),X3={kernelName:KE,backendName:"webgl",kernelFunc:K3},Y3={kernelName:YE,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return S3(r,!0,n)}},Z3=M0({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Q3={kernelName:QE,backendName:"webgl",kernelFunc:Z3},J3=M0({opSnippet:"return float(isinf(x));",dtype:"bool"}),t4={kernelName:JE,backendName:"webgl",kernelFunc:J3},e4=M0({opSnippet:"return float(isnan(x));",dtype:"bool"}),n4={kernelName:tT,backendName:"webgl",kernelFunc:e4},r4=L0({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:UJ,dtype:"bool"}),s4={kernelName:nT,backendName:"webgl",kernelFunc:r4},i4=L0({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),a4={kernelName:rT,backendName:"webgl",kernelFunc:i4},o4={kernelName:sT,backendName:"webgl",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,a=jJ(r,s,i);return e.makeTensorInfo([a.length],"float32",a)}},l4=M0({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:HJ}),u4={kernelName:iT,backendName:"webgl",kernelFunc:l4},c4=M0({opSnippet:"return log(1.0 + x);"}),h4={kernelName:aT,backendName:"webgl",kernelFunc:c4},d4=L0({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),p4={kernelName:oT,backendName:"webgl",kernelFunc:d4},f4=M0({opSnippet:"return float(!(x >= 1.0));"}),m4={kernelName:lT,backendName:"webgl",kernelFunc:f4},g4=L0({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),y4={kernelName:uT,backendName:"webgl",kernelFunc:g4};class b4{constructor(t,e,n,r,s){this.variableNames=["x"],this.outputShape=[];const i=e,a=t[3]-1;let o;this.outputShape=t;const l=`float(${n}) + float(${r}) * sum`;o=.5===s?`inversesqrt(${l})`:1===s?`1.0/(${l})`:`exp(log(${l}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${i}; j <= ${i}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${a}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${o};\n        setOutput(val);\n      }\n    `}}class v4{constructor(t,e,n,r,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=e,a=t[3]-1;let o;this.outputShape=t;const l=`float(${n}) + float(${r}) * sum`;o=.5===s?`inversesqrt(${l})`:1===s?`1.0/(${l})`:`exp(log(${l}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${i};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${i}; j <= ${i}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${o};\n        setOutput(result);\n      }\n    `}}const w4={kernelName:cT,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:a,alpha:o,beta:l}=r,u=FI().getBool("WEBGL_PACK_NORMALIZATION")?new v4(s.shape,i,a,o,l):new b4(s.shape,i,a,o,l);return n.runWebGLProgram(u,[s],s.dtype)}};class _4{constructor(t,e,n,r,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=s,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${s})\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${s});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const x4={kernelName:hT,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:a}=e,{depthRadius:o,bias:l,alpha:u,beta:c}=r,h=new _4(s.shape,o,l,u,c);return n.runWebGLProgram(h,[s,i,a],s.dtype)}};function k4(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{reductionIndices:a,keepDims:o}=s,l=i.shape.length,u=r.parseAxisParam(a,i.shape);let c=u;const h=d.getAxesPermutation(c,l),p=null!=h,f=n.shouldExecuteOnCPU([i]);let m=i;if(p){if(f){const t=n.texData.get(m.dataId).values,e=new Array(l);for(let n=0;n<e.length;n++)e[n]=i.shape[h[n]];const r=a0(t,i.shape,i.dtype,h,e);m=n.makeTensorInfo(e,i.dtype),n.texData.get(m.dataId).values=r}else m=Z0(i,h,n);c=d.getInnerMostAxes(c.length,l)}d.assertAxesAreInnerMostDims("max",c,l);const[g,y]=d.computeOutAndReduceShapes(m.shape,c);let b,v=g;if(o&&(v=d.expandShapeToKeepDim(g,u)),f){const t=n.texData.get(m.dataId),e=qJ(t.values,r.sizeFromShape(y),v,i.dtype);b=n.makeTensorInfo(v,i.dtype),n.texData.get(b.dataId).values=e}else b=function(t,e,n,s){const i=r.sizeFromShape(e),a=j0({inputs:{x:t},attrs:{shape:[r.sizeFromShape(t.shape)/i,i]},backend:s}),o=K0(a,t.dtype,"max",s),l=j0({inputs:{x:o},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(o),l}(m,y,v,n);return p&&n.disposeIntermediateTensorInfo(m),b}const S4={kernelName:dT,backendName:"webgl",kernelFunc:k4},C4=L0({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:GJ}),I4={kernelName:pT,backendName:"webgl",kernelFunc:C4},E4={kernelName:fT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e;tJ(i,"maxPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:u}=s;r.assert(d.eitherStridesOrDilationsAreOne(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const c=d.computePool2DInfo(i.shape,a,o,1,l,u);if(1===c.filterWidth&&1===c.filterHeight&&r.arraysEqual(c.inShape,c.outShape))return I0({inputs:{x:i},backend:n});const h=new $1(c,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}},T4={kernelName:gT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:a,pad:o,dataFormat:l,dimRoundingMode:u}=r,c=d.computePool3DInfo(s.shape,i,a,[1,1,1],o,u,l),h=new M1(c,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}};class N4{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e};\n          wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${e*n-1} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${n} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class A4{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${e};\n           wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${n};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${r};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${e*n*r-1} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${n} * ${r} +\n                  wR * ${r} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const R4={kernelName:yT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,a=i,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,h=d.computePool3DInfo(a.shape,o,l,[1,1,1],u,c),p=new M1(h,"max",!0),f=n.runWebGLProgram(p,[a],a.dtype),m=new A4(h),g=n.runWebGLProgram(m,[s,f],a.dtype);return n.disposeIntermediateTensorInfo(f),g}},O4={kernelName:mT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:a}=e,o=i;tJ([i,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:h}=r,p=d.computePool2DInfo(o.shape,l,u,1,c,h),f=new $1(p,"max",!0),m=n.runWebGLProgram(f,[o],o.dtype),g=new N4(p),y=n.runWebGLProgram(g,[s,m],o.dtype);return n.disposeIntermediateTensorInfo(m),y}},D4={kernelName:bT,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:i,strides:a,pad:o,includeBatchInIndex:l}=e,u=n;r.assert(4===s.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];r.assert(d.eitherStridesOrDilationsAreOne(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const h=d.computePool2DInfo(s.shape,i,a,c,o),[p,f]=function(t,e,n,r){let s=new $1(n,"max",!1);const i=r.runWebGLProgram(s,[t],"float32");return s=new $1(n,"max",!0,!0,e),[i,r.runWebGLProgram(s,[t],"float32")]}(s,l,h,u);return[p,f]}},F4={kernelName:vT,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:i,axis:a}=e,o=n,l=s.shape.length,u=r.parseAxisParam(a,s.shape);let c=u;const h=d.getAxesPermutation(c,l),p=null!=h,f=o.shouldExecuteOnCPU([s]),m=[];let g=s;if(p){if(f){const t=o.texData.get(g.dataId).values,e=new Array(l);for(let r=0;r<e.length;r++)e[r]=s.shape[h[r]];const n=a0(t,s.shape,s.dtype,h,e);g=o.makeTensorInfo(e,s.dtype),o.texData.get(g.dataId).values=n}else g=Z0(s,h,o);m.push(g),c=d.getInnerMostAxes(c.length,l)}d.assertAxesAreInnerMostDims("sum",c,l);const[y,b]=d.computeOutAndReduceShapes(g.shape,c);let v=y;i&&(v=d.expandShapeToKeepDim(y,u));const w=function(t,e,n,s){const i=r.sizeFromShape(e),a=j0({inputs:{x:t},attrs:{shape:[r.sizeFromShape(t.shape)/i,i]},backend:s}),o=K0(a,"float32","mean",s),l=j0({inputs:{x:o},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(o),l}(g,b,v,o);for(const r of m)o.disposeIntermediateTensorInfo(r);return w}},$4={kernelName:wT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s,l=i.shape.length,u=r.parseAxisParam(a,i.shape);let c=u;const h=d.getAxesPermutation(c,l);let p=i;null!=h&&(p=t1({inputs:{x:i},backend:n,attrs:{perm:h}}),c=d.getInnerMostAxes(c.length,i.shape.length)),d.assertAxesAreInnerMostDims("min",c,l);const[f,m]=d.computeOutAndReduceShapes(p.shape,c),g=j0({inputs:{x:p},backend:n,attrs:{shape:[-1,r.sizeFromShape(m)]}}),y=K0(g,g.dtype,"min",n);let b;return b=j0(o?{inputs:{x:y},backend:n,attrs:{shape:d.expandShapeToKeepDim(f,u)}}:{inputs:{x:y},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),null!=h&&n.disposeIntermediateTensorInfo(p),b}},M4=L0({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:KJ}),L4={kernelName:_T,backendName:"webgl",kernelFunc:M4};class P4{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,s=NJ(r),i=e.map(t=>t[0]).join(","),a=e.map((e,n)=>e[0]+t[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;this.userCode=1!==r?`\n      ${s} start = ${s}(${i});\n      ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${l};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};\n          }\n        }\n        ${s} coords = outC - start;\n        setOutput(getX(${o}));\n      }\n    `:`\n        int start = ${i};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${l};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${l};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class z4{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,s=NJ(r),i=e.map(t=>t[0]).join(","),a=e.map((e,n)=>e[0]+t[n]).join(","),o=u0("rc",r),l=u0("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,h="reflect"===n?0:1;let d="";if(1===r){const t=`\n        ${s} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${h};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${h};\n        }\n        source -= start;\n      `;d=`\n        ${s} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${o[r-1]} += 1;\n        if(${u}) {\n          ${t}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n      `}else{const t=`\n        ${s} source = rc;\n        ${s} lt = ${s}(lessThan(source, start));\n        ${s} gte = ${s}(greaterThanEqual(source, end));\n        ${s} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${h}) +\n                gte * ((end - 1) * 2 - source + ${h});\n        source -= start;\n      `;d=`\n        ${s} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${o[r-1]} += 1;\n        if(${u}) {\n          ${t}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n        rc = outputLoc;\n        ${o[r-2]} += 1;\n        if(${o[r-2]} < ${this.outputShape[r-2]}) {\n          ${t}\n          result[2] = getChannel(getX(${l.join()}), ${c});\n          ${o[r-1]} += 1;\n          if(${u}) {\n            ${t}\n            result[3] = getChannel(getX(${l.join()}), ${c});\n          }\n        }\n      `}this.userCode=`\n      const ${s} start = ${s}(${i});\n      const ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${d}\n        setOutput(result);\n      }\n    `}}const B4={kernelName:xT,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:i}=n,a=FI().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z4(r.shape,s,i):new P4(r.shape,s,i);return e.runWebGLProgram(a,[r],r.dtype)}},V4=L0({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),W4={kernelName:kT,backendName:"webgl",kernelFunc:V4};class U4{constructor(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}getCustomSetupFunc(t){return(e,n)=>{null==this.seedLoc&&(this.seedLoc=e.getUniformLocation(n,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}const j4=L0({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),H4={kernelName:RE,backendName:"webgl",kernelFunc:j4},q4="return a - b;",G4=L0({opSnippet:q4,packedOpSnippet:q4,supportsComplex:!0,cpuKernelImpl:r0}),K4={kernelName:pN,backendName:"webgl",kernelFunc:G4};function X4(t){const{inputs:e,backend:n,attrs:s}=t,{logits:i}=e,{dim:a}=s,o=r.parseAxisParam([a],i.shape),l=k4({inputs:{x:i},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=d.expandShapeToKeepDim(l.shape,o),c=j0({inputs:{x:l},backend:n,attrs:{shape:u}}),h=G4({inputs:{a:i,b:c},backend:n}),p=g3({inputs:{x:h},backend:n}),f=Q0({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:!1}}),m=j0({inputs:{x:f},backend:n,attrs:{shape:u}}),g=j4({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const Y4={kernelName:cN,backendName:"webgl",kernelFunc:X4},Z4={kernelName:ST,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:a,normalized:o}=r,l=o?s:X4({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=new U4(l.shape[0],l.shape[1],i),c=u.getCustomSetupFunc(a),h=n.runWebGLProgram(u,[l],"int32",c);return o||n.disposeIntermediateTensorInfo(l),h}},Q4="return -x;",J4={kernelName:IT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const t=n.texData.get(r.dataId),[e,s]=YJ(t.values,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,e)}let s;return s=FI().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new v0(r.shape,Q4):new g0(r.shape,Q4),n.runWebGLProgram(s,[r],r.dtype)}},t6=p.nonMaxSuppressionV3Impl,e6={kernelName:TT,backendName:"webgl",kernelFunc:function(t){d.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(i.dataId),{selectedIndices:h}=t6(u,c,a,o,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},n6=p.nonMaxSuppressionV4Impl,r6={kernelName:NT,backendName:"webgl",kernelFunc:function(t){d.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),h=n.readSync(i.dataId),{selectedIndices:p,validOutputs:f}=n6(c,h,a,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},s6=p.nonMaxSuppressionV5Impl,i6={kernelName:AT,backendName:"webgl",kernelFunc:function(t){d.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),h=n.readSync(i.dataId),p=a,f=o,m=l,g=u,{selectedIndices:y,selectedScores:b}=s6(c,h,p,f,m,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}};class a6{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}const o6={kernelName:OT,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:i}=e,{depth:a,onValue:o,offValue:l}=s,u=r.sizeFromShape(i.shape),c=new a6(u,a,o,l),h=j0({inputs:{x:i},backend:n,attrs:{shape:[u]}}),d=n.runWebGLProgram(c,[h],i.dtype);n.disposeIntermediateTensorInfo(h);const p=j0({inputs:{x:d},backend:n,attrs:{shape:[...i.shape,a]}});return n.disposeIntermediateTensorInfo(d),p}};function l6(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=n2({inputs:{input:r},backend:n}),e=l6({inputs:{x:t},backend:n}),s=y2({inputs:{input:r},backend:n}),i=l6({inputs:{x:s},backend:n}),a=T0({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),a}return E3({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const u6={kernelName:SN,backendName:"webgl",kernelFunc:l6},c6={kernelName:RT,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:s}=n;if("string"===s.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===s.dtype){const e=n2({inputs:{input:s},backend:r}),n=t({inputs:{x:e},backend:r}),i=y2({inputs:{input:s},backend:r}),a=l6({inputs:{x:i},backend:r}),o=T0({inputs:{real:n,imag:a},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(a),o}return E3({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:r})}},h6={kernelName:DT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{axis:i}=s;if(1===e.length)return b3({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const a=e[0].shape,o=e[0].dtype;e.forEach(t=>{r.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),r.assert(o===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],u=_2({inputs:e.map(t=>{const e=b3({inputs:{input:t},backend:n,attrs:{dim:i}});return l.push(e),e}),backend:n,attrs:{axis:i}});return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}};class d6{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,s=NJ(r),i=e.map(t=>t[0]).join(","),a=e.map((e,n)=>e[0]+t[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${s} start = ${s}(${i});\n      ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(${n}));\n        } else {\n          ${s} coords = outC - start;\n          setOutput(getX(${o}));\n        }\n      }\n    `:`\n        int start = ${i};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(${n}));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class p6{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,s=NJ(r),i=e.map(t=>t[0]).join(","),a=e.map((e,n)=>e[0]+t[n]).join(","),o=u0("rc",r),l=u0("source",r),u=`${o[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${l.slice(-2).join()})`,h=[s+" rc = outputLoc;",`${o[r-1]} += 1;\n       if(${u}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${o[r-2]} += 1;\n       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${o[r-1]} += 1;\n         if(${u}) {`],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+=`\n        ${h[f]}\n        if (${d}) {\n          result[${f}] = float(${n});\n        } else {\n          ${s} source = rc - start;\n          result[${f}] = getChannel(getX(${l.join()}), ${c});\n        }\n      `;p+=1===r?"} ":"}}",this.userCode=`\n      const ${s} start = ${s}(${i});\n      const ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}const f6=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:a}=r,o=FI().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new p6(s.shape,i,a):new d6(s.shape,i,a);return n.runWebGLProgram(o,[s],s.dtype)},m6={kernelName:FT,backendName:"webgl",kernelFunc:f6},g6=L0({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),y6={kernelName:$T,backendName:"webgl",kernelFunc:g6},b6={kernelName:LT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{axis:a,keepDims:o}=s,l=i.shape.length,u=[],c=r.parseAxisParam(a,i.shape);let h=c;const p=d.getAxesPermutation(h,l);let f,m=i;if(null!=p&&(m=t1({inputs:{x:i},backend:n,attrs:{perm:p}}),h=d.getInnerMostAxes(h.length,l),u.push(m)),d.assertAxesAreInnerMostDims("prod",h,l),n.shouldExecuteOnCPU([m])){const t=n.texData.get(m.dataId).values,{outVals:e,outShape:r,outDtype:s}=ZJ(m.shape,m.dtype,t,h);f=n.makeTensorInfo(r,s,e)}else{const[t,e]=d.computeOutAndReduceShapes(m.shape,h),s=r.sizeFromShape(e),a=j0({inputs:{x:m},backend:n,attrs:{shape:[-1,s]}}),o=K0(a,dA(i.dtype),"prod",n);f=j0({inputs:{x:o},backend:n,attrs:{shape:t}}),u.push(a),u.push(o)}if(o){u.push(f);const t=d.expandShapeToKeepDim(f.shape,c);f=j0({inputs:{x:f},backend:n,attrs:{shape:t}})}return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),f}},v6=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:a}=n,o=QJ(r,s,i,a);return e.makeTensorInfo([o.length],a,o)},w6={kernelName:PT,backendName:"webgl",kernelFunc:v6},_6=M0({opSnippet:"return 1.0 / x;"}),x6={kernelName:BT,backendName:"webgl",kernelFunc:_6},k6=M0({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),S6={kernelName:VT,backendName:"webgl",kernelFunc:k6},C6=M0({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),I6={kernelName:GT,backendName:"webgl",kernelFunc:C6};class E6{constructor(t,e,n,r,s){this.variableNames=["A"],this.outputShape=[];const[i,a,o,l]=t;this.outputShape=[i,e,n,l];const u=[r&&e>1?a-1:a,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=s?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class T6{constructor(t,e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,o,l]=t;this.outputShape=[i,e,n,l];const u=[r&&e>1?a-1:a,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=s?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${o}.0,\n                                     ${o}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${h};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const N6={kernelName:HT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r,[l,u]=o,c=FI().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new T6(s.shape,l,u,i,a):new E6(s.shape,l,u,i,a);return n.runWebGLProgram(c,[s],"float32")}};class A6{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,s]=e,[,i,a]=t,o=[n&&i>1?r-1:r,n&&a>1?s-1:s],l=[n&&i>1?i-1:i,n&&a>1?a-1:a],u=o[0]/l[0],c=o[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${i}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const R6={kernelName:qT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:a}=r,o=new A6(i.shape,s.shape,a);return n.runWebGLProgram(o,[i],i.dtype)}};class O6{constructor(t,e,n,r,s){this.variableNames=["A"],this.outputShape=[];const[i,a,o,l]=t;this.outputShape=[i,e,n,l];const u=[r&&e>1?a-1:a,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=s?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${r?"0.5":"0.0"})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}const D6={kernelName:UT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r,[l,u]=o,c=new O6(s.shape,l,u,i,a);return n.runWebGLProgram(c,[s],s.dtype)}};class F6{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,s]=e,[,i,a]=t,o=[n&&i>1?r-1:r,n&&a>1?s-1:s],l=[n&&i>1?i-1:i,n&&a>1?a-1:a],u=o[0]/l[0],c=o[1]/l[1],h=1/u,d=1/c,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${i}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${o[0]}) *\n                (float(dyR) / float(${l[0]}));\n\n            float sourceFracCol =\n                float(${o[1]}) *\n                  (float(dyC) / float(${l[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${s}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const $6={kernelName:jT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:a}=r,o=new F6(i.shape,s.shape,a);return n.runWebGLProgram(o,[i],i.dtype)}};class M6{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=t,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const r=t.map((n,r)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - coords[${n}] - 1`:`coords[${n}]`)(r)).join(","),s=NJ(n);this.userCode=`\n      void main() {\n        ${s} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}class L6{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=t;const r=u0("rc",n),s=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,i=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,a=NJ(n);function o(n){const r=t.map((r,s)=>function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - ${r[n]} - 1`:""+r[n]}(s,n));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${s}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${a} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(t){return o(t)}(r.slice())};\n          if(${s}){\n            result.g = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",o(t)}(r.slice())};\n          }\n          if(${i}) {\n            result.b = ${function(t){return t[n-2]="("+t[n-2]+" + 1)",o(t)}(r.slice())};\n            if(${s}) {\n              result.a = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",o(t)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const P6={kernelName:KT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{dims:a}=s,o=i.shape.length,l=r.parseAxisParam(a,i.shape);if(0===o)return I0({inputs:{x:i},backend:n});const u=FI().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new L6(i.shape,l):new M6(i.shape,l);return n.runWebGLProgram(u,[i],i.dtype)}};class z6{constructor(t,e,n,r){this.variableNames=["Image"],this.outputShape=[];const s=t[1],i=t[2],a=Math.sin(e).toFixed(3),o=Math.cos(e).toFixed(3);this.outputShape=t;const[l,u]=d.getImageCenter(r,s,i),c=l.toFixed(3),h=u.toFixed(3);let p="";p="number"==typeof n?`float outputValue = ${n.toFixed(2)};`:`\n        vec3 fill = vec3(${n.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ${c}) * ${o} - (float(y) - ${h}) * ${a};\n          float coordYFloat = (float(x) - ${c}) * ${a} + (float(y) - ${h}) * ${o};\n          int coordX = int(round(coordXFloat + ${c}));\n          int coordY = int(round(coordYFloat + ${h}));\n          ${p}\n          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${s}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const B6={kernelName:EN,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:a}=e,o=n,l=new z6(r.shape,s,i,a);return o.runWebGLProgram(l,[r],r.dtype)}},V6=M0({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),W6={kernelName:XT,backendName:"webgl",kernelFunc:V6},U6=M0({opSnippet:"return inversesqrt(x);",cpuKernelImpl:JJ}),j6={kernelName:YT,backendName:"webgl",kernelFunc:U6};class H6{constructor(t,e,n,r,s,i,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const o=NJ(s.length),l=NJ(i.length);let u="";1===n?u="i":2===n&&(u="i, j");let c="";1===r?c="i":2===r&&(c="i, coords[1]"),this.userCode=`\n        ${o} strides = ${o}(${s});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(getIndices(${u}));\n              flattenedIndex += index * ${e>1?"strides[j]":"strides"};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates(${c});\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      `}}const q6={kernelName:ZT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:h}=d.calculateShapes(i,s,a),p=[h/u,u];if(0===h)return n.makeTensorInfo(a,s.dtype);const f=j0({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),m=j0({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),y=new H6(l,o,f.shape.length,m.shape.length,c,p),b=n.runWebGLProgram(y,[m,f,g],m.dtype),v=j0({inputs:{x:b},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(g),v}};class G6{constructor(t,e,n){let r,s;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)s="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],a=[];for(let r=0;r<e.length;r++)a.push(""+n[r]),r<t&&i.push(""+n[r]);r=i.join(),s=a.join()}const i=NJ(n);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${s}));\n        } else {\n          setOutput(getB(${s}));\n        }\n      }\n    `}}const K6={kernelName:QT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,a=new G6(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(a,[r,s,i],hA(s.dtype,i.dtype))}},X6=M0({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${d.SELU_SCALEALPHA};\n  float scale = ${d.SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),Y6={kernelName:JT,backendName:"webgl",kernelFunc:X6},Z6=M0({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),Q6={kernelName:sN,backendName:"webgl",kernelFunc:Z6},J6=M0({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),t5={kernelName:rN,backendName:"webgl",kernelFunc:J6},e5=M0({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),n5={kernelName:eN,backendName:"webgl",kernelFunc:e5},r5=M0({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),s5={kernelName:nN,backendName:"webgl",kernelFunc:r5},i5=M0({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),a5={kernelName:iN,backendName:"webgl",kernelFunc:i5},o5={kernelName:lN,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{blockShape:a,paddings:o}=s;r.assert(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((t,e)=>t*e),u=[[0,0]];u.push(...o);for(let r=1+a.length;r<i.shape.length;++r)u.push([0,0]);const c=[],h=f6({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),p=d.getReshaped(h.shape,a,l,!1),f=d.getPermuted(p.length,a.length,!1),m=d.getReshapedPermuted(h.shape,a,l,!1),g=j0({inputs:{x:h},backend:n,attrs:{shape:p}}),y=t1({inputs:{x:g},backend:n,attrs:{perm:f}}),b=j0({inputs:{x:y},backend:n,attrs:{shape:m}});return c.push(h),c.push(g),c.push(y),c.forEach(t=>n.disposeIntermediateTensorInfo(t)),b}},l5={kernelName:fN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:l,numUpdates:u,strides:c,outputSize:h}=d.calculateShapes(i,s,o),p=new H6(u,l,s.shape.length,i.shape.length,c,[h,1],!1),f=n.runWebGLProgram(p,[i,s,a],i.dtype),m=j0({inputs:{x:f},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),m}},u5={kernelName:uN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{numOrSizeSplits:a,axis:o}=s,l=r.parseAxisParam(o,i.shape)[0],u=d.prepareSplitSize(i,a,l),c=new Array(i.shape.length).fill(0),h=i.shape.slice();return u.map(t=>{const e=[...h];e[l]=t;const r=Y1({inputs:{x:i},backend:n,attrs:{begin:c,size:e}});return c[l]+=t,r})}},c5=M0({opSnippet:"return sqrt(x);"}),h5={kernelName:aN,backendName:"webgl",kernelFunc:c5},d5={kernelName:dN,backendName:"webgl",kernelFunc:M0({opSnippet:"return x * x;"})},p5="return (a - b) * (a - b);",f5=L0({opSnippet:p5,packedOpSnippet:p5}),m5={kernelName:hN,backendName:"webgl",kernelFunc:f5},g5={kernelName:CN,backendName:"webgl",kernelFunc:function({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=new g0(r.shape,`if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float(${e.alpha});\n  `);return n.runWebGLProgram(s,[r],r.dtype)}};class y5{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,s=NJ(n.length),i=NJ(n.length);let a="";if(1===r)a="coords * strides + begin";else{let t=0;a=n.map((e,r)=>(t++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${t-1}] * strides[${r}] + begin[${r}]`)).join(",")}this.userCode=`\n      ${s} begin = ${s}(${t});\n      ${s} strides = ${s}(${e});\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${a}));\n      }\n    `}}const b5={kernelName:mN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:a,strides:o,beginMask:u,endMask:c,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:p}=r,{nonStrided:f,$begin:m,$strides:g,size:y,newShape:b,outShape:v}=l.sliceInfo(s.shape,i,a,o,u,c,h,d,p),w=j0({inputs:{x:s},backend:n,attrs:{shape:b}});let _;if(f){const t=Y1({inputs:{x:w},backend:n,attrs:{begin:m,size:y}});_=j0({inputs:{x:t},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(t)}else if(v.some(t=>0===t))_=n.makeTensorInfo(v,s.dtype,[]);else if(n.shouldExecuteOnCPU([w])){const t=n.texData.get(w.dataId),e=IR(w.shape,w.dtype,t.values),r=n0(v,e,g,m);_=n.makeTensorInfo(v,w.dtype,r.values)}else{const t=new y5(m,g,v);_=n.runWebGLProgram(t,[w],w.dtype)}const x=j0({inputs:{x:_},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(_),x}},v5=M0({opSnippet:"return tan(x);"}),w5={kernelName:gN,backendName:"webgl",kernelFunc:v5},_5=M0({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),x5={kernelName:yN,backendName:"webgl",kernelFunc:_5};class k5{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let i=0;i<n.length;i++)n[i]=t[i]*e[i];this.outputShape=n,this.rank=n.length;const r=NJ(this.rank),s=function(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(1===e)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}(t);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${s}));\n      }\n    `}}function S5(t){const{inputs:e,backend:n,attrs:s}=t,{x:i}=e,{reps:a}=s;if("string"===i.dtype){const t=n.readSync(i.dataId).map(t=>r.decodeString(t)),e=IR(i.shape,i.dtype,t),s=s0(e,a);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const o=new k5(i.shape,a);return n.runWebGLProgram(o,[i],i.dtype)}const C5={kernelName:bN,backendName:"webgl",kernelFunc:S5},I5={kernelName:vN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:a}=r,o=n.readSync(s.dataId),[l,u]=i0(o,s.shape,s.dtype,i,a);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}},E5={kernelName:_N,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;tJ(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(i.dataId),{outputValues:o,outputShape:l,indices:u}=o0(a,s,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}},T5={kernelName:xN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const a=s,o=a.shape.length,l=s.shape[i],u=new Array(o-1);let c=0;for(let m=0;m<o;m++)m!==i&&(u[c++]=a.shape[m]);const h=[],d=new Array(o).fill(0),p=a.shape.slice();p[i]=1;const f=new Array(l);for(let m=0;m<f.length;m++){d[i]=m;const t=Y1({inputs:{x:a},backend:n,attrs:{begin:d,size:p}}),e=j0({inputs:{x:t},backend:n,attrs:{shape:u}});f[m]=e,h.push(t)}return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),f}};class N5{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,s=t.inSize,i=t.numSegments,a=i*Math.ceil(s/n);this.outputShape=[r,a];const o=4*Math.floor(n/4),l=n%4,u="\n        sumValue += dot(values, segFilter);\n    ";let c="";s%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `);let h="";s%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${h}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${i})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${i})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${o}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${o};\n        if (${1===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${u}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${u}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}const A5=[w4,x4,r1,i1,o1,u1,d1,m1,g1,y1,k1,S1,I1,T1,O1,A1,F1,P1,L1,V1,W1,U1,q1,Q1,J1,s2,o2,c2,p2,N0,x2,D2,F2,T2,M2,L2,$2,z2,V2,U2,G2,K2,Y2,n3,r3,J2,i3,o3,u3,c3,d3,f3,y3,v3,x3,C3,T3,A3,D3,$3,P3,B3,V3,U3,H3,G3,X3,E0,Y3,b2,Q3,t4,n4,O0,s4,a4,o4,h4,u4,p4,m4,y4,S4,T4,E4,R4,O4,D4,I4,F4,$4,L4,B4,W4,Z4,U0,J4,e6,r6,i6,e2,o6,c6,h6,m6,y6,$0,b6,w6,r2,H4,x6,I6,S6,H0,N6,R6,D6,$6,P6,B6,W6,j6,q6,K6,Y6,Q6,t5,n5,s5,Z1,Y4,a5,o5,l5,u5,h5,d5,m5,g5,b5,K4,J0,w5,x5,C5,I5,e1,E5,T5,{kernelName:kN,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:i,segmentIds:a}=e,{numSegments:o}=s,l=i.shape.length,u=[];let c=0;const h=d.getAxesPermutation([c],l);let p=i;null!=h&&(p=t1({inputs:{x:i},backend:n,attrs:{perm:h}}),u.push(p),c=d.getInnerMostAxes(1,l)[0]);const f=d.segment_util.computeOutShape(p.shape,c,o),m=r.sizeFromShape([p.shape[c]]),g=j0({inputs:{x:p},backend:n,attrs:{shape:[-1,m]}});u.push(g);const y=dA(i.dtype),b=(t,e,r,s,i)=>{const a=t.shape[0],o=t.shape[1],l=d.segment_util.segOpComputeOptimalWindowSize(o,i),c=new N5({windowSize:l,inSize:o,batchSize:a,numSegments:i},e),h=n.compileAndRun(c,[t,r],s);if(u.push(h),h.shape[1]===i)return h;const p=v6({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),f=S5({inputs:{x:p},backend:n,attrs:{reps:[o/l]}});return u.push(p),u.push(f),b(h,e,f,s,i)},v=j0({inputs:{x:b(g,"unsortedSegmentSum",a,y,o)},backend:n,attrs:{shape:f}});let w=v;if(null!=h){u.push(v);const t=d.getUndoAxesPermutation(h);w=t1({inputs:{x:w},backend:n,attrs:{perm:t}})}return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),w}},u6];for(const Set of A5)MN(Set);let R5=(()=>{class t{constructor(){this.model=null,this.wasm="worker.sql-wasm.js",console.log("ToxicityService:constructor"),this.loadWASM(this)}loadWASM(t){return EC(this,void 0,void 0,function*(){console.log("ToxicityService:loadWASM start"),t.model=yield function(t,e){return qB(this,void 0,void 0,function(){var t;return GB(this,function(n){switch(n.label){case 0:return[4,(t=new nV(.85,e)).load()];case 1:return n.sent(),[2,t]}})})}(0,[]),console.log("ToxicityService:loadWASM end")})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Lt({token:t,factory:t.\u0275fac,providedIn:"any"}),t})();function O5(t,e){1&t&&(Ja(0,undefined,undefined),to())}function D5(t,e){if(1&t){const t=eo();Ya(0,"p",5),so("click",function(){ln(t);const e=uo().$implicit;return uo().onMessage(e)}),Do(1),Za()}if(2&t){const t=uo().$implicit;vi(1),$o(" ",t.text," ")}}function F5(t,e){if(1&t){const t=eo();Ya(0,"p",6),so("click",function(){ln(t);const e=uo().$implicit;return uo().onMessage(e)}),Do(1),Za()}if(2&t){const t=uo().$implicit;vi(1),$o(" ",t.text," ")}}function $5(t,e){if(1&t&&(Ya(0,"div"),Ha(1,O5,1,0,"ng-container",2),Ha(2,D5,2,1,"ng-template",null,3,Su),Ha(4,F5,2,1,"ng-template",null,4,Su),Za()),2&t){const t=e.$implicit,n=qa(3),r=qa(5);vi(1),Ka("ngIf",t.from_me)("ngIfThen",n)("ngIfElse",r)}}let M5=(()=>{class t{constructor(t,e){this.dbservice=t,this.toxservice=e,this.chat_messages=null,this.dbservice.message_share.subscribe(t=>{this.chat_messages=t.data})}ngOnInit(){}onMessage(t){console.log("MessageViewComponent::onMessage");const e=performance.now(),n=t.text;this.toxservice.model.classify([n]).then(t=>{var r=[];for(const e in t){const n=t[e].label;1==t[e].results[0].match&&r.push(n)}var s=performance.now()-e;console.log(r.toString()+" Delta: "+Math.round(s/n.length)+" ms per character")})}}return t.\u0275fac=function(e){return new(e||t)(Ga($C),Ga(R5))},t.\u0275cmp=fe({type:t,selectors:[["app-message-view"]],features:[Jo([])],decls:2,vars:1,consts:[[1,"imessage"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfThen","ngIfElse"],["fromme",""],["fromthem",""],[1,"from-me",3,"click"],[1,"from-them",3,"click"]],template:function(t,e){1&t&&(Ya(0,"div",0),Ha(1,$5,6,3,"div",1),Za()),2&t&&(vi(1),Ka("ngForOf",e.chat_messages))},directives:[Kc,Yc],styles:['.imessage[_ngcontent-%COMP%]{background-color:#fff;border-radius:.25rem;display:flex;flex-direction:column;font-family:SanFrancisco;font-size:1rem;margin:0 auto 1rem;padding:.5rem 1.5rem;overflow-y:scroll;overflow-x:hidden;height:100%}.imessage[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}.imessage[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgba(0,0,0,.26)}.imessage[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{border-radius:1.15rem;line-height:1.25;max-width:75%;padding:.5rem .875rem;position:relative;word-wrap:break-word}.imessage[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after, .imessage[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:before{bottom:-.1rem;content:"";height:1rem;position:absolute}p.from-me[_ngcontent-%COMP%]{align-self:flex-end;background-color:#248bf5;color:#fff}p.from-me[_ngcontent-%COMP%]:before{border-bottom-left-radius:.8rem .7rem;border-right:1rem solid #248bf5;right:-.35rem;transform:translateY(-.1rem)}p.from-me[_ngcontent-%COMP%]:after{background-color:#fff;border-bottom-left-radius:.5rem;right:-40px;transform:translate(-30px,-2px);width:10px}p[class^=from-][_ngcontent-%COMP%]{margin:.5rem 0;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}p.from-me[_ngcontent-%COMP%] ~ p.from-me[_ngcontent-%COMP%], p.from-me[_ngcontent-%COMP%] ~ p.from-me[_ngcontent-%COMP%]:not(:last-child){margin:.25rem 0 0}p.from-me[_ngcontent-%COMP%] ~ p.from-me[_ngcontent-%COMP%]:last-child{margin-bottom:.5rem}p.from-them[_ngcontent-%COMP%]{align-items:flex-start;background-color:#e5e5ea;color:#000}p.from-them[_ngcontent-%COMP%]:before{border-bottom-right-radius:.8rem .7rem;border-left:1rem solid #e5e5ea;left:-.35rem;transform:translateY(-.1rem)}p.from-them[_ngcontent-%COMP%]:after{background-color:#fff;border-bottom-right-radius:.5rem;left:20px;transform:translate(-30px,-2px);width:10px}p[class^=from-].emoji[_ngcontent-%COMP%]{background:none;font-size:2.5rem}p[class^=from-].emoji[_ngcontent-%COMP%]:before{content:none}.no-tail[_ngcontent-%COMP%]:before{display:none}.margin-b_none[_ngcontent-%COMP%]{margin-bottom:0!important}.margin-b_one[_ngcontent-%COMP%]{margin-bottom:1rem!important}.margin-t_one[_ngcontent-%COMP%]{margin-top:1rem!important}@font-face{font-family:SanFrancisco;src:url(https://cdn.rawgit.com/AllThingsSmitty/fonts/25983b71/SanFrancisco/sanfranciscodisplay-regular-webfont.woff2) format("woff2"),url(https://cdn.rawgit.com/AllThingsSmitty/fonts/25983b71/SanFrancisco/sanfranciscodisplay-regular-webfont.woff) format("woff")}body[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;font-weight:400;margin:0}.container[_ngcontent-%COMP%]{margin:0 auto;max-width:600px;padding:1rem}h1[_ngcontent-%COMP%]{margin-bottom:.5rem}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{font-weight:400}h2[_ngcontent-%COMP%]{border-bottom:1px solid #e5e5ea;color:#666;margin-top:0;padding-bottom:1.5rem}.comment[_ngcontent-%COMP%]{color:#222;font-size:1.25rem;line-height:1.5;margin-bottom:1.25rem;max-width:100%;padding:0}@media screen and (max-width:800px){body[_ngcontent-%COMP%]{margin:0 .5rem}.container[_ngcontent-%COMP%]{padding:.5rem}.imessage[_ngcontent-%COMP%]{font-size:1.05rem;margin:0 auto 1rem;max-width:600px;padding:.25rem .875rem;overflow-y:scroll}.imessage[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0}}.custom-scroll-bar[_ngcontent-%COMP%]{height:100vh;overflow-y:scroll;overflow-x:hidden}.custom-scroll-bar[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}.custom-scroll-bar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgba(0,0,0,.26)}']}),t})();function L5(t,e){if(1&t&&(Ya(0,"div"),Ya(1,"mat-list-option",9),Ya(2,"h3",10),Ya(3,"mat-icon"),Do(4),Za(),Do(5),Za(),Ya(6,"h4",10),Do(7),Za(),Za(),Qa(8,"mat-divider"),Za()),2&t){const t=e.$implicit;vi(1),Ka("value",t),vi(3),Fo(t.type),vi(1),$o(" ",t.display_name||t.participants.join(",")||""," "),vi(2),$o(" ",t.most_recent_message," ")}}let P5=(()=>{class t{constructor(t,e){this.dbservice=t,this.mainapp=e,this.selecteddb=null,this.chats=null,this.selected=null,this.mainapp.db_change_share.subscribe(t=>{this.selecteddb=t,this.dbservice.getChats(this.selecteddb,null,0,0)}),this.dbservice.chat_share.subscribe(t=>{this.chats=t.data})}ngOnInit(){}selectChat(t,e){const n=e.selected[0].value.id;n&&this.dbservice.getChat(this.selecteddb,n,null)}}return t.\u0275fac=function(e){return new(e||t)(Ga($C),Ga(LC))},t.\u0275cmp=fe({type:t,selectors:[["app-chat-view"]],features:[Jo([])],decls:15,vars:9,consts:[["cols","12","rowHeight","100%"],[3,"colspan","rowspan"],[2,"height","100%","width","100%"],["color","accent"],[1,"custom-scroll-bar",3,"multiple","selectionChange"],["chatitems",""],[4,"ngFor","ngForOf"],[2,"width","100%"],[2,"width","100%","height","100%"],[2,"cursor","pointer",3,"value"],["matLine",""]],template:function(t,e){if(1&t){const t=eo();Ya(0,"mat-grid-list",0),Ya(1,"mat-grid-tile",1),Ya(2,"div",2),Ya(3,"mat-toolbar",3),Ya(4,"mat-toolbar-row"),Do(5),Za(),Za(),Ya(6,"mat-selection-list",4,5),so("selectionChange",function(n){ln(t);const r=qa(7);return e.selectChat(n,r.selectedOptions)}),Ha(8,L5,9,4,"div",6),Za(),Za(),Za(),Qa(9,"mat-divider",7),Ya(10,"mat-grid-tile",1),Qa(11,"app-message-view",8),Za(),Qa(12,"mat-divider",7),Ya(13,"mat-grid-tile",1),Do(14," Hello "),Za(),Za()}2&t&&(vi(1),Ka("colspan",3)("rowspan",1),vi(4),$o(" ",e.selecteddb||"No Database Loaded"," "),vi(1),Ka("multiple",!1),vi(2),Ka("ngForOf",e.chats),vi(2),Ka("colspan",6)("rowspan",1),vi(3),Ka("colspan",3)("rowspan",1))},directives:[tw,jv,ty,Jg,Ov,Kc,sv,M5,Rv,_g,ub],styles:[".is-active[_ngcontent-%COMP%]{background-color:red}.mat-icon[_ngcontent-%COMP%]{vertical-align:middle}.mat-list[_ngcontent-%COMP%]{flex-grow:1;overflow:scroll}.mat-list-item[_ngcontent-%COMP%]{background-color:#fefefe}.custom-scroll-bar[_ngcontent-%COMP%]{height:100vh;overflow-y:scroll;overflow-x:hidden}.custom-scroll-bar[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}.custom-scroll-bar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgba(0,0,0,.26)}.example-viewport[_ngcontent-%COMP%]{height:100%;width:100%;border:1px solid #000}.example-alternate[_ngcontent-%COMP%]{background:hsla(0,0%,49.8%,.3)}.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}"]}),t})(),z5=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=fe({type:t,selectors:[["app-entity-view"]],decls:2,vars:0,template:function(t,e){1&t&&(Ya(0,"p"),Do(1,"entity-view works!"),Za())},styles:[""]}),t})(),B5=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=fe({type:t,selectors:[["app-sentiment-view"]],decls:2,vars:0,template:function(t,e){1&t&&(Ya(0,"p"),Do(1,"sentiment-view works!"),Za())},styles:[""]}),t})();var V5=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};function W5(t){return 0|t.length}function U5(t){return!(t>0)}function j5(t){return"object"!=typeof t||"length"in t?t:Array.from(t)}var H5=function(t){return t};function q5(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(n<s||void 0===n&&s>=s)&&(n=s)}return n}function G5(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let s of t)null!=(s=e(s,++r,t))&&(n>s||void 0===n&&s>=s)&&(n=s)}return n}function K5(t,e,n=0,r=t.length-1,s=V5){for(;r>n;){if(r-n>600){const i=r-n+1,a=e-n+1,o=Math.log(i),l=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*l*(i-l)/i)*(a-i/2<0?-1:1);K5(t,e,Math.max(n,Math.floor(e-a*l/i+u)),Math.min(r,Math.floor(e+(i-a)*l/i+u)),s)}const i=t[e];let a=n,o=r;for(X5(t,n,e),s(t[r],i)>0&&X5(t,n,r);a<o;){for(X5(t,a,o),++a,--o;s(t[a],i)<0;)++a;for(;s(t[o],i)>0;)--o}0===s(t[n],i)?X5(t,n,o):(++o,X5(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}return t}function X5(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Y5(t,e,n){if(r=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n))).length){if((e=+e)<=0||r<2)return G5(t);if(e>=1)return q5(t);var r,s=(r-1)*e,i=Math.floor(s),a=q5(K5(t,i).subarray(0,i+1));return a+(G5(t.subarray(i+1))-a)*(s-i)}}var Z5=function(t,e,n){t=+t,e=+e,n=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+n;for(var r=-1,s=0|Math.max(0,Math.ceil((e-t)/n)),i=new Array(s);++r<s;)i[r]=t+r*n;return i};function Q5(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let s of t)(s=+e(s,++r,t))&&(n+=s)}return n}var J5=Array.prototype.slice,t8=function(t){return t},e8=1e-6;function n8(t){return"translate("+(t+.5)+",0)"}function r8(t){return"translate(0,"+(t+.5)+")"}function s8(t){return e=>+t(e)}function i8(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function a8(){return!this.__axis}function o8(t,e){var n=[],r=null,s=null,i=6,a=6,o=3,l=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",c=1===t||3===t?n8:r8;function h(h){var d=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,p=null==s?e.tickFormat?e.tickFormat.apply(e,n):t8:s,f=Math.max(i,0)+o,m=e.range(),g=+m[0]+.5,y=+m[m.length-1]+.5,b=(e.bandwidth?i8:s8)(e.copy()),v=h.selection?h.selection():h,w=v.selectAll(".domain").data([null]),_=v.selectAll(".tick").data(d,e).order(),x=_.exit(),k=_.enter().append("g").attr("class","tick"),S=_.select("line"),C=_.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(k),S=S.merge(k.append("line").attr("stroke","currentColor").attr(u+"2",l*i)),C=C.merge(k.append("text").attr("fill","currentColor").attr(u,l*f).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==v&&(w=w.transition(h),_=_.transition(h),S=S.transition(h),C=C.transition(h),x=x.transition(h).attr("opacity",e8).attr("transform",function(t){return isFinite(t=b(t))?c(t):this.getAttribute("transform")}),k.attr("opacity",e8).attr("transform",function(t){var e=this.parentNode.__axis;return c(e&&isFinite(e=e(t))?e:b(t))})),x.remove(),w.attr("d",4===t||2==t?a?"M"+l*a+","+g+"H0.5V"+y+"H"+l*a:"M0.5,"+g+"V"+y:a?"M"+g+","+l*a+"V0.5H"+y+"V"+l*a:"M"+g+",0.5H"+y),_.attr("opacity",1).attr("transform",function(t){return c(b(t))}),S.attr(u+"2",l*i),C.attr(u,l*f).text(p),v.filter(a8).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),v.each(function(){this.__axis=b})}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=J5.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:J5.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(r=null==t?null:J5.call(t),h):r&&r.slice()},h.tickFormat=function(t){return arguments.length?(s=t,h):s},h.tickSize=function(t){return arguments.length?(i=a=+t,h):i},h.tickSizeInner=function(t){return arguments.length?(i=+t,h):i},h.tickSizeOuter=function(t){return arguments.length?(a=+t,h):a},h.tickPadding=function(t){return arguments.length?(o=+t,h):o},h}var l8={value:()=>{}};function u8(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new c8(r)}function c8(t){this._=t}function h8(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function d8(t,e){for(var n,r=0,s=t.length;r<s;++r)if((n=t[r]).name===e)return n.value}function p8(t,e,n){for(var r=0,s=t.length;r<s;++r)if(t[r].name===e){t[r]=l8,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}c8.prototype=u8.prototype={constructor:c8,on:function(t,e){var n,r=this._,s=h8(t+"",r),i=-1,a=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<a;)if(n=(t=s[i]).type)r[n]=p8(r[n],t.name,e);else if(null==e)for(n in r)r[n]=p8(r[n],t.name,null);return this}for(;++i<a;)if((n=(t=s[i]).type)&&(n=d8(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new c8(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,s=new Array(n),i=0;i<n;++i)s[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,s)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],s=0,i=r.length;s<i;++s)r[s].value.apply(e,n)}};var f8=u8;function m8(){}var g8=function(t){return null==t?m8:function(){return this.querySelector(t)}},y8=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)};function b8(){return[]}var v8=function(t){return null==t?b8:function(){return this.querySelectorAll(t)}},w8=function(t){return function(){return this.matches(t)}};function _8(t){return function(e){return e.matches(t)}}var x8=Array.prototype.find;function k8(){return this.firstElementChild}var S8=Array.prototype.filter;function C8(){return this.children}var I8=function(t){return new Array(t.length)};function E8(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}E8.prototype={constructor:E8,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var T8=function(t){return function(){return t}};function N8(t,e,n,r,s,i){for(var a,o=0,l=e.length,u=i.length;o<u;++o)(a=e[o])?(a.__data__=i[o],r[o]=a):n[o]=new E8(t,i[o]);for(;o<l;++o)(a=e[o])&&(s[o]=a)}function A8(t,e,n,r,s,i,a){var o,l,u,c=new Map,h=e.length,d=i.length,p=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(p[o]=u=a.call(l,l.__data__,o,e)+"",c.has(u)?s[o]=l:c.set(u,l));for(o=0;o<d;++o)u=a.call(t,i[o],o,i)+"",(l=c.get(u))?(r[o]=l,l.__data__=i[o],c.delete(u)):n[o]=new E8(t,i[o]);for(o=0;o<h;++o)(l=e[o])&&c.get(p[o])===l&&(s[o]=l)}function R8(t){return t.__data__}function O8(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var D8="http://www.w3.org/1999/xhtml",F8={svg:"http://www.w3.org/2000/svg",xhtml:D8,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},$8=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),F8.hasOwnProperty(e)?{space:F8[e],local:t}:t};function M8(t){return function(){this.removeAttribute(t)}}function L8(t){return function(){this.removeAttributeNS(t.space,t.local)}}function P8(t,e){return function(){this.setAttribute(t,e)}}function z8(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function B8(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function V8(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var W8=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function U8(t){return function(){this.style.removeProperty(t)}}function j8(t,e,n){return function(){this.style.setProperty(t,e,n)}}function H8(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function q8(t,e){return t.style.getPropertyValue(e)||W8(t).getComputedStyle(t,null).getPropertyValue(e)}function G8(t){return function(){delete this[t]}}function K8(t,e){return function(){this[t]=e}}function X8(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Y8(t){return t.trim().split(/^|\s+/)}function Z8(t){return t.classList||new Q8(t)}function Q8(t){this._node=t,this._names=Y8(t.getAttribute("class")||"")}function J8(t,e){for(var n=Z8(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function t7(t,e){for(var n=Z8(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function e7(t){return function(){J8(this,t)}}function n7(t){return function(){t7(this,t)}}function r7(t,e){return function(){(e.apply(this,arguments)?J8:t7)(this,t)}}function s7(){this.textContent=""}function i7(t){return function(){this.textContent=t}}function a7(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function o7(){this.innerHTML=""}function l7(t){return function(){this.innerHTML=t}}function u7(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function c7(){this.nextSibling&&this.parentNode.appendChild(this)}function h7(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function d7(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===D8&&e.documentElement.namespaceURI===D8?e.createElement(t):e.createElementNS(n,t)}}function p7(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}Q8.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var f7=function(t){var e=$8(t);return(e.local?p7:d7)(e)};function m7(){return null}function g7(){var t=this.parentNode;t&&t.removeChild(this)}function y7(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function b7(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function v7(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}function w7(t){return function(){var e=this.__on;if(e){for(var n,r=0,s=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++s]=n:this.removeEventListener(n.type,n.listener,n.options);++s?e.length=s:delete this.__on}}}function _7(t,e,n){return function(){var r,s=this.__on,i=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var a=0,o=s.length;a<o;++a)if((r=s[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e);this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},s?s.push(r):this.__on=[r]}}function x7(t,e,n){var r=W8(t),s=r.CustomEvent;"function"==typeof s?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function k7(t,e){return function(){return x7(this,t,e)}}function S7(t,e){return function(){return x7(this,t,e.apply(this,arguments))}}var C7=[null];function I7(t,e){this._groups=t,this._parents=e}function E7(){return new I7([[document.documentElement]],C7)}I7.prototype=E7.prototype={constructor:I7,select:function(t){"function"!=typeof t&&(t=g8(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i,a,o=e[s],l=o.length,u=r[s]=new Array(l),c=0;c<l;++c)(i=o[c])&&(a=t.call(i,i.__data__,c,o))&&("__data__"in i&&(a.__data__=i.__data__),u[c]=a);return new I7(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:y8(e)}}(t):v8(t);for(var e=this._groups,n=e.length,r=[],s=[],i=0;i<n;++i)for(var a,o=e[i],l=o.length,u=0;u<l;++u)(a=o[u])&&(r.push(t.call(a,a.__data__,u,o)),s.push(a));return new I7(r,s)},selectChild:function(t){return this.select(null==t?k8:function(t){return function(){return x8.call(this.children,t)}}("function"==typeof t?t:_8(t)))},selectChildren:function(t){return this.selectAll(null==t?C8:function(t){return function(){return S8.call(this.children,t)}}("function"==typeof t?t:_8(t)))},filter:function(t){"function"!=typeof t&&(t=w8(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i,a=e[s],o=a.length,l=r[s]=[],u=0;u<o;++u)(i=a[u])&&t.call(i,i.__data__,u,a)&&l.push(i);return new I7(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,R8);var n=e?A8:N8,r=this._parents,s=this._groups;"function"!=typeof t&&(t=T8(t));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),u=0;u<i;++u){var c=r[u],h=s[u],d=h.length,p=y8(t.call(c,c&&c.__data__,u,r)),f=p.length,m=o[u]=new Array(f),g=a[u]=new Array(f),y=l[u]=new Array(d);n(c,h,m,g,y,p,e);for(var b,v,w=0,_=0;w<f;++w)if(b=m[w]){for(w>=_&&(_=w+1);!(v=g[_])&&++_<f;);b._next=v||null}}return(a=new I7(a,r))._enter=o,a._exit=l,a},enter:function(){return new I7(this._enter||this._groups.map(I8),this._parents)},exit:function(){return new I7(this._exit||this._groups.map(I8),this._parents)},join:function(t,e,n){var r=this.enter(),s=this,i=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(s=e(s)),null==n?i.remove():n(i),r&&s?r.merge(s).order():s},merge:function(t){if(!(t instanceof I7))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,r=e.length,s=Math.min(r,n.length),i=new Array(r),a=0;a<s;++a)for(var o,l=e[a],u=n[a],c=l.length,h=i[a]=new Array(c),d=0;d<c;++d)(o=l[d]||u[d])&&(h[d]=o);for(;a<r;++a)i[a]=e[a];return new I7(i,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,s=t[e],i=s.length-1,a=s[i];--i>=0;)(r=s[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=O8);for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a,o=n[i],l=o.length,u=s[i]=new Array(l),c=0;c<l;++c)(a=o[c])&&(u[c]=a);u.sort(e)}return new I7(s,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s,i=e[n],a=0,o=i.length;a<o;++a)(s=i[a])&&t.call(s,s.__data__,a,i);return this},attr:function(t,e){var n=$8(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?L8:M8:"function"==typeof e?n.local?V8:B8:n.local?z8:P8)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?U8:"function"==typeof e?H8:j8)(t,e,null==n?"":n)):q8(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?G8:"function"==typeof e?X8:K8)(t,e)):this.node()[t]},classed:function(t,e){var n=Y8(t+"");if(arguments.length<2){for(var r=Z8(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each(("function"==typeof e?r7:e?e7:n7)(n,e))},text:function(t){return arguments.length?this.each(null==t?s7:("function"==typeof t?a7:i7)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?o7:("function"==typeof t?u7:l7)(t)):this.node().innerHTML},raise:function(){return this.each(c7)},lower:function(){return this.each(h7)},append:function(t){var e="function"==typeof t?t:f7(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:f7(t),r=null==e?m7:"function"==typeof e?e:g8(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(g7)},clone:function(t){return this.select(t?b7:y7)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,s,i=v7(t+""),a=i.length;if(!(arguments.length<2)){for(o=e?_7:w7,r=0;r<a;++r)this.each(o(i[r],e,n));return this}var o=this.node().__on;if(o)for(var l,u=0,c=o.length;u<c;++u)for(r=0,l=o[u];r<a;++r)if((s=i[r]).type===l.type&&s.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?S7:k7)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,s=t[e],i=0,a=s.length;i<a;++i)(r=s[i])&&(yield r)}};var T7=E7,N7=function(t){return"string"==typeof t?new I7([[document.querySelector(t)]],[document.documentElement]):new I7([[t]],C7)},A7=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function R7(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function O7(){}var D7=.7,F7=1/D7,$7="\\s*([+-]?\\d+)\\s*",M7="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",L7="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",P7=/^#([0-9a-f]{3,8})$/,z7=new RegExp("^rgb\\("+[$7,$7,$7]+"\\)$"),B7=new RegExp("^rgb\\("+[L7,L7,L7]+"\\)$"),V7=new RegExp("^rgba\\("+[$7,$7,$7,M7]+"\\)$"),W7=new RegExp("^rgba\\("+[L7,L7,L7,M7]+"\\)$"),U7=new RegExp("^hsl\\("+[M7,L7,L7]+"\\)$"),j7=new RegExp("^hsla\\("+[M7,L7,L7,M7]+"\\)$"),H7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function q7(){return this.rgb().formatHex()}function G7(){return this.rgb().formatRgb()}function K7(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=P7.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?X7(e):3===n?new J7(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Y7(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Y7(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=z7.exec(t))?new J7(e[1],e[2],e[3],1):(e=B7.exec(t))?new J7(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=V7.exec(t))?Y7(e[1],e[2],e[3],e[4]):(e=W7.exec(t))?Y7(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=U7.exec(t))?r9(e[1],e[2]/100,e[3]/100,1):(e=j7.exec(t))?r9(e[1],e[2]/100,e[3]/100,e[4]):H7.hasOwnProperty(t)?X7(H7[t]):"transparent"===t?new J7(NaN,NaN,NaN,0):null}function X7(t){return new J7(t>>16&255,t>>8&255,255&t,1)}function Y7(t,e,n,r){return r<=0&&(t=e=n=NaN),new J7(t,e,n,r)}function Z7(t){return t instanceof O7||(t=K7(t)),t?new J7((t=t.rgb()).r,t.g,t.b,t.opacity):new J7}function Q7(t,e,n,r){return 1===arguments.length?Z7(t):new J7(t,e,n,null==r?1:r)}function J7(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function t9(){return"#"+n9(this.r)+n9(this.g)+n9(this.b)}function e9(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function n9(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function r9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new i9(t,e,n,r)}function s9(t){if(t instanceof i9)return new i9(t.h,t.s,t.l,t.opacity);if(t instanceof O7||(t=K7(t)),!t)return new i9;if(t instanceof i9)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,s=Math.min(e,n,r),i=Math.max(e,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(a=e===i?(n-r)/o+6*(n<r):n===i?(r-e)/o+2:(e-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new i9(a,o,l,t.opacity)}function i9(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function a9(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function o9(t,e,n,r,s){var i=t*t,a=i*t;return((1-3*t+3*i-a)*e+(4-6*i+3*a)*n+(1+3*t+3*i-3*a)*r+a*s)/6}A7(O7,K7,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:q7,formatHex:q7,formatHsl:function(){return s9(this).formatHsl()},formatRgb:G7,toString:G7}),A7(J7,Q7,R7(O7,{brighter:function(t){return t=null==t?F7:Math.pow(F7,t),new J7(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?D7:Math.pow(D7,t),new J7(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:t9,formatHex:t9,formatRgb:e9,toString:e9})),A7(i9,function(t,e,n,r){return 1===arguments.length?s9(t):new i9(t,e,n,null==r?1:r)},R7(O7,{brighter:function(t){return t=null==t?F7:Math.pow(F7,t),new i9(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?D7:Math.pow(D7,t),new i9(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,s=2*n-r;return new J7(a9(t>=240?t-240:t+120,s,r),a9(t,s,r),a9(t<120?t+240:t-120,s,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var l9=t=>()=>t;function u9(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):l9(isNaN(t)?e:t)}var c9=function t(e){var n=function(t){return 1==(t=+t)?u9:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):l9(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Q7(t)).r,(e=Q7(e)).r),s=n(t.g,e.g),i=n(t.b,e.b),a=u9(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=s(e),t.b=i(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function h9(t){return function(e){var n,r,s=e.length,i=new Array(s),a=new Array(s),o=new Array(s);for(n=0;n<s;++n)r=Q7(e[n]),i[n]=r.r||0,a[n]=r.g||0,o[n]=r.b||0;return i=t(i),a=t(a),o=t(o),r.opacity=1,function(t){return r.r=i(t),r.g=a(t),r.b=o(t),r+""}}}h9(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),s=t[r],i=t[r+1];return o9((n-r/e)*e,r>0?t[r-1]:2*s-i,s,i,r<e-1?t[r+2]:2*i-s)}}),h9(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e);return o9((n-r/e)*e,t[(r+e-1)%e],t[r%e],t[(r+1)%e],t[(r+2)%e])}});var d9=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,s=e.slice();return function(i){for(n=0;n<r;++n)s[n]=t[n]*(1-i)+e[n]*i;return s}};function p9(t,e){var n,r=e?e.length:0,s=t?Math.min(r,t.length):0,i=new Array(s),a=new Array(r);for(n=0;n<s;++n)i[n]=x9(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<s;++n)a[n]=i[n](t);return a}}var f9,m9,g9=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},y9=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},b9=function(t,e){var n,r={},s={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=x9(t[n],e[n]):s[n]=e[n];return function(t){for(n in r)s[n]=r[n](t);return s}},v9=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,w9=new RegExp(v9.source,"g"),_9=function(t,e){var n,r,s,i=v9.lastIndex=w9.lastIndex=0,a=-1,o=[],l=[];for(t+="",e+="";(n=v9.exec(t))&&(r=w9.exec(e));)(s=r.index)>i&&(s=e.slice(i,s),o[a]?o[a]+=s:o[++a]=s),(n=n[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,l.push({i:a,x:y9(n,r)})),i=w9.lastIndex;return i<e.length&&(s=e.slice(i),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)o[(n=l[r]).i]=n.x(t);return o.join("")})},x9=function(t,e){var n,r,s=typeof e;return null==e||"boolean"===s?l9(e):("number"===s?y9:"string"===s?(n=K7(e))?(e=n,c9):_9:e instanceof K7?c9:e instanceof Date?g9:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?p9:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?b9:y9:d9))(t,e)},k9=0,S9=0,C9=0,I9=0,E9=0,T9=0,N9="object"==typeof performance&&performance.now?performance:Date,A9="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function R9(){return E9||(A9(O9),E9=N9.now()+T9)}function O9(){E9=0}function D9(){this._call=this._time=this._next=null}function F9(t,e,n){var r=new D9;return r.restart(t,e,n),r}function $9(){E9=(I9=N9.now())+T9,k9=S9=0;try{!function(){R9(),++k9;for(var t,e=f9;e;)(t=E9-e._time)>=0&&e._call.call(null,t),e=e._next;--k9}()}finally{k9=0,function(){for(var t,e,n=f9,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:f9=e);m9=t,L9(r)}(),E9=0}}function M9(){var t=N9.now(),e=t-I9;e>1e3&&(T9-=e,I9=t)}function L9(t){k9||(S9&&(S9=clearTimeout(S9)),t-E9>24?(t<1/0&&(S9=setTimeout($9,t-N9.now()-T9)),C9&&(C9=clearInterval(C9))):(C9||(I9=N9.now(),C9=setInterval(M9,1e3)),k9=1,A9($9)))}D9.prototype=F9.prototype={constructor:D9,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?R9():+n)+(null==e?0:+e),this._next||m9===this||(m9?m9._next=this:f9=this,m9=this),this._call=t,this._time=n,L9()},stop:function(){this._call&&(this._call=null,this._time=1/0,L9())}};var P9=function(t,e,n){var r=new D9;return r.restart(n=>{r.stop(),t(n+e)},e=null==e?0:+e,n),r},z9=f8("start","end","cancel","interrupt"),B9=[],V9=function(t,e,n,r,s,i){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,s=t.__transition;function i(l){var u,c,h,d;if(1!==n.state)return o();for(u in s)if((d=s[u]).name===n.name){if(3===d.state)return P9(i);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete s[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete s[u])}if(P9(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function a(e){for(var s=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(o),n.state=5,1),i=-1,a=r.length;++i<a;)r[i].call(t,s);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),o())}function o(){for(var r in n.state=6,n.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=n,n.timer=F9(function(t){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=t&&i(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:s,on:z9,tween:B9,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})};function W9(t,e){var n=j9(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function U9(t,e){var n=j9(t,e);if(n.state>3)throw new Error("too late; already running");return n}function j9(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var H9,q9=180/Math.PI,G9={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},K9=function(t,e,n,r,s,i){var a,o,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(e,t)*q9,skewX:Math.atan(l)*q9,scaleX:a,scaleY:o}};function X9(t,e,n,r){function s(t){return t.length?t.pop()+" ":""}return function(i,a){var o=[],l=[];return i=t(i),a=t(a),function(t,r,s,i,a,o){if(t!==s||r!==i){var l=a.push("translate(",null,e,null,n);o.push({i:l-4,x:y9(t,s)},{i:l-2,x:y9(r,i)})}else(s||i)&&a.push("translate("+s+e+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,o,l),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(s(n)+"rotate(",null,r)-2,x:y9(t,e)})):e&&n.push(s(n)+"rotate("+e+r)}(i.rotate,a.rotate,o,l),function(t,e,n,i){t!==e?i.push({i:n.push(s(n)+"skewX(",null,r)-2,x:y9(t,e)}):e&&n.push(s(n)+"skewX("+e+r)}(i.skewX,a.skewX,o,l),function(t,e,n,r,i,a){if(t!==n||e!==r){var o=i.push(s(i)+"scale(",null,",",null,")");a.push({i:o-4,x:y9(t,n)},{i:o-2,x:y9(e,r)})}else 1===n&&1===r||i.push(s(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,o,l),i=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)o[(e=l[n]).i]=e.x(t);return o.join("")}}}var Y9=X9(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?G9:K9(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),Z9=X9(function(t){return null==t?G9:(H9||(H9=document.createElementNS("http://www.w3.org/2000/svg","g")),H9.setAttribute("transform",t),(t=H9.transform.baseVal.consolidate())?K9((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):G9)},", ",")",")");function Q9(t,e){var n,r;return function(){var s=U9(this,t),i=s.tween;if(i!==n)for(var a=0,o=(r=n=i).length;a<o;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}s.tween=r}}function J9(t,e,n){var r,s;if("function"!=typeof n)throw new Error;return function(){var i=U9(this,t),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:e,value:n},l=0,u=s.length;l<u;++l)if(s[l].name===e){s[l]=o;break}l===u&&s.push(o)}i.tween=s}}function ttt(t,e,n){var r=t._id;return t.each(function(){var t=U9(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return j9(t,r).value[e]}}var ett=function(t,e){var n;return("number"==typeof e?y9:e instanceof K7?c9:(n=K7(e))?(e=n,c9):_9)(t,e)};function ntt(t){return function(){this.removeAttribute(t)}}function rtt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function stt(t,e,n){var r,s,i=n+"";return function(){var a=this.getAttribute(t);return a===i?null:a===r?s:s=e(r=a,n)}}function itt(t,e,n){var r,s,i=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?s:s=e(r=a,n)}}function att(t,e,n){var r,s,i;return function(){var a,o,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(o=l+"")?null:a===r&&o===s?i:(s=o,i=e(r=a,l));this.removeAttribute(t)}}function ott(t,e,n){var r,s,i;return function(){var a,o,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(o=l+"")?null:a===r&&o===s?i:(s=o,i=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function ltt(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function utt(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ctt(t,e){var n,r;function s(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&utt(t,s)),n}return s._value=e,s}function htt(t,e){var n,r;function s(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&ltt(t,s)),n}return s._value=e,s}function dtt(t,e){return function(){W9(this,t).delay=+e.apply(this,arguments)}}function ptt(t,e){return e=+e,function(){W9(this,t).delay=e}}function ftt(t,e){return function(){U9(this,t).duration=+e.apply(this,arguments)}}function mtt(t,e){return e=+e,function(){U9(this,t).duration=e}}function gtt(t,e){if("function"!=typeof e)throw new Error;return function(){U9(this,t).ease=e}}function ytt(t,e,n){var r,s,i=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?W9:U9;return function(){var a=i(this,t),o=a.on;o!==r&&(s=(r=o).copy()).on(e,n),a.on=s}}var btt=T7.prototype.constructor;function vtt(t){return function(){this.style.removeProperty(t)}}function wtt(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function _tt(t,e,n){var r,s;function i(){var i=e.apply(this,arguments);return i!==s&&(r=(s=i)&&wtt(t,i,n)),r}return i._value=e,i}function xtt(t){return function(e){this.textContent=t.call(this,e)}}function ktt(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&xtt(r)),e}return r._value=t,r}var Stt=0;function Ctt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Itt(){return++Stt}var Ett=T7.prototype;Ctt.prototype=(function(t){return T7().transition(t)}).prototype={constructor:Ctt,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=g8(t));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o,l,u=r[a],c=u.length,h=i[a]=new Array(c),d=0;d<c;++d)(o=u[d])&&(l=t.call(o,o.__data__,d,u))&&("__data__"in o&&(l.__data__=o.__data__),h[d]=l,V9(h[d],e,n,d,h,j9(o,n)));return new Ctt(i,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=v8(t));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l,u=r[o],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var d,p=t.call(l,l.__data__,h,u),f=j9(l,n),m=0,g=p.length;m<g;++m)(d=p[m])&&V9(d,e,n,m,p,f);i.push(p),a.push(l)}return new Ctt(i,a,e,n)},filter:function(t){"function"!=typeof t&&(t=w8(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i,a=e[s],o=a.length,l=r[s]=[],u=0;u<o;++u)(i=a[u])&&t.call(i,i.__data__,u,a)&&l.push(i);return new Ctt(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,s=Math.min(r,n.length),i=new Array(r),a=0;a<s;++a)for(var o,l=e[a],u=n[a],c=l.length,h=i[a]=new Array(c),d=0;d<c;++d)(o=l[d]||u[d])&&(h[d]=o);for(;a<r;++a)i[a]=e[a];return new Ctt(i,this._parents,this._name,this._id)},selection:function(){return new btt(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Itt(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a,o=r[i],l=o.length,u=0;u<l;++u)if(a=o[u]){var c=j9(a,e);V9(a,t,n,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ctt(r,this._parents,t,n)},call:Ett.call,nodes:Ett.nodes,node:Ett.node,size:Ett.size,empty:Ett.empty,each:Ett.each,on:function(t,e){var n=this._id;return arguments.length<2?j9(this.node(),n).on.on(t):this.each(ytt(n,t,e))},attr:function(t,e){var n=$8(t),r="transform"===n?Z9:ett;return this.attrTween(t,"function"==typeof e?(n.local?ott:att)(n,r,ttt(this,"attr."+t,e)):null==e?(n.local?rtt:ntt)(n):(n.local?itt:stt)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=$8(t);return this.tween(n,(r.local?ctt:htt)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Y9:ett;return null==e?this.styleTween(t,function(t,e){var n,r,s;return function(){var i=q8(this,t),a=(this.style.removeProperty(t),q8(this,t));return i===a?null:i===n&&a===r?s:s=e(n=i,r=a)}}(t,r)).on("end.style."+t,vtt(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,s,i;return function(){var a=q8(this,t),o=n(this),l=o+"";return null==o&&(this.style.removeProperty(t),l=o=q8(this,t)),a===l?null:a===r&&l===s?i:(s=l,i=e(r=a,o))}}(t,r,ttt(this,"style."+t,e))).each(function(t,e){var n,r,s,i,a="style."+e,o="end."+a;return function(){var l=U9(this,t),u=l.on,c=null==l.value[a]?i||(i=vtt(e)):void 0;u===n&&s===c||(r=(n=u).copy()).on(o,s=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,s,i=n+"";return function(){var a=q8(this,t);return a===i?null:a===r?s:s=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,_tt(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ttt(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,ktt(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,s=j9(this.node(),n).tween,i=0,a=s.length;i<a;++i)if((r=s[i]).name===t)return r.value;return null}return this.each((null==e?Q9:J9)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?dtt:ptt)(e,t)):j9(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ftt:mtt)(e,t)):j9(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(gtt(e,t)):j9(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;U9(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){0==--s&&i()}};n.each(function(){var n=U9(this,r),s=n.on;s!==t&&((e=(t=s).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),n.on=e}),0===s&&i()})},[Symbol.iterator]:Ett[Symbol.iterator]};var Ttt={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ntt(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Att(t){return{type:t}}function Rtt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}T7.prototype.interrupt=function(t){return this.each(function(){!function(t,e){var n,r,s,i=t.__transition,a=!0;if(i){for(s in e=null==e?null:e+"",i)(n=i[s]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[s]):a=!1;a&&delete t.__transition}}(this,t)})},T7.prototype.transition=function(t){var e,n;t instanceof Ctt?(e=t._id,t=t._name):(e=Itt(),(n=Ttt).time=R9(),t=null==t?null:t+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a,o=r[i],l=o.length,u=0;u<l;++u)(a=o[u])&&V9(a,t,e,u,o,n||Ntt(a,e));return new Ctt(r,this._parents,t,e)},Math,["w","e"].map(Att),["n","s"].map(Att),["n","w","e","s","nw","ne","sw","se"].map(Att);var Ott=function(t){return(t=Rtt(Math.abs(t)))?t[1]:NaN},Dtt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ftt(t){if(!(e=Dtt.exec(t)))throw new Error("invalid format: "+t);var e;return new $tt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function $tt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Ftt.prototype=$tt.prototype,$tt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Mtt,Ltt,Ptt,ztt,Btt=function(t,e){var n=Rtt(t,e);if(!n)return t+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")},Vtt={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Btt(100*t,e),r:Btt,s:function(t,e){var n=Rtt(t,e);if(!n)return t+"";var r=n[0],s=n[1],i=s-(Mtt=3*Math.max(-8,Math.min(8,Math.floor(s/3))))+1,a=r.length;return i===a?r:i>a?r+new Array(i-a+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Rtt(t,Math.max(0,e+i-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)},Wtt=function(t){return t},Utt=Array.prototype.map,jtt=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];Ltt=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Wtt:(e=Utt.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var s=t.length,i=[],a=0,o=e[0],l=0;s>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),i.push(t.substring(s-=o,s+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return i.reverse().join(n)}),s=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?Wtt:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(Utt.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Ftt(t)).fill,n=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,m=t.comma,g=t.precision,y=t.trim,b=t.type;"n"===b?(m=!0,b="g"):Vtt[b]||(void 0===g&&(g=12),y=!0,b="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var v="$"===d?s:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===d?i:/[%p]/.test(b)?l:"",_=Vtt[b],x=/[defgprs%]/.test(b);function k(t){var s,i,l,d=v,k=w;if("c"===b)k=_(t)+k,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:_(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,s=-1;r<n;++r)switch(t[r]){case".":s=e=r;break;case"0":0===s&&(s=r),e=r;break;default:if(!+t[r])break t;s>0&&(s=0)}return s>0?t.slice(0,s)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:u:"-"===h||"("===h?"":h)+d,k=("s"===b?jtt[8+Mtt/3]:"")+k+(S&&"("===h?")":""),x)for(s=-1,i=t.length;++s<i;)if(48>(l=t.charCodeAt(s))||l>57){k=(46===l?a+t.slice(s+1):t.slice(s))+k,t=t.slice(0,s);break}}m&&!p&&(t=r(t,1/0));var C=d.length+t.length+k.length,I=C<f?new Array(f-C+1).join(e):"";switch(m&&p&&(t=r(I+t,I.length?f-k.length:1/0),I=""),n){case"<":t=d+t+k+I;break;case"=":t=d+I+t+k;break;case"^":t=I.slice(0,C=I.length>>1)+d+t+k+I.slice(C);break;default:t=I+d+t+k}return o(t)}return g=void 0===g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:h,formatPrefix:function(t,e){var n=h(((t=Ftt(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Ott(e)/3))),s=Math.pow(10,-r),i=jtt[8+r/3];return function(t){return n(s*t)+i}}}}({thousands:",",grouping:[3],currency:["$",""]}),Ptt=Ltt.format,ztt=Ltt.formatPrefix;var Htt=Math.sqrt(50),qtt=Math.sqrt(10),Gtt=Math.sqrt(2);function Ktt(t,e,n){var r=(e-t)/Math.max(0,n),s=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,s);return s>=0?(i>=Htt?10:i>=qtt?5:i>=Gtt?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(i>=Htt?10:i>=qtt?5:i>=Gtt?2:1)}var Xtt=function(t){let e=t,n=t;function r(t,e,r,s){for(null==r&&(r=0),null==s&&(s=t.length);r<s;){const i=r+s>>>1;n(t[i],e)<0?r=i+1:s=i}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>V5(t(e),n)}(t)),{left:r,center:function(t,n,s,i){null==s&&(s=0),null==i&&(i=t.length);const a=r(t,n,s,i-1);return a>s&&e(t[a-1],n)>-e(t[a],n)?a-1:a},right:function(t,e,r,s){for(null==r&&(r=0),null==s&&(s=t.length);r<s;){const i=r+s>>>1;n(t[i],e)>0?s=i:r=i+1}return r}}};const Ytt=Xtt(V5).right;Xtt(function(t){return null===t?NaN:+t});var Ztt=Ytt,Qtt=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}};function Jtt(t){return+t}var tet=[0,1];function eet(t){return t}function net(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function ret(t,e,n){var r=t[0],s=t[1],i=e[0],a=e[1];return s<r?(r=net(s,r),i=n(a,i)):(r=net(r,s),i=n(i,a)),function(t){return i(r(t))}}function set(t,e,n){var r=Math.min(t.length,e.length)-1,s=new Array(r),i=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)s[a]=net(t[a],t[a+1]),i[a]=n(e[a],e[a+1]);return function(e){var n=Ztt(t,e,1,r)-1;return i[n](s[n](e))}}function iet(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function aet(){return function(){var t,e,n,r,s,i,a=tet,o=tet,l=x9,u=eet;function c(){var t,e,n,l=Math.min(a.length,o.length);return u!==eet&&((t=a[0])>(e=a[l-1])&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=l>2?set:ret,s=i=null,h}function h(e){return isNaN(e=+e)?n:(s||(s=r(a.map(t),o,l)))(t(u(e)))}return h.invert=function(n){return u(e((i||(i=r(o,a.map(t),y9)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,Jtt),c()):a.slice()},h.range=function(t){return arguments.length?(o=Array.from(t),c()):o.slice()},h.rangeRound=function(t){return o=Array.from(t),l=Qtt,c()},h.clamp=function(t){return arguments.length?(u=!!t||eet,c()):u!==eet},h.interpolate=function(t){return arguments.length?(l=t,c()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}()(eet,eet)}function oet(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function uet(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}function cet(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,s,i,a,o=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(s=t,t=e,e=s),0===(a=Ktt(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),i=new Array(s=Math.ceil(e-t+1));++o<s;)i[o]=(t+o)*a;else for(a=-a,t=Math.ceil(t*a),e=Math.floor(e*a),i=new Array(s=Math.ceil(e-t+1));++o<s;)i[o]=(t+o)/a;return r&&i.reverse(),i}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var s,i=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/s;return i>=Htt?s*=10:i>=qtt?s*=5:i>=Gtt&&(s*=2),e<t?-s:s}(t,e,n);switch((r=Ftt(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(s=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ott(e)/3)))-Ott(Math.abs(t)))}(i,a))||(r.precision=s),ztt(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(s=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ott(e)-Ott(t))+1}(i,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=s-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(s=function(t){return Math.max(0,-Ott(Math.abs(t)))}(i))||(r.precision=s-2*("%"===r.type))}return Ptt(r)}(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,s,i=e(),a=0,o=i.length-1,l=i[a],u=i[o],c=10;for(u<l&&(s=l,l=u,u=s,s=a,a=o,o=s);c-- >0;){if((s=Ktt(l,u,n))===r)return i[a]=l,i[o]=u,e(i);if(s>0)l=Math.floor(l/s)*s,u=Math.ceil(u/s)*s;else{if(!(s<0))break;l=Math.ceil(l*s)/s,u=Math.floor(u*s)/s}r=s}return t},t}function het(){var t=aet();return t.copy=function(){return iet(t,het())},oet.apply(t,arguments),cet(t)}function det(){var t,e,n,r,s,i=0,a=1,o=eet,l=!1;function u(e){return isNaN(e=+e)?s:o(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r;return arguments.length?([n,r]=e,o=t(n,r),u):[o(0),o(1)]}}return u.domain=function(s){return arguments.length?([i,a]=s,t=r(i=+i),e=r(a=+a),n=t===e?0:1/(e-t),u):[i,a]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(o=t,u):o},u.range=c(x9),u.rangeRound=c(Qtt),u.unknown=function(t){return arguments.length?(s=t,u):s},function(s){return r=s,t=s(i),e=s(a),n=t===e?0:1/(e-t),u}}function pet(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function fet(){var t=cet(det()(eet));return t.copy=function(){return pet(t,fet())},uet.apply(t,arguments)}var met=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n};function get(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var yet=get(met("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),bet=(get(met("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),get(met("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),get(met("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),new Date),vet=new Date;function wet(t,e,n,r){function s(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=function(e){return t(e=new Date(+e)),e},s.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},s.range=function(n,r,i){var a,o=[];if(n=s.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return o;do{o.push(a=new Date(+n)),e(n,i),t(n)}while(a<n&&n<r);return o},s.filter=function(n){return wet(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(s.count=function(e,r){return bet.setTime(+e),vet.setTime(+r),t(bet),t(vet),Math.floor(n(bet,vet))},s.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?s.filter(r?function(e){return r(e)%t==0}:function(e){return s.count(0,e)%t==0}):s:null}),s}var _et=864e5,xet=6048e5,ket=wet(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/_et},function(t){return t.getUTCDate()-1});function Cet(t){return wet(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/xet})}var Iet=Cet(0),Eet=Cet(1),Tet=(Cet(2),Cet(3),Cet(4)),Net=(Cet(5),Cet(6),wet(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()})),Aet=Net,Ret=Net.range,Oet=wet(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Oet.every=function(t){return isFinite(t=Math.floor(t))&&t>0?wet(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var Det=Oet;function Fet(t){return wet(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/xet})}var $et=Fet(0),Met=Fet(1),Let=(Fet(2),Fet(3),Fet(4)),Pet=(Fet(5),Fet(6),wet(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/_et,t=>t.getDate()-1)),zet=wet(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});zet.every=function(t){return isFinite(t=Math.floor(t))&&t>0?wet(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Bet=zet;function Vet(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Wet(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Uet(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var jet,Het,qet,Get={"-":"",_:" ",0:"0"},Ket=/^\s*\d+/,Xet=/^%/,Yet=/[\\^$*+?|[\]().{}]/g;function Zet(t,e,n){var r=t<0?"-":"",s=(r?-t:t)+"",i=s.length;return r+(i<n?new Array(n-i+1).join(e)+s:s)}function Qet(t){return t.replace(Yet,"\\$&")}function Jet(t){return new RegExp("^(?:"+t.map(Qet).join("|")+")","i")}function tnt(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}function ent(t,e,n){var r=Ket.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function nnt(t,e,n){var r=Ket.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function rnt(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function snt(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function int(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function ant(t,e,n){var r=Ket.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function ont(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function lnt(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function unt(t,e,n){var r=Ket.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function cnt(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function hnt(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function dnt(t,e,n){var r=Ket.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function pnt(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function fnt(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function mnt(t,e,n){var r=Ket.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function gnt(t,e,n){var r=Ket.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ynt(t,e,n){var r=Ket.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function bnt(t,e,n){var r=Xet.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function vnt(t,e,n){var r=Ket.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function wnt(t,e,n){var r=Ket.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function _nt(t,e){return Zet(t.getDate(),e,2)}function xnt(t,e){return Zet(t.getHours(),e,2)}function knt(t,e){return Zet(t.getHours()%12||12,e,2)}function Snt(t,e){return Zet(1+Pet.count(Bet(t),t),e,3)}function Cnt(t,e){return Zet(t.getMilliseconds(),e,3)}function Int(t,e){return Cnt(t,e)+"000"}function Ent(t,e){return Zet(t.getMonth()+1,e,2)}function Tnt(t,e){return Zet(t.getMinutes(),e,2)}function Nnt(t,e){return Zet(t.getSeconds(),e,2)}function Ant(t){var e=t.getDay();return 0===e?7:e}function Rnt(t,e){return Zet($et.count(Bet(t)-1,t),e,2)}function Ont(t){var e=t.getDay();return e>=4||0===e?Let(t):Let.ceil(t)}function Dnt(t,e){return t=Ont(t),Zet(Let.count(Bet(t),t)+(4===Bet(t).getDay()),e,2)}function Fnt(t){return t.getDay()}function $nt(t,e){return Zet(Met.count(Bet(t)-1,t),e,2)}function Mnt(t,e){return Zet(t.getFullYear()%100,e,2)}function Lnt(t,e){return Zet((t=Ont(t)).getFullYear()%100,e,2)}function Pnt(t,e){return Zet(t.getFullYear()%1e4,e,4)}function znt(t,e){var n=t.getDay();return Zet((t=n>=4||0===n?Let(t):Let.ceil(t)).getFullYear()%1e4,e,4)}function Bnt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Zet(e/60|0,"0",2)+Zet(e%60,"0",2)}function Vnt(t,e){return Zet(t.getUTCDate(),e,2)}function Wnt(t,e){return Zet(t.getUTCHours(),e,2)}function Unt(t,e){return Zet(t.getUTCHours()%12||12,e,2)}function jnt(t,e){return Zet(1+ket.count(Det(t),t),e,3)}function Hnt(t,e){return Zet(t.getUTCMilliseconds(),e,3)}function qnt(t,e){return Hnt(t,e)+"000"}function Gnt(t,e){return Zet(t.getUTCMonth()+1,e,2)}function Knt(t,e){return Zet(t.getUTCMinutes(),e,2)}function Xnt(t,e){return Zet(t.getUTCSeconds(),e,2)}function Ynt(t){var e=t.getUTCDay();return 0===e?7:e}function Znt(t,e){return Zet(Iet.count(Det(t)-1,t),e,2)}function Qnt(t){var e=t.getUTCDay();return e>=4||0===e?Tet(t):Tet.ceil(t)}function Jnt(t,e){return t=Qnt(t),Zet(Tet.count(Det(t),t)+(4===Det(t).getUTCDay()),e,2)}function trt(t){return t.getUTCDay()}function ert(t,e){return Zet(Eet.count(Det(t)-1,t),e,2)}function nrt(t,e){return Zet(t.getUTCFullYear()%100,e,2)}function rrt(t,e){return Zet((t=Qnt(t)).getUTCFullYear()%100,e,2)}function srt(t,e){return Zet(t.getUTCFullYear()%1e4,e,4)}function irt(t,e){var n=t.getUTCDay();return Zet((t=n>=4||0===n?Tet(t):Tet.ceil(t)).getUTCFullYear()%1e4,e,4)}function art(){return"+0000"}function ort(){return"%"}function lrt(t){return+t}function urt(t){return Math.floor(+t/1e3)}function crt(t){return((t=Math.exp(t))+1/t)/2}function hrt(t,e,n){this.k=t,this.x=e,this.y=n}jet=function(t){var e=t.dateTime,n=t.date,r=t.time,s=t.periods,i=t.days,a=t.shortDays,o=t.months,l=t.shortMonths,u=Jet(s),c=tnt(s),h=Jet(i),d=tnt(i),p=Jet(a),f=tnt(a),m=Jet(o),g=tnt(o),y=Jet(l),b=tnt(l),v={a:function(t){return a[t.getDay()]},A:function(t){return i[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return o[t.getMonth()]},c:null,d:_nt,e:_nt,f:Int,g:Lnt,G:znt,H:xnt,I:knt,j:Snt,L:Cnt,m:Ent,M:Tnt,p:function(t){return s[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:lrt,s:urt,S:Nnt,u:Ant,U:Rnt,V:Dnt,w:Fnt,W:$nt,x:null,X:null,y:Mnt,Y:Pnt,Z:Bnt,"%":ort},w={a:function(t){return a[t.getUTCDay()]},A:function(t){return i[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return o[t.getUTCMonth()]},c:null,d:Vnt,e:Vnt,f:qnt,g:rrt,G:irt,H:Wnt,I:Unt,j:jnt,L:Hnt,m:Gnt,M:Knt,p:function(t){return s[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:lrt,s:urt,S:Xnt,u:Ynt,U:Znt,V:Jnt,w:trt,W:ert,x:null,X:null,y:nrt,Y:srt,Z:art,"%":ort},_={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:hnt,e:hnt,f:ynt,g:ont,G:ant,H:pnt,I:pnt,j:dnt,L:gnt,m:cnt,M:fnt,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:unt,Q:vnt,s:wnt,S:mnt,u:nnt,U:rnt,V:snt,w:ent,W:int,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:ont,Y:ant,Z:lnt,"%":bnt};function x(t,e){return function(n){var r,s,i,a=[],o=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++o<u;)37===t.charCodeAt(o)&&(a.push(t.slice(l,o)),null!=(s=Get[r=t.charAt(++o)])?r=t.charAt(++o):s="e"===r?" ":"0",(i=e[r])&&(r=i(n,s)),a.push(r),l=o+1);return a.push(t.slice(l,o)),a.join("")}}function k(t,e){return function(n){var r,s,i=Uet(1900,void 0,1);if(S(i,t,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(e&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(s=(r=Wet(Uet(i.y,0,1))).getUTCDay(),r=s>4||0===s?Eet.ceil(r):Eet(r),r=ket.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(s=(r=Vet(Uet(i.y,0,1))).getDay(),r=s>4||0===s?Met.ceil(r):Met(r),r=Pet.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),s="Z"in i?Wet(Uet(i.y,0,1)).getUTCDay():Vet(Uet(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(s+5)%7:i.w+7*i.U-(s+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Wet(i)):Vet(i)}}function S(t,e,n,r){for(var s,i,a=0,o=e.length,l=n.length;a<o;){if(r>=l)return-1;if(37===(s=e.charCodeAt(a++))){if(s=e.charAt(a++),!(i=_[s in Get?e.charAt(a++):s])||(r=i(t,n,r))<0)return-1}else if(s!=n.charCodeAt(r++))return-1}return r}return v.x=x(n,v),v.X=x(r,v),v.c=x(e,v),w.x=x(n,w),w.X=x(r,w),w.c=x(e,w),{format:function(t){var e=x(t+="",v);return e.toString=function(){return t},e},parse:function(t){var e=k(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=k(t+="",!0);return e.toString=function(){return t},e}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Het=jet.utcFormat,qet=jet.utcParse,function t(e,n,r){function s(t,s){var i,a,o=t[0],l=t[1],u=t[2],c=s[2],h=s[0]-o,d=s[1]-l,p=h*h+d*d;if(p<1e-12)a=Math.log(c/u)/e,i=function(t){return[o+t*h,l+t*d,u*Math.exp(e*t*a)]};else{var f=Math.sqrt(p),m=(c*c-u*u+r*p)/(2*u*n*f),g=(c*c-u*u-r*p)/(2*c*n*f),y=Math.log(Math.sqrt(m*m+1)-m),b=Math.log(Math.sqrt(g*g+1)-g);a=(b-y)/e,i=function(t){var r,s=t*a,i=crt(y),c=u/(n*f)*(i*(r=e*s+y,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(y));return[o+c*h,l+c*d,u*i/crt(e*s+y)]}}return i.duration=1e3*a*e/Math.SQRT2,i}return s.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},s}(Math.SQRT2,2,4),hrt.prototype={constructor:hrt,scale:function(t){return 1===t?this:new hrt(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new hrt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new hrt(1,0,0);class drt{constructor(t,e){this.el=null,this.margin=null,this.barHeight=null,this.height=null,this.container=null,this.svg=null,this.title=null,this.bar=null,this.gx=null,this.width=null,this.x=null,this.color=null,this.el=t,this.title=e,this.updateDimension=this.updateDimension.bind(this),this.initVis()}initVis(){const t=this;t.margin={top:24,right:16,bottom:24,left:32},t.barHeight=12,t.height=t.margin.top+t.margin.bottom+t.barHeight,t.container=N7(t.el).classed("legend-container sequential-legend",!0),t.svg=t.container.append("svg").style("display","block"),t.svg.append("text").attr("class","legend-title").attr("x",t.margin.left).attr("y",t.margin.top-8).attr("fill","currentColor").attr("font-weight","bold").text(t.title),t.bar=t.svg.append("image").attr("x",t.margin.left).attr("y",t.margin.top).attr("height",t.barHeight).attr("preserveAspectRatio","none"),t.gx=t.svg.append("g").attr("class","axis").attr("transform",`translate(0,${t.margin.top})`).attr("font-family","inherent"),t.updateDimension(),window.addEventListener("resize",t.updateDimension)}updateVis(){const t=this;var e;t.svg.attr("width",t.width).attr("height",t.height).attr("viewBox",[0,0,t.width,t.height]),t.bar.attr("width",t.width-t.margin.left-t.margin.right).attr("xlink:href",t.ramp(t.color.interpolator()).toDataURL()),t.gx.call((e=t.x,o8(3,e)).ticks(t.width/100).tickSize(t.barHeight).tickPadding(8)).attr("font-size",null).attr("font-family",null).call(t=>t.select(".domain").remove()).call(t=>t.selectAll(".tick line").attr("stroke","#fff")).call(e=>e.select(".tick text").text(t.color.domain()[0]))}updateDimension(){const t=this;t.width=t.container.node().clientWidth,t.x&&(t.x.range([t.margin.left,t.width-t.margin.right]),t.updateVis())}updateScale(t){const e=this;e.color=t,e.x=het().domain(t.domain()).range([e.margin.left,e.width-e.margin.right]).nice(),e.updateVis()}ramp(t,e=256){const n=document.createElement("canvas");n.width=e,n.height=1;const r=n.getContext("2d");for(let s=0;s<e;++s)r.fillStyle=t(s/(e-1)),r.fillRect(s,0,1,1);return n}destroyVis(){window.removeEventListener("resize",this.updateDimension),this.container.selectAll("*").remove()}}class prt{constructor(t){this.containerBox=null,this.el=null,this.paddingY=null,this.container=null,this.tooltip=null,this.tooltipBox=null,this.el=t,this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.move=this.move.bind(this),this.initVis()}initVis(){const t=this;t.paddingY=8,t.container=N7(t.el).classed("chart-tooltip-container",!0),t.tooltip=t.container.append("div").attr("class","chart-tooltip")}show(t){const e=this;e.tooltip.html(t).classed("show",!0),e.containerBox=e.el.getBoundingClientRect(),e.tooltipBox=e.tooltip.node().getBoundingClientRect()}hide(){this.tooltip.classed("show",!1)}move(t){const e=this,n=function(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}(t,e.el);let r=n[0]-e.tooltipBox.width/2;r<0?r=0:r+e.tooltipBox.width>e.containerBox.width&&(r=e.containerBox.width-e.tooltipBox.width);let s=n[1]-e.tooltipBox.height-e.paddingY;s<0&&(s=n[1]+e.paddingY,s+e.tooltipBox.height>e.containerBox.height&&(s=e.containerBox.height-e.tooltipBox.height)),e.tooltip.style("transform",`translate(${r}px,${s}px)`)}}class frt{constructor(t,e,n=!0,r=!0){this.el=null,this.data=null,this.seeSent=null,this.seeReceived=null,this.displayData=null,this.parseDate=null,this.formatDate=null,this.formatDisplayDate=null,this.formatDay=null,this.formatMonth=null,this.formatCount=null,this.formatPercentage=null,this.margin=null,this.color=null,this.container=null,this.legend=null,this.svg=null,this.tooltip=null,this.nGridColumns=null,this.gridSize=null,this.width=null,this.height=null,this.focusRect=null,this.el=t,this.data=e,this.seeSent=n,this.seeReceived=r,this.updateDimension=this.updateDimension.bind(this),this.tooltipContent=this.tooltipContent.bind(this),this.pathMonth=this.pathMonth.bind(this),this.initVis()}initVis(){const t=this;t.parseDate=qet("%Y-%m-%d"),t.formatDate=Het("%Y-%m-%d"),t.formatDisplayDate=Het("%b %d, %Y"),t.formatDay=t=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t],t.formatMonth=Het("%b"),t.formatCount=Ptt(","),t.formatPercentage=Ptt(".0%"),t.margin={top:24,right:16,bottom:8,left:32,innerTop:24,innerBottom:24},t.color=fet().interpolator(t=>yet(1-t)),t.container=N7(t.el).append("div").attr("class","yearly-heatmap"),t.legend=new drt(t.container.append("div").node(),"Number of messages "+[t.seeSent?"sent":"",t.seeReceived?"received":""].filter(t=>t).join(" + ")),t.svg=t.container.append("div").attr("class","chart-container").append("svg").style("display","block"),t.tooltip=new prt(t.container.node()),window.addEventListener("resize",t.updateDimension),t.updateDimension(),t.wrangleData()}wrangleData(){const t=this,e=new Map(t.data.map(t=>[t.date,t])),n=function(t,e){let n,r;if(void 0===e)for(const s of t)null!=s&&(void 0===n?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)));else{let s=-1;for(let i of t)null!=(i=e(i,++s))&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}(t.data,e=>t.parseDate(e.date)),r=ket.range(n[0],ket.offset(n[1]),1).map(n=>{const r=t.formatDate(n),s=e.get(r);let i=[{key:"sent",value:0,percentage:0},{key:"received",value:0,percentage:0}],a=[];s&&(Object.keys(s).filter(t=>"date"!==t).forEach(t=>{"you"===t?i.find(t=>"sent"===t.key).value+=s[t]:i.find(t=>"received"===t.key).value+=s[t],a.push({key:t,value:s[t]})}),a.sort((t,e)=>function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}(t.value,e.value)));const o=Q5(i,t=>t.value);let l;return i.unshift({key:"total",value:o,percentage:0}),o>0&&(i.forEach(t=>t.percentage=t.value/o),a.forEach(t=>t.percentage=t.value/o)),t.seeSent&&t.seeReceived?l=i.find(t=>"total"===t.key):t.seeSent?l=i.find(t=>"sent"===t.key):t.seeReceived&&(l=i.find(t=>"received"===t.key)),l&&(l.see=!0),{date:r,parsedDate:n,values:a,summary:i,seeTotal:l?l.value:0,total:o}}),s=Math.ceil(Y5(r.map(t=>t.seeTotal).sort(V5),.99));t.color.domain([1,s]),t.displayData=function(t,...e){return function(t,e,n,r){return function t(s,i){if(i>=r.length)return n(s);const a=new Map,o=r[i++];let l=-1;for(const e of s){const t=o(e,++l,s),n=a.get(t);n?n.push(e):a.set(t,[e])}for(const[e,n]of a)a.set(e,t(n,i));return e(a)}(t,0)}(t,Array.from,H5,e)}(r,t=>t.parsedDate.getUTCFullYear());const i=q5(t.displayData,([t,e])=>{const n=new Date(t,11,31);return Iet.count(Det(n),n)});t.nGridColumns=i+1,t.legend.updateScale(t.color),t.updateVis()}updateVis(){const t=this;t.gridSize=(t.width-t.margin.left-t.margin.right)/t.nGridColumns,t.height=t.margin.top+t.margin.bottom+t.displayData.length*(7*t.gridSize)+(t.displayData.length-1)*(t.margin.innerTop+t.margin.innerBottom);const e=t.svg.attr("width",t.width).attr("height",t.height).attr("viewBox",[0,0,t.width,t.height]).selectAll(".year-g").data(t.displayData,([t,e])=>t).join(t=>t.append("g").attr("class","year-g").call(t=>t.append("text").attr("class","year-label").attr("x",-8).attr("y",-8).attr("text-anchor","end").attr("font-weight","bold").text(([t,e])=>t)).call(t=>t.append("g").attr("class","day-labels").attr("text-anchor","end")).call(t=>t.append("g").attr("class","month-labels")).call(t=>t.append("g").attr("class","grid-rects")).call(t=>t.append("g").attr("class","month-paths").attr("fill","none")).call(t=>t.append("rect").attr("class","focus-rect").attr("fill","none"))).attr("transform",(e,n)=>`translate(${t.margin.left},${t.margin.top+n*(7*t.gridSize+t.margin.innerTop+t.margin.innerBottom)})`);e.select(".day-labels").selectAll(".day-label").data(Z5(7)).join(e=>e.append("text").attr("class","day-label").attr("x",-8).attr("dy","0.31em").text(t.formatDay)).attr("y",e=>(e+.5)*t.gridSize),e.select(".month-labels").selectAll(".month-label").data(([t,e])=>Ret(Aet(e[0].parsedDate),Aet.offset(Aet(e[e.length-1].parsedDate),1)),t.formatMonth).join(e=>e.append("text").attr("class","month-label").attr("y",-8).text(t.formatMonth)).attr("x",e=>Iet.count(Det(e),Iet.floor(e))*t.gridSize+1),e.select(".grid-rects").selectAll(".grid-rect").data(([t,e])=>e,t=>t.date).join(e=>e.append("rect").attr("class","grid-rect").on("mouseover",function(e,n){const r=N7(this);t.focusRect=N7(this.parentNode.parentNode).select(".focus-rect").classed("show",!0).attr("x",r.attr("x")).attr("y",r.attr("y")).attr("fill",r.attr("fill")),t.tooltip.show(t.tooltipContent(n))}).on("mouseout",function(){t.focusRect.classed("show",!1),t.focusRect=null,t.tooltip.hide()}).on("mousemove",t.tooltip.move)).attr("width",t.gridSize-1).attr("height",t.gridSize-1).attr("x",e=>Iet.count(Det(e.parsedDate),e.parsedDate)*t.gridSize+.5).attr("y",e=>e.parsedDate.getUTCDay()*t.gridSize+.5).attr("fill",e=>e.seeTotal?t.color(e.seeTotal):"#fff"),e.select(".month-paths").selectAll(".month-path").data(([t,e])=>Ret(Aet(e[0].parsedDate),Aet.offset(Aet(e[e.length-1].parsedDate),1)),t.formatMonth).join(t=>t.append("path").attr("class","month-path").attr("stroke","#fff").attr("stroke-width",3)).attr("d",t.pathMonth),e.select(".focus-rect").attr("width",t.gridSize-1).attr("height",t.gridSize-1)}updateDimension(){const t=this;t.width=t.container.node().clientWidth,t.displayData&&t.updateVis()}pathMonth(t){const e=this,n=Math.max(0,Math.min(7,t.getUTCDay())),r=Iet.count(Det(t),t);return`${0===n?`M${r*e.gridSize},0`:7===n?`M${(r+1)*e.gridSize},0`:`M${(r+1)*e.gridSize},0V${n*e.gridSize}H${r*e.gridSize}`}V${7*e.gridSize}`}tooltipContent(t){const e=this;let n=`<div>${e.formatDisplayDate(t.parsedDate)}</div>`;return t.total>0&&(n+=`\n      <div class="table-title">Summary</div>\n      <table>\n        <tbody>\n          ${t.summary.map(t=>`\n            <tr>\n              <td class="${t.see?"strong":null}">${t.key}</td>\n              <td style="text-align: right;" class="${t.see?"strong":null}">${e.formatCount(t.value)}</td>\n              <td style="text-align: right;" class="${t.see?"strong":null}">${e.formatPercentage(t.percentage)}</td>\n            </tr>\n          `).join("")}\n        </tbody>\n      </table>\n      <div class="table-title">Details</div>\n      <table>\n        <tbody>\n          ${t.values.map(t=>`\n            <tr>\n              <td>${t.key}</td>\n              <td style="text-align: right;">${e.formatCount(t.value)}</td>\n              <td style="text-align: right;">${e.formatPercentage(t.percentage)}</td>\n            </tr>\n          `).join("")}\n        </tbody>\n      </table>\n    `),n}destroyVis(){const t=this;t.legend.destroyVis(),window.removeEventListener("resize",t.updateDimension),t.container.selectAll("*").remove()}}class mrt{constructor(t,e,n=!0,r=!0){this.container=null,this.el=null,this.data=null,this.seeSent=null,this.seeReceived=null,this.displayData=null,this.formatDay=null,this.formatHour=null,this.formatDisplayHour=null,this.formatCount=null,this.formatPercentage=null,this.margin=null,this.legend=null,this.color=null,this.days=null,this.hours=null,this.svg=null,this.gridSize=null,this.width=null,this.height=null,this.focusRect=null,this.tooltip=null,this.el=t,this.data=e,this.seeSent=n,this.seeReceived=r,this.updateDimension=this.updateDimension.bind(this),this.tooltipContent=this.tooltipContent.bind(this),this.initVis()}initVis(){const t=this;t.formatDay=t=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t],t.formatHour=t=>t,t.formatDisplayHour=t=>t+":00",t.formatCount=Ptt(","),t.formatPercentage=Ptt(".0%"),t.margin={top:24,right:16,bottom:8,left:32},t.color=fet().interpolator(t=>yet(1-t)),t.container=N7(t.el).append("div").attr("class","weekly-heatmap"),t.legend=new drt(t.container.append("div").node(),"Number of messages "+[t.seeSent?"sent":"",t.seeReceived?"received":""].filter(t=>t).join(" + ")),t.svg=t.container.append("div").attr("class","chart-container").append("svg").style("display","block"),t.tooltip=new prt(t.container.node()),t.svg.append("g").attr("transform",`translate(${t.margin.left},${t.margin.top})`).call(t=>t.append("g").attr("class","day-labels").attr("text-anchor","end")).call(t=>t.append("g").attr("class","hour-labels")).call(t=>t.append("g").attr("class","grid-rects")).call(t=>t.append("rect").attr("class","focus-rect").attr("fill","none")),t.focusRect=t.svg.select(".focus-rect"),window.addEventListener("resize",t.updateDimension),t.updateDimension(),t.wrangleData()}wrangleData(){const t=this;t.days=Z5(7),t.hours=Z5(24),t.displayData=function(...t){const e="function"==typeof t[t.length-1]&&function(t){return e=>t(...e)}(t.pop()),n=(t=t.map(j5)).map(W5),r=t.length-1,s=new Array(r+1).fill(0),i=[];if(r<0||n.some(U5))return i;for(;;){i.push(s.map((e,n)=>t[n][e]));let a=r;for(;++s[a]===n[a];){if(0===a)return e?i.map(e):i;s[a--]=0}}}(t.days,t.hours).map(([e,n])=>{const r=t.data.find(t=>t.day===e&&t.hour===n);let s=[{key:"sent",value:0,percentage:0},{key:"received",value:0,percentage:0}];r&&s.forEach(t=>t.value+=r[t.key]);const i=Q5(s,t=>t.value);let a;return s.unshift({key:"total",value:i,percentage:0}),i>0&&s.forEach(t=>t.percentage=t.value/i),t.seeSent&&t.seeReceived?a=s.find(t=>"total"===t.key):t.seeSent?a=s.find(t=>"sent"===t.key):t.seeReceived&&(a=s.find(t=>"received"===t.key)),a&&(a.see=!0),{day:e,hour:n,summary:s,seeTotal:a?a.value:0,total:i}});const e=Math.ceil(Y5(t.displayData.map(t=>t.seeTotal).sort(V5),.99));t.color.domain([1,e]),t.legend.updateScale(t.color),t.updateVis()}updateVis(){const t=this;t.gridSize=(t.width-t.margin.left-t.margin.right)/t.hours.length,t.height=t.margin.top+t.margin.bottom+t.days.length*t.gridSize,t.svg.attr("width",t.width).attr("height",t.height).attr("viewBox",[0,0,t.width,t.height]),t.svg.select(".day-labels").selectAll(".day-label").data(t.days).join(e=>e.append("text").attr("class","day-label").attr("x",-8).attr("dy","0.31em").text(t.formatDay)).attr("y",e=>(e+.5)*t.gridSize),t.svg.select(".hour-labels").selectAll(".hour-label").data(t.hours).join(e=>e.append("text").attr("class","hour-label").attr("y",-8).text(t.formatHour)).attr("x",e=>(e+.5)*t.gridSize),t.svg.select(".grid-rects").selectAll(".grid-rect").data(t.displayData,t=>`${t.day}-${t.hour}`).join(e=>e.append("rect").attr("class","grid-rect").on("mouseover",function(e,n){const r=N7(this);t.focusRect.classed("show",!0).attr("x",r.attr("x")).attr("y",r.attr("y")).attr("fill",r.attr("fill")),t.tooltip.show(t.tooltipContent(n))}).on("mouseout",function(){t.focusRect.classed("show",!1),t.tooltip.hide()}).on("mousemove",t.tooltip.move)).attr("width",t.gridSize-1).attr("height",t.gridSize-1).attr("x",e=>e.hour*t.gridSize+.5).attr("y",e=>e.day*t.gridSize+.5).attr("fill",e=>e.seeTotal?t.color(e.seeTotal):"#fff"),t.focusRect.attr("width",t.gridSize-1).attr("height",t.gridSize-1)}updateDimension(){const t=this;t.width=t.container.node().clientWidth,t.displayData&&t.updateVis()}tooltipContent(t){const e=this;let n=`<div>${e.formatDisplayHour(t.hour)} ${e.formatDay(t.day)}</div>`;return t.total>0&&(n+=`\n      <div class="table-title">Summary</div>\n      <table>\n        <tbody>\n          ${t.summary.map(t=>`\n            <tr>\n              <td class="${t.see?"strong":null}">${t.key}</td>\n              <td style="text-align: right;" class="${t.see?"strong":null}">${e.formatCount(t.value)}</td>\n              <td style="text-align: right;" class="${t.see?"strong":null}">${e.formatPercentage(t.percentage)}</td>\n            </tr>\n          `).join("")}\n        </tbody>\n      </table>\n    `),n}destroyVis(){const t=this;t.legend.destroyVis(),window.removeEventListener("resize",t.updateDimension),t.container.selectAll("*").remove()}}function grt(t,e){1&t&&(Ya(0,"mat-card",3),Ya(1,"mat-card-header"),Ya(2,"div",4),Ya(3,"mat-icon",5),Do(4,"emoji_people"),Za(),Za(),Ya(5,"mat-card-title"),Do(6,"Hello! Welcome"),Za(),Ya(7,"mat-card-subtitle"),Do(8,"Some information for you before starting"),Za(),Za(),Ya(9,"mat-card-content"),Ya(10,"div"),Ya(11,"h3"),Do(12,"What is this?"),Za(),Ya(13,"p"),Do(14,"Sometimes it's useful to review how you communicate with friends to better understand your own interactions and that of your friends. Context and tone are lost while communicating over text and as a result misunderstandings are common. This tool is meant to eventually be an aid to you and help you understand how you and your friends communicate. It's very much a work in progress. "),Za(),Ya(15,"ul"),Ya(16,"li",6),Do(17,"It's excellent practice to "),Ya(18,"b"),Do(19,"disconnect"),Za(),Do(20," your computer's internet / wifi before you do this."),Za(),Ya(21,"li",6),Do(22,"Ideally you've opened this page in "),Ya(23,"b"),Do(24,"incognito"),Za(),Do(25," mode as well. The "),Ya(26,"code"),Do(27,"chat.db"),Za(),Do(28," file isn't something you want to share."),Za(),Za(),Ya(29,"h3"),Do(30,"Instructions"),Za(),Ya(31,"ol"),Ya(32,"li"),Do(33," You will need to copy the "),Ya(34,"code"),Do(35,"chat.db"),Za(),Do(36," file to your desktop. Open the "),Ya(37,"code"),Do(38,"terminal"),Za(),Do(39," application and run the following "),Ya(40,"code"),Do(41,"sudo"),Za(),Do(42," command. "),Ya(43,"div",7),Ya(44,"code",8),Do(45,"> sudo cp ~/Library/Messages/chat.db ~/Desktop"),Za(),Qa(46,"br"),Ya(47,"code",8),Do(48,"Password: "),Za(),Ya(49,"code",9),Do(50,"secret"),Za(),Za(),Za(),Ya(51,"li"),Do(52,"check that the "),Ya(53,"code"),Do(54,"chat.db"),Za(),Do(55," file is on your desktop"),Za(),Ya(56,"li"),Do(57,'click the hamburger icon at the top left of this page and select "Load file". Find '),Ya(58,"code"),Do(59,"chat.db"),Za(),Do(60," - it's on your desktop"),Za(),Ya(61,"li"),Do(62,"let this website take time to load and process your file"),Za(),Ya(63,"li"),Do(64,"delete the "),Ya(65,"code"),Do(66,"chat.db"),Za(),Do(67," file from your desktop"),Za(),Za(),Ya(68,"h3"),Do(69,"Background"),Za(),Ya(70,"p"),Do(71," This site was built using "),Ya(72,"code"),Do(73,"VSCode"),Za(),Do(74,", "),Ya(75,"code"),Do(76,"angular"),Za(),Do(77,", "),Ya(78,"code"),Do(79,"matrials"),Za(),Do(80,", "),Ya(81,"code"),Do(82,"d3.js"),Za(),Do(83," and "),Ya(84,"code"),Do(85,"sql.js"),Za(),Za(),Za(),Za(),Ya(86,"mat-card-actions"),Ya(87,"button",10),Do(88,"Got it"),Za(),Za(),Za())}function yrt(t,e){1&t&&(Ya(0,"mat-card",11),Ya(1,"mat-card-header"),Ya(2,"div",4),Ya(3,"mat-icon",5),Do(4,"bar_chart"),Za(),Za(),Ya(5,"mat-card-title"),Do(6,"Message view over time"),Za(),Ya(7,"mat-card-subtitle"),Do(8,"Take a look at the number of messages per day over a long time"),Za(),Za(),Ya(9,"mat-card-content"),Qa(10,"div",12),Za(),Ya(11,"mat-card-actions"),Ya(12,"button",10),Do(13,"NOTHING"),Za(),Za(),Za())}function brt(t,e){1&t&&(Ya(0,"mat-card",13),Ya(1,"mat-card-header"),Ya(2,"div",4),Ya(3,"mat-icon",5),Do(4,"bar_chart"),Za(),Za(),Ya(5,"mat-card-title"),Do(6,"Hour and day of week"),Za(),Ya(7,"mat-card-subtitle"),Do(8,"Look at what time and day you send/receive the most messages"),Za(),Za(),Ya(9,"mat-card-content"),Qa(10,"div",14),Za(),Ya(11,"mat-card-actions"),Ya(12,"button",10),Do(13,"NOTHING"),Za(),Za(),Za())}const vrt=[{path:"chats",component:P5},{path:"entities",component:z5},{path:"sentiments",component:B5},{path:"",component:(()=>{class t{constructor(t,e){this.dbservice=t,this.mainapp=e,this.selecteddb=null,this.yearlyQuery="SELECT date(message.date / 1000000000 + strftime('%s', '2001-01-01'), 'unixepoch', 'localtime') AS date, id AS number,  is_sent,  count( * ) AS count FROM message  LEFT JOIN  handle ON message.handle_id = handle.ROWID WHERE handle.ROWID != 0 GROUP BY date, id, is_sent ORDER BY date ASC;",this.weeklyQuery="SELECT strftime('%w',message.date / 1000000000 + strftime('%s', '2001-01-01'), 'unixepoch', 'localtime') as day, strftime('%H',message.date / 1000000000 + strftime('%s', '2001-01-01'), 'unixepoch', 'localtime') as hour,  sum(case when is_sent = 1 then 1 else 0 end) as sent, sum(case when is_sent = 0 then 1 else 0 end) as received FROM message GROUP BY day, hour ORDER BY day, hour;",this.yearlyMap=null,this.weeklyMap=null,this.infocard=null,this.yearlycard=null,this.yearlyCache={},this.weeklyCache={},this.weeklycard=null,this.dataReceived=!1,this.receiveMultiple=(function(t,e){console.log("HomeViewComponent:receiveMultiple"),this.updateYearlyView(t,e[0]),this.updateWeeklyView(t,e[1])}).bind(this),this.updateYearlyView=(function(t,e){console.log("HomeViewComponent:updateYearlyView");var n=[],r={};for(let l in e.values){var s=e.values[l][0],i=e.values[l][1],a=e.values[l][2],o=e.values[l][3];s.toString()in r||(r[s.toString()]={date:s,you:0}),a?r[s.toString()].you+=1:i.toString()in r[s.toString()]?r[s.toString()][i.toString()]+=o:r[s.toString()][i.toString()]=o}for(let l in r)n.push(r[l]);this.yearlyCache[this.selecteddb.toString()]=n,this.dataReceived=!0}).bind(this),this.updateWeeklyView=(function(t,e){console.log("updateWeeklyView");var n=[];for(let o in e.values){var r=Number(e.values[o][0]),s=Number(e.values[o][1]),i=Number(e.values[o][2]),a=Number(e.values[o][3]);n.push({day:r,hour:s,sent:i,received:a})}this.weeklyCache[this.selecteddb.toString()]=n,this.dataReceived=!0}).bind(this);const n=this;this.mainapp.db_change_share.subscribe(t=>{null!==t&&n.selecteddb!=t&&(n.selecteddb=t,n.selecteddb.toString()in n.yearlyCache||(n.yearlyCache[n.selecteddb.toString()]=null,n.dbservice.exec(n.selecteddb,n.yearlyQuery.toString()+n.weeklyQuery.toString(),n.receiveMultiple)))})}ngAfterViewChecked(){if(null==this.selecteddb)return;if(0==this.dataReceived)return;this.yearlycard=document.querySelector("#yearly-heatmap");const t=this.yearlyCache[this.selecteddb.toString()];t&&(this.yearlyMap=new frt(this.yearlycard,t,!1,!0)),this.weeklycard=document.querySelector("#weekly-heatmap");const e=this.weeklyCache[this.selecteddb.toString()];e&&(this.weeklyMap=new mrt(this.weeklycard,e,!1,!0)),this.infocard=document.querySelector(".infocard"),this.dataReceived=!1}}return t.\u0275fac=function(e){return new(e||t)(Ga($C),Ga(LC))},t.\u0275cmp=fe({type:t,selectors:[["app-home-view"]],decls:3,vars:3,consts:[["class","infocard","style","background-color: aliceblue;",4,"ngIf"],["class","yearly-card","style","background-color: aliceblue;",4,"ngIf"],["class","weeklytime-card","style","background-color: aliceblue;",4,"ngIf"],[1,"infocard",2,"background-color","aliceblue"],["mat-card-avatar","",1,"example-header-image"],[1,"chat-icon"],[2,"color","crimson"],[2,"width","400px","margin-left","0px","border-radius","5px","background-color","midnightblue"],[2,"color","blanchedalmond","margin-left","10px"],[2,"color","yellow"],["mat-button",""],[1,"yearly-card",2,"background-color","aliceblue"],["id","yearly-heatmap"],[1,"weeklytime-card",2,"background-color","aliceblue"],["id","weekly-heatmap"]],template:function(t,e){1&t&&(Ha(0,grt,89,0,"mat-card",0),Ha(1,yrt,14,0,"mat-card",1),Ha(2,brt,14,0,"mat-card",2)),2&t&&(Ka("ngIf",!e.selecteddb),vi(1),Ka("ngIf",e.selecteddb),vi(1),Ka("ngIf",e.selecteddb))},directives:[Yc,bw,vw,yw,ub,fw,mw,pw,gw,zv],styles:[".mat-card[_ngcontent-%COMP%]{margin:20px}.day[_ngcontent-%COMP%]{fill:#fff;stroke:#ccc}.month[_ngcontent-%COMP%]{fill:none;stroke:#000;stroke-width:2px}.RdYlGn[_ngcontent-%COMP%]   .q0-11[_ngcontent-%COMP%]{fill:#a50026}.RdYlGn[_ngcontent-%COMP%]   .q1-11[_ngcontent-%COMP%]{fill:#d73027}.RdYlGn[_ngcontent-%COMP%]   .q2-11[_ngcontent-%COMP%]{fill:#f46d43}.RdYlGn[_ngcontent-%COMP%]   .q3-11[_ngcontent-%COMP%]{fill:#fdae61}.RdYlGn[_ngcontent-%COMP%]   .q4-11[_ngcontent-%COMP%]{fill:#fee08b}.RdYlGn[_ngcontent-%COMP%]   .q5-11[_ngcontent-%COMP%]{fill:#ffffbf}.RdYlGn[_ngcontent-%COMP%]   .q6-11[_ngcontent-%COMP%]{fill:#d9ef8b}.RdYlGn[_ngcontent-%COMP%]   .q7-11[_ngcontent-%COMP%]{fill:#a6d96a}.RdYlGn[_ngcontent-%COMP%]   .q8-11[_ngcontent-%COMP%]{fill:#66bd63}.RdYlGn[_ngcontent-%COMP%]   .q9-11[_ngcontent-%COMP%]{fill:#1a9850}.RdYlGn[_ngcontent-%COMP%]   .q10-11[_ngcontent-%COMP%]{fill:#006837}"]}),t})()}];let wrt=(()=>{class t{}return t.\u0275mod=be({type:t}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},imports:[[bC.forRoot(vrt)],bC]}),t})(),_rt=(()=>{class t{}return t.\u0275mod=be({type:t,bootstrap:[LC]}),t.\u0275inj=Pt({factory:function(e){return new(e||t)},providers:[$C],imports:[[Lh,wrt,lg,ey,Iy,Dv,Bv,cb,ew,lw,ww,Md,rx,D_,ix,px]]}),t})();(function(){if(ic)throw new Error("Cannot enable prod mode after platform setup.");sc=!1})(),$h().bootstrapModule(_rt).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);